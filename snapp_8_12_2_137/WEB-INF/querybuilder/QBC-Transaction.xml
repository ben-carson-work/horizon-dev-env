<?xml version="1.0" encoding="UTF-8"?>
<DOQueryBuilderCollection>
  <CollectionName>Transaction</CollectionName>
  <MainTableName>tbTransaction</MainTableName> 
  <MainTableAlias>TRN</MainTableAlias>

  <FieldList>
    <Field TableAlias="TRN" FieldName="TransactionId" FieldAlias="TransactionId" DataType="11"/>
    <Field TableAlias="TRN" FieldName="TransactionFiscalDate" FieldAlias="TransactionFiscalDate" DataType="30"/>
    <Field TableAlias="TRN" FieldName="TransactionDateTime" FieldAlias="TransactionDateTime" DataType="31"/>
    <Field FieldType="20" FieldAlias="TransactionTime" DataType="32" SQL="Cast(TRN.TransactionDateTime as time)"/>
    <Field TableAlias="TRN" FieldName="SerialFiscalDate" FieldAlias="SerialFiscalDate" DataType="30"/>
    <Field TableAlias="TRN" FieldName="SerialDateTime" FieldAlias="SerialDateTime" DataType="31"/>
    <Field TableAlias="TRN" FieldName="TransactionSerial" FieldAlias="TransactionSerial" DataType="20"/>
    <Field TableAlias="TRN" FieldName="TransactionType" FieldAlias="TransactionType" DataType="20"/>
    <Field TableAlias="TRN" FieldName="TransactionType" FieldAlias="TransactionTypeDesc" DataType="12" LookupTable="3"/>
    <Field TableAlias="SAL" FieldName="SaleCode" FieldAlias="PNR" DataType="10"/>
    <Field TableAlias="EC" FieldName="EntityChangeId" FieldAlias="EntityChangeId" DataType="20"/>
    <Field FieldType="20" FieldAlias="TransactionCode" DataType="10" 
        SQL="'T:' + Cast(TRN.LicenseId as varchar(max)) + '.' + Cast(TRN.StationSerial as varchar(max)) + '.' + Convert(varchar, TRN.SerialFiscalDate, 12) + '.' + Cast(TRN.TransactionSerial as varchar(max))" 
    />
    <Field TableAlias="FirstPay" FieldName="PluginId" FieldAlias="FirstPaymentMethodId" DataType="11"/>
    <Field TableAlias="FirstPayPlg" FieldName="PluginName" FieldAlias="FirstPaymentMethodName" DataType="10"/>
    <Field TableAlias="FirstPayPlg" FieldName="PluginCode" FieldAlias="FirstPaymentMethodCode" DataType="10"/>
    <Field TableAlias="WKS" FieldName="LocationAccountId" FieldAlias="LocationId" DataType="1001"/>
    <Field TableAlias="LOC" FieldName="AccountCode" FieldAlias="LocationCode" DataType="10"/>
    <Field TableAlias="LOC" FieldName="DisplayName" FieldAlias="LocationName" DataType="10"/>
    <Field TableAlias="WKS" FieldName="OpAreaAccountId" FieldAlias="OpAreaId" DataType="1002"/>
    <Field TableAlias="OPA" FieldName="AccountCode" FieldAlias="OpAreaCode" DataType="10"/>
    <Field TableAlias="OPA" FieldName="DisplayName" FieldAlias="OpAreaName" DataType="10"/>
    <Field TableAlias="TRN" FieldName="WorkstationId" FieldAlias="WorkstationId" DataType="1003"/>
    <Field TableAlias="WKS" FieldName="WorkstationCode" FieldAlias="WorkstationCode" DataType="10"/>
    <Field TableAlias="WKS" FieldName="WorkstationName" FieldAlias="WorkstationName" DataType="10"/>
    <Field TableAlias="TRN" FieldName="UserAccountId" FieldAlias="UserAccountId" DataType="1004"/>
    <Field TableAlias="USR" FieldName="DisplayName" FieldAlias="UserAccountName" DataType="10"/>
    <Field TableAlias="USR_NAME" FieldName="UserName" FieldAlias="UserLoginName" DataType="10"/>
    <Field TableAlias="USR_EMAIL" FieldName="UserName" FieldAlias="UserLoginEmail" DataType="10"/>
    <Field TableAlias="TRN" FieldName="Approved" FieldAlias="Approved" DataType="100"/>
    <Field TableAlias="TRN" FieldName="Paid" FieldAlias="Paid" DataType="100"/>
    <Field TableAlias="TRN" FieldName="Encoded" FieldAlias="Encoded" DataType="100"/>
    <Field TableAlias="TRN" FieldName="Printed" FieldAlias="Printed" DataType="100"/>
    <Field TableAlias="TRN" FieldName="Validated" FieldAlias="Validated" DataType="100"/>
    <Field TableAlias="TRN" FieldName="ItemCount" FieldAlias="ItemCount" DataType="20"/>
    <Field TableAlias="TRN" FieldName="TotalAmount" FieldAlias="TotalAmount" DataType="23"/>
    <Field TableAlias="TRN" FieldName="TotalTax" FieldAlias="TotalTax" DataType="23"/>
    <Field TableAlias="TRN" FieldName="PaidAmount" FieldAlias="PaidAmount" DataType="23"/>
    <Field TableAlias="TRN" FieldName="PaidTax" FieldAlias="PaidTax" DataType="23"/>
  </FieldList>
  
  <TableList>
    <Table TableAlias="SAL" TableName="tbSale" ParentTableAlias="tbSale" OnClause="SAL.SaleId=TRN.SaleId"/>
    <Table TableAlias="FirstPay" TableName="tbPayment" ParentTableAlias="TRN" OnClause="FirstPay.PaymentId=(select top 1 PaymentId from tbPayment where TransactionId=TRN.TransactionId)"/>
    <Table TableAlias="FirstPayPlg" TableName="tbPlugin" ParentTableAlias="FirstPay" OnClause="FirstPayPlg.PluginId=FirstPay.PluginId"/>
    <Table TableAlias="EC" TableName="tbEntityChange" ParentTableAlias="FirstPay" OnClause="EC.EntityId=TRN.TransactionId"/>
    <Table TableAlias="WKS" TableName="tbWorkstation" ParentTableAlias="TRN" OnClause="WKS.WorkstationId=TRN.WorkstationId"/>
    <Table TableAlias="LOC" TableName="tbAccount" ParentTableAlias="WKS" OnClause="LOC.AccountId=WKS.LocationAccountId"/>
    <Table TableAlias="OPA" TableName="tbAccount" ParentTableAlias="WKS" OnClause="OPA.AccountId=WKS.OpAreaAccountId"/>
    <Table TableAlias="USR" TableName="tbAccount" ParentTableAlias="TRN" OnClause="USR.AccountId=TRN.UserAccountId"/>
    <Table TableAlias="USR_NAME" TableName="tbLoginAlias" ParentTableAlias="USR" OnClause="USR_NAME.AccountId=USR.AccountId and USR_NAME.LoginAliasType=0"/>
    <Table TableAlias="USR_EMAIL" TableName="tbLoginAlias" ParentTableAlias="USR" OnClause="USR_EMAIL.AccountId=USR.AccountId and USR_EMAIL.LoginAliasType=1"/>
  </TableList>
  
  <ForeignKeyList>
    <ForeignKey ParentCollectionName="Payment" ParentFieldAlias="TransactionId" ChildFieldAlias="TransactionId"/>
  </ForeignKeyList>
</DOQueryBuilderCollection>