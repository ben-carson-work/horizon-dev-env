<?xml version="1.0" encoding="UTF-8" ?>
<project name="SqlServer" database="SqlServer" id="SnAppProject" >
	<schema name="dbo" catalogname="SnApp" >
		<table name="tbAccessPoint" >
			<comment><![CDATA[Extension table for tbWorkstation]]></comment>
			<column name="AptWorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID. Same as tbWorkstation.WorkstationId]]></comment>
			</column>
			<column name="ControllerWorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[ID of the workstation (TOR) controlling this device]]></comment>
			</column>
			<column name="EntryControl" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[43]]]></comment>
			</column>
			<column name="ExitControl" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[43]]]></comment>
			</column>
			<column name="ReentryControl" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[44]]]></comment>
			</column>
			<column name="CounterMode" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[45]]]></comment>
			</column>
			<column name="EntryCount" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Not Yet Used]]></comment>
			</column>
			<column name="ExitCount" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Not Yet Used]]></comment>
			</column>
			<column name="HardwareCode" type="varchar" length="10" jt="12" >
				<comment><![CDATA[Use to identify specific device (like dragon barcode gun). Vary from device to device.]]></comment>
			</column>
			<column name="DriverId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Driver type for this access point]]></comment>
			</column>
			<column name="QueueControl" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Not Yet Used]]></comment>
			</column>
			<column name="Settings" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[JSON variable data settings. Vary device from device]]></comment>
			</column>
			<column name="CheckValidPerformance" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Force the mobile admisson application to allow the access control only if there is a valid performance]]></comment>
			</column>
			<index name="PK_AccessPoint" unique="PRIMARY_KEY" >
				<column name="AptWorkstationId" />
			</index>
			<index name="IX_AccessPoint_ControllerWorkstationId" unique="NORMAL" >
				<column name="ControllerWorkstationId" />
			</index>
			<index name="IX_AccessPoint_DriverId" unique="NORMAL" >
				<column name="DriverId" />
			</index>
			<fk name="FK_AccessPoint_AptWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="AptWorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_AccessPoint_ControllerWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="ControllerWorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_AccessPoint_Driver" to_schema="SnApp.dbo" to_table="tbDriver" >
				<fk_column name="DriverId" pk="DriverId" />
			</fk>
		</table>
		<table name="tbAccessPoint2Area" >
			<comment><![CDATA[Enlist the access areas accessible by each access point.
Note that this table could be empty for a specific APT, and access areas inherted from gate (operatinga are - tbAccount) level]]></comment>
			<column name="AptWorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the access point]]></comment>
			</column>
			<column name="AccessAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the access area]]></comment>
			</column>
			<index name="IX_AccessPoint2Area_AccessAreaAccountId" unique="NORMAL" >
				<column name="AccessAreaAccountId" options="ASC" />
			</index>
			<index name="PK_AccessPoint2Area" unique="PRIMARY_KEY" >
				<column name="AptWorkstationId" />
				<column name="AccessAreaAccountId" />
			</index>
			<fk name="FK_AccountPoint2Area_AccessAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccessAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountPoint2Area_AccessPoint" to_schema="SnApp.dbo" to_table="tbAccessPoint" delete_action="cascade" >
				<fk_column name="AptWorkstationId" pk="AptWorkstationId" />
			</fk>
		</table>
		<table name="tbAccessPointDescription" prior="Tbl" >
			<comment><![CDATA[Access point descriptions can be different according to their date range validity]]></comment>
			<column name="AccessPointId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to access point internal id]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Start validity of the description]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[End validity of the description. If null the descricption does not expire]]></comment>
			</column>
			<column name="Description" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Access point' s description]]></comment>
			</column>
			<index name="PK_AccessPointDescription" unique="PRIMARY_KEY" >
				<column name="AccessPointId" />
				<column name="ValidDateFrom" />
			</index>
			<fk name="FK_AccessPointDescription_AccessPoint" to_schema="SnApp.dbo" to_table="tbAccessPoint" delete_action="cascade" >
				<fk_column name="AccessPointId" pk="AptWorkstationId" />
			</fk>
		</table>
		<table name="tbAccount" >
			<comment><![CDATA[Holds data for accounts (organizations and people) but is used as well to store (field EntityType indicates the nature of the record):
- Licensee
- Locations
- Op. Areas
- Access Areas
- Resources]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LicenseId" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Licensee owning this record]]></comment>
			</column>
			<column name="ParentAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the parent account (IE: users of an organization; op.areas of a location; etc)]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="AccountStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[130] Active, Blocked, Deleted]]></comment>
			</column>
			<column name="AccountCode" type="varchar" length="20" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Internal, autogenerated alphanumeric code (use not yet defined)]]></comment>
			</column>
			<column name="DisplayName" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Full name of the account. Calculated in case of Organization/People, user defined for other purposes (like op.area name)]]></comment>
			</column>
			<column name="CreateDateTime" type="timestamp" jt="93" mandatory="y" >
				<comment><![CDATA[Record creation date/time]]></comment>
			</column>
			<column name="CreateEmptyAccount" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if the account was "empty account" when created.]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" />
			<column name="AccountVersion" type="bigint" jt="-5" >
				<comment><![CDATA[Autoinc field updated everytime the entity (in this specific record or any dependant) is modified. To be used for differential reports]]></comment>
			</column>
			<column name="AccountSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number starting from 1]]></comment>
			</column>
			<column name="AccountSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with AccountSequence to create encrypted barcodes]]></comment>
			</column>
			<column name="RetentionDate" type="date" jt="91" >
				<comment><![CDATA[Date (calculated based on different parameters) on which to apply expiration/purging rules.
Normally this date is the creation/update date or the visit date]]></comment>
			</column>
			<index name="UQ_Account_AccountCode" unique="UNIQUE_KEY" >
				<column name="AccountCode" options="ASC" />
			</index>
			<index name="IX_Account_Status" unique="NORMAL" >
				<column name="EntityType" options="ASC" />
				<column name="AccountStatus" options="ASC" />
				<column name="DisplayName" options="ASC" />
			</index>
			<index name="IX_Account_EntityType" unique="NORMAL" >
				<column name="EntityType" options="ASC" />
				<column name="DisplayName" options="ASC" />
			</index>
			<index name="PK_Account" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<index name="UQ_Account_AccountSequence" unique="UNIQUE_INDEX" options="WHERE AccountSequence is not null INCLUDE AccountSeed" >
				<column name="AccountSequence" />
			</index>
			<index name="UQ_Account_AccountVersion" unique="UNIQUE_INDEX" options="where AccountVersion&lt;&gt;0" >
				<column name="AccountVersion" />
			</index>
			<index name="IX_Account_RetentionDate" unique="NORMAL" options="where RetentionDate is not null" >
				<column name="RetentionDate" />
			</index>
			<index name="IX_Account_ParentAccountId_EntityType" unique="NORMAL" options="WHERE ParentAccountId IS NOT NULL" >
				<column name="ParentAccountId" options="ASC" />
				<column name="EntityType" />
			</index>
			<fk name="FK_Account_Parent" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="ParentAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Account_License" to_schema="SnApp.dbo" to_table="tbLicense" >
				<fk_column name="LicenseId" pk="LicenseId" />
			</fk>
		</table>
		<table name="tbAccount2Plugin" >
			<comment><![CDATA[Used to store specific payment methods enabled on an organization]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_Account2Plugin_PluginId" unique="NORMAL" >
				<column name="PluginId" options="ASC" />
			</index>
			<index name="PK_Account2Plugin" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="PluginId" />
			</index>
			<fk name="FK_Account2Plugin_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Account2Plugin_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbAccount2Role" >
			<comment><![CDATA[Holds many-to-many relationship between user account and security roles]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to user internal ID]]></comment>
			</column>
			<column name="RoleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to role internal ID]]></comment>
			</column>
			<index name="IX_Accounnt2Role_RoleId" unique="NORMAL" >
				<column name="RoleId" options="ASC" />
			</index>
			<index name="PK_Account2Role" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="RoleId" />
			</index>
			<fk name="FK_Account2Role_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Account2Role_Role" to_schema="SnApp.dbo" to_table="tbRole" >
				<fk_column name="RoleId" pk="RoleId" />
			</fk>
		</table>
		<table name="tbAccountAccessArea" prior="tbAccount2Plugin_0" >
			<comment><![CDATA[Used to manage bulk print by access area]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="FulfilmentAreaTagId" prior="FullfillmentAreaTagId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[ID of the fulfillment access area group label (tag) created in BKO]]></comment>
			</column>
			<index name="PK_AccountAccessArea" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<index name="IX_AccountAccessArea_FulfilmentAreaTagId " unique="NORMAL" options="where FulfilmentAreaTagId is not null" >
				<column name="FulfilmentAreaTagId" />
			</index>
			<fk name="FK_AccountAccessArea_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountAccessArea_Tag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="FulfilmentAreaTagId" pk="TagId" />
			</fk>
		</table>
		<table name="tbAccountAssociation" >
			<comment><![CDATA[Extension table for tbAccount.
Contains information about association]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal account id]]></comment>
			</column>
			<column name="ActiveFrom" type="binary" length="3" decimal="0" jt="-2" >
				<comment><![CDATA[Association atcive from date. If null, always active]]></comment>
			</column>
			<column name="ActiveTo" type="binary" length="3" decimal="0" jt="-2" >
				<comment><![CDATA[Association atcive to date. If null, always active]]></comment>
			</column>
			<column name="MemberRequired" type="bit" length="0" decimal="0" jt="-7" mandatory="y" >
				<comment><![CDATA[Required member to be selected when the association is selected for sale]]></comment>
			</column>
			<column name="MemberVerificationType" type="smallint" length="0" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[LK[366]]]></comment>
			</column>
			<column name="MemberValidationType" type="smallint" length="0" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[LK[367]]]></comment>
			</column>
			<column name="ValidationPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Pugin used to validate the association members]]></comment>
			</column>
			<column name="MemberGridId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the grid to use to building the association member search result grid]]></comment>
			</column>
			<index name="IX_AccountAssociation_ValidationPluginId" unique="NORMAL" options="where ValidationPluginId is not null" >
				<column name="ValidationPluginId" options="ASC" />
			</index>
			<index name="IX_AccountAssociation_MemberGridId" unique="NORMAL" options="where MemberGridId is not null" >
				<column name="MemberGridId" options="ASC" />
			</index>
			<index name="PK_AccountAssociation" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<fk name="FK_AccountAssociation_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountAssociation_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="ValidationPluginId" pk="PluginId" />
			</fk>
			<fk name="FK_AccountAssociation_Grid" to_schema="SnApp.dbo" to_table="tbGrid" >
				<fk_column name="MemberGridId" pk="GridId" />
			</fk>
		</table>
		<table name="tbAccountContext" >
			<comment><![CDATA[Account context stored in categories and inherited by accounts]]></comment>
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Category identifier]]></comment>
			</column>
			<column name="AccountContext" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[397]]]></comment>
			</column>
			<index name="PK_AccountContext" unique="PRIMARY_KEY" >
				<column name="CategoryId" />
				<column name="AccountContext" />
			</index>
			<fk name="FK_tbAccountContext_tbCategory" to_schema="SnApp.dbo" to_table="tbCategory" delete_action="cascade" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbAccountCrossPlatform" >
			<comment><![CDATA[Account extension table to store cross platform information]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CrossPlatformStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[284]]]></comment>
			</column>
			<column name="CrossPlatformType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[283]]]></comment>
			</column>
			<column name="CrossPlatformURL" type="nvarchar" length="1000" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Third party system URL]]></comment>
			</column>
			<column name="CrossPlatformRef" prior="CrossPlatformCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[If SnApp to SnApp integration this will contain the workstation id to communicate to the 3rd party system]]></comment>
			</column>
			<index name="UQ_AccountCrossPlatform_WorkstationId" unique="UNIQUE_KEY" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_AccountCrossPlatform_Code" unique="NORMAL" >
				<column name="CrossPlatformRef" options="ASC" />
			</index>
			<index name="PK_AccountCrossPlatform" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<fk name="FK_AccountCrossPlatform_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountCrossPlatform_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbAccountCrossPlatformParam" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ParamName" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="ParamValue" type="nvarchar(max)" jt="12" mandatory="y" />
			<index name="PK_AccountCrossPlatformParam" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="ParamName" />
			</index>
			<fk name="FK_AccountCrossPlatformParam_AccountCrossPlatform" to_schema="SnApp.dbo" to_table="tbAccountCrossPlatform" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbAccountDepositLog" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LogFiscalDate" type="date" jt="91" mandatory="y" />
			<column name="LogSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="LogAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="DepositBalance" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Balance including current operation]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[TransactionId is null for consolidating rows (not yet implemented)]]></comment>
			</column>
			<column name="TransactionArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<column name="TransactionArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<index name="IX_AccountDepositLog_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="PK_AccountDepositLog" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="LogFiscalDate" />
				<column name="LogSerial" />
			</index>
			<index name="IX_AccountDepositLog_TransactionArcId" unique="NORMAL" options="WHERE TransactionArcId IS NOT NULL" >
				<column name="TransactionArcId" />
			</index>
			<fk name="FK_AccountDepositLog_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountDepositLog_TransactionId" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbAccountDetail" >
			<comment><![CDATA[Extension table for tbAccount.
Redound data mask data (tbMetaData) for a selected number of reasonable fields]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="AllowDistribution" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Location Only]]></comment>
			</column>
			<column name="AllowAdmission" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Location Only]]></comment>
			</column>
			<column name="AllowGeneralAdmission" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Location Only]]></comment>
			</column>
			<column name="AllowCapacityAllocation" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Access Area Only]]></comment>
			</column>
			<column name="AllowSeatAllocation" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Access Area Only]]></comment>
			</column>
			<column name="LocationTimeZone" type="tinyint" jt="-6" >
				<comment><![CDATA[LK[238]]]></comment>
			</column>
			<column name="FirstName" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=1]]></comment>
			</column>
			<column name="LastName" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=3]]></comment>
			</column>
			<column name="CompanyName" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=31]]></comment>
			</column>
			<column name="Address" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=6]]></comment>
			</column>
			<column name="ZipCode" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=10]]></comment>
			</column>
			<column name="City" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=8]]></comment>
			</column>
			<column name="Province" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=54]]></comment>
			</column>
			<column name="State" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=9]]></comment>
			</column>
			<column name="Country" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=11]]></comment>
			</column>
			<column name="HomePhone" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=12]]></comment>
			</column>
			<column name="BusinessPhone" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=13]]></comment>
			</column>
			<column name="MobilePhone" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=15]]></comment>
			</column>
			<column name="Fax" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=14]]></comment>
			</column>
			<column name="EmailAddress" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=21]]></comment>
			</column>
			<column name="ExternalCode" type="varchar" length="30" decimal="0" jt="12" >
				<comment><![CDATA[not used - to be removed]]></comment>
			</column>
			<column name="NickName" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Redund tbMetaData for FieldType=58]]></comment>
			</column>
			<column name="BiometricOverride" type="tinyint" length="1" decimal="0" jt="-6" >
				<comment><![CDATA[LK[379]]]></comment>
			</column>
			<index name="IX_AccountDetail_NickName" unique="NORMAL" options="where NickName is not null" >
				<column name="NickName" options="ASC" />
			</index>
			<index name="PK_AccountDetail" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<fk name="FK_AccountDetail_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbAccountExposureLog" prior="tbAccountDepositLog_0" >
			<comment><![CDATA[Changes to the tbAccountFinance.ExposureBalance are logged in this table]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LogFiscalDate" type="date" jt="91" mandatory="y" />
			<column name="LogSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="LogAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="ExposureBalance" prior="DepositBalance" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Exposure balance including current operation]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[TransactionId is null for consolidating rows]]></comment>
			</column>
			<column name="TransactionArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<column name="TransactionArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<index name="IX_AccountExposureLog_TransactionId" unique="NORMAL" >
				<column name="TransactionId" />
			</index>
			<index name="PK_AccountExposureLog" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="LogFiscalDate" />
				<column name="LogSerial" />
			</index>
			<index name="IX_AccountExposureLog_TransactionArcId" unique="NORMAL" options="WHERE TransactionArcId IS NOT NULL" >
				<column name="TransactionArcId" />
			</index>
			<fk name="FK_AccountExposureLog_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountExposureLog_TransactionId" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbAccountFinance" >
			<comment><![CDATA[Extension table for tbAccount.
Holds all finance related settings for organizations]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the "financial setup" is active for the account]]></comment>
			</column>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Sale Channel this organization belongs to]]></comment>
			</column>
			<column name="TotalCredit" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Total credit limit]]></comment>
			</column>
			<column name="CreditDays" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Number of days after purchase, to calculate credit due date]]></comment>
			</column>
			<column name="GracePeriodDays" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Number of days after credit due date, when the account should be blocked]]></comment>
			</column>
			<column name="CreditPerTransaction" type="money" length="0" jt="3" >
				<comment><![CDATA[Maximum credit per transaction]]></comment>
			</column>
			<column name="ItemsPerTransaction" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Maximum items per transaction]]></comment>
			</column>
			<column name="AutoPayCredits" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Determins is deposit on account should be used to pay orders when sufficient.
1=Use deposit
0=Always credit]]></comment>
			</column>
			<column name="VoidWindowDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Number of days, before visit date, when is still possible to void an order]]></comment>
			</column>
			<column name="TotalOpen" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[All credits with status = OPEN or INVOICED]]></comment>
			</column>
			<column name="TotalPaid" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[All credits with status = PAID]]></comment>
			</column>
			<column name="AdvancedPayment" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Balance: algebric sum of tbAccountDepositLog]]></comment>
			</column>
			<column name="AgentAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Agent assigned to the organization (for commission purposes)]]></comment>
			</column>
			<column name="B2BWorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[B2B platform to be used by this organization]]></comment>
			</column>
			<column name="CommissionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Commission rule applicable to the organization]]></comment>
			</column>
			<column name="TotalUncommitted" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Total amount of account's financial exposition]]></comment>
			</column>
			<column name="TotalCommitted" type="money" length="0" jt="3" >
				<comment><![CDATA[Total amount of committed orders]]></comment>
			</column>
			<column name="MaxExposureLimit" type="money" jt="3" >
				<comment><![CDATA[Maximum exposure limit for the account (unlimited if null)]]></comment>
			</column>
			<column name="ExposureBalance" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Total amount of reservations not yet paid.
Algebric sum of tbAccountExposureLog.ExposureBalance]]></comment>
			</column>
			<column name="OpenOrderBalance" type="money" jt="3" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Total amount of reservations not yet paid + Consignment not yet redeemed.
Algebric sum of tbAccountExposureLog.ExposureBalance]]></comment>
			</column>
			<column name="ConsignmentPaymentMethodId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Payment method used for consignment sales]]></comment>
			</column>
			<column name="AutoDaysBeforeVisit" prior="AudoDaysBeforeVisit" type="smallint" jt="5" >
				<comment><![CDATA[In case of auto-pay option activate contains the number of days before visit date that the open reservation shall be charged]]></comment>
			</column>
			<column name="AutoPaymentMethodId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the payment method id to be used in case of "auto-pay" reservations. Can only be selected from "Credit" and "Web payment" payment types.]]></comment>
			</column>
			<column name="AutoPaymentTokenId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the payment token id to be used in case of "auto-pay" reservations and AutoPaymentMethod is web payment.]]></comment>
			</column>
			<column name="AutoAltPaymentMethodId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to and alternative payment method to use in case of "auto-pay" reservations when the main payment fails. It can only be taken from "Credit" payment types.]]></comment>
			</column>
			<column name="AutoAltPaymentTokenId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the payment token id to be used in case of alternative "auto-pay" reservations and AutoAltPaymentMethod is web payment.]]></comment>
			</column>
			<column name="ChannelManagerPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the plugin to be used as channel manager integration]]></comment>
			</column>
			<column name="ChannelManagerWorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the workstation against which incoming channel manager orders will be recorded]]></comment>
			</column>
			<column name="ChannelManagerCodeAliasTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the code alias type to be used on incoming channel manager orders, to record the resellar order reference]]></comment>
			</column>
			<column name="ChannelManagerResellerCode" type="varchar" length="100" jt="12" >
				<comment><![CDATA[Identifier of the reseller on the channel manager system]]></comment>
			</column>
			<index name="IX_AccountFinance_SaleChannelId" unique="NORMAL" options="where SaleChannelId is not null" >
				<column name="SaleChannelId" options="ASC" />
			</index>
			<index name="IX_AccountFinance_AgentAccountId" unique="NORMAL" options="where AgentAccountId is not null" >
				<column name="AgentAccountId" options="ASC" />
			</index>
			<index name="IX_AccountFinance_B2BWorkstationId" unique="NORMAL" options="where B2BWorkstationId is not null" >
				<column name="B2BWorkstationId" options="ASC" />
			</index>
			<index name="IX_AccountFinance_CommissionId" unique="NORMAL" options="where CommissionId is not null" >
				<column name="CommissionId" options="ASC" />
			</index>
			<index name="PK_AccountFinance" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<index name="IX_AccountFinance_ConsignmentPaymentMethodId" unique="NORMAL" options="where ConsignmentPaymentMethodId is not null" >
				<column name="ConsignmentPaymentMethodId" />
			</index>
			<index name="IX_AccountFinance_AutoPaymentMethodId" unique="NORMAL" options="where AutoPaymentMethodId is not null" >
				<column name="AutoPaymentMethodId" />
			</index>
			<index name="IX_AccountFinance_AutoPaymentTokenId" unique="NORMAL" options="where AutoPaymentTokenId is not null" >
				<column name="AutoPaymentTokenId" />
			</index>
			<index name="IX_AccountFinance_AutoAltPaymentMethodId" unique="NORMAL" options="where AutoAltPaymentMethodId is not null" >
				<column name="AutoAltPaymentMethodId" />
			</index>
			<index name="IX_AccountFinance_ChannelManagerWorkstationId" unique="NORMAL" options="where ChannelManagerWorkstationId is not null" >
				<column name="ChannelManagerWorkstationId" />
			</index>
			<index name="IX_AccountFinance_ChannelManagerCodeAliasTypeId" unique="NORMAL" options="where ChannelManagerCodeAliasTypeId is not null" >
				<column name="ChannelManagerCodeAliasTypeId" />
			</index>
			<index name="IX_AccountFinance_ChannelManagerPluginId" unique="NORMAL" options="where ChannelManagerPluginId is not null" >
				<column name="ChannelManagerPluginId" />
				<column name="ChannelManagerWorkstationId" />
				<column name="ChannelManagerResellerCode" />
			</index>
			<index name="IX_AccountFinance_AutoAltPaymentTokenId" unique="NORMAL" options="where AutoAltPaymentTokenId is not null" >
				<column name="AutoAltPaymentTokenId" />
			</index>
			<fk name="FK_AccountFinance_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountFinance_Account_Agent" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AgentAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountFinance_B2BWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="B2BWorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_AccountFinance_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_AccountFinance_Commission" to_schema="SnApp.dbo" to_table="tbCommission" >
				<fk_column name="CommissionId" pk="CommissionId" />
			</fk>
			<fk name="FK_AccountFinance_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="ConsignmentPaymentMethodId" pk="PluginId" />
			</fk>
			<fk name="FK_AccountFinance_AutoPaymentMethod" to_schema="SnApp.dbo" to_table="tbPluginPaymentMethod" >
				<fk_column name="AutoPaymentMethodId" pk="PluginId" />
			</fk>
			<fk name="FK_AccountFinance_AutoAltPaymentMethod" to_schema="SnApp.dbo" to_table="tbPluginPaymentMethod" >
				<fk_column name="AutoAltPaymentMethodId" pk="PluginId" />
			</fk>
			<fk name="FK_AccountFinance_PaymentToken" to_schema="SnApp.dbo" to_table="tbPaymentToken" >
				<fk_column name="AutoPaymentTokenId" pk="PaymentTokenId" />
			</fk>
			<fk name="FK_AccountFinance_ChannelManagerPlugin" to_schema="SnApp.dbo" to_table="tbPlugin" delete_action="setNull" >
				<fk_column name="ChannelManagerPluginId" pk="PluginId" />
			</fk>
			<fk name="FK_AccountFinance_ChannelManagerWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="ChannelManagerWorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_AccountFinance_CodeAliasType" to_schema="SnApp.dbo" to_table="tbCodeAliasType" >
				<fk_column name="ChannelManagerCodeAliasTypeId" pk="CodeAliasTypeId" />
			</fk>
			<fk name="FK_AccountFinance_AltPaymentToken" to_schema="SnApp.dbo" to_table="tbPaymentToken" >
				<fk_column name="AutoAltPaymentTokenId" pk="PaymentTokenId" />
			</fk>
		</table>
		<table name="tbAccountFlag" >
			<comment><![CDATA[Optional flags for tbAccount]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to account internal ID]]></comment>
			</column>
			<column name="AccountFlag" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[374]]]></comment>
			</column>
			<index name="PK_AccountFlag" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="AccountFlag" />
			</index>
			<index name="IX_AccountFlag_AccountFlag" unique="NORMAL" >
				<column name="AccountFlag" />
			</index>
			<fk name="FK_AccountFlag_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbAccountInventoryBalance" >
			<comment><![CDATA[Holds information about account inventory products]]></comment>
			<column name="AccountInventoryBalanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the account]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="PerformanceSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the performance set]]></comment>
			</column>
			<column name="OptionSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the dynamic options selected]]></comment>
			</column>
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity, algebraic sum of tbTransactionAccountInventory.Quantity]]></comment>
			</column>
			<column name="UnitAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Unit amount paid]]></comment>
			</column>
			<index name="UQ_AccountInventoryBalance_AccountId" unique="UNIQUE_KEY" >
				<column name="AccountId" options="ASC" />
				<column name="ProductId" options="ASC" />
				<column name="PerformanceSetId" options="ASC" />
				<column name="OptionSetId" options="ASC" />
				<column name="UnitAmount" options="ASC" />
			</index>
			<index name="IX_AccountInventoryBalance_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_AccountInventoryBalance_PerformanceSetId" unique="NORMAL" options="where PerformanceSetId is not null" >
				<column name="PerformanceSetId" options="ASC" />
			</index>
			<index name="IX_AccountInventoryBalance_OptionSetId" unique="NORMAL" options="where OptionSetId is not null" >
				<column name="OptionSetId" options="ASC" />
			</index>
			<index name="PK_AccountInventoryBalance" unique="PRIMARY_KEY" >
				<column name="AccountInventoryBalanceId" />
			</index>
			<fk name="FK_AccountInventoryBalance_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountInventoryBalance_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_AccountInventoryBalance_PerformanceSet" to_schema="SnApp.dbo" to_table="tbPerformanceSet" >
				<fk_column name="PerformanceSetId" pk="PerformanceSetId" />
			</fk>
			<fk name="FK_AccountInventoryBalance_OptionSet" to_schema="SnApp.dbo" to_table="tbOptionSet" >
				<fk_column name="OptionSetId" pk="OptionSetId" />
			</fk>
		</table>
		<table name="tbAccountOpArea" prior="Tbl" >
			<comment><![CDATA[tbAccount extension table to hold operating area specific properties]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ZipFile" type="varbinary(max)" jt="-3" >
				<comment><![CDATA[Zip file containing workstation configurations common to operating area level, such as users and other configs.]]></comment>
			</column>
			<column name="ZipFileLastUpdate" type="datetime" jt="92" >
				<comment><![CDATA[Timestamp of field ZipFile last update]]></comment>
			</column>
			<column name="UserZipFile" type="varbinary(max)" jt="-3" >
				<comment><![CDATA[Zip file containing users able to log into the op.area]]></comment>
			</column>
			<column name="UserZipFileLastUpdate" type="datetime" jt="92" >
				<comment><![CDATA["UserZipFile" last update date/time]]></comment>
			</column>
			<index name="PK_AccountOpArea" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<fk name="FK_AccountOpArea_AccountId" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbAccountOpenOrderLog" prior="Tbl" >
			<comment><![CDATA[Detailed movements to calculate tbAccountFinance.OpenOrderBalance]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the account internal ID]]></comment>
			</column>
			<column name="LogFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Entry fiscal date]]></comment>
			</column>
			<column name="LogSerial" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Incremental serial for same AccountId & LogFiscalDate]]></comment>
			</column>
			<column name="LogAmount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Entry movement amount]]></comment>
			</column>
			<column name="OpenOrderBalance" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Balance including current movement]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the transaction which generated the movement.
Column is nullable for consolidation rows]]></comment>
			</column>
			<column name="TransactionArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<column name="TransactionArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<index name="PK_AccountOpenOrderLog" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="LogFiscalDate" />
				<column name="LogSerial" />
			</index>
			<index name="IX_AccountOpenOrderLog_TransactionId" unique="NORMAL" >
				<column name="TransactionId" />
			</index>
			<index name="IX_AccountOpenOrderLog_TransactionArcId" unique="NORMAL" >
				<column name="TransactionArcId" />
			</index>
			<fk name="FK_AccountOpenOrderLog_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountOpenOrderLog_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbAccountRelation" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ChildAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RelationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_AccountRelation_ChildAccountId" unique="NORMAL" >
				<column name="ChildAccountId" options="ASC" />
			</index>
			<index name="IX_AccountRelation_RelationId" unique="NORMAL" >
				<column name="RelationId" options="ASC" />
			</index>
			<index name="PK_AccountRelation" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="ChildAccountId" />
			</index>
			<fk name="FK_AccountRelation_Account_AccountId" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountRelation_Account_ChildAccountId" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="ChildAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountRelation_Relation" to_schema="SnApp.dbo" to_table="tbRelation" >
				<fk_column name="RelationId" pk="RelationId" />
			</fk>
		</table>
		<table name="tbAccountResource" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ResourceTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ResourceQuantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<index name="IX_AccountResource_ResourceTypeId" unique="NORMAL" >
				<column name="ResourceTypeId" options="ASC" />
			</index>
			<index name="PK_AccountResource" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<fk name="FK_AccountResource_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountResource_ResourceType" to_schema="SnApp.dbo" to_table="tbResourceType" >
				<fk_column name="ResourceTypeId" pk="ResourceTypeId" />
			</fk>
		</table>
		<table name="tbAccountTaxExempt" >
			<comment><![CDATA[Extension table for tbAccount.
Contains information about tax exempt certificates for guests]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CertificateCode" type="varchar" length="30" decimal="0" jt="12" >
				<comment><![CDATA[Unique code of the certificate]]></comment>
			</column>
			<column name="ExpirationDate" type="date" jt="91" >
				<comment><![CDATA[Expiration date of the certificate]]></comment>
			</column>
			<column name="Approved" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[1 = An operator approved the certicate and can then be used]]></comment>
			</column>
			<index name="IX_AccountTaxExempt_CertificateCode" unique="NORMAL" options="where CertificateCode is not null" >
				<column name="CertificateCode" options="ASC" />
			</index>
			<index name="PK_AccountTaxExempt" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<fk name="FK_AccountTaxExempt_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbAccountTaxExempt2Tax" prior="Tbl" >
			<comment><![CDATA[List of "excplicit" exemptible taxes for the account]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Account internal ID]]></comment>
			</column>
			<column name="TaxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Tax internal ID]]></comment>
			</column>
			<index name="PK_AccountTaxExempt2Tax" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="TaxId" />
			</index>
			<index name="IX_AccountTaxExempt2Tax_TaxId" unique="NORMAL" >
				<column name="TaxId" />
			</index>
			<fk name="FK_AccountTaxExempt2Tax_AccountTaxExempt" to_schema="SnApp.dbo" to_table="tbAccountTaxExempt" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountTaxExempt2Tax_Tax" to_schema="SnApp.dbo" to_table="tbTax" >
				<fk_column name="TaxId" pk="TaxId" />
			</fk>
		</table>
		<table name="tbAccountTemp" prior="Tbl" >
			<comment><![CDATA[Store references for "temporary" accounts.
Temporary accounts are usually created by external devices (tables) which collect demographics when guests are inline. These demographics are then recalled&validated from POS]]></comment>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to account internal ID]]></comment>
			</column>
			<column name="AccountTempCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Unique code (per op.area / fiscal date)]]></comment>
			</column>
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to operating area internal ID.
It helps searches from POS as each POS would show only temporary accounts created on its own operating area]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to workstation internal ID.
It helps searches from POS as each POS would show only temporary accounts created for this workstation]]></comment>
			</column>
			<column name="CreateFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Record creation local fiscal date]]></comment>
			</column>
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Record creation date/time]]></comment>
			</column>
			<index name="PK_AccountTemp" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<index name="IX_AccountTemp_CreateDateTime" unique="NORMAL" >
				<column name="CreateDateTime" />
			</index>
			<index name="UQ_AccountTemp_AccountTempCode" unique="UNIQUE_INDEX" >
				<column name="CreateFiscalDate" />
				<column name="OpAreaId" />
				<column name="AccountTempCode" />
			</index>
			<index name="IX_AccountTemp_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" />
				<column name="CreateDateTime" />
			</index>
			<index name="IX_AccountTemp_OpAreaId" unique="NORMAL" options="INCLUDE (WorkstationId, CreateFiscalDate)" >
				<column name="OpAreaId" />
				<column name="CreateDateTime" />
			</index>
			<fk name="FK_AccountTemp_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountTemp_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountTemp_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbAccountUserLimit" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RoleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_AccountUserLimit_RoleId" unique="NORMAL" >
				<column name="RoleId" options="ASC" />
			</index>
			<index name="PK_AccountUserLimit" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="RoleId" />
			</index>
			<fk name="FK_AccountUserLimit_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AccountUserLimit_Role" to_schema="SnApp.dbo" to_table="tbRole" >
				<fk_column name="RoleId" pk="RoleId" />
			</fk>
		</table>
		<table name="tbAction" >
			<column name="ActionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131] (Email, Task, Issue, Etc)]]></comment>
			</column>
			<column name="ActionStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[149]]]></comment>
			</column>
			<column name="ActionName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="ActionData" type="nvarchar(max)" jt="12" />
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="CloseDateTime" type="datetime" jt="92" />
			<column name="PurgeDate" type="date" jt="91" >
				<comment><![CDATA[Date for when the record is supposed to be purged. When NULL, purge follows overall configurations]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the template used for generating the email]]></comment>
			</column>
			<column name="DocTemplateType" prior="DocRemplateType" type="smallint" jt="5" >
				<comment><![CDATA[LK[85]]]></comment>
			</column>
			<column name="ActionSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number generate on creation starting from 1]]></comment>
			</column>
			<column name="ActionSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with ActionSequence to create encrypted barcodes]]></comment>
			</column>
			<column name="ActionVersion" type="bigint" jt="-5" >
				<comment><![CDATA[Autoinc field updated everytime the entity (in this specific record or any dependant) is modified. To be used for differential reports]]></comment>
			</column>
			<index name="IX_Action_EntityType" unique="NORMAL" >
				<column name="EntityType" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="PK_Action" unique="PRIMARY_KEY" >
				<column name="ActionId" />
			</index>
			<index name="UQ_Action_ActionSequence" unique="UNIQUE_INDEX" options="WHERE ActionSequence&lt;&gt;0 INCLUDE ActionSeed" >
				<column name="ActionSequence" />
			</index>
			<index name="UQ_Action_ActionVersion" unique="UNIQUE_INDEX" options="where ActionVersion&lt;&gt;0" >
				<column name="ActionVersion" />
			</index>
			<index name="IX_Action_PurgeDate" unique="NORMAL" options="WHERE PurgeDate is NOT NULL" >
				<column name="PurgeDate" />
			</index>
			<index name="IX_Action_DocTemplateId" unique="NORMAL" options="WHERE DocTemplateId is NOT NULL" >
				<column name="DocTemplateId" />
				<column name="CreateDateTime" />
			</index>
			<fk name="FK_Action_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" delete_action="setNull" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbActionLink" >
			<column name="ActionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ActionLinkType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[150]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="IX_ActionLink_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_ActionLink" unique="PRIMARY_KEY" >
				<column name="ActionId" />
				<column name="ActionLinkType" />
				<column name="EntityId" />
			</index>
			<fk name="FK_ActionLink_Action" to_schema="SnApp.dbo" to_table="tbAction" delete_action="cascade" >
				<fk_column name="ActionId" pk="ActionId" />
			</fk>
		</table>
		<table name="tbActivityLog" >
			<column name="ActivityLogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="ActivityLogType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[402]]]></comment>
			</column>
			<column name="LogLevel" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[165]]]></comment>
			</column>
			<column name="ActivityLogDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time about when the log was produced]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Workstation generating the log]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[user logged in when log was generated]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" length="1" decimal="0" jt="1" >
				<comment><![CDATA[Reference to the object (when possible) this log refers to]]></comment>
			</column>
			<column name="LogData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Log Text]]></comment>
			</column>
			<index name="IX_ActivityLog_ActivityLogDateTime" unique="NORMAL" >
				<column name="ActivityLogDateTime" options="ASC" />
			</index>
			<index name="IX_ActivityLog_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_ActivityLog_WorksatationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_ActivityLog_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_ActivityLog" unique="PRIMARY_KEY" >
				<column name="ActivityLogId" />
			</index>
			<fk name="FK_ActivityLog_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ActivityLog_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbApiFirewall" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="CustomAddressRange" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="CustomServiceFilter" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="PK_ApiFirewall" unique="PRIMARY_KEY" >
				<column name="EntityId" />
			</index>
		</table>
		<table name="tbApiFirewallAddress" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AddressSequence" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="FromIP" type="varchar" length="40" decimal="0" jt="12" mandatory="y" />
			<column name="ToIP" type="varchar" length="40" decimal="0" jt="12" mandatory="y" />
			<index name="PK_ApiFirewallAddress" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="AddressSequence" />
			</index>
			<fk name="FK_ApiFirewall_ApiFirewallAddress" to_schema="SnApp.dbo" to_table="tbApiFirewall" delete_action="cascade" >
				<fk_column name="EntityId" pk="EntityId" />
			</fk>
		</table>
		<table name="tbApiFirewallService" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ServiceSequence" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ServiceName" type="varchar" length="50" decimal="0" jt="12" />
			<column name="CommandName" type="varchar" length="50" decimal="0" jt="12" />
			<index name="PK_ApiFirewallService" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="ServiceSequence" />
			</index>
			<fk name="FK_ApiFirewall_ApiFirewallService" to_schema="SnApp.dbo" to_table="tbApiFirewall" delete_action="cascade" >
				<fk_column name="EntityId" pk="EntityId" />
			</fk>
		</table>
		<table name="tbApiLog" >
			<comment><![CDATA[Holds requests/responses of application web API's. Filled and purged based on configuration]]></comment>
			<column name="ApiLogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="StartDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Request took in charge by the server]]></comment>
			</column>
			<column name="EndDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Response sent back to client]]></comment>
			</column>
			<column name="RequestCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[API code (CMD parameter)]]></comment>
			</column>
			<column name="RequestCommand" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[API sub command]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Client workstation id]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Logged user]]></comment>
			</column>
			<column name="RequestHttpMethod" type="varchar" length="10" decimal="0" jt="12" >
				<comment><![CDATA[Request HTTP method (GET, POST, etc...)]]></comment>
			</column>
			<column name="RequestURL" type="nvarchar" length="255" decimal="0" jt="12" >
				<comment><![CDATA[Request query string]]></comment>
			</column>
			<column name="RequestBody" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Request's body]]></comment>
			</column>
			<column name="RequestHeader" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Request's headers]]></comment>
			</column>
			<column name="AnswerBody" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Response's body]]></comment>
			</column>
			<column name="AnswerHeader" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Response's headers]]></comment>
			</column>
			<column name="AnswerCommonStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[212]]]></comment>
			</column>
			<column name="AnswerHttpStatus" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Response's HTTP status (ie: 401=Unauthorized)]]></comment>
			</column>
			<column name="AnswerStatusCode" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[LK[139] SnApp high-level response status code]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="ClientIPAddress" type="varchar" length="25" decimal="0" jt="12" >
				<comment><![CDATA[Client IP Address]]></comment>
			</column>
			<column name="ErrorStackTrace" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[In case of API failure response, it contains the stack trace of the java exception]]></comment>
			</column>
			<index name="IX_ApiLog_EndDateTime" unique="NORMAL" >
				<column name="EndDateTime" options="ASC" />
			</index>
			<index name="IX_ApiLog_WorkstationId" unique="NORMAL" options="where WorkstationId is not null" >
				<column name="WorkstationId" options="ASC" />
				<column name="EndDateTime" options="ASC" />
			</index>
			<index name="IX_ApiLog_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
				<column name="EndDateTime" options="ASC" />
			</index>
			<index name="IX_ApiLog_RequestCode" unique="NORMAL" >
				<column name="RequestCode" options="ASC" />
				<column name="EndDateTime" options="ASC" />
			</index>
			<index name="IX_ApiLog_AnswerCommonStatus" unique="NORMAL" >
				<column name="AnswerCommonStatus" options="ASC" />
				<column name="EndDateTime" options="ASC" />
			</index>
			<index name="PK_ApiLog" unique="PRIMARY_KEY" >
				<column name="ApiLogId" />
			</index>
			<fk name="FK_ApiLog_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ApiLog_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbApiLogLink" >
			<comment><![CDATA[Tracks relations between an API call (tbApiLog) and the producted database elements (is: transaction)]]></comment>
			<column name="ApiLogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[API log internal ID]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Database entity internal ID]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Database entity type]]></comment>
			</column>
			<index name="IX_ApiLogLink_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_ApiLogLink" unique="PRIMARY_KEY" >
				<column name="ApiLogId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_ApiLogLink_ApiLog" to_schema="SnApp.dbo" to_table="tbApiLog" delete_action="cascade" >
				<fk_column name="ApiLogId" pk="ApiLogId" />
			</fk>
		</table>
		<table name="tbAssociation2Mask" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal account id]]></comment>
			</column>
			<column name="MaskId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal mask id]]></comment>
			</column>
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Display order]]></comment>
			</column>
			<index name="IX_Association2Mask_MaskId" unique="NORMAL" >
				<column name="MaskId" options="ASC" />
			</index>
			<index name="PK_Association2Mask" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="MaskId" />
			</index>
			<fk name="FK_Association2Mask_Mask" to_schema="SnApp.dbo" to_table="tbMask" >
				<fk_column name="MaskId" pk="MaskId" />
			</fk>
			<fk name="FK_Association2Mask_AccountAssociation" to_schema="SnApp.dbo" to_table="tbAccountAssociation" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbAssociation2Product" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal account id]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal product id]]></comment>
			</column>
			<index name="IX_Association2Product_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="PK_Association2Product" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="ProductId" />
			</index>
			<fk name="FK_Association2Product_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Association2Product_AccountAssociation" to_schema="SnApp.dbo" to_table="tbAccountAssociation" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbAsyncFinalize" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="AsyncFinalizeStatus" type="smallint" jt="5" mandatory="y" />
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="StartDateTime" type="datetime" jt="92" />
			<column name="EndDateTime" type="datetime" jt="92" />
			<column name="DocData" type="nvarchar(max)" jt="12" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" />
			<index name="IX_AsyncFinalize_StatusAndCreateDT" unique="NORMAL" >
				<column name="AsyncFinalizeStatus" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_AsyncFinalize_ServerAndStatus" unique="NORMAL" options="where ServerId is not null" >
				<column name="ServerId" options="ASC" />
				<column name="AsyncFinalizeStatus" options="ASC" />
			</index>
			<index name="PK_AsyncFinalize" unique="PRIMARY_KEY" >
				<column name="EntityId" />
			</index>
			<fk name="FK_AsyncFinalize_Server" to_schema="SnApp.dbo" to_table="tbServer" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbAsyncFinalizeConsQueue" prior="tbAyncFinalizeConsQueue" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="ConsQueueStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[266]]]></comment>
			</column>
			<column name="QueueDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="StartDateTime" type="datetime" jt="92" />
			<column name="EndDateTime" type="datetime" jt="92" />
			<index name="IX_AsyncFinalizeConsQueue_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="ConsQueueStatus" options="ASC" />
			</index>
			<index name="PK_AsyncFinalizeConsQueue" unique="PRIMARY_KEY" >
				<column name="EntityId" />
			</index>
			<index name="IX_AsyncFinalizeConsQueue_ConsQueueStatus" unique="NORMAL" options="INCLUDE (ServerId)" >
				<column name="ConsQueueStatus" />
				<column name="QueueDateTime" />
			</index>
			<fk name="FK_AsyncFinalizeConsQueue_Entity" to_schema="SnApp.dbo" to_table="tbAsyncFinalize" delete_action="cascade" >
				<fk_column name="EntityId" pk="EntityId" />
			</fk>
		</table>
		<table name="tbAsyncFinalizeStat" >
			<comment><![CDATA[Consolidated statistiics for "async finalize" (pos precesses) threads]]></comment>
			<column name="TimeSlot" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[15 minutes timeslot]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Reference to server]]></comment>
			</column>
			<column name="MinMS" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Minimum processing time msecs in the slot]]></comment>
			</column>
			<column name="MaxMS" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Maximum processing time msecs in the slot]]></comment>
			</column>
			<column name="AvgMS" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Average processing time msecs in the slot]]></comment>
			</column>
			<column name="TotalMS" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" >
				<comment><![CDATA[Total processing msecs in the slot]]></comment>
			</column>
			<column name="ItemCount" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Total number of items (threads) in the slot]]></comment>
			</column>
			<column name="MaxConcurrentThreads" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Max number of concurrent threads]]></comment>
			</column>
			<index name="IX_AsyncFinalizeStat_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="TimeSlot" options="ASC" />
			</index>
			<index name="PK_AsyncFinalizeStat" unique="PRIMARY_KEY" >
				<column name="TimeSlot" />
				<column name="EntityType" />
				<column name="ServerId" />
			</index>
			<fk name="FK_AsyncFinalizeStat_Server" to_schema="SnApp.dbo" to_table="tbServer" delete_action="cascade" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbAsyncProcess" >
			<column name="AsyncProcessId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="AsyncProcessName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="AsyncProcessClassAlias" type="varchar" length="25" jt="12" />
			<column name="AsyncProcessStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[179]]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" />
			<column name="QuantityTot" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantityPos" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantitySkip" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="StartDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="EndDateTime" type="datetime" jt="92" />
			<column name="ReportEmailAddress" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[Email is sent on completion of the process]]></comment>
			</column>
			<column name="ConfigData" type="nvarchar(max)" jt="12" />
			<column name="RefEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="RefEntityId" type="uniqueidentifier" jt="1" />
			<index name="IX_AsyncProcess_ServerAndStatus" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="AsyncProcessStatus" options="ASC" />
				<column name="StartDateTime" options="DESC" />
			</index>
			<index name="IX_AsyncProcess_StartEnd" unique="NORMAL" >
				<column name="StartDateTime" options="DESC" />
				<column name="EndDateTime" options="DESC" />
			</index>
			<index name="IX_AsyncProcess_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_AsyncProcess_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_AsyncProcess" unique="PRIMARY_KEY" >
				<column name="AsyncProcessId" />
			</index>
			<fk name="FK_AsyncProcess_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_AsyncProcess_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbAsyncProcessItem" >
			<column name="AsyncProcessId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" />
			<index name="IX_AsyncProcess_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_AsyncProcessItem" unique="PRIMARY_KEY" >
				<column name="AsyncProcessId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_AsyncProcessItem_AsyncProcess" to_schema="SnApp.dbo" to_table="tbAsyncProcess" delete_action="cascade" >
				<fk_column name="AsyncProcessId" pk="AsyncProcessId" />
			</fk>
		</table>
		<table name="tbAsyncProcessLog" >
			<column name="AsyncProcessLogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Unique identifier]]></comment>
			</column>
			<column name="AsyncProcessId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the corresponding async process]]></comment>
			</column>
			<column name="LogDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/time of log]]></comment>
			</column>
			<column name="LogType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[360]]]></comment>
			</column>
			<column name="LogRecap" type="varchar" length="100" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Short version of log]]></comment>
			</column>
			<column name="LogText" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Full version of log]]></comment>
			</column>
			<index name="IX_AsyncProcessLog_AsyncProcessId" unique="NORMAL" >
				<column name="AsyncProcessId" options="ASC" />
				<column name="LogDateTime" options="ASC" />
			</index>
			<index name="PK_AsyncProcessLog" unique="PRIMARY_KEY" >
				<column name="AsyncProcessLogId" />
			</index>
			<fk name="FK_AsyncProcessLog_AsyncProcess" to_schema="SnApp.dbo" to_table="tbAsyncProcess" delete_action="cascade" >
				<fk_column name="AsyncProcessId" pk="AsyncProcessId" />
			</fk>
		</table>
		<table name="tbAttribute" >
			<comment><![CDATA[Holds information about configured product types]]></comment>
			<column name="AttributeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="ParentEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="ParentEntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[An Attribute could be overall available (this field = null) or beloning only to a subset entity (like an event)]]></comment>
			</column>
			<column name="AttributeCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="AttributeName" type="nvarchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[Attribute name]]></comment>
			</column>
			<column name="AttributeWeight" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Overall sorting of the attribute]]></comment>
			</column>
			<column name="SeatCategory" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if this attribute's items should be considered "seat categories"]]></comment>
			</column>
			<index name="IDX_Attribute_ParentEntity" unique="NORMAL" >
				<column name="ParentEntityType" options="ASC" />
				<column name="ParentEntityId" options="ASC" />
			</index>
			<index name="IDX_Attribute_ParentEntityId" unique="NORMAL" >
				<column name="ParentEntityId" options="ASC" />
			</index>
			<index name="UQ_Attribute_Code" unique="UNIQUE_KEY" >
				<column name="AttributeCode" options="ASC" />
			</index>
			<index name="PK_Attribute" unique="PRIMARY_KEY" >
				<column name="AttributeId" />
			</index>
		</table>
		<table name="tbAttributeItem" >
			<comment><![CDATA[Holds information about configured attribute's items]]></comment>
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="AttributeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the attribute. 1 Attribute = N Items]]></comment>
			</column>
			<column name="AttributeItemCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="AttributeItemName" type="nvarchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[Attribute item name]]></comment>
			</column>
			<column name="AttributeItemNameExt" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Attribute item additional description]]></comment>
			</column>
			<column name="ShowNameExt" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if AttributeNameExt should display or not. Changes POS UI representation of the attribute item]]></comment>
			</column>
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Sorting within an attribute]]></comment>
			</column>
			<column name="OptionalPrice" type="money" length="0" jt="3" >
				<comment><![CDATA[Used to vary the price of a product when choosed as dynamic option.
Used also when StatProductId is not null as the price for the "statistical product"]]></comment>
			</column>
			<column name="SeatCategoryCode" type="varchar" length="10" jt="12" >
				<comment><![CDATA[In case the attribute is flagged as SeatCategory, it's the ittelligible user defined code to be used for limited-capacity-related functions]]></comment>
			</column>
			<column name="SeatCategoryColor" type="varchar" length="7" decimal="0" jt="12" >
				<comment><![CDATA[In case the attribute is flagged as SeatCategory, it's the color to be used for graphical representation]]></comment>
			</column>
			<column name="SeatAlgorithmType" type="smallint" jt="5" >
				<comment><![CDATA[LK[143]]]></comment>
			</column>
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Status of the attribute item]]></comment>
			</column>
			<column name="StatProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Defines the statistical product.
When a product A (containing attribute items with a stat product B) is sold, statistically 2 records will be put in tbSaleItem: product A and  B, where B StatAmount will equal the OptionalPrice set in this attribute item record; A StatAmount will be "A Price" minus "B OptionalPrice"]]></comment>
			</column>
			<index name="IX_AttributeItem_Attribute" unique="NORMAL" >
				<column name="AttributeId" options="ASC" />
			</index>
			<index name="IX_AttributeItem_StatProductId" unique="NORMAL" options="where StatProductId is not null" >
				<column name="StatProductId" options="ASC" />
			</index>
			<index name="PK_AttributeItem" unique="PRIMARY_KEY" >
				<column name="AttributeItemId" />
			</index>
			<index name="UQ_AttributeItem_AttributeItemCode" unique="UNIQUE_INDEX" >
				<column name="AttributeId" />
				<column name="AttributeItemCode" />
			</index>
			<fk name="FK_AttributeItem_StatProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="StatProductId" pk="ProductId" />
			</fk>
			<fk name="FK_AttributeItem_Attribute" to_schema="SnApp.dbo" to_table="tbAttribute" delete_action="cascade" >
				<fk_column name="AttributeId" pk="AttributeId" />
			</fk>
		</table>
		<table name="tbAuth" >
			<comment><![CDATA[Holds information about credit card transaction status]]></comment>
			<column name="AuthId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Workstation which created the transaction]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[User which created the transaction]]></comment>
			</column>
			<column name="AuthProcessorType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[141] Lookup to processor type: Demo - Mercury - ICVerify - Stratus - Ingenico - etc]]></comment>
			</column>
			<column name="ExternalAuth" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="AuthType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[142] Sale, VoidSale, Refund, PreAuth, PreauthCapture]]></comment>
			</column>
			<column name="AuthStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[55] ToBeApproved, Processing, Approved, Declined, AuthorizerTimeout, AuthorizerOffline, AuthorizerError]]></comment>
			</column>
			<column name="AuthAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount to be authorized]]></comment>
			</column>
			<column name="RequestDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Record creation date/time]]></comment>
			</column>
			<column name="StartDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Background processing start date/time]]></comment>
			</column>
			<column name="EndDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Background processing end date/time]]></comment>
			</column>
			<column name="CardType" type="varchar" length="15" decimal="0" jt="12" >
				<comment><![CDATA[Credit card type (VISA, MASTERCARD, etc)]]></comment>
			</column>
			<column name="CardNumber" type="varchar" length="40" decimal="0" jt="12" >
				<comment><![CDATA[Card number (real one or token)]]></comment>
			</column>
			<column name="CardExpDate" type="varchar" length="4" decimal="0" jt="12" >
				<comment><![CDATA[Expiration date]]></comment>
			</column>
			<column name="CardHolderName" type="varchar" length="30" decimal="0" jt="12" >
				<comment><![CDATA[Card holder name]]></comment>
			</column>
			<column name="InputType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[98] Manual, Swiped]]></comment>
			</column>
			<column name="AuthorizationMode" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[58] Online, VoiceAuth]]></comment>
			</column>
			<column name="AuthorizationCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Bank authorization code]]></comment>
			</column>
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="PK_Auth" unique="PRIMARY_KEY" >
				<column name="AuthId" />
			</index>
			<index name="IX_Auth_PaymentId" unique="NORMAL" >
				<column name="PaymentId" />
			</index>
			<fk name="FK_Auth_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Auth_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Auth_PaymentCard" to_schema="SnApp.dbo" to_table="tbPaymentCard" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
		</table>
		<table name="tbBiometric" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="BiometricSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="BiometricType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[229]]]></comment>
			</column>
			<column name="Template" type="varbinary(max)" jt="-3" mandatory="y" />
			<column name="EnrollmentDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" />
			<column name="ExpirationDate" type="date" jt="91" >
				<comment><![CDATA[Expiration date used when the biometric template is linked to a secondary ticket]]></comment>
			</column>
			<column name="ExternalTemplateId" type="varchar" length="100" jt="12" >
				<comment><![CDATA[Template id from external biometric lookup provider]]></comment>
			</column>
			<column name="BiometricStatus" type="smallint" length="1" jt="5" mandatory="y" >
				<comment><![CDATA[LK[453]]]></comment>
			</column>
			<index name="IX_Biometric_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_Biometric_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="IX_Biometric_EnrollmentDateTime" unique="NORMAL" >
				<column name="EnrollmentDateTime" options="ASC" />
			</index>
			<index name="IX_Biometric_ExpirationDate" unique="NORMAL" options="where ExpirationDate is not null" >
				<column name="ExpirationDate" options="ASC" />
			</index>
			<index name="PK_Biometric" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="BiometricSerial" />
			</index>
			<fk name="FK_Biometric_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Biometric_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbBiometricExternalPurge" prior="tbBiometricExternalPrge" >
			<comment><![CDATA[Temporary stores biometric templates that need to be de-enrolled on external systems]]></comment>
			<column name="BiometricExternalPurgeId" prior="BiometricExtrenalPurgeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the entity where the template was assigned]]></comment>
			</column>
			<column name="BiometricType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[229]]]></comment>
			</column>
			<column name="EnrollmentDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time of when the biometric template was enrolled]]></comment>
			</column>
			<column name="ExternalTemplateId" type="varchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Template id from external biometric lookup provider]]></comment>
			</column>
			<column name="AttemptCount" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Number of failed attempts]]></comment>
			</column>
			<column name="NextTryDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Next scheduled attempt date/time]]></comment>
			</column>
			<column name="BiometricExternalPurgeStatus" type="smallint" length="1" jt="5" mandatory="y" >
				<comment><![CDATA[LK[465]]]></comment>
			</column>
			<index name="PK_BiometricExternalPurge" unique="PRIMARY_KEY" >
				<column name="BiometricExternalPurgeId" />
			</index>
			<index name="IX_BiometricExternalPurge_EntityId" unique="NORMAL" >
				<column name="EntityId" />
			</index>
			<index name="IX_BiometricExternalPurge_ExternalTemplateId" unique="NORMAL" >
				<column name="ExternalTemplateId" />
			</index>
			<index name="IX_BiometricExternalPurge_Status_And_NextTry" unique="NORMAL" >
				<column name="BiometricExternalPurgeStatus" />
				<column name="NextTryDateTime" />
			</index>
		</table>
		<table name="tbBox" >
			<comment><![CDATA[Holds information about operators cash box.
The generic rule is that 1 box per Date per User per Location is created]]></comment>
			<column name="BoxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="BoxCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[System generate intelligible code]]></comment>
			</column>
			<column name="FBoxDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Box fiscal date]]></comment>
			</column>
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the location]]></comment>
			</column>
			<column name="OpAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Referece to the Operating Area (if the flag into licensee is active)]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the operator]]></comment>
			</column>
			<column name="BoxStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[53]]]></comment>
			</column>
			<column name="OverShort" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[When box gets closed, indicates how much is the over-short (difference between Declared and Expected amounts)]]></comment>
			</column>
			<column name="OverShortFlag" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[1 if the box is over-short (difference between Declared and Expected amounts)]]></comment>
			</column>
			<column name="CashContentAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Consolidated cash amount in the box]]></comment>
			</column>
			<column name="CashLimitWarnAmount" type="money" length="0" jt="3" >
				<comment><![CDATA[Taken from rights, cash limit warn amount for this box]]></comment>
			</column>
			<column name="LastWorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Last known workstation for the box]]></comment>
			</column>
			<index name="UQ_Box_Code" unique="UNIQUE_KEY" >
				<column name="BoxCode" options="ASC" />
			</index>
			<index name="IX_Box_DateLocationUser" unique="NORMAL" >
				<column name="FBoxDate" options="ASC" />
				<column name="LocationAccountId" options="ASC" />
				<column name="UserAccountId" options="ASC" />
				<column name="BoxStatus" options="ASC" />
			</index>
			<index name="IX_Box_LastWorkstationId" unique="NORMAL" >
				<column name="LastWorkstationId" options="ASC" />
			</index>
			<index name="IX_Box_LocationAccountId" unique="NORMAL" >
				<column name="LocationAccountId" options="ASC" />
				<column name="FBoxDate" options="ASC" />
			</index>
			<index name="IX_Box_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
				<column name="FBoxDate" options="ASC" />
			</index>
			<index name="PK_Box" unique="PRIMARY_KEY" >
				<column name="BoxId" />
			</index>
			<index name="IX_Box_OpAreaAccountId" unique="NORMAL" >
				<column name="OpAreaAccountId" />
				<column name="FBoxDate" />
			</index>
			<fk name="FK_Box_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Box_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Box_LastWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="LastWorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="Fk_Box_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaAccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbBoxContent" >
			<comment><![CDATA[Holds the breakdown of the expected box content, grouped by payment method]]></comment>
			<column name="BoxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to box ID]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the payment method]]></comment>
			</column>
			<column name="CurrencyISO" type="varchar" length="3" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Currency]]></comment>
			</column>
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="ContentAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Expected amount in main currency]]></comment>
			</column>
			<column name="CurrencyAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Expected amount in CurrencyISO currency]]></comment>
			</column>
			<index name="IX_BoxContent_PluginId" unique="NORMAL" >
				<column name="PluginId" options="ASC" />
			</index>
			<index name="PK_BoxContent" unique="PRIMARY_KEY" >
				<column name="BoxId" />
				<column name="PluginId" />
				<column name="CurrencyISO" />
			</index>
			<fk name="FK_BoxContent_Box" to_schema="SnApp.dbo" to_table="tbBox" delete_action="cascade" >
				<fk_column name="BoxId" pk="BoxId" />
			</fk>
			<fk name="FK_BoxContent_Plugin" to_schema="SnApp.dbo" to_table="tbPluginPaymentMethod" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbBoxDeposit" >
			<comment><![CDATA[Enlist all deposit and withdraws made on a box, including initial funds]]></comment>
			<column name="BoxDepositId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="BoxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the box]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the workstation where the operation is done]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the operator who made the operation]]></comment>
			</column>
			<column name="BoxDepositType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[64]]]></comment>
			</column>
			<column name="DepositFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date of the operation relative to the location where it was performed.
This field was introduced with patch 3.235 and its value might not be accurate (it will reflect the box's fiscal date) for records created before the patch because of the limitation of the patch itself.]]></comment>
			</column>
			<column name="DepositDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time of the operation]]></comment>
			</column>
			<column name="DepositAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount of the operation (positive for deposits, negative for withdraws)]]></comment>
			</column>
			<column name="BagNumber" type="varchar" length="15" jt="12" >
				<comment><![CDATA[BagNumber inserted by the operator]]></comment>
			</column>
			<column name="SupAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[If the operation was supervised, reference to the supervisor user account]]></comment>
			</column>
			<index name="IX_BoxDeposit_BoxId" unique="NORMAL" >
				<column name="BoxId" options="ASC" />
			</index>
			<index name="IX_BoxDeposit_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_BoxDeposit_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="IX_BoxDeposit_SupAccountId" unique="NORMAL" options="where SupAccountId is not null" >
				<column name="SupAccountId" options="ASC" />
			</index>
			<index name="IX_BoxDeposit_BagNumber" unique="NORMAL" options="where BagNumber is not null" >
				<column name="BagNumber" options="ASC" />
			</index>
			<index name="PK_BoxDeposit" unique="PRIMARY_KEY" >
				<column name="BoxDepositId" />
			</index>
			<index name="IX_BoxDeposit_DepositFiscalDate" unique="NORMAL" >
				<column name="DepositFiscalDate" />
				<column name="DepositDateTime" />
			</index>
			<fk name="FK_BoxDeposit_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_BoxDeposit_SupAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="SupAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_BoxDeposit_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_BoxDeposit_Box" to_schema="SnApp.dbo" to_table="tbBox" delete_action="cascade" >
				<fk_column name="BoxId" pk="BoxId" />
			</fk>
		</table>
		<table name="tbBoxDepositBreakdown" >
			<column name="BoxDepositId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the box deposit]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the payment method]]></comment>
			</column>
			<column name="CurrencyISO" type="varchar" length="3" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Currency]]></comment>
			</column>
			<column name="Amount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Denomination for coins, rolls or banknotes]]></comment>
			</column>
			<column name="FundCategory" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[71] - Coins, Rolls, Banknotes]]></comment>
			</column>
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity for denomination]]></comment>
			</column>
			<column name="ExchangeRate" type="decimal" length="38" decimal="19" jt="3" />
			<index name="PK_BoxDepositBreakdown" unique="PRIMARY_KEY" >
				<column name="BoxDepositId" />
				<column name="PluginId" />
				<column name="CurrencyISO" />
				<column name="Amount" />
				<column name="FundCategory" />
			</index>
			<fk name="FK_BoxDepositBreakdown_BoxDepositDetail" to_schema="SnApp.dbo" to_table="tbBoxDepositDetail" >
				<fk_column name="BoxDepositId" pk="BoxDepositId" />
			</fk>
		</table>
		<table name="tbBoxDepositDetail" >
			<comment><![CDATA[Holds a tbBoxDeposit breakdown by payment method]]></comment>
			<column name="BoxDepositId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the box deposit]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the payment method]]></comment>
			</column>
			<column name="CurrencyISO" type="varchar" length="3" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Currency]]></comment>
			</column>
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="TotalAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount in CurrencyISO currency]]></comment>
			</column>
			<column name="ExchangeRate" type="decimal" length="38" decimal="19" jt="3" mandatory="y" />
			<index name="IX_BoxDepositDetail_PluginId" unique="NORMAL" >
				<column name="PluginId" options="ASC" />
			</index>
			<index name="PK_BoxDepositDetail" unique="PRIMARY_KEY" >
				<column name="BoxDepositId" />
				<column name="PluginId" />
				<column name="CurrencyISO" />
			</index>
			<index name="unq_tbBoxDepositDetail_BoxDepositId" unique="UNIQUE_KEY" >
				<column name="BoxDepositId" />
			</index>
			<fk name="FK_BoxDepositDetail_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
			<fk name="FK_BoxDepositDetail_BoxDeposit" to_schema="SnApp.dbo" to_table="tbBoxDeposit" >
				<fk_column name="BoxDepositId" pk="BoxDepositId" />
			</fk>
		</table>
		<table name="tbBoxDepositIntercompany" prior="Tbl" >
			<column name="BoxDepositId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the box deposit]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the payment method]]></comment>
			</column>
			<column name="CurrencyISO" type="varchar" length="3" jt="12" mandatory="y" >
				<comment><![CDATA[Currency]]></comment>
			</column>
			<column name="CostCenterId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the cost center]]></comment>
			</column>
			<column name="Amount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Amount declared for the specific cost center]]></comment>
			</column>
			<index name="PK_BoxDepositIntercompany" unique="PRIMARY_KEY" >
				<column name="BoxDepositId" />
				<column name="PluginId" />
				<column name="CurrencyISO" />
				<column name="CostCenterId" />
			</index>
			<fk name="FK_BoxDepositIntercompany_BoxDepositDetail" to_schema="SnApp.dbo" to_table="tbBoxDepositDetail" delete_action="cascade" >
				<fk_column name="BoxDepositId" pk="BoxDepositId" />
				<fk_column name="PluginId" pk="PluginId" />
				<fk_column name="CurrencyISO" pk="CurrencyISO" />
			</fk>
		</table>
		<table name="tbBoxWarn" prior="Tbl" >
			<comment><![CDATA[Contains warning flags for each BOX]]></comment>
			<column name="BoxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the BOX]]></comment>
			</column>
			<column name="BoxWarn" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[445]]]></comment>
			</column>
			<index name="PK_BoxWarn" unique="PRIMARY_KEY" >
				<column name="BoxId" />
				<column name="BoxWarn" />
			</index>
			<fk name="FK_BoxWarn_Box" to_schema="SnApp.dbo" to_table="tbBox" delete_action="cascade" >
				<fk_column name="BoxId" pk="BoxId" />
			</fk>
		</table>
		<table name="tbBroadcast" >
			<column name="BroadcastId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SrcWorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="BroadcastType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[227]]]></comment>
			</column>
			<column name="BroadcastName" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="BroadcastDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="Acknowledged" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="BroadcastData" type="nvarchar(max)" jt="12" />
			<column name="ExpireDateTime" type="smalldatetime" jt="93" />
			<column name="DstLocationId" type="uniqueidentifier" jt="1" />
			<column name="DstOpAreaId" type="uniqueidentifier" jt="1" />
			<column name="DstWorkstationId" type="uniqueidentifier" jt="1" />
			<index name="IX_Broadcast_BroadcastDateTime" unique="NORMAL" >
				<column name="BroadcastDateTime" options="ASC" />
			</index>
			<index name="IX_Broadcast_SrcWorkstationId" unique="NORMAL" >
				<column name="SrcWorkstationId" options="ASC" />
			</index>
			<index name="IX_Broadcast_DstWorkstationId" unique="NORMAL" options="where DstWorkstationId is not null" >
				<column name="DstWorkstationId" options="ASC" />
			</index>
			<index name="IX_Broadcast_DstLocationId" unique="NORMAL" options="where DstLocationId is not null" >
				<column name="DstLocationId" options="ASC" />
			</index>
			<index name="IX_Broadcast_DstOpAreaId" unique="NORMAL" options="where DstOpAreaId is not null" >
				<column name="DstOpAreaId" options="ASC" />
			</index>
			<index name="IX_Broadcast_ExpireDateTime" unique="NORMAL" options="where ExpiredateTime is not null" >
				<column name="ExpireDateTime" options="ASC" />
			</index>
			<index name="PK_Broadcast" unique="PRIMARY_KEY" >
				<column name="BroadcastId" />
			</index>
			<fk name="FK_Broadcast_DstLoacationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="DstLocationId" pk="AccountId" />
			</fk>
			<fk name="FK_Broadcast_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="DstOpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_Broadcast_DstWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="DstWorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Broadcast_SrcWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="SrcWorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbCalendar" >
			<comment><![CDATA[Holds information about configure calendars]]></comment>
			<column name="CalendarId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CalendarType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[485] Internal/Snapp/etc]]></comment>
			</column>
			<column name="CalendarCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defind code]]></comment>
			</column>
			<column name="CalendarName" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Calendar name]]></comment>
			</column>
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Status]]></comment>
			</column>
			<column name="DatedCalendar" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if it is a "dated" calendar (used for dated product sales)]]></comment>
			</column>
			<column name="DatedEventId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[In case of "dated calendar", reference to the dependant event]]></comment>
			</column>
			<column name="DatedLocationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[In case of "dated calendar", indicates the location for the dependant event]]></comment>
			</column>
			<column name="DatedAccessAreaId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[In case of "dated calendar", indicates the access area for the dependant event]]></comment>
			</column>
			<column name="CategoryId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Category of the calendar]]></comment>
			</column>
			<index name="UQ_Calendar_CalendarCode" unique="UNIQUE_KEY" >
				<column name="CalendarCode" options="ASC" />
			</index>
			<index name="IX_Calendar_DatedEventId" unique="NORMAL" options="where DatedEventId is not null" >
				<column name="DatedEventId" options="ASC" />
			</index>
			<index name="IX_Calendar_DatedLocationId" unique="NORMAL" options="where DatedLocationId is not null" >
				<column name="DatedLocationId" options="ASC" />
			</index>
			<index name="IX_Calendar_DatedAccessAreaId" unique="NORMAL" options="where DatedAccessAreaId is not null" >
				<column name="DatedAccessAreaId" options="ASC" />
			</index>
			<index name="PK_Calendar" unique="PRIMARY_KEY" >
				<column name="CalendarId" />
			</index>
			<index name="IX_Calendar_CalendarType" unique="NORMAL" options="INCLUDE (Enabled, DatedCalendar)" >
				<column name="CalendarType" />
				<column name="CalendarName" />
			</index>
			<index name="IX_Calendar_CategoryId" unique="NORMAL" options="WHERE CategoryId IS NOT NULL" >
				<column name="CategoryId" />
			</index>
			<fk name="FK_Calendar_DatedLocation" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="DatedLocationId" pk="AccountId" />
			</fk>
			<fk name="FK_Calendar_DatedAccessArea" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="DatedAccessAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_Calendar_DatedEvent" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="DatedEventId" pk="EventId" />
			</fk>
			<fk name="FK_Calendar_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbCalendarDetail" >
			<comment><![CDATA[Each record represent a singular day of a calendar]]></comment>
			<column name="CalendarId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the calendar]]></comment>
			</column>
			<column name="CalendarDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Day]]></comment>
			</column>
			<column name="PerformanceTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to performance type]]></comment>
			</column>
			<column name="RateCodeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to rate code]]></comment>
			</column>
			<column name="StopSaleType" type="smallint" jt="5" >
				<comment><![CDATA[LK[486] Soft/Hard stop]]></comment>
			</column>
			<index name="IX_CalendarDetail_PerformanceTypeId" unique="NORMAL" options="where PerformanceTypeId is not null" >
				<column name="PerformanceTypeId" options="ASC" />
			</index>
			<index name="IX_CalendarDetail_RateCodeId" unique="NORMAL" options="where RateCodeId is not null" >
				<column name="RateCodeId" options="ASC" />
			</index>
			<index name="PK_CalendarDetail" unique="PRIMARY_KEY" >
				<column name="CalendarId" />
				<column name="CalendarDate" />
			</index>
			<fk name="FK_CalendarDetail_PerformanceType" to_schema="SnApp.dbo" to_table="tbPerformanceType" >
				<fk_column name="PerformanceTypeId" pk="PerformanceTypeId" />
			</fk>
			<fk name="FK_CalendarDetail_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" delete_action="cascade" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_CalendarDetail_RateCode" to_schema="SnApp.dbo" to_table="tbRateCode" >
				<fk_column name="RateCodeId" pk="RateCodeId" />
			</fk>
		</table>
		<table name="tbCaptcha" >
			<column name="CaptchaId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CaptchaCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" />
			<index name="IX_Captcha_CreateDateTime" unique="NORMAL" >
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="PK_Captcha" unique="PRIMARY_KEY" >
				<column name="CaptchaId" />
			</index>
		</table>
		<table name="tbCardType" >
			<comment><![CDATA[Enlist which product types (SourceProductId) are eligible to upgrade to the current product type (ProductId)]]></comment>
			<column name="CardTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CardTypeCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="CardTypeName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="CardTypeStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[414]]]></comment>
			</column>
			<index name="PK_CardType" unique="PRIMARY_KEY" >
				<column name="CardTypeId" />
			</index>
		</table>
		<table name="tbCardTypeRange" >
			<comment><![CDATA[Enlist which product types (SourceProductId) are eligible to upgrade to the current product type (ProductId)]]></comment>
			<column name="CardTypeRangeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CardTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RangeFrom" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="RangeTo" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<index name="IX_CardTypeRange_CardTypeId" unique="NORMAL" >
				<column name="CardTypeId" options="ASC" />
			</index>
			<index name="PK_CardTypeRange" unique="PRIMARY_KEY" >
				<column name="CardTypeRangeId" />
			</index>
			<fk name="FK_CardTypeRange_CardType" to_schema="SnApp.dbo" to_table="tbCardType" delete_action="cascade" >
				<fk_column name="CardTypeId" pk="CardTypeId" />
			</fk>
		</table>
		<table name="tbCatalog" >
			<comment><![CDATA[Holds information about configured catalogs.
A catalog is a tree structure, therefore this table is self-referencing on ParentCatalogId]]></comment>
			<column name="CatalogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CatalogType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[?] Catalog/Folder/Entity/Action]]></comment>
			</column>
			<column name="CatalogCode" type="varchar" length="15" jt="12" >
				<comment><![CDATA[Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="CatalogEnabled" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Node's status]]></comment>
			</column>
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Sorting between siblings (same ParentCatalogId)]]></comment>
			</column>
			<column name="ParentCatalogId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[when null, it's a "catalog", mandatory for all other CatalogType]]></comment>
			</column>
			<column name="CatalogName" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Not used for CatalogType=Entity]]></comment>
			</column>
			<column name="CatalogNameExt" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Node additional description]]></comment>
			</column>
			<column name="ShowNameExt" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if CatalogNameExt should display or not. Changes POS UI representation of the node]]></comment>
			</column>
			<column name="BackgroundColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<column name="ForegroundColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<column name="IconAlias" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[Font-Awesome icon name]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131] Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="ShowInFullMenu" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="ShowInQuickMenu" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="ShowInMainContent" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="AuthNeeded" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="TemplateCode" type="varchar" length="15" jt="12" >
				<comment><![CDATA[Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="FlowType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[233] Used only for CatalogType=Folder]]></comment>
			</column>
			<column name="AutoSynchronize" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Used only for CatalogType=Catalog]]></comment>
			</column>
			<column name="ManualChange" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Set to 1 for manually added nodes. Manually added nodes won't be remove by synchronization process]]></comment>
			</column>
			<column name="ButtonDisplayType" type="tinyint" jt="-6" >
				<comment><![CDATA[LK[292]]]></comment>
			</column>
			<column name="RootCatalogId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CategoryId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Category of the catalog. Applicable on root catalog node only]]></comment>
			</column>
			<column name="PricePointProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the product type used as reference price point for a folder]]></comment>
			</column>
			<index name="IX_Catalog_ParentId" unique="NORMAL" >
				<column name="ParentCatalogId" options="ASC" />
			</index>
			<index name="IX_Catalog_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_Catalog_CatalogCode" unique="NORMAL" options="where CatalogCode is not null" >
				<column name="CatalogCode" options="ASC" />
			</index>
			<index name="IX_Catalog_RootCatalogId" unique="NORMAL" >
				<column name="RootCatalogId" options="ASC" />
				<column name="EntityType" options="ASC" />
			</index>
			<index name="UQ_Catalog_CatalogCode" unique="NORMAL" options="WHERE CatalogType=1" >
				<column name="CatalogCode" options="ASC" />
			</index>
			<index name="IX_Catalog_CatalogType" unique="NORMAL" >
				<column name="CatalogType" options="ASC" />
			</index>
			<index name="PK_Catalog" unique="PRIMARY_KEY" >
				<column name="CatalogId" />
			</index>
			<index name="IX_Catalog_CategoryId" unique="NORMAL" >
				<column name="CategoryId" />
			</index>
			<index name="IX_Catalog_PricePointProduct" unique="NORMAL" options="WHERE PricePointProductId IS NOT NULL" >
				<column name="PricePointProductId" />
			</index>
			<fk name="FK_Catalog_ParentCatalog" to_schema="SnApp.dbo" to_table="tbCatalog" >
				<fk_column name="ParentCatalogId" pk="CatalogId" />
			</fk>
			<fk name="FK_Catalog_RootCatalog" to_schema="SnApp.dbo" to_table="tbCatalog" >
				<fk_column name="RootCatalogId" pk="CatalogId" />
			</fk>
			<fk name="FK_Catalog_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
			<fk name="FK_Catalog_PricePointProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="PricePointProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbCatalogCache" >
			<comment><![CDATA[Holds a cache of catalog zip file which contains all dependancies]]></comment>
			<column name="CatalogCacheId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Catalog cache internal ID]]></comment>
			</column>
			<column name="CatalogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to catalog]]></comment>
			</column>
			<column name="ZipFile" type="varbinary(max)" jt="-3" mandatory="y" >
				<comment><![CDATA[Catalog zip file]]></comment>
			</column>
			<column name="InvalidCache" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[- not used -]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Cache last update timestamp]]></comment>
			</column>
			<index name="UQ_CatalogCache_CatalogId" unique="NORMAL" >
				<column name="CatalogId" options="ASC" />
			</index>
			<index name="PK_CatalogCache" unique="PRIMARY_KEY" >
				<column name="CatalogCacheId" />
			</index>
			<fk name="FK_CatalogCache_Catalog" to_schema="SnApp.dbo" to_table="tbCatalog" delete_action="cascade" >
				<fk_column name="CatalogId" pk="CatalogId" />
			</fk>
		</table>
		<table name="tbCatalogRule" >
			<comment><![CDATA[Synchrnonization rules for catalog's folders]]></comment>
			<column name="CatalogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to catalog node (might be the root or a folder)]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131] rule grouping: ProductType / FamilyType / Event]]></comment>
			</column>
			<column name="CatalogRuleLine" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting within a catalog node]]></comment>
			</column>
			<column name="TagId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tag (works along with EntityType)]]></comment>
			</column>
			<column name="RuleInclude" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[1=Include / 0=Exclude]]></comment>
			</column>
			<index name="IX_CatalogRule_TagId" unique="NORMAL" >
				<column name="TagId" options="ASC" />
			</index>
			<index name="PK_CatalogRule" unique="PRIMARY_KEY" >
				<column name="CatalogId" />
				<column name="EntityType" />
				<column name="CatalogRuleLine" />
				<column name="TagId" />
			</index>
			<fk name="FK_CatalogRule_Tag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="TagId" pk="TagId" />
			</fk>
			<fk name="FK_CatalogRule_Catalog" to_schema="SnApp.dbo" to_table="tbCatalog" delete_action="cascade" >
				<fk_column name="CatalogId" pk="CatalogId" />
			</fk>
		</table>
		<table name="tbCategory" >
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="ParentCategoryId" type="uniqueidentifier" jt="1" />
			<column name="CategoryCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="CategoryName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="CategoryNameExt" type="nvarchar" length="50" jt="12" />
			<column name="ShowNameExt" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="RecursiveName" type="nvarchar" length="200" decimal="0" jt="12" />
			<column name="InheritMask" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true, masks for these categories are inherited recursively from parents]]></comment>
			</column>
			<column name="InheritLocation" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true, locations for these categories are inherited recursively from parents]]></comment>
			</column>
			<column name="InheritAccountContext" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true, account contexts for these categories are inherited recursively from parents. Account contexts are defined as LK[397]]]></comment>
			</column>
			<column name="BackgroundColor" type="varchar" length="6" decimal="0" jt="12" />
			<column name="ForegroundColor" type="varchar" length="6" decimal="0" jt="12" />
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Sorting for entities which support multiple categories (ie: accounts)]]></comment>
			</column>
			<index name="UQ_Category_Code" unique="UNIQUE_KEY" >
				<column name="CategoryCode" options="ASC" />
			</index>
			<index name="IX_Category_ParentCategoryId" unique="NORMAL" >
				<column name="ParentCategoryId" options="ASC" />
			</index>
			<index name="PK_Category" unique="PRIMARY_KEY" >
				<column name="CategoryId" />
			</index>
			<fk name="FK_Category_ParentCategory" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="ParentCategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbCategory2Entity" >
			<comment><![CDATA[many-2-many relationship between categories and entities which support multiple categories (ie: accounts)]]></comment>
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="IX_Category2Entity_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_Category2Entity" unique="PRIMARY_KEY" >
				<column name="CategoryId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_Category2Entity_Category" to_schema="SnApp.dbo" to_table="tbCategory" delete_action="cascade" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbCategory2Location" >
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_Category2Location_LocationAccountId" unique="NORMAL" >
				<column name="LocationAccountId" options="ASC" />
			</index>
			<index name="PK_Category2Location" unique="PRIMARY_KEY" >
				<column name="CategoryId" />
				<column name="LocationAccountId" />
			</index>
			<fk name="FK_Category2Location_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Category2Location_Category" to_schema="SnApp.dbo" to_table="tbCategory" delete_action="cascade" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbCategory2Mask" >
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MaskId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_Category2Mask_MaskId" unique="NORMAL" >
				<column name="MaskId" options="ASC" />
			</index>
			<index name="PK_Category2Mask" unique="PRIMARY_KEY" >
				<column name="CategoryId" />
				<column name="MaskId" />
			</index>
			<fk name="FK_Category2Mask_Category" to_schema="SnApp.dbo" to_table="tbCategory" delete_action="cascade" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
			<fk name="FK_Category2Mask_Mask" to_schema="SnApp.dbo" to_table="tbMask" >
				<fk_column name="MaskId" pk="MaskId" />
			</fk>
		</table>
		<table name="tbCodeAlias" >
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="CodeAlias" type="varchar" length="100" decimal="0" jt="12" mandatory="y" />
			<column name="CodeAliasTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" length="1" decimal="0" jt="1" mandatory="y" />
			<index name="IX_CodeAlias_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_CodeAlias_CodeAliasTypeId" unique="NORMAL" >
				<column name="CodeAliasTypeId" options="ASC" />
			</index>
			<index name="PK_CodeAlias" unique="PRIMARY_KEY" >
				<column name="EntityType" />
				<column name="CodeAlias" />
				<column name="CodeAliasTypeId" />
			</index>
			<fk name="FK_CodeAlias_CodeAliasType" to_schema="SnApp.dbo" to_table="tbCodeAliasType" >
				<fk_column name="CodeAliasTypeId" pk="CodeAliasTypeId" />
			</fk>
		</table>
		<table name="tbCodeAliasType" >
			<column name="CodeAliasTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CodeAliasTypeCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[code alias type code]]></comment>
			</column>
			<column name="CodeAliasTypeName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[code alias type name]]></comment>
			</column>
			<column name="CodeAliasTypeStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[357]]]></comment>
			</column>
			<column name="UniquePerObject" type="bit" length="1" decimal="0" jt="-7" mandatory="y" >
				<comment><![CDATA[true if code alias type can be used once for every entity type]]></comment>
			</column>
			<column name="ReplaceExisting" type="bit" length="1" decimal="0" jt="-7" mandatory="y" >
				<comment><![CDATA[If true, the existing code will be removed from the Entity it is connected to and linked to the new entity]]></comment>
			</column>
			<index name="PK_CodeAliasType" unique="PRIMARY_KEY" >
				<column name="CodeAliasTypeId" />
			</index>
		</table>
		<table name="tbCommission" >
			<column name="CommissionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CommissionCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="CommissionName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="PeriodType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[273]]]></comment>
			</column>
			<column name="IsQuantity" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true the commision details are about quantities, if false they are about amounts]]></comment>
			</column>
			<column name="CommissionAmountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[506] Static, Allow dynamic, Require dynamic]]></comment>
			</column>
			<column name="RoundingType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK73 Rounding rule for the calculated commission]]></comment>
			</column>
			<column name="TaxProfileId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Tax profile to be used to calculate the tax portion of the]]></comment>
			</column>
			<column name="CalculateOnGrossPrice" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When 0, the commission rate is applied to the ticket NET price.
When 1, the commission rate is applied to the ticket GROSS price.]]></comment>
			</column>
			<index name="PK_Commission" unique="PRIMARY_KEY" >
				<column name="CommissionId" />
			</index>
			<index name="IX_Commission_TaxProfileId" unique="NORMAL" options="WHERE TaxProfileId IS NOT NULL" >
				<column name="TaxProfileId" />
			</index>
			<fk name="FK_Commission_TaxProfile" to_schema="SnApp.dbo" to_table="tbTaxProfile" >
				<fk_column name="TaxProfileId" pk="TaxProfileId" />
			</fk>
		</table>
		<table name="tbCommissionDetail" >
			<column name="CommissionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CommissionSequence" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="FinanceGroupTagId" type="uniqueidentifier" jt="1" />
			<column name="Percentage" type="money" length="0" jt="3" mandatory="y" />
			<column name="QuantityFrom" type="int" length="1" decimal="0" jt="4" />
			<column name="QuantityTo" type="int" length="1" decimal="0" jt="4" />
			<column name="AmountFrom" type="money" length="0" jt="3" />
			<column name="AmountTo" type="money" length="0" jt="3" />
			<index name="IX_CommissionDetail_FinanceGroupTagId" unique="NORMAL" options="when FinanceGroupTagId is not null" >
				<column name="FinanceGroupTagId" options="ASC" />
			</index>
			<index name="PK_CommissionDetail" unique="PRIMARY_KEY" >
				<column name="CommissionId" />
				<column name="CommissionSequence" />
			</index>
			<fk name="FK_CommissionDetail_Tag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="FinanceGroupTagId" pk="TagId" />
			</fk>
			<fk name="FK_CommissionDetail_Commission" to_schema="SnApp.dbo" to_table="tbCommission" delete_action="cascade" >
				<fk_column name="CommissionId" pk="CommissionId" />
			</fk>
		</table>
		<table name="tbConfigLang" >
			<comment><![CDATA[Translate data: product names, etc]]></comment>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LangField" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[301]]]></comment>
			</column>
			<column name="LangISO" type="varchar" length="3" decimal="0" jt="12" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="Translation" type="nvarchar" length="100" jt="12" mandatory="y" />
			<index name="PK_ConfigLang" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="LangField" />
				<column name="LangISO" />
			</index>
		</table>
		<table name="tbConsAPI" >
			<column name="ConsolidateType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[167]]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="DateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="Service" type="varchar" length="25" decimal="0" jt="12" mandatory="y" />
			<column name="Command" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="HitCount" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="MinMS" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="AvgMS" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="MaxMS" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="TotMS" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" />
			<index name="IX_ConsAPI_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
			</index>
			<index name="PK_ConsAPI" unique="PRIMARY_KEY" >
				<column name="ConsolidateType" />
				<column name="FiscalDate" />
				<column name="DateTime" />
				<column name="Service" />
				<column name="Command" />
				<column name="ServerId" />
			</index>
			<index name="IX_ConsAPI_ConsolidateType_DateTime" unique="NORMAL" >
				<column name="ConsolidateType" />
				<column name="DateTime" />
			</index>
			<fk name="FK_ConsAPI_Server" to_schema="SnApp.dbo" to_table="tbServer" delete_action="cascade" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbConsAccess" >
			<comment><![CDATA[Consolidated statistics for admission data]]></comment>
			<column name="ConsAccessType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[169]]]></comment>
			</column>
			<column name="ConsolidateType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[167]]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[The fiscal date to which the entry scan belongs to]]></comment>
			</column>
			<column name="DateTime" type="smalldatetime" length="1" decimal="0" jt="93" mandatory="y" >
				<comment><![CDATA[The actual date and time for which the ticket was scanned]]></comment>
			</column>
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the location where the scan happened]]></comment>
			</column>
			<column name="OpAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the operating area where the scan happened]]></comment>
			</column>
			<column name="AccessAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the access area where the scan happened]]></comment>
			</column>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the performance where the scan happened]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OptionSetId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[There is no FK because we are going to save '0000-0000-etc' instead of nulls. Nulls cannot be used because the field is part of the PK]]></comment>
			</column>
			<column name="QtyFirstUsage" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyEntry" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyReentry" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyExit" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyCrossover" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyOverride" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyTransit" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyOffEntry" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyOffReentry" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QtyOffCrossover" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="FirstUsageRevenue" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_ConsAccess_LocationAccountId" unique="NORMAL" >
				<column name="LocationAccountId" options="ASC" />
			</index>
			<index name="IX_ConsAccess_OpAreaAccountId" unique="NORMAL" >
				<column name="OpAreaAccountId" options="ASC" />
			</index>
			<index name="IX_ConsAccess_PerformanceId" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_ConsAccess_AccessAreaId" unique="NORMAL" >
				<column name="AccessAreaAccountId" options="ASC" />
			</index>
			<index name="IX_ConsAccess_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_ConsAccess_OptionSetId" unique="NORMAL" >
				<column name="OptionSetId" options="ASC" />
			</index>
			<index name="PK_ConsAccess" unique="PRIMARY_KEY" >
				<column name="ConsAccessType" />
				<column name="ConsolidateType" />
				<column name="FiscalDate" />
				<column name="DateTime" />
				<column name="LocationAccountId" />
				<column name="OpAreaAccountId" />
				<column name="AccessAreaAccountId" />
				<column name="PerformanceId" />
				<column name="ProductId" />
				<column name="OptionSetId" />
			</index>
			<fk name="FK_ConsAccess_AcAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccessAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsAccess_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsAccess_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsAccess_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ConsAccess_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
		</table>
		<table name="tbConsAccountSale" >
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OptionSetId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[There is no FK because we are going to save '0000-0000-etc' instead of nulls. Nulls cannot be used because the field is part of the PK]]></comment>
			</column>
			<column name="TotalAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="TotalQuantity" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_ConsAccountSale_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="IX_ConsAccountSale_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_ConsAccountSale_OptionSetId" unique="NORMAL" >
				<column name="OptionSetId" options="ASC" />
			</index>
			<index name="PK_ConsAccountSale" unique="PRIMARY_KEY" >
				<column name="FiscalDate" />
				<column name="AccountId" />
				<column name="ProductId" />
				<column name="OptionSetId" />
			</index>
			<fk name="FK_ConsAccountSale_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsAccountSale_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbConsExtProductType" >
			<column name="ConsExtProductTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ExtProductTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ConsExtProductTypeType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[408]]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="TimeSlot" type="smalldatetime" jt="93" />
			<column name="Amount" type="money" length="0" jt="3" mandatory="y" />
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="Invalidated" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="IX_ConsExtProductType_ExtProductTypeId" unique="NORMAL" >
				<column name="ExtProductTypeId" options="ASC" />
			</index>
			<index name="PK_ConsExtProductType" unique="PRIMARY_KEY" >
				<column name="ConsExtProductTypeId" />
			</index>
			<fk name="FK_ConsExtProductType_ExtProductType" to_schema="SnApp.dbo" to_table="tbExtProductType" delete_action="cascade" >
				<fk_column name="ExtProductTypeId" pk="ExtProductTypeId" />
			</fk>
		</table>
		<table name="tbConsPayment" >
			<column name="ConsPaymentId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="LocationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PaymentMethodId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Amount" type="money" length="0" jt="3" mandatory="y" />
			<index name="UQ_ConsPayment" unique="UNIQUE_KEY" >
				<column name="FiscalDate" options="ASC" />
				<column name="LocationId" options="ASC" />
				<column name="OpAreaId" options="ASC" />
				<column name="PaymentMethodId" options="ASC" />
			</index>
			<index name="IX_ConsPayment_PaymentMethodId" unique="NORMAL" >
				<column name="PaymentMethodId" options="ASC" />
				<column name="FiscalDate" options="ASC" />
			</index>
			<index name="IX_ConsPayment_LocationId" unique="NORMAL" >
				<column name="LocationId" options="ASC" />
				<column name="FiscalDate" options="ASC" />
			</index>
			<index name="IX_ConsPayment_OpAreaId" unique="NORMAL" >
				<column name="OpAreaId" options="ASC" />
				<column name="FiscalDate" options="ASC" />
			</index>
			<index name="PK_ConsPayment" unique="PRIMARY_KEY" >
				<column name="ConsPaymentId" />
			</index>
			<fk name="FK_ConsPayment_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsPayment_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsPayment_PaymentMethod" to_schema="SnApp.dbo" to_table="tbPluginPaymentMethod" >
				<fk_column name="PaymentMethodId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbConsRotation" >
			<column name="ConsolidateType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[167] Day / TimeSlot]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="DateTime" type="datetime" jt="92" mandatory="y" />
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AptWorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="QtyEntry" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Total entry rotations]]></comment>
			</column>
			<column name="QtyExit" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Total exit rotations]]></comment>
			</column>
			<column name="QtyEntryControlled" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Entry controlled only]]></comment>
			</column>
			<column name="QtyExitControlled" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Exit controlled only]]></comment>
			</column>
			<column name="QtyEntryFree" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Entry free only]]></comment>
			</column>
			<column name="QtyExitFree" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Exit free only]]></comment>
			</column>
			<index name="IX_ConsRotation_LocationId" unique="NORMAL" >
				<column name="LocationAccountId" options="ASC" />
			</index>
			<index name="IX_ConsRotation_AptWorkstationId" unique="NORMAL" >
				<column name="AptWorkstationId" options="ASC" />
			</index>
			<index name="PK_ConsRotation" unique="PRIMARY_KEY" >
				<column name="ConsolidateType" />
				<column name="FiscalDate" />
				<column name="DateTime" />
				<column name="LocationAccountId" />
				<column name="AptWorkstationId" />
			</index>
			<fk name="FK_ConsRotation_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsRotation_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="AptWorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbConsRotationQueue" prior="Tbl" >
			<comment><![CDATA[Temporary holds individual rotations requests which will consolidated into tbConsRotation and then removed from this table]]></comment>
			<column name="ConsRotationQueueId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="AccessPointId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the access point where the rotation happened]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date at access point's location]]></comment>
			</column>
			<column name="RotationDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Rotation's date/time at server timezone]]></comment>
			</column>
			<column name="RotationLocalDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Rotation's date/time at access point's timezone]]></comment>
			</column>
			<column name="QtyEntry" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for entries (controlled + free)]]></comment>
			</column>
			<column name="QtyExit" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for exits (controlled + free)]]></comment>
			</column>
			<column name="QtyEntryControlled" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for controlled entries]]></comment>
			</column>
			<column name="QtyExitControlled" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Conter for controlled exits]]></comment>
			</column>
			<column name="QtyEntryFree" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for un-controlled entries]]></comment>
			</column>
			<column name="QtyExitFree" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for un-controlled exits]]></comment>
			</column>
			<index name="PK_ConsRotationQueue" unique="PRIMARY_KEY" >
				<column name="ConsRotationQueueId" />
			</index>
			<index name="IX_ConsRotationQueue_AccesssPointId" unique="NORMAL" >
				<column name="AccessPointId" />
				<column name="RotationDateTime" />
			</index>
			<fk name="FK_ConsRotationQueue_WksAccessPoint" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="AccessPointId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbConsRotationQueueConsQueue" prior="tbOutboundQueueHistoryConsQueue_0" >
			<column name="ConsRotationQueueId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="ConsQueueStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[266]]]></comment>
			</column>
			<column name="QueueDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="StartDateTime" type="datetime" jt="92" />
			<column name="EndDateTime" type="datetime" jt="92" />
			<index name="IX_ConsRotationQueueConsQueue_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="ConsQueueStatus" options="ASC" />
			</index>
			<index name="PK_ConsRotationQueueConsQueue" unique="PRIMARY_KEY" >
				<column name="ConsRotationQueueId" />
			</index>
			<index name="IX_ConsRotationQueueConsQueue_ConsQueueStatus" unique="NORMAL" options="INCLUDE (ServerId)" >
				<column name="ConsQueueStatus" />
				<column name="QueueDateTime" />
			</index>
			<fk name="FK_ConsRotationQueueConsQueue_ConsRotationQueue" to_schema="SnApp.dbo" to_table="tbConsRotationQueue" delete_action="cascade" >
				<fk_column name="ConsRotationQueueId" pk="ConsRotationQueueId" />
			</fk>
		</table>
		<table name="tbConsSale" >
			<column name="ConsSaleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ConsSaleType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[161]]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="TimeSlot" type="smalldatetime" jt="93" />
			<column name="LocationId" type="uniqueidentifier" jt="1" />
			<column name="OpAreaId" type="uniqueidentifier" jt="1" />
			<column name="ProductId" type="uniqueidentifier" jt="1" />
			<column name="OptionSetId" type="uniqueidentifier" jt="1" />
			<column name="Amount" type="money" length="0" jt="3" mandatory="y" />
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="EventId" type="uniqueidentifier" jt="1" />
			<index name="IX_ConsSale_LocationId" unique="NORMAL" options="where LocationId is not null" >
				<column name="LocationId" options="ASC" />
				<column name="ConsSaleType" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="TimeSlot" options="ASC" />
			</index>
			<index name="IX_ConsSale_OpAreaId" unique="NORMAL" options="where OpAreaId is not null" >
				<column name="OpAreaId" options="ASC" />
				<column name="ConsSaleType" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="TimeSlot" options="ASC" />
			</index>
			<index name="IX_ConsSale_ProductId" unique="NORMAL" options="where ProductId is not null" >
				<column name="ProductId" options="ASC" />
				<column name="ConsSaleType" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="TimeSlot" options="ASC" />
			</index>
			<index name="IX_ConsSale_OptionSetId" unique="NORMAL" options="where OptionSetId is not null" >
				<column name="OptionSetId" options="ASC" />
				<column name="ConsSaleType" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="TimeSlot" options="ASC" />
			</index>
			<index name="IX_ConsSale_EventId" unique="NORMAL" options="where EventId is not null" >
				<column name="EventId" options="ASC" />
				<column name="ConsSaleType" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="TimeSlot" options="ASC" />
			</index>
			<index name="UQ_ConsSale" unique="UNIQUE_KEY" >
				<column name="ConsSaleType" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="TimeSlot" options="ASC" />
				<column name="LocationId" options="ASC" />
				<column name="OpAreaId" options="ASC" />
				<column name="ProductId" options="ASC" />
				<column name="OptionSetId" options="ASC" />
				<column name="Amount" options="ASC" />
				<column name="EventId" options="ASC" />
			</index>
			<index name="PK_ConsSale" unique="PRIMARY_KEY" >
				<column name="ConsSaleId" />
			</index>
			<fk name="FK_ConsSale_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsSale_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsSale_Event" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
			<fk name="FK_ConsSale_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ConsSale_OptionSet" to_schema="SnApp.dbo" to_table="tbOptionSet" >
				<fk_column name="OptionSetId" pk="OptionSetId" />
			</fk>
		</table>
		<table name="tbConsServer" >
			<column name="ConsolidateType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[167]]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="DateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ServerParamKey" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[335]]]></comment>
			</column>
			<column name="ServerParamSubKey" type="varchar" length="32" decimal="0" jt="12" mandatory="y" />
			<column name="ValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[336]]]></comment>
			</column>
			<column name="MinValue" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" />
			<column name="AvgValue" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" />
			<column name="MaxValue" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" />
			<column name="CntValue" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" />
			<column name="TotValue" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" />
			<index name="IX_ConsServer_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="ConsolidateType" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="DateTime" options="ASC" />
				<column name="ServerParamKey" options="ASC" />
				<column name="ServerParamSubKey" options="ASC" />
			</index>
			<index name="PK_ConsServer" unique="PRIMARY_KEY" >
				<column name="ConsolidateType" />
				<column name="FiscalDate" />
				<column name="DateTime" />
				<column name="ServerId" />
				<column name="ServerParamKey" />
				<column name="ServerParamSubKey" />
			</index>
			<fk name="FK_ConsServer_Server" to_schema="SnApp.dbo" to_table="tbServer" delete_action="cascade" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbConsUpsell" prior="tbUpsellStats" >
			<comment><![CDATA[Upsell behavior statistical consolidation]]></comment>
			<column name="ConsUpsellId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Transaction's fiscal date]]></comment>
			</column>
			<column name="SourceProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the upsell/swap triggering/source product type]]></comment>
			</column>
			<column name="TargetProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the upsell/swap target product type]]></comment>
			</column>
			<column name="UpsellType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[488] Swap/Upsell]]></comment>
			</column>
			<column name="Quantity" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the operator which performance the upsell]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to workstation]]></comment>
			</column>
			<index name="PK_ConsUpsell" unique="PRIMARY_KEY" >
				<column name="ConsUpsellId" />
			</index>
			<index name="IX_ConsUpsell_SourceProductId" unique="NORMAL" >
				<column name="SourceProductId" />
				<column name="FiscalDate" />
			</index>
			<index name="IX_ConsUpsell_TargetProductId" unique="NORMAL" >
				<column name="TargetProductId" />
				<column name="FiscalDate" />
			</index>
			<index name="IX_ConsUpsell_UserAccountId" unique="NORMAL" options="WHERE UserAccountId IS NOT NULL" >
				<column name="UserAccountId" />
			</index>
			<index name="UQ_ConsUpsell_FiscalDate" unique="UNIQUE_INDEX" >
				<column name="FiscalDate" />
				<column name="UserAccountId" />
				<column name="WorkstationId" />
				<column name="TargetProductId" />
				<column name="SourceProductId" />
				<column name="UpsellType" />
			</index>
			<index name="IX_ConsUpsell_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" />
			</index>
			<fk name="FK_ConsUpsell_SourceProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="SourceProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ConsUpsell_TargetProduct" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="TargetProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ConsUpsell_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="setNull" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ConsUpsell_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbCorrelation" >
			<column name="CorrelationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CorrelationCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Correlation code coming with API request]]></comment>
			</column>
			<column name="SuppressEvent" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Value passed through outbound queue messages]]></comment>
			</column>
			<column name="RequestDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Date of the API request]]></comment>
			</column>
			<column name="RequestDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time of the API request]]></comment>
			</column>
			<column name="RequestCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[API code (CMD parameter)]]></comment>
			</column>
			<column name="RequestCommand" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[API sub command]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Session's workstation]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Session's user]]></comment>
			</column>
			<column name="ServerId" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Server (tomcat) identifier]]></comment>
			</column>
			<index name="UQ_Correlation_CorrelationCode" unique="UNIQUE_KEY" >
				<column name="CorrelationCode" options="ASC" />
			</index>
			<index name="IX_Correlation_DateTime" unique="NORMAL" >
				<column name="RequestDate" options="ASC" />
				<column name="RequestDateTime" options="ASC" />
			</index>
			<index name="IX_Correlation_RequestCode" unique="NORMAL" >
				<column name="RequestCode" options="ASC" />
				<column name="RequestCommand" options="ASC" />
				<column name="RequestDate" options="ASC" />
				<column name="RequestDateTime" options="ASC" />
			</index>
			<index name="IX_Correlation_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_Correlation_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_Correlation" unique="PRIMARY_KEY" >
				<column name="CorrelationId" />
			</index>
			<fk name="FK_Correlation_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Correlation_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbCryptoKey" >
			<column name="CryptoKeyId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EncryptedKey" type="nvarchar" length="1000" decimal="0" jt="12" mandatory="y" />
			<column name="LastChangeDate" type="date" jt="91" mandatory="y" />
			<column name="Deprecated" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Set to true when updating the key value... during the process the key cannot be used for new data encryption]]></comment>
			</column>
			<index name="PK_CryptoKey" unique="PRIMARY_KEY" >
				<column name="CryptoKeyId" />
			</index>
		</table>
		<table name="tbCurrency" >
			<column name="CurrencyId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CurrencyType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[47]]]></comment>
			</column>
			<column name="CurrencyStatus" type="smallint" length="1" jt="5" mandatory="y" >
				<comment><![CDATA[LK[426]]]></comment>
			</column>
			<column name="ISOCode" type="varchar" length="3" decimal="0" jt="12" mandatory="y" />
			<column name="ISOCodeNumeric" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="Symbol" type="nvarchar" length="10" decimal="0" jt="12" mandatory="y" />
			<column name="CurrencyName" type="nvarchar" length="30" jt="12" mandatory="y" />
			<column name="ExchangeRate" type="decimal" length="38" decimal="19" jt="3" mandatory="y" />
			<column name="ReverseExchangeRate" type="decimal" length="38" decimal="19" jt="3" />
			<column name="RoundDecimals" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="CurrencyFormat" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[147]]]></comment>
			</column>
			<column name="SmallestDenomination" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Minimum value to round at (up, down or algebraic)]]></comment>
			</column>
			<column name="RoundingType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[73]]]></comment>
			</column>
			<column name="AlgebraicThreshold" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Threshold when "rounding type=algebraic" to decide if up or down]]></comment>
			</column>
			<index name="UQ_Currency_ISOCode" unique="UNIQUE_KEY" >
				<column name="ISOCode" options="ASC" />
			</index>
			<index name="PK_Currency" unique="PRIMARY_KEY" >
				<column name="CurrencyId" />
			</index>
		</table>
		<table name="tbCurrencyDetail" >
			<column name="CurrencyDetailId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CurrencyId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="FundCategory" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[71]]]></comment>
			</column>
			<column name="Amount" type="money" length="0" jt="3" mandatory="y" />
			<index name="PK_CurrencyDetail" unique="PRIMARY_KEY" >
				<column name="CurrencyDetailId" />
			</index>
			<index name="IX_CurrencyDetail_CurrencyId" unique="NORMAL" >
				<column name="CurrencyId" />
			</index>
			<fk name="FK_CurrencyDetail_Currency" to_schema="SnApp.dbo" to_table="tbCurrency" delete_action="cascade" >
				<fk_column name="CurrencyId" pk="CurrencyId" />
			</fk>
		</table>
		<table name="tbDBInfo" >
			<column name="ParamName" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="ParamValue" type="nvarchar(max)" jt="12" mandatory="y" />
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" />
			<index name="PK_DBInfo" unique="PRIMARY_KEY" >
				<column name="ParamName" />
			</index>
			<index name="IX_DBInfo_LastUpdate" unique="NORMAL" options="INCLUDE (ParamName, ParamValue)" >
				<column name="LastUpdate" options="DESC" />
			</index>
		</table>
		<table name="tbDataSource" >
			<comment><![CDATA[Connection information to alternative databases such as reporting or logging database]]></comment>
			<column name="DataSourceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="DataSourceCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligibe alphanumeric user defined code]]></comment>
			</column>
			<column name="DataSourceName" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Datasource name]]></comment>
			</column>
			<column name="DataSourceType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[306]]]></comment>
			</column>
			<column name="DBHostName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="DBDatabaseName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="DBUserName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="DBPassword" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="CryptType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[236]]]></comment>
			</column>
			<column name="DBReadOnlyIntent" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Activate parameter ApplicationIntent=ReadOnly which for AZURE DB is the replica DB]]></comment>
			</column>
			<column name="LogTableName" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[For "log" data sources only, is the table name to be used for logging]]></comment>
			</column>
			<column name="LogTableURI" type="varchar" length="200" decimal="0" jt="12" >
				<comment><![CDATA[For "log" data sources only. Is the full table identifier for when querying logs from production database. Ie: [SERVER].[DATABASE NAME].[dbo].[tbLog]]]></comment>
			</column>
			<column name="PoolMin" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Minimum pool size]]></comment>
			</column>
			<column name="PoolMax" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Maximum pool size]]></comment>
			</column>
			<column name="WaitTimeoutMS" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Maximim time allowed to wait for a connection]]></comment>
			</column>
			<column name="IdleTimeoutMS" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Time after which an unused connection is closed and thrown away (for connections between min and max pool size)]]></comment>
			</column>
			<index name="UQ_DataSource_Code" unique="UNIQUE_KEY" >
				<column name="DataSourceCode" options="ASC" />
			</index>
			<index name="PK_DataSource" unique="PRIMARY_KEY" >
				<column name="DataSourceId" />
			</index>
		</table>
		<table name="tbDatabaseUpdate" >
			<column name="DatabaseUpdateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DateTimeStart" type="datetime" jt="92" mandatory="y" />
			<column name="DateTimeEnd" type="datetime" jt="92" />
			<column name="UpdateStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[?]]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="DBVersionFrom" type="varchar" length="10" decimal="0" jt="12" mandatory="y" />
			<column name="DBVersionTo" type="varchar" length="10" decimal="0" jt="12" mandatory="y" />
			<column name="ProgressPatch" type="varchar" length="10" decimal="0" jt="12" mandatory="y" />
			<column name="ProgressScript" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ProgressPos" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ProgressTot" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ErrorMsg" type="nvarchar(max)" jt="12" />
			<index name="IX_DatabaseUpdate_Status" unique="NORMAL" >
				<column name="UpdateStatus" options="ASC" />
				<column name="ServerId" options="ASC" />
			</index>
			<index name="PK_DatabaseUpdate" unique="PRIMARY_KEY" >
				<column name="DatabaseUpdateId" />
			</index>
		</table>
		<table name="tbDocContext" >
			<comment><![CDATA[List of application contexts where each statistical report should appear]]></comment>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ContextType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[198]]]></comment>
			</column>
			<index name="IX_DocContext_ContextType" unique="NORMAL" >
				<column name="ContextType" options="ASC" />
			</index>
			<index name="PK_DocContext" unique="PRIMARY_KEY" >
				<column name="DocTemplateId" />
				<column name="ContextType" />
			</index>
			<fk name="FK_DocContext_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" delete_action="cascade" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbDocParam" >
			<column name="DocParamId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DocParamType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[8] MetaFieldDataType]]></comment>
			</column>
			<column name="DocParamName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="DocParamCaption" type="nvarchar" length="50" jt="12" />
			<column name="DocParamDefault" type="nvarchar" length="50" jt="12" />
			<column name="Mandatory" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="IX_DocParam_DocTemplateId" unique="NORMAL" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="PK_DocParam" unique="PRIMARY_KEY" >
				<column name="DocParamId" />
			</index>
			<fk name="FK_DocParam_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" delete_action="cascade" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbDocTemplate" >
			<comment><![CDATA[Holds informations for all templates (media, order confirmation, stat.reports, etc)]]></comment>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Category (for data organization only)]]></comment>
			</column>
			<column name="DocTemplateType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[85] - Identify the template context, like "media", "transaction receipt"]]></comment>
			</column>
			<column name="DocEditorType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[87] - Identify the template format, like "email", "data export"]]></comment>
			</column>
			<column name="DocTemplateName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the template]]></comment>
			</column>
			<column name="DocTemplateCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Code of the template]]></comment>
			</column>
			<column name="DocEnabled" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Enabled/Disabled]]></comment>
			</column>
			<column name="DocData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Template's data, format depend on field DocTemplateEditor]]></comment>
			</column>
			<column name="ParentTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For queries, it's the DocTemplateId 'owning' this query]]></comment>
			</column>
			<column name="SystemCode" type="varchar" length="15" jt="12" >
				<comment><![CDATA[Identifier for system templates]]></comment>
			</column>
			<column name="MediaGroupTagId" type="uniqueidentifier" jt="1" />
			<column name="ExecRequireLogin" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates that this report can be executed without login check]]></comment>
			</column>
			<column name="MediaCashoutOption" type="smallint" jt="5" >
				<comment><![CDATA[LK[192]]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Templates' last modification]]></comment>
			</column>
			<column name="SaleForApproval" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true report is available if order (sale) not approved]]></comment>
			</column>
			<column name="SaleOpen" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true report is available if order (sale) is approved]]></comment>
			</column>
			<column name="SalePaid" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true report is available if order (sale) is paid]]></comment>
			</column>
			<column name="SaleCompleted" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true report is available if order (sale) is completed]]></comment>
			</column>
			<column name="IndividualPAH" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates to attach 1 print@home PDF per media, instead of 1 PDF overall]]></comment>
			</column>
			<column name="MediaRfidOptionType" type="smallint" jt="5" >
				<comment><![CDATA[LK[288]]]></comment>
			</column>
			<column name="DataSourceSelection" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When true, datasource can be selected on report's execution]]></comment>
			</column>
			<column name="DataSourceId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Default datasource to be used to run the report]]></comment>
			</column>
			<column name="MaxDateRangeDays" type="int" length="1" decimal="0" jt="4" />
			<column name="ExtensionPackageId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the specific extension package containing the report]]></comment>
			</column>
			<column name="MediaEncoderPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the external media encoder plugin]]></comment>
			</column>
			<column name="DataExportOutputFormat" type="smallint" jt="5" >
				<comment><![CDATA[LK[496] CSV,  XLS, PDF]]></comment>
			</column>
			<column name="CsvFieldSeparator" type="nvarchar" length="10" jt="12" >
				<comment><![CDATA[Character to be used as field separator in CSV exports]]></comment>
			</column>
			<column name="CsvQuoteCharacter" type="nvarchar" length="10" jt="12" >
				<comment><![CDATA[Character to be used as "quote character" in CSV exports]]></comment>
			</column>
			<column name="CsvIncludeHeaderLine" type="bit" jt="-7" >
				<comment><![CDATA[Indicates if field names should be inserted as the first line of the CSV export]]></comment>
			</column>
			<column name="CsvIncludeBOM" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if CSV export should have the first byte as BOM (Byte Order Mark)]]></comment>
			</column>
			<column name="PayByLink" type="bit" jt="-7" >
				<comment><![CDATA[identify paybylink doc template]]></comment>
			</column>
			<column name="AutoCompleteOnPayment" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the order will be automatically completed (Paid, Printed and Validated) once the pay by link payment approval is received]]></comment>
			</column>
			<column name="AutoCompleteDocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Order confirmation DocTemplateId to be used to automatically send an order confirmmation including print at home tickets when the pay by link payment approval is received]]></comment>
			</column>
			<index name="UQ_DocTemplate_SystemCode" unique="UNIQUE_KEY" options="WHERE SystemCode IS NOT NULL" >
				<column name="SystemCode" options="ASC" />
				<column name="ExtensionPackageId" options="ASC" />
			</index>
			<index name="UQ_DocTemplate_DocTemplateCode" unique="UNIQUE_KEY" >
				<column name="DocTemplateCode" options="ASC" />
			</index>
			<index name="IX_DocTemplate_DocTemplateType_LastUpdate" unique="NORMAL" >
				<column name="DocTemplateType" options="ASC" />
				<column name="LastUpdate" options="ASC" />
			</index>
			<index name="IX_DocTemplate_ParentTemplateId" unique="NORMAL" >
				<column name="ParentTemplateId" options="ASC" />
			</index>
			<index name="IX_DocTemplate_DataSourceId" unique="NORMAL" options="where DataSourceId is not null" >
				<column name="DataSourceId" options="ASC" />
			</index>
			<index name="IX_DocTemplate_ExtensionPackageId" unique="NORMAL" options="where ExtensionPackageId is not null" >
				<column name="ExtensionPackageId" options="ASC" />
			</index>
			<index name="IX_DocTemplate_MediaEncoderPluginId" unique="NORMAL" options="where MediaEncoderPluginId is not null" >
				<column name="MediaEncoderPluginId" options="ASC" />
			</index>
			<index name="PK_DocTemplate" unique="PRIMARY_KEY" >
				<column name="DocTemplateId" />
			</index>
			<index name="IX_DocTemplate_CategoryId" unique="NORMAL" >
				<column name="CategoryId" />
			</index>
			<index name="IX_DocTemplate_MediaGroupTagId" unique="NORMAL" >
				<column name="MediaGroupTagId" />
			</index>
			<index name="IX_DocTemplate_AutoCompleteDocTemplateId" unique="NORMAL" options="where AutoCompleteDocTemplateId is not null" >
				<column name="AutoCompleteDocTemplateId" options="ASC" />
			</index>
			<fk name="FK_DocTemplate_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
			<fk name="FK_DocTemplate_MediaEncoderPlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="MediaEncoderPluginId" pk="PluginId" />
			</fk>
			<fk name="FK_DocTemplate_Parent" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="ParentTemplateId" pk="DocTemplateId" />
			</fk>
			<fk name="FK_DocTemplate_MediaGroupTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="MediaGroupTagId" pk="TagId" />
			</fk>
			<fk name="FK_DocTemplate_ExtensionPackage" to_schema="SnApp.dbo" to_table="tbExtensionPackage" >
				<fk_column name="ExtensionPackageId" pk="ExtensionPackageId" />
			</fk>
			<fk name="FK_DocTemplate_DataSource" to_schema="SnApp.dbo" to_table="tbDataSource" >
				<fk_column name="DataSourceId" pk="DataSourceId" />
			</fk>
			<fk name="FK_DocTemplate_AutoCompleteDocTemplateId" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="AutoCompleteDocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbDocTemplate2DocTemplate" prior="tbDocTemplate2Doc" >
			<comment><![CDATA[Stores the "statistical reports" templates (LinkedDocTemplateId) which should be attached in an "order confirmation" template (DocTemplateId)]]></comment>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the "master" template]]></comment>
			</column>
			<column name="LinkedDocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the "slave" template]]></comment>
			</column>
			<index name="PK_DocTemplate2DocTemplate" unique="PRIMARY_KEY" >
				<column name="DocTemplateId" />
				<column name="LinkedDocTemplateId" />
			</index>
			<index name="IX_DocTemplate2DocTemplate_LinkedDocTemplate" unique="NORMAL" >
				<column name="LinkedDocTemplateId" />
			</index>
			<fk name="FK_DocTemplate2DocTemplate_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" delete_action="cascade" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
			<fk name="FK_DocTemplate2DocTemplate_LinkedDocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="LinkedDocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbDocTemplate2Driver" >
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="DriverId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DeviceAlias" type="varchar" length="15" jt="12" />
			<index name="IX_DocTemplate2Driver_DriverId" unique="NORMAL" >
				<column name="DriverId" options="ASC" />
			</index>
			<index name="PK_DocTemplate2Driver" unique="PRIMARY_KEY" >
				<column name="DocTemplateId" />
				<column name="PriorityOrder" />
				<column name="DriverId" />
			</index>
			<fk name="FK_DocTemplate2Driver_Driver" to_schema="SnApp.dbo" to_table="tbDriver" >
				<fk_column name="DriverId" pk="DriverId" />
			</fk>
			<fk name="FK_DocTemplate2Driver_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" delete_action="cascade" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbDocketDevice" >
			<comment><![CDATA[List of configured kitchen docket monitors/printers]]></comment>
			<column name="DocketDeviceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DocketDeviceType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[311] Display/Printer]]></comment>
			</column>
			<column name="DocketDeviceName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" />
			<index name="IX_DocketDevice_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_DocketDevice_DocTemplateId" unique="NORMAL" options="where DocTemplateId is not null" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="PK_DocketDevice" unique="PRIMARY_KEY" >
				<column name="DocketDeviceId" />
			</index>
			<fk name="FK_DocketDevice_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_DocketDevice_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbDocketDevice2OpArea" >
			<comment><![CDATA[Configured operating areas for each docket device]]></comment>
			<column name="DocketDeviceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_DocketDevice2OpArea" unique="NORMAL" >
				<column name="OpAreaId" options="ASC" />
			</index>
			<index name="PK_DocketDevice2OpArea" unique="PRIMARY_KEY" >
				<column name="DocketDeviceId" />
				<column name="OpAreaId" />
			</index>
			<fk name="FK_DocketDevice2OpArea_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbDriver" >
			<column name="DriverId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DriverType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[41]]]></comment>
			</column>
			<column name="DriverName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="LibraryName" type="varchar" length="100" decimal="0" jt="12" />
			<column name="ClassAlias" type="varchar" length="25" decimal="0" jt="12" mandatory="y" />
			<column name="ClassName" type="varchar" length="255" decimal="0" jt="12" />
			<column name="ConfigFileName" prior="ConfigFile" type="varchar" length="100" jt="12" >
				<comment><![CDATA[Name of the HTML fragment file handling plugin's config/settings UI]]></comment>
			</column>
			<column name="DriverConfigFileName" type="varchar" length="100" jt="12" >
				<comment><![CDATA[Name of the HTML fragment file handling driver's config/settings UI]]></comment>
			</column>
			<column name="ExtensionPackageId" type="uniqueidentifier" jt="1" />
			<column name="DriverSettings" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[XML/JSON driver specific settings]]></comment>
			</column>
			<column name="Sdm" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Snapp deviced manager flag.]]></comment>
			</column>
			<index name="IX_Driver_ExtensionPackageId" unique="NORMAL" >
				<column name="ExtensionPackageId" options="ASC" />
			</index>
			<index name="PK_Driver" unique="PRIMARY_KEY" >
				<column name="DriverId" />
			</index>
			<fk name="FK_Driver_ExtensionPackage" to_schema="SnApp.dbo" to_table="tbExtensionPackage" >
				<fk_column name="ExtensionPackageId" pk="ExtensionPackageId" />
			</fk>
		</table>
		<table name="tbDriverFramework" >
			<column name="DriverId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="FileName" prior="FrameworkFileName" type="varchar" length="100" decimal="0" jt="12" mandatory="y" />
			<column name="Platform" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[SO platform which file has to be used to]]></comment>
			</column>
			<column name="SourceFolder" type="varchar" length="100" jt="12" >
				<comment><![CDATA[File source folder on repository]]></comment>
			</column>
			<column name="ToRunningFolder" type="bit" jt="-7" >
				<comment><![CDATA[Define if file has to be copied where the VgsBoard file is]]></comment>
			</column>
			<index name="PK_DriverFramework" unique="PRIMARY_KEY" >
				<column name="DriverId" />
				<column name="FileName" />
				<column name="Platform" />
			</index>
			<fk name="FK_DriverFramework_Driver" to_schema="SnApp.dbo" to_table="tbDriver" delete_action="cascade" >
				<fk_column name="DriverId" pk="DriverId" />
			</fk>
		</table>
		<table name="tbEntitlement" >
			<comment><![CDATA[Holds information about configured entitlements (access rights).
Can be attached to product types or attribute items]]></comment>
			<column name="EntitlementId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the entity which this entitlement is attache to]]></comment>
			</column>
			<column name="EntitlementStatus" type="smallint" length="1" jt="5" mandatory="y" >
				<comment><![CDATA[LK[497] 1=Static, 2=Dynamic, 3=DynamicOld]]></comment>
			</column>
			<column name="EntitlementData" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[JSON representation of the entitlement rules]]></comment>
			</column>
			<column name="VarExpRule" type="smallint" jt="5" >
				<comment><![CDATA[LK[27]]]></comment>
			</column>
			<column name="VarExpQuantity" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Values meaning depend on VarExpRule]]></comment>
			</column>
			<column name="VarFirstUsageRule" type="smallint" jt="5" >
				<comment><![CDATA[LK[29]]]></comment>
			</column>
			<column name="VarFirstUsageQuantity" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Values meaning depend on VarFirstUsageRule]]></comment>
			</column>
			<column name="AdmDateFrom" type="date" jt="91" >
				<comment><![CDATA[Consolidated "date start" limit calculated on entitlement's JSON]]></comment>
			</column>
			<column name="AdmDateTo" type="date" jt="91" >
				<comment><![CDATA[Consolidated "date end" limit calculated on entitlement's JSON]]></comment>
			</column>
			<column name="AdmTimeFrom" type="datetime" jt="92" >
				<comment><![CDATA[Consolidated "time start" limit calculated on entitlement's JSON]]></comment>
			</column>
			<column name="AdmTimeTo" type="datetime" jt="92" >
				<comment><![CDATA[Consolidated "time end" limit calculated on entitlement's JSON]]></comment>
			</column>
			<column name="AdmCalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Consolidated "calendar" calculated on entitlement's JSON]]></comment>
			</column>
			<column name="PerformanceQuantity" type="int" jt="4" >
				<comment><![CDATA[Number of consecutive performances to be autoselected on sale]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Last record update]]></comment>
			</column>
			<column name="Used" type="bit" jt="-7" >
				<comment><![CDATA[Set to 1 when there is at least 1 tbTicketUsage pointing to the entitlement]]></comment>
			</column>
			<index name="IDX_Entitlement_Entity" unique="NORMAL" >
				<column name="EntityType" options="ASC" />
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_Entitlement_AdmCalendarId" unique="NORMAL" options="where AdmCalendarId is not null" >
				<column name="AdmCalendarId" options="ASC" />
			</index>
			<index name="PK_Entitlement" unique="PRIMARY_KEY" >
				<column name="EntitlementId" />
			</index>
			<index name="IX_Entitlement_EntityIdAndStatus" unique="NORMAL" >
				<column name="EntityId" />
				<column name="EntitlementStatus" />
			</index>
			<index name="UQ_Entitlement_EntityId" unique="UNIQUE_INDEX" options="where EntitlementStatus in (1,2)" >
				<column name="EntityId" options="ASC" />
				<column name="EntitlementStatus" />
			</index>
			<index name="IX_Entitlement_StatusUsedLastUpdate" unique="NORMAL" >
				<column name="EntitlementStatus" />
				<column name="Used" />
				<column name="LastUpdate" />
			</index>
			<fk name="FK_Entitlement_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="AdmCalendarId" pk="CalendarId" />
			</fk>
		</table>
		<table name="tbEntitlement2Event" >
			<comment><![CDATA[Consolidated list of potential events which each entitlement refers to]]></comment>
			<column name="EntitlementId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to entitlement]]></comment>
			</column>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to event]]></comment>
			</column>
			<index name="IX_Entitlement2Event_EventId" unique="NORMAL" >
				<column name="EventId" options="ASC" />
			</index>
			<index name="PK_Entitlement2Event" unique="PRIMARY_KEY" >
				<column name="EntitlementId" />
				<column name="EventId" />
			</index>
			<fk name="FK_Entitlement2Event_Event" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
			<fk name="FK_Entitlement2Event_Entitlement" to_schema="SnApp.dbo" to_table="tbEntitlement" delete_action="cascade" >
				<fk_column name="EntitlementId" pk="EntitlementId" />
			</fk>
		</table>
		<table name="tbEntitlementVersion" prior="tbEntitlementOverride" >
			<comment><![CDATA[Hold's historical product's entitlements versioning. Used to override existing tickets' entitlements.]]></comment>
			<column name="EntitlementVersionId" prior="EntitlementOverrideId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product internal ID]]></comment>
			</column>
			<column name="EncodeDateFrom" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Indicates to apply entitlements override to tickets encoded starting from this date]]></comment>
			</column>
			<column name="EncodeDateTo" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Indicates to apply entitlements override to tickets encoded up to this date]]></comment>
			</column>
			<column name="EntitlementData" type="varchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[Entitlements data object]]></comment>
			</column>
			<column name="OverrideVersion" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Incremental numeric version]]></comment>
			</column>
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time of record creation]]></comment>
			</column>
			<column name="CreateWorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the workstation from which this record was created]]></comment>
			</column>
			<column name="CreateUserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the operator which created this record]]></comment>
			</column>
			<index name="PK_EntitlementVersion" unique="PRIMARY_KEY" >
				<column name="EntitlementVersionId" />
			</index>
			<index name="IX_EntitlementVersion_CreateUserAccountId" unique="NORMAL" options="where CreateUserAccountId is not null" >
				<column name="CreateUserAccountId" />
				<column name="CreateDateTime" />
			</index>
			<index name="IX_EntitlementVersion_CreateWorkstationId" unique="NORMAL" >
				<column name="CreateWorkstationId" />
				<column name="CreateDateTime" />
			</index>
			<index name="IX_EntitlementVersion_ProductId" unique="NORMAL" >
				<column name="ProductId" />
				<column name="OverrideVersion" />
			</index>
			<index name="IX_EntitlementVersion_ProductId_EncodeDateTo" unique="NORMAL" options="INCLUDE EncodeDateFrom, OverrideVersion" >
				<column name="ProductId" />
				<column name="EncodeDateTo" />
			</index>
			<fk name="FK_EntitlementVersion_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_EntitlementVersion_CreateWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="CreateWorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_EntitlementVersion_CreateUserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="CreateUserAccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbEntityChange" >
			<column name="EntityChangeId" type="bigint" jt="-5" mandatory="y" >
				<identity><![CDATA[IDENTITY(1,1)]]></identity>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="InsertUpdate" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="EntityChangeGroup" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[446]]]></comment>
			</column>
			<column name="CreateDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Record date of creation]]></comment>
			</column>
			<column name="DocData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[JSON serialization of the entity]]></comment>
			</column>
			<index name="UQ_EntityChange_EntityId" unique="UNIQUE_INDEX" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_EntityChange_EntityType" unique="NORMAL" options="include (InsertUpdate, EntityId)" >
				<column name="EntityType" options="ASC" />
				<column name="EntityChangeId" options="ASC" />
			</index>
			<index name="PK_EntityChange" unique="PRIMARY_KEY" >
				<column name="EntityChangeId" />
			</index>
			<index name="IX_EntityChange_EntityChangeGroup" unique="NORMAL" >
				<column name="EntityChangeGroup" />
				<column name="CreateDate" />
				<column name="EntityChangeId" />
			</index>
		</table>
		<table name="tbEntityLink" >
			<column name="SrcEntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DstEntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityLinkType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[209]]]></comment>
			</column>
			<column name="SrcEntityType" type="smallint" jt="5" mandatory="y" />
			<column name="DstEntityType" type="smallint" jt="5" mandatory="y" />
			<index name="IX_EntityLink_SrcEntityId_DstEntityType" unique="NORMAL" >
				<column name="SrcEntityId" options="ASC" />
				<column name="DstEntityType" options="ASC" />
			</index>
			<index name="IX_EntityLink_SrcEntityId_EntityLinkType" unique="NORMAL" >
				<column name="SrcEntityId" options="ASC" />
				<column name="EntityLinkType" options="ASC" />
			</index>
			<index name="IX_EntityLink_DstEntityId_SrcEntityType" unique="NORMAL" >
				<column name="DstEntityId" options="ASC" />
				<column name="SrcEntityType" options="ASC" />
			</index>
			<index name="IX_EntityLink_DstEntityId_EntityLinkType" unique="NORMAL" >
				<column name="DstEntityId" options="ASC" />
				<column name="EntityLinkType" options="ASC" />
			</index>
			<index name="PK_EntityLink" unique="PRIMARY_KEY" >
				<column name="SrcEntityId" />
				<column name="DstEntityId" />
				<column name="EntityLinkType" />
			</index>
		</table>
		<table name="tbEntityRight" >
			<comment><![CDATA[Used to define document-specific-rights.... like "what user/role can view/edit a report"]]></comment>
			<column name="DocEntityId" type="uniqueidentifier" length="0" decimal="0" jt="1" mandatory="y" />
			<column name="UsrEntityId" type="uniqueidentifier" length="0" decimal="0" jt="1" mandatory="y" />
			<column name="DocEntityType" type="smallint" length="0" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="UsrEntityType" type="smallint" length="0" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="RightLevel" type="smallint" length="0" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[LK[152]]]></comment>
			</column>
			<index name="IX_EntityRight_UsrEntityId" unique="NORMAL" >
				<column name="UsrEntityId" options="ASC" />
				<column name="DocEntityType" options="ASC" />
			</index>
			<index name="PK_EntityRight" unique="PRIMARY_KEY" >
				<column name="DocEntityId" />
				<column name="UsrEntityId" />
			</index>
		</table>
		<table name="tbEntityTab" >
			<column name="EntityTabId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LangISO" type="varchar" length="3" decimal="0" jt="12" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[?] Event/Product Family]]></comment>
			</column>
			<column name="EntityTabName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="EntityTabType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[232]]]></comment>
			</column>
			<column name="ExternalURL" type="varchar" length="2000" decimal="0" jt="12" />
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<index name="IX_EntityTab_EntityId_LangISO" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="LangISO" options="ASC" />
			</index>
			<index name="PK_EntityTab" unique="PRIMARY_KEY" >
				<column name="EntityTabId" />
			</index>
		</table>
		<table name="tbEvent" >
			<comment><![CDATA[Holds information of events (shows)]]></comment>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the location which this event belongs to]]></comment>
			</column>
			<column name="EventType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[38]]]></comment>
			</column>
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Category of the event (determins applicable data masks)]]></comment>
			</column>
			<column name="EventCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="EventName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Event name]]></comment>
			</column>
			<column name="EventNameExt" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Event additional description]]></comment>
			</column>
			<column name="ShowNameExt" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if EventNameExt should be displayed on POS buttons]]></comment>
			</column>
			<column name="EventStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[40]]]></comment>
			</column>
			<column name="OnSaleFrom" type="date" jt="91" >
				<comment><![CDATA[Date from which the event is available for sale. 
Null = no limit]]></comment>
			</column>
			<column name="OnSaleTo" type="date" jt="91" >
				<comment><![CDATA[Date after which the event is not available for sale anymore. 
Null = no limit]]></comment>
			</column>
			<column name="ProducerAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Organization producing the event]]></comment>
			</column>
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Default for new performances]]></comment>
			</column>
			<column name="AccessAreaAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Default for new performances]]></comment>
			</column>
			<column name="CalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Operating calendar]]></comment>
			</column>
			<column name="UncountCalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference a calendar for which dates should not be counted as "outstanding" bookings]]></comment>
			</column>
			<column name="DefaultPerformanceDuration" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[In minutes]]></comment>
			</column>
			<column name="AdmissionOpenMins" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Start admission "n" minutes relative to performance start ("-10" mean 10 minutes before)]]></comment>
			</column>
			<column name="AdmissionCloseMins" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Stop admission "n" minutes relative to performance start. ("+10" means 10 minuter after performance start)]]></comment>
			</column>
			<column name="PositionLat" type="float" length="1" decimal="0" jt="8" >
				<comment><![CDATA[GPS latitude coords]]></comment>
			</column>
			<column name="PositionLong" type="float" length="1" decimal="0" jt="8" >
				<comment><![CDATA[GPS longitude coords]]></comment>
			</column>
			<column name="Weight" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Sorting weight]]></comment>
			</column>
			<column name="ActiveDateFrom" type="date" jt="91" >
				<comment><![CDATA[Rough indication of when the event will be performing (usefull for temporary events B2C representation, without going to performance level)]]></comment>
			</column>
			<column name="ActiveDateTo" type="date" jt="91" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveTimeFrom" type="datetime" jt="92" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveTimeTo" type="datetime" jt="92" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveMON" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveTUE" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveWED" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveTHU" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveFRI" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveSAT" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ActiveSUN" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="AverageVisitTime" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[" (in minutes)]]></comment>
			</column>
			<column name="ReferencePrice" type="money" length="0" jt="3" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="PerformanceSelection" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="QueueSlotFrequence" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[expressed in minutes]]></comment>
			</column>
			<column name="QueueSlotCapacity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Not Yet Used]]></comment>
			</column>
			<column name="AutoCreatePerfDays" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[If greater than zero, system will auto-create performances for "n" days accordingly to the operating calendar (CalendarId)]]></comment>
			</column>
			<column name="LastPerfAutoCreate" type="smalldatetime" jt="93" >
				<comment><![CDATA[Internal Use]]></comment>
			</column>
			<column name="SoldOutWarnLimit" type="tinyint" length="1" decimal="0" jt="-6" >
				<comment><![CDATA[For limited capacity events, it represents the percertage, under which the system will display seats in "orange" color, indicating that a performance is almost sold out]]></comment>
			</column>
			<column name="RestrictOpenOrder" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If flagged, orders cannot be left open but must be paid on creation]]></comment>
			</column>
			<column name="VarExpRule" type="smallint" jt="5" >
				<comment><![CDATA[LK[289]]]></comment>
			</column>
			<column name="VarExpQuantity" type="smallint" length="1" decimal="0" jt="5" />
			<column name="VarFirstUsageRule" type="smallint" jt="5" >
				<comment><![CDATA[LK[289]]]></comment>
			</column>
			<column name="VarFirstUsageQuantity" type="smallint" length="1" decimal="0" jt="5" />
			<column name="AdmDateFrom" type="date" jt="91" >
				<comment><![CDATA[Rough indication of when the event will be performing (usefull for temporary events B2C representation, without going to performance level)]]></comment>
			</column>
			<column name="AdmDateTo" type="date" jt="91" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="AdmTimeFrom" type="datetime" jt="92" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="AdmTimeTo" type="datetime" jt="92" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="CrossPlatformId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[If not null, event comes from cross platform. No manual changes are allowed.]]></comment>
			</column>
			<column name="CrossEventStatus" type="smallint" jt="5" >
				<comment><![CDATA[LK[302] Present only if CrossPlatformId is not null]]></comment>
			</column>
			<column name="BackgroundColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<column name="ForegroundColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<column name="IconAlias" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[FontAwesome icon name]]></comment>
			</column>
			<column name="BookingWindowDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Users can only select performances up to this number of days in the future]]></comment>
			</column>
			<column name="DynRateCodeType" type="smallint" jt="5" >
				<comment><![CDATA[LK[461] Indicates if tbEventDynRateCode.Value refers to SOLD vs AVAILABLE quantities]]></comment>
			</column>
			<column name="DynRateCodeValueType" type="smallint" jt="5" >
				<comment><![CDATA[LK[135] Indicates if tbEventDynRateCode.Value are expressed as ABSOLUTE or PERCENTAGE]]></comment>
			</column>
			<column name="WaiverDocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Template for the waiver required to access this event's performances]]></comment>
			</column>
			<column name="RedemptionCacheDeltaHours" type="smallint" jt="5" >
				<comment><![CDATA[Number of hours, before/after performance admission timeframe, where the performance should be anyway loaded into redemption's cache, in order to properly return "too early / too late" validation errors]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Record last modification date/time]]></comment>
			</column>
			<column name="StopBookingWindowMinutes" type="smallint" jt="5" >
				<comment><![CDATA[Users can select performances only within this many minutes from their start time]]></comment>
			</column>
			<column name="CapacityThresholdDeltaMins" type="smallint" jt="5" >
				<comment><![CDATA[Threshold delta minutes]]></comment>
			</column>
			<index name="UQ_Event_EventCode" unique="UNIQUE_KEY" >
				<column name="EventCode" options="ASC" />
			</index>
			<index name="IX_Event_AccountId" unique="NORMAL" options="where AccountId is not null" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="IX_Event_CategoryId" unique="NORMAL" >
				<column name="CategoryId" options="ASC" />
			</index>
			<index name="IX_Event_ProducerAccountId" unique="NORMAL" options="where ProducerAccountId is not null" >
				<column name="ProducerAccountId" options="ASC" />
			</index>
			<index name="IX_Event_LocationAccountId" unique="NORMAL" options="where LocationAccountId is not null" >
				<column name="LocationAccountId" options="ASC" />
			</index>
			<index name="IX_Event_AccessAreaAccountId" unique="NORMAL" options="where AccessAreaAccountId is not null" >
				<column name="AccessAreaAccountId" options="ASC" />
			</index>
			<index name="IX_Event_CalendarId" unique="NORMAL" options="where CalendarId is not null" >
				<column name="CalendarId" options="ASC" />
			</index>
			<index name="IX_Event_LastPerfAutoCreate" unique="NORMAL" >
				<column name="EventType" options="ASC" />
				<column name="LastPerfAutoCreate" options="ASC" />
			</index>
			<index name="IX_Event_CrossPlatformId" unique="NORMAL" options="where CrossPlatformId is not null" >
				<column name="CrossPlatformId" options="ASC" />
			</index>
			<index name="PK_Event" unique="PRIMARY_KEY" >
				<column name="EventId" />
			</index>
			<index name="IX_Event_UncountCalendarId" unique="NORMAL" >
				<column name="UncountCalendarId" />
			</index>
			<index name="IX_Event_WaiverDocTemplateId" unique="NORMAL" options="WHERE WaiverDocTemplateId IS NOT NULL" >
				<column name="WaiverDocTemplateId" />
			</index>
			<fk name="FK_Event_ProducerAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="ProducerAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Event_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Event_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Event_AcAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccessAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Event_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
			<fk name="FK_Event_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_Event_AccountCrossPlatform" to_schema="SnApp.dbo" to_table="tbAccountCrossPlatform" >
				<fk_column name="CrossPlatformId" pk="AccountId" />
			</fk>
			<fk name="FK_Event_UncountCalendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="UncountCalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_Event_WaiverDocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="WaiverDocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbEvent2ResourceType" prior="Tbl" >
			<comment><![CDATA[Resource types related to the event]]></comment>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to event internal ID]]></comment>
			</column>
			<column name="ResourceTypeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to resource type internal ID]]></comment>
			</column>
			<index name="PK_Event2ResourceType" unique="PRIMARY_KEY" >
				<column name="EventId" />
				<column name="ResourceTypeId" />
			</index>
			<index name="IX_Event2ResourceType_ResourceTypeId" unique="NORMAL" >
				<column name="ResourceTypeId" />
			</index>
			<fk name="FK_Event2ResourceType_EventId" to_schema="SnApp.dbo" to_table="tbEvent" delete_action="cascade" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
			<fk name="FK_Event2ResourceType_ResourceTypeId" to_schema="SnApp.dbo" to_table="tbResourceType" >
				<fk_column name="ResourceTypeId" pk="ResourceTypeId" />
			</fk>
		</table>
		<table name="tbEventCapacityThreshold" prior="Tbl" >
			<comment><![CDATA[Master configuration table to manage auto-reallocation of limited capacity categories and envelopes]]></comment>
			<column name="EventCapacityThresholdId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Unique identifier]]></comment>
			</column>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to event]]></comment>
			</column>
			<column name="ThresholdValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135] Absolute, Percentage]]></comment>
			</column>
			<column name="ThresholdValue" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Value of the threshold (absolute or percentage)]]></comment>
			</column>
			<column name="ThresholdDefault" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates wheter the threshold is the default]]></comment>
			</column>
			<index name="PK_EventCapacityThreshold" unique="PRIMARY_KEY" >
				<column name="EventCapacityThresholdId" />
			</index>
			<index name="IX_EventCapacityThreshold_EventId" unique="NORMAL" >
				<column name="EventId" />
				<column name="ThresholdValue" />
			</index>
			<fk name="FK_EventCapacityThreshold_Event" to_schema="SnApp.dbo" to_table="tbEvent" delete_action="cascade" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
		</table>
		<table name="tbEventCapacityThresholdDetail" prior="Tbl" >
			<comment><![CDATA[Details configuration table to manage auto-reallocation of limited capacity categories and envelopes]]></comment>
			<column name="EventCapacityThresholdId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the attribute item]]></comment>
			</column>
			<column name="SeatEnvelopeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the seat envelope]]></comment>
			</column>
			<column name="ValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135] Absolute, Percentage]]></comment>
			</column>
			<column name="Value" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Value to be allocated to the category and envelope (absolute or percentage)]]></comment>
			</column>
			<index name="PFK_EventCapacityThresholdDetail" unique="PRIMARY_KEY" >
				<column name="EventCapacityThresholdId" />
				<column name="AttributeItemId" />
				<column name="SeatEnvelopeId" />
			</index>
			<index name="IX_EventCapacityThresholdDetail_AttributeItemId" unique="NORMAL" >
				<column name="AttributeItemId" />
			</index>
			<index name="IX_EventCapacityThresholdDetail_SeatEnvelopeId" unique="NORMAL" >
				<column name="SeatEnvelopeId" />
			</index>
			<fk name="FK_EventCapacityThresholdDetail_EventCapacityThreshold" to_schema="SnApp.dbo" to_table="tbEventCapacityThreshold" delete_action="cascade" >
				<fk_column name="EventCapacityThresholdId" pk="EventCapacityThresholdId" />
			</fk>
			<fk name="FK_EventCapacityThresholdDetail_AttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="AttributeItemId" pk="AttributeItemId" />
			</fk>
			<fk name="FK_EventCapacityThresholdDetail_SeatEnvelope" to_schema="SnApp.dbo" to_table="tbSeatEnvelope" >
				<fk_column name="SeatEnvelopeId" pk="SeatEnvelopeId" />
			</fk>
		</table>
		<table name="tbEventCategory" >
			<column name="EventCategoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LicenseId" type="smallint" jt="5" mandatory="y" />
			<column name="EventCategoryType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[180]]]></comment>
			</column>
			<column name="EventCategoryCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="EventCategoryName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="UQ_EventCategory_Code" unique="UNIQUE_KEY" >
				<column name="LicenseId" options="ASC" />
				<column name="EventCategoryCode" options="ASC" />
			</index>
			<index name="PK_EventCategory" unique="PRIMARY_KEY" >
				<column name="EventCategoryId" />
			</index>
			<fk name="FK_EventCategory_License" to_schema="SnApp.dbo" to_table="tbLicense" >
				<fk_column name="LicenseId" pk="LicenseId" />
			</fk>
		</table>
		<table name="tbEventCategoryLink" >
			<column name="EventCategoryLinkId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EventCategoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_EventCategoryLink_EventCategoryId" unique="NORMAL" >
				<column name="EventCategoryId" options="ASC" />
			</index>
			<index name="IX_EventCategoryLink_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_EventCategoryLink" unique="PRIMARY_KEY" >
				<column name="EventCategoryLinkId" />
			</index>
			<fk name="FK_EventCategoryLink_EventCategory" to_schema="SnApp.dbo" to_table="tbEventCategory" delete_action="cascade" >
				<fk_column name="EventCategoryId" pk="EventCategoryId" />
			</fk>
		</table>
		<table name="tbEventDynRateCode" prior="tbEventDyn" >
			<comment><![CDATA[Configuration for dynamic rate code assignment (dynamic pricing)]]></comment>
			<column name="EventDynRateCodeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the event owning this rule]]></comment>
			</column>
			<column name="PerformanceTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the performance type on which this rule applies.
Null value means DEFAULT performance type.]]></comment>
			</column>
			<column name="SeatCategoryId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the seat category on which this rull applies.
Null means ANY category]]></comment>
			</column>
			<column name="RateCodeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the rate code to be used when this rule applies]]></comment>
			</column>
			<column name="Value" prior="Availability" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[When the performance availability goes beyond what's speficied in this field, the rule is applied.
It could express SOLD or AVAILABLE quantities. Field tbEvent.DynRateCodeType tells which one.
It could express absolute or percentetage values. Field tbEvent.DynRateCodeValueType tells which one]]></comment>
			</column>
			<index name="PK_EventDynRateCode" unique="PRIMARY_KEY" >
				<column name="EventDynRateCodeId" />
			</index>
			<index name="IX_EventDynRateCode_EventId" unique="NORMAL" >
				<column name="EventId" />
			</index>
			<index name="IX_EventDynRateCode_PerformanceTypeId" unique="NORMAL" >
				<column name="PerformanceTypeId" />
			</index>
			<index name="IX_EventDynRateCode_SeatCategoryId" unique="NORMAL" >
				<column name="SeatCategoryId" />
			</index>
			<index name="IX_EventDynRateCode_RateCodeId" unique="NORMAL" >
				<column name="RateCodeId" />
			</index>
			<fk name="FK_EventDynRateCode_Event" to_schema="SnApp.dbo" to_table="tbEvent" delete_action="cascade" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
			<fk name="FK_EventDynRateCode_PerformanceType" to_schema="SnApp.dbo" to_table="tbPerformanceType" >
				<fk_column name="PerformanceTypeId" pk="PerformanceTypeId" />
			</fk>
			<fk name="FK_EventDynRateCode_SeatCategoryAttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="SeatCategoryId" pk="AttributeItemId" />
			</fk>
			<fk name="FK_EventDynRateCode_RateCode" to_schema="SnApp.dbo" to_table="tbRateCode" >
				<fk_column name="RateCodeId" pk="RateCodeId" />
			</fk>
		</table>
		<table name="tbEventDynSaleChannel" prior="tbRateCode2SaleChannel" >
			<comment><![CDATA[Sale channels for which dynamic pricing is applicable for the event]]></comment>
			<column name="EventDynSaleChannelId" prior="RateCode2SaleChannelId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="EventId" prior="RateCodeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the event]]></comment>
			</column>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the sale channel]]></comment>
			</column>
			<index name="PK_EventDynSaleChannel" unique="PRIMARY_KEY" >
				<column name="EventDynSaleChannelId" />
			</index>
			<index name="UQ_EventDynSaleChannel_EventId_SaleChannelId" unique="NORMAL" >
				<column name="EventId" />
				<column name="SaleChannelId" />
			</index>
			<index name="IX_EventDynSaleChannel_SaleChannelId" unique="NORMAL" >
				<column name="SaleChannelId" />
			</index>
			<fk name="FK_EventDynSaleChannel_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_EventDynSaleChannel_Event" to_schema="SnApp.dbo" to_table="tbEvent" delete_action="cascade" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
		</table>
		<table name="tbEventFlag" >
			<comment><![CDATA[Holds configure optional flags for events]]></comment>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to event]]></comment>
			</column>
			<column name="EventFlag" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[383]]]></comment>
			</column>
			<index name="PK_EventFlag" unique="PRIMARY_KEY" >
				<column name="EventId" />
				<column name="EventFlag" />
			</index>
			<fk name="FK_EventFlag_Event" to_schema="SnApp.dbo" to_table="tbEvent" delete_action="cascade" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
		</table>
		<table name="tbEventItinerary" >
			<column name="EventItineraryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ChildEventId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_EventItinerary_EventId" unique="NORMAL" >
				<column name="EventId" options="ASC" />
				<column name="PriorityOrder" options="ASC" />
			</index>
			<index name="IX_EventItinerary_ChildEventId" unique="NORMAL" >
				<column name="ChildEventId" options="ASC" />
			</index>
			<index name="PK_EventItinerary" unique="PRIMARY_KEY" >
				<column name="EventItineraryId" />
			</index>
			<fk name="FK_EventCategoryLink_Event" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
			<fk name="FK_EventCategoryLink_ChildEvent" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="ChildEventId" pk="EventId" />
			</fk>
		</table>
		<table name="tbExtMediaBatch" >
			<column name="ExtMediaBatchId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Batch identification]]></comment>
			</column>
			<column name="ExtMediaBatchCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Imported file name(no file extention)]]></comment>
			</column>
			<column name="ExtMediaBatchStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[400]]]></comment>
			</column>
			<column name="ExtMediaBatchAnomaly" type="smallint" jt="5" >
				<comment><![CDATA[LK[401]]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Refers to the partner (organization) who produced the ext. codes]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[the id of the server who ran the batch import]]></comment>
			</column>
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[File rows count]]></comment>
			</column>
			<column name="ExtMediaBatchCodeExt1" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[imported order id]]></comment>
			</column>
			<column name="ExtMediaBatchCodeExt2" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[External reference]]></comment>
			</column>
			<column name="ImportFileName" type="varchar" length="250" decimal="0" jt="12" >
				<comment><![CDATA[Imported file name]]></comment>
			</column>
			<column name="ImportFile" type="varbinary(max)" jt="-3" >
				<comment><![CDATA[Imported file content]]></comment>
			</column>
			<index name="UQ_ExtMediaBatch_AccountId_BatchCode" unique="UNIQUE_KEY" >
				<column name="AccountId" options="ASC" />
				<column name="ExtMediaBatchCode" options="ASC" />
			</index>
			<index name="IX_ExtMediaBatch_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
			</index>
			<index name="IX_ExtMediaBatch_ExtMediaBatchCodeExt1" unique="NORMAL" >
				<column name="ExtMediaBatchCodeExt1" options="ASC" />
			</index>
			<index name="IX_ExtMediaBatch_ExtMediaBatchCodeExt2" unique="NORMAL" >
				<column name="ExtMediaBatchCodeExt2" options="ASC" />
			</index>
			<index name="PK_ExtMediaBatch" unique="PRIMARY_KEY" >
				<column name="ExtMediaBatchId" />
			</index>
			<fk name="FK_ExtMediaBatch_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ExtMediaBatch_Server" to_schema="SnApp.dbo" to_table="tbServer" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbExtMediaBatchDetail" >
			<column name="ExtMediaBatchDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[detail id]]></comment>
			</column>
			<column name="ExtMediaBatchId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ExtMediaBatch]]></comment>
			</column>
			<column name="ExtProductCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[product code]]></comment>
			</column>
			<column name="ExtProductName" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[product name]]></comment>
			</column>
			<column name="ExtProductPrice" type="money" length="0" jt="3" >
				<comment><![CDATA[product price]]></comment>
			</column>
			<column name="ExtMediaCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[External media code]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" />
			<column name="ValidDateTo" type="date" jt="91" />
			<index name="IX_ExtMediaBatchDetail_ExtMediaBatchId" unique="NORMAL" >
				<column name="ExtMediaBatchId" options="ASC" />
			</index>
			<index name="IX_ExtMediaBatchDetail_ExtProductCode" unique="NORMAL" >
				<column name="ExtProductCode" options="ASC" />
			</index>
			<index name="PK_ExtMediaBatchDetail" unique="PRIMARY_KEY" >
				<column name="ExtMediaBatchDetailId" />
			</index>
			<fk name="FK_ExtMediaBatchDetail_ExtMediaMatch" to_schema="SnApp.dbo" to_table="tbExtMediaBatch" delete_action="cascade" >
				<fk_column name="ExtMediaBatchId" pk="ExtMediaBatchId" />
			</fk>
		</table>
		<table name="tbExtMediaCode" >
			<comment><![CDATA[Sometimes the system is used to sell third party tickets. Partners provide imports of barcodes to be used by our system, that will be recognized by their system.]]></comment>
			<column name="ExtMediaCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Refers to the partner (organization) who produced the ext. codes]]></comment>
			</column>
			<column name="ExtMediaGroupId" type="uniqueidentifier" jt="1" />
			<column name="ImportDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="PerformanceDate" type="date" jt="91" >
				<comment><![CDATA[For dated tickets]]></comment>
			</column>
			<column name="MediaId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Media where the code has been "burned" on]]></comment>
			</column>
			<column name="EncodeFiscalDate" type="date" jt="91" >
				<comment><![CDATA[Redund value for tbMedia.EncodeFiscalDate]]></comment>
			</column>
			<column name="HoldWorkstationId" type="uniqueidentifier" jt="1" />
			<column name="HoldDateTime" type="smalldatetime" jt="93" />
			<column name="ExtMediaBatchId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to ExtBacth where media code is coming from]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" />
			<column name="ValidDateTo" type="date" jt="91" />
			<column name="ExtProductTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[reference to productType]]></comment>
			</column>
			<column name="IndividualCouponId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Individual coupon where the code has been "burned" on]]></comment>
			</column>
			<index name="IX_ExtMediaCode_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
				<column name="ImportDateTime" options="ASC" />
			</index>
			<index name="IX_ExtMediaCode_MediaId" unique="NORMAL" options="where MediaId is not null" >
				<column name="MediaId" options="ASC" />
			</index>
			<index name="IX_ExtMediaCode_EncodeFiscalDate" unique="NORMAL" >
				<column name="EncodeFiscalDate" options="ASC" />
			</index>
			<index name="IX_ExtMediaCode_ExtMediaGroupId" unique="NORMAL" options="where ExtMediaBatchId is not null" >
				<column name="ExtMediaGroupId" options="ASC" />
			</index>
			<index name="IX_ExtMediaCode_ExtMediaBatchId" unique="NORMAL" >
				<column name="ExtMediaBatchId" options="ASC" />
			</index>
			<index name="IX_ExtMediaCode_ExtProductType" unique="NORMAL" >
				<column name="ExtProductTypeId" options="ASC" />
			</index>
			<index name="PK_ExtMediaCode" unique="PRIMARY_KEY" >
				<column name="ExtMediaCode" />
			</index>
			<index name="IX_ExtMediaCode_IndividualCouponId" unique="NORMAL" options="where IndividualCouponId is not null" >
				<column name="IndividualCouponId" />
			</index>
			<index name="IX_ExtMediaCode_HoldDateTime" unique="NORMAL" options="include (HoldWorkstationId)" >
				<column name="HoldDateTime" options="ASC " />
			</index>
			<fk name="FK_ExtMediaCode_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ExtMediaCode_Media" to_schema="SnApp.dbo" to_table="tbMedia" delete_action="cascade" >
				<fk_column name="MediaId" pk="MediaId" />
			</fk>
			<fk name="FK_ExtMediaCode_ExtMediaBatch" to_schema="SnApp.dbo" to_table="tbExtMediaBatch" delete_action="cascade" >
				<fk_column name="ExtMediaBatchId" pk="ExtMediaBatchId" />
			</fk>
			<fk name="FK_ExtMediaCode_ExtMediaGroup" to_schema="SnApp.dbo" to_table="tbExtMediaGroup" >
				<fk_column name="ExtMediaGroupId" pk="ExtMediaGroupId" />
			</fk>
			<fk name="FK_ExtMediaCode_ExtProductType" to_schema="SnApp.dbo" to_table="tbExtProductType" >
				<fk_column name="ExtProductTypeId" pk="ExtProductTypeId" />
			</fk>
			<fk name="FK_ExtMediaCode_IndividualCouponId" to_schema="SnApp.dbo" to_table="tbIndividualCoupon" delete_action="cascade" >
				<fk_column name="IndividualCouponId" pk="IndividualCouponId" />
			</fk>
		</table>
		<table name="tbExtMediaGroup" >
			<column name="ExtMediaGroupId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ExtMediaGroupCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="ExtMediaGroupName" type="nvarchar" length="100" jt="12" />
			<column name="NotifyQuantityLow" type="int" length="1" decimal="0" jt="4" />
			<column name="NotifyQuantityCritical" type="int" length="1" decimal="0" jt="4" />
			<column name="NotifyExpirationDays" type="smallint" length="1" decimal="0" jt="5" />
			<index name="UQ_ExtMediaGroup_ExtMediaGroupCode" unique="UNIQUE_KEY" >
				<column name="ExtMediaGroupCode" options="ASC" />
			</index>
			<index name="PK_ExtMediaGroup" unique="PRIMARY_KEY" >
				<column name="ExtMediaGroupId" />
			</index>
		</table>
		<table name="tbExtProductType" >
			<column name="ExtProductTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Refers to the partner (organization) who produced the ext. product]]></comment>
			</column>
			<column name="ExtProductCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="ExtProductName" type="nvarchar" length="50" jt="12" />
			<column name="ExtProductPrice" type="money" length="0" jt="3" />
			<column name="ExtMediaGroupId" type="uniqueidentifier" jt="1" />
			<index name="IX_ExtProductType_ExtMediaGroupId" unique="NORMAL" options="where ExtMediaGroupId is not null" >
				<column name="ExtMediaGroupId" options="ASC" />
			</index>
			<index name="UQ_ExtProductType_AccountId_ExtProductCode" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
				<column name="ExtProductCode" options="ASC" />
			</index>
			<index name="PK_ExtProductType" unique="PRIMARY_KEY" >
				<column name="ExtProductTypeId" />
			</index>
			<fk name="FK_ExtProductType_ExtMediaGroup" to_schema="SnApp.dbo" to_table="tbExtMediaGroup" >
				<fk_column name="ExtMediaGroupId" pk="ExtMediaGroupId" />
			</fk>
		</table>
		<table name="tbExtProductTypeLog" >
			<column name="ExtProductTypeLogId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ExtProductTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ExtProductTypeLogType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[409]]]></comment>
			</column>
			<column name="DateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<index name="IX_ExtProductTypeLog_ExtProductTypeId" unique="NORMAL" >
				<column name="ExtProductTypeId" options="ASC" />
			</index>
			<index name="PK_ExtProductTypeLog" unique="PRIMARY_KEY" >
				<column name="ExtProductTypeLogId" />
			</index>
			<fk name="FK_ExtProductTypeLog_ExtProductType" to_schema="SnApp.dbo" to_table="tbExtProductType" >
				<fk_column name="ExtProductTypeId" pk="ExtProductTypeId" />
			</fk>
		</table>
		<table name="tbExtProductTypeLogConsQueue" prior="tbLedgerConsQueue_0" >
			<column name="ExtProductTypeLogId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="ConsQueueStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[266]]]></comment>
			</column>
			<column name="QueueDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="StartDateTime" type="datetime" jt="92" />
			<column name="EndDateTime" type="datetime" jt="92" />
			<index name="IX_ExtProductTypeLogConsQueue_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="ConsQueueStatus" options="ASC" />
			</index>
			<index name="PK_ExtProductTypeLogConsQueue" unique="PRIMARY_KEY" >
				<column name="ExtProductTypeLogId" />
			</index>
			<index name="IX_ExtProductTypeLogConsQueue_ConsQueueStatus" unique="NORMAL" options="INCLUDE (ServerId)" >
				<column name="ConsQueueStatus" />
				<column name="QueueDateTime" />
			</index>
			<fk name="FK_ExtProductTypeLogConsQueue_ExtProductTypeLog" to_schema="SnApp.dbo" to_table="tbExtProductTypeLog" >
				<fk_column name="ExtProductTypeLogId" pk="ExtProductTypeLogId" />
			</fk>
		</table>
		<table name="tbExtensionPackage" >
			<column name="ExtensionPackageId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ExtensionPackageCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="ExtensionPackageName" type="nvarchar" length="100" jt="12" />
			<column name="ExtensionPackageVersion" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="ExtensionPackageStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[?]]]></comment>
			</column>
			<column name="IconName" type="varchar" length="50" jt="12" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="JarFile" type="varbinary(max)" jt="-3" mandatory="y" />
			<column name="InfoDoc" type="nvarchar(max)" jt="12" mandatory="y" />
			<column name="ConfigDoc" type="nvarchar(max)" jt="12" />
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" />
			<index name="UQ_EstensionPackage_Code" unique="UNIQUE_KEY" >
				<column name="ExtensionPackageCode" options="ASC" />
			</index>
			<index name="IX_ExtensionPackage_LastUpdate" unique="NORMAL" >
				<column name="LastUpdate" options="ASC" />
			</index>
			<index name="PK_ExtensionPackage" unique="PRIMARY_KEY" >
				<column name="ExtensionPackageId" />
			</index>
		</table>
		<table name="tbExtensionPackageStatus" >
			<column name="ExtensionPackageId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ExtensionPackageStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[240]]]></comment>
			</column>
			<column name="NeedRestart" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="IX_ExtensionPackageStatus_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
			</index>
			<index name="PK_ExtensionPackageStatus" unique="PRIMARY_KEY" >
				<column name="ExtensionPackageId" />
				<column name="ServerId" />
			</index>
			<fk name="FK_ExtensionPackageStatus_ExtensionPackage" to_schema="SnApp.dbo" to_table="tbExtensionPackage" delete_action="cascade" >
				<fk_column name="ExtensionPackageId" pk="ExtensionPackageId" />
			</fk>
		</table>
		<table name="tbFont" >
			<column name="FontId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="FontName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="FileName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="FontStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[297]]]></comment>
			</column>
			<column name="FontEncoding" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[298]]]></comment>
			</column>
			<column name="FontData" type="varbinary(max)" jt="-3" mandatory="y" />
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" />
			<index name="IX_Font_Name" unique="NORMAL" >
				<column name="FontName" options="ASC" />
			</index>
			<index name="IX_Font_PriorityOrder" unique="NORMAL" >
				<column name="PriorityOrder" options="ASC" />
			</index>
			<index name="PK_Font" unique="PRIMARY_KEY" >
				<column name="FontId" />
			</index>
		</table>
		<table name="tbFullText" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Word" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" />
			<column name="SearchWeight" type="tinyint" length="1" decimal="0" jt="-6" mandatory="y" />
			<index name="IX_FullText_EntitType_Word" unique="NORMAL" options="INCLUDE (SearchWeight)" >
				<column name="EntityType" options="ASC" />
				<column name="Word" options="ASC" />
			</index>
			<index name="PK_FullText" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="Word" />
			</index>
		</table>
		<table name="tbGateCategory" >
			<comment><![CDATA[Definition of gate categories]]></comment>
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="GateCategoryCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="GateCategoryName" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Gate category name]]></comment>
			</column>
			<index name="UQ_GateCategory_Code" unique="UNIQUE_KEY" >
				<column name="GateCategoryCode" options="ASC" />
			</index>
			<index name="PK_GateCategory" unique="PRIMARY_KEY" >
				<column name="GateCategoryId" />
			</index>
		</table>
		<table name="tbGateCategory2Entity" prior="tbGateCategory2Event" >
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to gate category]]></comment>
			</column>
			<column name="EntityId" prior="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to entity (Event, Product)]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="IX_Gatecategory2Event_EventId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_GateCategory2Event" unique="PRIMARY_KEY" >
				<column name="GateCategoryId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_GateCategory2Entity_GateCategory" to_schema="SnApp.dbo" to_table="tbGateCategory" >
				<fk_column name="GateCategoryId" pk="GateCategoryId" />
			</fk>
		</table>
		<table name="tbGrid" >
			<comment><![CDATA[Table used to store grid structure of the search results in BKO and POS based on entity types]]></comment>
			<column name="GridId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal Id]]></comment>
			</column>
			<column name="GridCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="GridName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Grid name]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="GridData" type="varchar(max)" length="0" decimal="0" jt="12" >
				<comment><![CDATA[Description grid's json]]></comment>
			</column>
			<index name="UQ_Grid_Code" unique="NORMAL" >
				<column name="GridCode" options="ASC" />
			</index>
			<index name="PK_Grid" unique="PRIMARY_KEY" >
				<column name="GridId" />
			</index>
		</table>
		<table name="tbHistoryDetail" >
			<comment><![CDATA[Keeps trace of the modifications made to an entity with detailed information]]></comment>
			<column name="HistoryLogDetailId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="HistoryLogId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="HistoryField" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[301] Used to vreate a description for the history field]]></comment>
			</column>
			<column name="HistorySubField" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Used to further identify an history field]]></comment>
			</column>
			<column name="HistorySubFieldType" type="smallint" jt="5" >
				<comment><![CDATA[LK(305) Used to identify the type of the history sub field]]></comment>
			</column>
			<column name="OldValue" type="nvarchar" length="100" decimal="0" jt="12" >
				<comment><![CDATA[The actual old value]]></comment>
			</column>
			<column name="NewValue" type="nvarchar" length="100" decimal="0" jt="12" >
				<comment><![CDATA[The actual new value]]></comment>
			</column>
			<column name="OldValueLong" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Used to store the old value if it is longer than 100 characters]]></comment>
			</column>
			<column name="NewValueLong" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Used to store the new value if it is longher than 100 characters]]></comment>
			</column>
			<column name="OldEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131] The old value could be a different entity type]]></comment>
			</column>
			<column name="OldEntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[ID of the old entity]]></comment>
			</column>
			<column name="NewEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131] The new value could be a different entity type]]></comment>
			</column>
			<column name="NewEntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[ID of the new entity]]></comment>
			</column>
			<index name="IX_HistoryDetail_OldEntityId" unique="NORMAL" options="where OldEntityId is not null" >
				<column name="OldEntityId" options="ASC" />
			</index>
			<index name="IX_HistoryDetail_NewEntityId" unique="NORMAL" options="where NewEntityId is not null" >
				<column name="NewEntityId" options="ASC" />
			</index>
			<index name="PK_HistoryDetail" unique="PRIMARY_KEY" >
				<column name="HistoryLogDetailId" />
			</index>
			<index name="IX_HistoryDetail_HistoryLogId" unique="NORMAL" >
				<column name="HistoryLogId" />
				<column name="HistoryField" />
				<column name="HistorySubField" />
			</index>
			<fk name="FK_HistoryDetail_HistoryLog" to_schema="SnApp.dbo" to_table="tbHistoryLog" delete_action="cascade" >
				<fk_column name="HistoryLogId" pk="HistoryLogId" />
			</fk>
		</table>
		<table name="tbHistoryLog" >
			<comment><![CDATA[Keeps trace of the modifications made to an entity]]></comment>
			<column name="HistoryLogId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[ID of the entity logged]]></comment>
			</column>
			<column name="LogDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date and time of the log]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131] Type of the entity logged]]></comment>
			</column>
			<column name="LogTimestamp" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date and time of the log (including milliseconds)]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[ID of the user that is making the changes to the enntity]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[ID of the workstation that is making the changes to the entity]]></comment>
			</column>
			<column name="HistoryLogType" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[210] Create, Last Update, Update, Delete]]></comment>
			</column>
			<column name="Notes" type="nvarchar(max)" length="1" decimal="0" jt="12" >
				<comment><![CDATA[Notes on the changes made]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[ID of the transaction that is making the changes]]></comment>
			</column>
			<column name="TransactionArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<column name="TransactionArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<column name="JobId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[ID of the job that made the changes]]></comment>
			</column>
			<index name="UQ_HistoryLog_EntityId_LogType" unique="UNIQUE_KEY" options="where HistoryLogType in (1,2) /*Create/LastUpdate*/" >
				<column name="EntityId" options="ASC" />
				<column name="HistoryLogType" options="ASC" />
			</index>
			<index name="IX_HistoryLog_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="LogDateTime" options="ASC" />
			</index>
			<index name="IX_HistoryLog_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
				<column name="LogDateTime" options="ASC" />
			</index>
			<index name="IX_HistoryLog_LogType_DateTime" unique="NORMAL" >
				<column name="HistoryLogType" options="ASC" />
				<column name="LogDateTime" options="ASC" />
			</index>
			<index name="IX_HistoryLog_DateTime" unique="NORMAL" >
				<column name="LogDateTime" options="ASC" />
			</index>
			<index name="IX_HistoryLog_EntityType" unique="NORMAL" >
				<column name="EntityType" options="ASC" />
				<column name="LogDateTime" options="ASC" />
			</index>
			<index name="IX_HistoryLog_TransactionId" unique="NORMAL" options="where TransactionId is not null" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="IX_HistoryLog_JobId" unique="NORMAL" options="where JobId is not null" >
				<column name="JobId" options="ASC" />
			</index>
			<index name="PK_HistoryLog" unique="PRIMARY_KEY" >
				<column name="HistoryLogId" />
			</index>
			<index name="IX_HistoryLog_EntityId" unique="NORMAL" >
				<column name="EntityId" />
				<column name="LogDateTime" />
			</index>
			<fk name="FK_HistoryLog_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_HistoryLog_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_HistoryLog_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_HistoryLog_Job" to_schema="SnApp.dbo" to_table="tbJob" >
				<fk_column name="JobId" pk="JobId" />
			</fk>
		</table>
		<table name="tbIndividualCoupon" >
			<column name="IndividualCouponId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="IndividualCouponCode" type="varchar" length="150" jt="12" mandatory="y" >
				<comment><![CDATA[Max length for media code is 32. But since when a media gets recycled, the media code becomes "mediacode#PNR" we leave some extra space in the table field.
03/11/2021 - Size increased to 150 cause it is now possible to create individual coupons with external codes (ex. QR codes)]]></comment>
			</column>
			<column name="IndividualCouponStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[269]]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Refers to promo rule]]></comment>
			</column>
			<column name="IssueTransactionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="IssueFiscalDate" type="date" jt="91" mandatory="y" />
			<column name="IssueDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="SettleTransactionId" type="uniqueidentifier" jt="1" />
			<column name="SettleFiscalDate" type="date" jt="91" />
			<column name="SettleDateTime" type="smalldatetime" jt="93" />
			<column name="ValidDateFrom" type="date" jt="91" />
			<column name="ValidDateTo" type="date" jt="91" />
			<column name="CampaignCode" type="varchar" length="15" jt="12" />
			<column name="AccountId" type="uniqueidentifier" jt="1" />
			<column name="MembershipPlanProductId" type="uniqueidentifier" jt="1" />
			<index name="UQ_IndividualCoupon_Code" unique="UNIQUE_KEY" >
				<column name="IndividualCouponCode" options="ASC" />
			</index>
			<index name="IX_IndividualCoupon_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
				<column name="IssueDateTime" options="ASC" />
			</index>
			<index name="IX_IndividualCoupon_IssueTransactionId" unique="NORMAL" >
				<column name="IssueTransactionId" options="ASC" />
				<column name="IssueDateTime" options="ASC" />
			</index>
			<index name="IX_IndividualCoupon_SettleTransactionId" unique="NORMAL" options="where SettleTransactionId is not null" >
				<column name="SettleTransactionId" options="ASC" />
				<column name="SettleDateTime" options="ASC" />
			</index>
			<index name="IX_IndividualCoupon_AccountId" unique="NORMAL" options="where AccountId is not null" >
				<column name="AccountId" options="ASC" />
				<column name="IssueDateTime" options="ASC" />
			</index>
			<index name="IX_IndividualCoupon_IssueFiscalDate" unique="NORMAL" >
				<column name="IssueFiscalDate" options="ASC" />
				<column name="IssueDateTime" options="ASC" />
			</index>
			<index name="IX_IndividualCoupon_SettleFiscalDate" unique="NORMAL" options="where SettleFiscalDate is not null" >
				<column name="SettleFiscalDate" options="ASC" />
				<column name="SettleDateTime" options="ASC" />
			</index>
			<index name="IX_IndividualCoupon_CampaignCode" unique="NORMAL" options="where CampaignCode is not null" >
				<column name="CampaignCode" options="ASC" />
				<column name="IssueDateTime" options="ASC" />
			</index>
			<index name="PK_IndividualCoupon" unique="PRIMARY_KEY" >
				<column name="IndividualCouponId" />
			</index>
			<index name="IX_IndividualCoupon_MembershipPlanProductId" unique="NORMAL" options="WHERE MembershipPlanProductId IS NOT NULL" >
				<column name="MembershipPlanProductId" options="ASC" />
				<column name="IssueFiscalDate" options="ASC" />
			</index>
			<fk name="FK_IndividualCoupon_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_IndividualCoupon_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_IndividualCoupon_IssueTransaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="IssueTransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_IndividualCoupon_SettleTransaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="SettleTransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_IndividualCoupon_MembershipPlan" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="setNull" >
				<fk_column name="MembershipPlanProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbInstallmentContract" >
			<comment><![CDATA[Holds information about each installment contract issued.
"plan" is a template, "contract" is the instance issued]]></comment>
			<column name="InstallmentContractId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="InstallmentContractCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible numerical system generated code]]></comment>
			</column>
			<column name="InstallmentPlanId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to installment plan]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the payor account]]></comment>
			</column>
			<column name="InstallmentContractStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[216]]]></comment>
			</column>
			<column name="CreateFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Contract issue fiscal date]]></comment>
			</column>
			<column name="CreateDateTime" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Contract issue date/time]]></comment>
			</column>
			<column name="TotalAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Total value of the contract, including downpayment and fees]]></comment>
			</column>
			<column name="FeeAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Fees total amount  applied to the contract]]></comment>
			</column>
			<column name="FinancedAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Total financed amount]]></comment>
			</column>
			<column name="SettledAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Total settled amount]]></comment>
			</column>
			<column name="IssueTransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the transaction where the contract was issued]]></comment>
			</column>
			<column name="BlockDate" type="date" jt="91" >
				<comment><![CDATA[If a contract gets blocked, here we save the date when happened]]></comment>
			</column>
			<column name="PaymentTokenId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the payment-token to be used for future charges]]></comment>
			</column>
			<column name="ExportedDateTime" type="datetime" jt="92" >
				<comment><![CDATA[If valorized means that the contract has been exported to third-party systems (for example ALTA)]]></comment>
			</column>
			<column name="TestPaymentId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the credit card used ti pre-authorize installment]]></comment>
			</column>
			<column name="RenewFromInstallmentContractId" prior="ExpirationDate" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the contract that is renewed by the current record]]></comment>
			</column>
			<column name="InstallmentContractVersion" type="bigint" jt="-5" >
				<comment><![CDATA[Autoinc field updated everytime the entity (in this specific record or any dependant) is modified. To be used for differential reports]]></comment>
			</column>
			<column name="InstallmentContractSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number generate on creation starting from 1]]></comment>
			</column>
			<column name="InstallmentContractSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with InstallmentContractSequence to create encrypted barcodes]]></comment>
			</column>
			<column name="ArchivedTickets" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[One or more tickets linked to this contracthave been archived and purged from production DB]]></comment>
			</column>
			<index name="UQ_InstallmentContract_InstallmentContractCode" unique="UNIQUE_KEY" >
				<column name="InstallmentContractCode" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_InstallmentPlanId" unique="NORMAL" >
				<column name="InstallmentPlanId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_BlockDate" unique="NORMAL" options="where BlockDate is not null" >
				<column name="BlockDate" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_CreateFiscalDate" unique="NORMAL" >
				<column name="CreateFiscalDate" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_CreateDateTime" unique="NORMAL" >
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_InstallmentContractStatus" unique="NORMAL" >
				<column name="InstallmentContractStatus" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_IssueTransactionId" unique="NORMAL" >
				<column name="IssueTransactionId" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_PaymentTokenId" unique="NORMAL" options="where PaymentTokenId is not null" >
				<column name="PaymentTokenId" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_ToBeExported" unique="NORMAL" options="where&#10;  ExportedDateTime is null" >
				<column name="ExportedDateTime" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_InstallmentContract_TestPaymentId" unique="NORMAL" options="where TestPaymentId is not null" >
				<column name="TestPaymentId" options="ASC" />
			</index>
			<index name="PK_InstallmentContract" unique="PRIMARY_KEY" >
				<column name="InstallmentContractId" />
			</index>
			<index name="IX_InstallmentContract_RenewFromInstallmentContractId" unique="NORMAL" options="where RenewFromInstallmentContractId is not null" >
				<column name="RenewFromInstallmentContractId" />
			</index>
			<index name="UQ_InstallmentContract_InstallmentContractSequence" unique="UNIQUE_INDEX" options="WHERE InstallmentContractSequence&lt;&gt;0 INCLUDE InstallmentContractSeed" >
				<column name="InstallmentContractSequence" />
			</index>
			<index name="UQ_InstallmentContract_InstallmentContractVersion" unique="NORMAL" options="where InstallmentContractVersion&lt;&gt;0" >
				<column name="InstallmentContractVersion" />
			</index>
			<fk name="FK_InstallmentContract_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_InstallmentContract_IssueTransaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="IssueTransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_InstallmentContract_PaymentCard" to_schema="SnApp.dbo" to_table="tbPaymentCard" >
				<fk_column name="TestPaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_InstallmentContract_InstallmentPlan" to_schema="SnApp.dbo" to_table="tbInstallmentPlan" >
				<fk_column name="InstallmentPlanId" pk="InstallmentPlanId" />
			</fk>
			<fk name="FK_InstallmentContract_PaymentToken" to_schema="SnApp.dbo" to_table="tbPaymentToken" >
				<fk_column name="PaymentTokenId" pk="PaymentTokenId" />
			</fk>
			<fk name="FK_InstallmentContract_RenewFromInstallmentContract" to_schema="SnApp.dbo" to_table="tbInstallmentContract" >
				<fk_column name="RenewFromInstallmentContractId" pk="InstallmentContractId" />
			</fk>
		</table>
		<table name="tbInstallmentContract2Ticket" >
			<comment><![CDATA[List the products belenging to an installment contract]]></comment>
			<column name="InstallmentContractId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the installment contract]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product]]></comment>
			</column>
			<index name="UQ_InstallmentContract2Ticket_TicketId" unique="UNIQUE_KEY" >
				<column name="TicketId" options="ASC" />
			</index>
			<index name="PK_InstallmentContract2Ticket" unique="PRIMARY_KEY" >
				<column name="InstallmentContractId" />
				<column name="TicketId" />
			</index>
			<fk name="FK_InstallmentContract2Ticket_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_InstallmentContract2Ticket_InstallmentContract" to_schema="SnApp.dbo" to_table="tbInstallmentContract" delete_action="cascade" >
				<fk_column name="InstallmentContractId" pk="InstallmentContractId" />
			</fk>
		</table>
		<table name="tbInstallmentContractDetail" >
			<comment><![CDATA[List of the scheduled payments for an installment contract]]></comment>
			<column name="InstallmentContractId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the installment contract]]></comment>
			</column>
			<column name="InstallmentNumber" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Scheduled payment number (1 to N relative to the contract)]]></comment>
			</column>
			<column name="ScheduledDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Scheduled payment date (won't change)]]></comment>
			</column>
			<column name="NextAttemptDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Scheduled payment date (will change if card charge fails)]]></comment>
			</column>
			<column name="AttemptCount" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Number of charge attempts already made]]></comment>
			</column>
			<column name="InstallmentAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount (to be) charged]]></comment>
			</column>
			<column name="InstallmentStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[217]]]></comment>
			</column>
			<column name="SettleTransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[If the card charge when fine, reference to the trasaction which made the charge]]></comment>
			</column>
			<column name="SettleDate" type="date" jt="91" >
				<comment><![CDATA[Redund SettleTransactionId's fiscal date]]></comment>
			</column>
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[False when charge should not be tried any more]]></comment>
			</column>
			<column name="PaymentTokenId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the payment-token used to settle this charge]]></comment>
			</column>
			<index name="IX_InstallmentContractDetail_SettleTransactionId" unique="NORMAL" >
				<column name="SettleTransactionId" options="ASC" />
			</index>
			<index name="IX_InstallmentContractDetail_Active" unique="NORMAL" options="where Active&lt;&gt;0" >
				<column name="Active" options="ASC" />
				<column name="NextAttemptDate" options="ASC" />
				<column name="InstallmentNumber" options="ASC" />
			</index>
			<index name="IX_InstallmentContractDetail_PaymentTokenId" unique="NORMAL" options="where PaymentTokenId is not null" >
				<column name="PaymentTokenId" options="ASC" />
			</index>
			<index name="PK_InstallmentContractDetail" unique="PRIMARY_KEY" >
				<column name="InstallmentContractId" />
				<column name="InstallmentNumber" />
			</index>
			<fk name="FK_InstallmentContractDetail_InstallmentContract" to_schema="SnApp.dbo" to_table="tbInstallmentContract" delete_action="cascade" >
				<fk_column name="InstallmentContractId" pk="InstallmentContractId" />
			</fk>
			<fk name="FK_InstallmentContractDetail_PaymentToken" to_schema="SnApp.dbo" to_table="tbPaymentToken" >
				<fk_column name="PaymentTokenId" pk="PaymentTokenId" />
			</fk>
		</table>
		<table name="tbInstallmentContractItem" >
			<column name="InstallmentContractItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="InstallmentContractId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Referrence to the installment contract]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="PerformanceSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the performance set]]></comment>
			</column>
			<column name="OptionSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Set of dynamic options selected for this item]]></comment>
			</column>
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Total quantity of product types]]></comment>
			</column>
			<column name="UnitAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount for single item (incl. taxes)]]></comment>
			</column>
			<column name="UnitTax" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Tax portion of UnitaAmount for single item]]></comment>
			</column>
			<index name="IX_InstallmentContractItem_InstallmentContractId" unique="NORMAL" >
				<column name="InstallmentContractId" options="ASC" />
			</index>
			<index name="IX_InstallmentContractItem_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_InstallmentContractItem_PerformanceSetId" unique="NORMAL" options="where PerformanceSetId is not null" >
				<column name="PerformanceSetId" options="ASC" />
			</index>
			<index name="IX_InstallmentContractItem_OptionSetId" unique="NORMAL" options="where OptionSetId is not null" >
				<column name="OptionSetId" options="ASC" />
			</index>
			<index name="PK_InstallmentContractItem" unique="PRIMARY_KEY" >
				<column name="InstallmentContractItemId" />
			</index>
			<fk name="FK_InstallmentContractItem_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_InstallmentContractItem_PerformanceSet" to_schema="SnApp.dbo" to_table="tbPerformanceSet" >
				<fk_column name="PerformanceSetId" pk="PerformanceSetId" />
			</fk>
			<fk name="FK_InstallmentContractItem_OptionSet" to_schema="SnApp.dbo" to_table="tbOptionSet" >
				<fk_column name="OptionSetId" pk="OptionSetId" />
			</fk>
			<fk name="FK_InstallmentContractItem_InstallmentContract" to_schema="SnApp.dbo" to_table="tbInstallmentContract" delete_action="cascade" >
				<fk_column name="InstallmentContractId" pk="InstallmentContractId" />
			</fk>
		</table>
		<table name="tbInstallmentContractItemDetail" >
			<column name="InstallmentContractItemDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Detail internal ID]]></comment>
			</column>
			<column name="InstallmentContractItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the installment contract item]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the ticket account]]></comment>
			</column>
			<index name="IX_InstallmentContractItemDetail_InstallmentContractItemId" unique="NORMAL" >
				<column name="InstallmentContractItemId" options="ASC" />
			</index>
			<index name="IX_InstallmentContractItemDetail_AccountId" unique="NORMAL" options="where AccountId is not null" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="PK_InstallmentContractItemDetail" unique="PRIMARY_KEY" >
				<column name="InstallmentContractItemDetailId" />
			</index>
			<fk name="FK_InstallmentContractItemDetail_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_InstallmentContractItemDetail_InstallmentContractItem" to_schema="SnApp.dbo" to_table="tbInstallmentContractItem" delete_action="cascade" >
				<fk_column name="InstallmentContractItemId" pk="InstallmentContractItemId" />
			</fk>
		</table>
		<table name="tbInstallmentContractTrigger" prior="tbInstall" >
			<comment><![CDATA[Stores planner trigger dates (renewal, renewal notice, ect...) for each installment contract]]></comment>
			<column name="InstallmentContractTriggerId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="InstallmentContractId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to installment contract]]></comment>
			</column>
			<column name="InstallmentContractTriggerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[463] renewal, renewal notice, etc...]]></comment>
			</column>
			<column name="ScheduledDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Date scheduled for the trigger to happen]]></comment>
			</column>
			<column name="TriggerDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/Time about when the event is triggered]]></comment>
			</column>
			<index name="PK_InstallmentContractTrigger" unique="PRIMARY_KEY" >
				<column name="InstallmentContractTriggerId" />
			</index>
			<index name="IX_InstallmentContractTrigger_InstallmentContractId" unique="NORMAL" >
				<column name="InstallmentContractId" />
				<column name="ScheduledDate" />
			</index>
			<index name="IX_InstallmentContractTrigger_ScheduledDate" unique="NORMAL" options="where TriggerDateTime is null" >
				<column name="ScheduledDate" />
				<column name="TriggerDateTime" />
			</index>
			<fk name="FK_InstallmentContractTrigger_InstallmentContract" to_schema="SnApp.dbo" to_table="tbInstallmentContract" delete_action="cascade" >
				<fk_column name="InstallmentContractId" pk="InstallmentContractId" />
			</fk>
		</table>
		<table name="tbInstallmentPlan" >
			<comment><![CDATA[Holds information about available installment plans and their properties]]></comment>
			<column name="InstallmentPlanId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="InstallmentPlanCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alpha numeric user defined code]]></comment>
			</column>
			<column name="InstallmentPlanName" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Installment plan name]]></comment>
			</column>
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Status of the plan (usable or not)]]></comment>
			</column>
			<column name="EnabledPOS" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[" for POS]]></comment>
			</column>
			<column name="EnabledB2C" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[" for B2C]]></comment>
			</column>
			<column name="EnabledCLC" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[" for call center platform]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Plan usable only from date]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[Plan usable only up to date. 
Null = no limit]]></comment>
			</column>
			<column name="PaymentCount" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Number of payments/installments]]></comment>
			</column>
			<column name="PaymentCycleType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[211] 

"Fixed Date" (this means that if "15" is indicated on field PaymentCycleValue it would be on the 15th of each month. If "31" the last day of the month will be used... 28 on feb)

"Number of days" (this means the number of days starting at the transaction date)]]></comment>
			</column>
			<column name="PaymentCycleValue" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="DownPaymentType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135] Absolute/Percentage]]></comment>
			</column>
			<column name="DownPaymentValue" type="money" length="0" jt="3" mandatory="y" />
			<column name="VariableDownPayment" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Operator can change down payment amount]]></comment>
			</column>
			<column name="MaxAttempts" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="RetryAfterDays" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="FirstInstallmentOffset" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Number of days after the contract issuing date where the first installment is to be done]]></comment>
			</column>
			<column name="RenewInstallmentPlanId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[When a contract is renewed, this is the new contract template to be used. When is null, auto renewal is not allowed]]></comment>
			</column>
			<column name="AutoRenewCommDays" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Notice days before auto-renewal]]></comment>
			</column>
			<column name="DurationDays" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Should match the validity of the tickets, and is the time after the contract issueing when the renewal will take place]]></comment>
			</column>
			<column name="ContractFeeType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135] Absolute/Percentage]]></comment>
			</column>
			<column name="ContractFeeValue" type="money" length="0" jt="3" mandatory="y" />
			<column name="ProductFeeType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135] Absolute/Percentage]]></comment>
			</column>
			<column name="ProductFeeValue" type="money" length="0" jt="3" mandatory="y" />
			<column name="CalendarId" type="uniqueidentifier" jt="1" />
			<column name="ContractDocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Term And Conditions. DocTemplateType=InstallmentContract]]></comment>
			</column>
			<column name="FeeProductId" type="uniqueidentifier" jt="1" />
			<column name="ContractPreviewDocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Preview contract template id available before contract finalization. DocTemplateType=InstallmentContract]]></comment>
			</column>
			<index name="UQ_InstallmentPlan_Code" unique="UNIQUE_KEY" >
				<column name="InstallmentPlanCode" options="ASC" />
			</index>
			<index name="IX_InstallmentPlan_RenewInstallmentPlanId" unique="NORMAL" >
				<column name="RenewInstallmentPlanId" options="ASC" />
			</index>
			<index name="IX_InstallmentPlan_CalendarId" unique="NORMAL" options="where CalendarId is not null" >
				<column name="CalendarId" options="ASC" />
			</index>
			<index name="IX_InstallmentPlan_ContractDocTemplateId" unique="NORMAL" options="where ContractDocTemplateId is not null" >
				<column name="ContractDocTemplateId" options="ASC" />
			</index>
			<index name="IX_InstallmentPlan_FeeProductId" unique="NORMAL" options="where FeeProductId is not null" >
				<column name="FeeProductId" options="ASC" />
			</index>
			<index name="IX_InstallmentPlan_ContractPreviewDocTemplateId" unique="NORMAL" options="where ContractPreviewDocTemplateId is not null" >
				<column name="ContractPreviewDocTemplateId" options="ASC" />
			</index>
			<index name="PK_InstallmentPlan" unique="PRIMARY_KEY" >
				<column name="InstallmentPlanId" />
			</index>
			<fk name="FK_InstallmentPlan_FeeProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="FeeProductId" pk="ProductId" />
			</fk>
			<fk name="FK_InstallmentPlan_ContractDocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="ContractDocTemplateId" pk="DocTemplateId" />
			</fk>
			<fk name="FK_InstallmentPlan_ContractPreviewDocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="ContractPreviewDocTemplateId" pk="DocTemplateId" />
			</fk>
			<fk name="FK_InstallmentPlan_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_InstallmentPlan_RenewInstallmentPlan" to_schema="SnApp.dbo" to_table="tbInstallmentPlan" >
				<fk_column name="RenewInstallmentPlanId" pk="InstallmentPlanId" />
			</fk>
		</table>
		<table name="tbInstallmentPlanComm" >
			<comment><![CDATA[Setting of email templates for each "plan"/"event"]]></comment>
			<column name="InstallmentPlanId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="InstallmentCommType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[213]]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_InstallmentPlanComm_DocTemplate" unique="NORMAL" >
				<column name="DocTemplateId" options="ASC" />
				<column name="InstallmentCommType" options="ASC" />
			</index>
			<index name="PK_InstallmentPlanComm" unique="PRIMARY_KEY" >
				<column name="InstallmentPlanId" />
				<column name="InstallmentCommType" />
			</index>
			<fk name="FK_InstallmentPlanComm_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
			<fk name="FK_InstallmentPlanComm_InstallmentPlan" to_schema="SnApp.dbo" to_table="tbInstallmentPlan" delete_action="cascade" >
				<fk_column name="InstallmentPlanId" pk="InstallmentPlanId" />
			</fk>
		</table>
		<table name="tbIntercompanyCostCenter" >
			<comment><![CDATA[Link to the doc template to be printed]]></comment>
			<column name="IntercompanyCostCenterId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="IntercompanyCostCenterCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="IntercompanyCostCenterName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="ForceReceipt" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When selected, it will force the printing of a receipt]]></comment>
			</column>
			<index name="IX_IntercompanyCostCenter_DocTemplateId" unique="NORMAL" options="where DocTemplateId is not null" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="PK_IntercompanyCostCenter" unique="PRIMARY_KEY" >
				<column name="IntercompanyCostCenterId" />
			</index>
			<fk name="FK_IntercompanyCostCenter_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbInvoice" prior="Tbl" >
			<comment><![CDATA[Contains the invoice header data]]></comment>
			<column name="InvoiceId" prior="IncoiceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="InvoiceCode" type="varchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[Unique code of the invoice]]></comment>
			</column>
			<column name="InvoiceStatus" type="smallint" length="1" jt="5" mandatory="y" >
				<comment><![CDATA[LK[432]]]></comment>
			</column>
			<column name="IssueDateTime" prior="InvoiceDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Issue Date/Time]]></comment>
			</column>
			<column name="IssueDate" prior="InvoiceFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Issue date]]></comment>
			</column>
			<column name="DueDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Due date of the invoice payment]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the Account of the invoice]]></comment>
			</column>
			<column name="LocationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the location the invoice is issued for]]></comment>
			</column>
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to operating area where the invoice was created]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to workstation where the invoice was created]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the user that created the invoice]]></comment>
			</column>
			<column name="TotalAmount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Total gross amount of the invoice]]></comment>
			</column>
			<column name="TotalTax" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Total tax amount of the invoice]]></comment>
			</column>
			<column name="ItemCount" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Total quantity of items in the invoice]]></comment>
			</column>
			<index name="PK_Invoice" unique="PRIMARY_KEY" >
				<column name="InvoiceId" />
			</index>
			<index name="IX_Invoice_AccountId" unique="NORMAL" >
				<column name="AccountId" />
				<column name="IssueDateTime" />
			</index>
			<index name="IX_Invoice_OpAreaId" unique="NORMAL" >
				<column name="OpAreaId" />
				<column name="IssueDateTime" />
			</index>
			<index name="IX_Invoice_UserAccountId" unique="NORMAL" >
				<column name="UserAccountId" />
				<column name="IssueDateTime" />
			</index>
			<index name="IX_Invoice_LocationId" unique="NORMAL" >
				<column name="LocationId" />
				<column name="IssueDateTime" />
			</index>
			<index name="IX_Invoice_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" />
				<column name="IssueDateTime" />
			</index>
			<index name="IX_Invoice_IssueDate" unique="NORMAL" >
				<column name="IssueDate" />
				<column name="IssueDateTime" />
			</index>
			<index name="UQ_Invoice_InvoiceCode" unique="UNIQUE_INDEX" >
				<column name="InvoiceCode" />
			</index>
			<index name="IX_Invoice_DueDate" unique="NORMAL" >
				<column name="DueDate" />
				<column name="IssueDateTime" />
			</index>
			<fk name="FK_Invoice_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Invoice_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Invoice_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Invoice_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_Invoice_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbInvoiceItem" prior="tb" >
			<comment><![CDATA[Contains the invoice items data]]></comment>
			<column name="InvoiceItemId" prior="ItemInvoiceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="InvoiceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the Invoice]]></comment>
			</column>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the invoiced sale item]]></comment>
			</column>
			<column name="UnitAmount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Unit amount of the item  (discounted, tax inclusive)]]></comment>
			</column>
			<column name="UnitTax" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Unit tax amount of the item]]></comment>
			</column>
			<column name="Quantity" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Number of items]]></comment>
			</column>
			<column name="TotalAmount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[UnitAmount * Quantity]]></comment>
			</column>
			<column name="TotalTax" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[UnitTax * Quantity]]></comment>
			</column>
			<index name="PK_InvoiceItem" unique="PRIMARY_KEY" >
				<column name="InvoiceItemId" />
			</index>
			<index name="UQ_InvoiceItem_InvoiceId" unique="UNIQUE_INDEX" >
				<column name="InvoiceId" />
				<column name="SaleItemId" />
				<column name="UnitAmount" />
			</index>
			<index name="UQ_InvoiceItem_SaleItemId" unique="UNIQUE_INDEX" >
				<column name="SaleItemId" />
				<column name="InvoiceId" />
				<column name="UnitAmount" />
			</index>
			<fk name="FK_InvoiceItem_Invoice" to_schema="SnApp.dbo" to_table="tbInvoice" delete_action="cascade" >
				<fk_column name="InvoiceId" pk="InvoiceId" />
			</fk>
			<fk name="FK_InvoiceItem_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbInvoicePayment" prior="tbInvoiceItem_0" >
			<comment><![CDATA[Contains a reference to the approved payments of the invoiced sales]]></comment>
			<column name="InvoiceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the Invoice]]></comment>
			</column>
			<column name="PaymentId" prior="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the payment]]></comment>
			</column>
			<column name="PaymentAmount" prior="UnitAmount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Payment amount]]></comment>
			</column>
			<index name="PK_InvoicePayment" unique="PRIMARY_KEY" >
				<column name="InvoiceId" />
				<column name="PaymentId" />
			</index>
			<index name="IX_InvoicePayment_PaymentId" unique="NORMAL" >
				<column name="PaymentId" />
			</index>
			<fk name="FK_InvoicePayment_Invoice" to_schema="SnApp.dbo" to_table="tbInvoice" delete_action="cascade" >
				<fk_column name="InvoiceId" pk="InvoiceId" />
			</fk>
			<fk name="FK_InvoicePayment_Payment" to_schema="SnApp.dbo" to_table="tbPayment" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
		</table>
		<table name="tbJob" >
			<column name="JobId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TaskId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="JobStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[96] Waiting, InProgress, Succeeded, Failed, Rejected]]></comment>
			</column>
			<column name="StartEntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="StartEntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="StartDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="FinishDateTime" type="datetime" jt="92" />
			<column name="WarningCount" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="FailedCount" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="SucceededCount" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="JobLog" type="nvarchar(max)" jt="12" />
			<column name="TriggerEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="TriggerEntityId" type="uniqueidentifier" jt="1" />
			<column name="Checked" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" />
			<column name="DatabaseProcess" type="smallint" length="1" decimal="0" jt="5" />
			<column name="TaskConfig" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Snapshot ot task configuration data at job execution time]]></comment>
			</column>
			<index name="IX_Job_TaskIdChecked" unique="NORMAL" >
				<column name="TaskId" options="ASC" />
				<column name="Checked" options="ASC" />
				<column name="StartDateTime" options="ASC" />
			</index>
			<index name="IX_Job_StartDateTime" unique="NORMAL" >
				<column name="StartDateTime" options="ASC" />
			</index>
			<index name="IX_Job_TaskId" unique="NORMAL" >
				<column name="TaskId" options="ASC" />
				<column name="StartDateTime" options="ASC" />
			</index>
			<index name="IX_Job_ServerId" unique="NORMAL" options="where ServerId not null" >
				<column name="ServerId" options="ASC" />
				<column name="StartDateTime" options="ASC" />
			</index>
			<index name="PK_Job" unique="PRIMARY_KEY" >
				<column name="JobId" />
			</index>
			<fk name="FK_Job_Task" to_schema="SnApp.dbo" to_table="tbTask" delete_action="cascade" >
				<fk_column name="TaskId" pk="TaskId" />
			</fk>
		</table>
		<table name="tbLedger" >
			<comment><![CDATA[List of ledger entries]]></comment>
			<column name="GroupEntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[In double-entry bookkeeping, each modification is made by at least 2 ledger entries. This field is keeping this "n" entries togheter and might be a meaningless UUID, or a reference to another database object (ie: transaction), depending on GroupEntityType value]]></comment>
			</column>
			<column name="LedgerSerial" type="tinyint" length="1" decimal="0" jt="-6" mandatory="y" >
				<comment><![CDATA[Sorting within the same GroupEntityId]]></comment>
			</column>
			<column name="GroupEntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]  Transaction / LedgerGroup]]></comment>
			</column>
			<column name="LedgerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[183]]]></comment>
			</column>
			<column name="LedgerFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date of the entry]]></comment>
			</column>
			<column name="LedgerDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time of the entry]]></comment>
			</column>
			<column name="LedgerAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Referense to the ledger account]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the location/organization]]></comment>
			</column>
			<column name="LedgerAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount of the entry]]></comment>
			</column>
			<column name="WriteDateTime" type="datetime" jt="92" >
				<comment><![CDATA[DB Server date/time of the entry]]></comment>
			</column>
			<column name="LedgerSequence" type="bigint" jt="-5" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Sequential unique (for this table) number starting from 1]]></comment>
			</column>
			<index name="IX_Ledger_LedgerAccountId" unique="NORMAL" >
				<column name="LedgerAccountId" options="ASC" />
				<column name="LedgerFiscalDate" options="ASC" />
			</index>
			<index name="IX_Ledger_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
				<column name="LedgerFiscalDate" options="ASC" />
			</index>
			<index name="IX_Ledger_FiscalDate" unique="NORMAL" >
				<column name="LedgerFiscalDate" options="DESC" />
				<column name="LedgerDateTime" options="DESC" />
				<column name="GroupEntityId" options="ASC" />
				<column name="LedgerAmount" options="ASC" />
			</index>
			<index name="IX_Ledger_WriteDateTime" unique="NORMAL" options="where WriteDateTime is not null" >
				<column name="WriteDateTime" options="ASC" />
			</index>
			<index name="PK_Ledger" unique="PRIMARY_KEY" >
				<column name="GroupEntityId" />
				<column name="LedgerSerial" />
			</index>
			<index name="unq_tbLedger_GroupEntityId" unique="UNIQUE_KEY" >
				<column name="GroupEntityId" />
			</index>
			<index name="UQ_Ledger_LedgerSequence" unique="UNIQUE_KEY" >
				<column name="LedgerSequence" />
			</index>
			<fk name="FK_Ledger_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Ledger_LedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="LedgerAccountId" pk="LedgerAccountId" />
			</fk>
		</table>
		<table name="tbLedgerAccount" >
			<comment><![CDATA[Chart Of Accounts]]></comment>
			<column name="LedgerAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LedgerAccountCode" type="varchar" length="15" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible user defined code, usually in the form of 000.000.000.000]]></comment>
			</column>
			<column name="LedgerAccountName" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Name of the ledger account]]></comment>
			</column>
			<column name="LedgerAccountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[186] Asset, Liability, Revenue, Expense, etc]]></comment>
			</column>
			<column name="LedgerAccountLevel" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[249] Master, Group, SubAccount]]></comment>
			</column>
			<column name="LedgerAccountStatus" type="smallint" length="1" jt="5" mandatory="y" >
				<comment><![CDATA[LK[489] Active, Disabled]]></comment>
			</column>
			<column name="AffectClearing" type="bit" jt="-7" mandatory="y" />
			<index name="UQ_LedgerAccount_Code" unique="UNIQUE_KEY" >
				<column name="LedgerAccountCode" options="ASC" />
			</index>
			<index name="PK_LedgerAccount" unique="PRIMARY_KEY" >
				<column name="LedgerAccountId" />
			</index>
		</table>
		<table name="tbLedgerClearing" >
			<column name="LedgerClearingId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal id]]></comment>
			</column>
			<column name="GroupEntityId" type="uniqueidentifier" length="1" decimal="0" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ledger (tbLedger)]]></comment>
			</column>
			<column name="GroupEntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ticket]]></comment>
			</column>
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to gate category]]></comment>
			</column>
			<column name="LedgerTriggerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[183] Sale, Refund, Redeem entry etc...]]></comment>
			</column>
			<column name="LedgerTriggerEntityId" type="uniqueidentifier" length="1" decimal="0" jt="1" mandatory="y" >
				<comment><![CDATA[Referenced object]]></comment>
			</column>
			<column name="LedgerTriggerEntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131] Referenced object type]]></comment>
			</column>
			<column name="LedgerFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date of entry]]></comment>
			</column>
			<column name="LedgerDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/time of entry]]></comment>
			</column>
			<column name="DeltaAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount of entry]]></comment>
			</column>
			<column name="ClearingAllocated" type="money" length="0" jt="3" >
				<comment><![CDATA[Clearing allocated on the ticket (and gate category if exists) at the time of the ledger movement]]></comment>
			</column>
			<column name="InheritedEntry" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[True when entry was not originated by the specific product but has been inherited (ex. upgrade of used products)]]></comment>
			</column>
			<index name="IX_LedgerClearing_GroupEntityId" unique="NORMAL" >
				<column name="GroupEntityId" options="ASC" />
				<column name="LedgerDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerClearing_TicketId" unique="NORMAL" >
				<column name="TicketId" options="ASC" />
				<column name="LedgerDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerClearing_GateCategoryId" unique="NORMAL" options="where GateCategoryId is not null" >
				<column name="GateCategoryId" options="ASC" />
				<column name="LedgerDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerClearing_LedgerFiscalDate" unique="NORMAL" >
				<column name="LedgerFiscalDate" options="ASC" />
				<column name="LedgerDateTime" options="ASC" />
			</index>
			<index name="PK_LedgerClearing" unique="PRIMARY_KEY" >
				<column name="LedgerClearingId" />
			</index>
			<fk name="FK_LedgerClearing_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_LedgerClearing_GateCategory" to_schema="SnApp.dbo" to_table="tbGateCategory" >
				<fk_column name="GateCategoryId" pk="GateCategoryId" />
			</fk>
		</table>
		<table name="tbLedgerDateTotal" >
			<comment><![CDATA[Consolidated balance of the ledger account, broken down by FiscalDate and Location/Organization]]></comment>
			<column name="LedgerFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal Date]]></comment>
			</column>
			<column name="LedgerAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the ledger account]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the location/organization]]></comment>
			</column>
			<column name="LedgerTotalBalance" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[balance]]></comment>
			</column>
			<index name="IX_LedgerDateTotal_LedgerAccountId" unique="NORMAL" options="INCLUDE(LedgerTotalBalance)" >
				<column name="LedgerAccountId" options="ASC" />
				<column name="LedgerFiscalDate" options="ASC" />
				<column name="AccountId" options="ASC" />
			</index>
			<index name="IX_LedgerDateTotal_AccountId" unique="NORMAL" options="INCLUDE(LedgerTotalBalance)" >
				<column name="AccountId" options="ASC" />
				<column name="LedgerFiscalDate" options="ASC" />
				<column name="LedgerAccountId" options="ASC" />
			</index>
			<index name="PK_LedgerDateTotal" unique="PRIMARY_KEY" >
				<column name="LedgerFiscalDate" />
				<column name="LedgerAccountId" />
				<column name="AccountId" />
			</index>
			<fk name="FK_LedgerDateTotal_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_LedgerDateTotal_LedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" delete_action="cascade" >
				<fk_column name="LedgerAccountId" pk="LedgerAccountId" />
			</fk>
		</table>
		<table name="tbLedgerManual" >
			<comment><![CDATA[Used to store ledger manual entries information]]></comment>
			<column name="LedgerManualId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LedgerManualDateTime" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Operation date/time]]></comment>
			</column>
			<column name="LedgerLocalDateTime" type="smalldatetime" jt="93" >
				<comment><![CDATA[Date/Time of the entry]]></comment>
			</column>
			<column name="LocationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the location]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the workstation]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the operator]]></comment>
			</column>
			<column name="LedgerManualNotes" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Operation's notes]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" />
			<column name="AffectClearingLimit" type="bit" jt="-7" />
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" />
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to transaction]]></comment>
			</column>
			<index name="IX_LedgerManual_WorstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="LedgerManualDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerManual_UserAccountId" unique="NORMAL" >
				<column name="UserAccountId" options="ASC" />
				<column name="LedgerManualDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerManual_DateTime" unique="NORMAL" >
				<column name="LedgerManualDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerManual_TicketId" unique="NORMAL" options="where ticketId is not null" >
				<column name="TicketId" options="ASC" />
				<column name="LedgerManualDateTime" options="ASC" />
			</index>
			<index name="PK_LedgerManual" unique="PRIMARY_KEY" >
				<column name="LedgerManualId" />
			</index>
			<index name="IX_LedgerManual_GateCategoryId" unique="NORMAL" options="WHERE GateCategoryId is not null" >
				<column name="GateCategoryId" />
			</index>
			<index name="IX_LedgerManual_TransactionId" unique="NORMAL" options="WHERE TransactionId is not null" >
				<column name="TransactionId" />
			</index>
			<index name="IX_LedgerManual_LocationId" unique="NORMAL" >
				<column name="LocationId" />
				<column name="LedgerManualDateTime" />
			</index>
			<fk name="FK_LedgerManual_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_LedgerManual_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_LedgerManual_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_LedgerManual_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_LedgerManual_GateCategory" to_schema="SnApp.dbo" to_table="tbGateCategory" >
				<fk_column name="GateCategoryId" pk="GateCategoryId" />
			</fk>
			<fk name="FK_LedgerManual_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbLedgerManualItem" >
			<comment><![CDATA[Ledger entity breakdown for tbLedgerManual]]></comment>
			<column name="LedgerManualItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LedgerManualId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ledger manual]]></comment>
			</column>
			<column name="LedgerAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ledger account]]></comment>
			</column>
			<column name="LocationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to location, used for segregation in ledger accounts]]></comment>
			</column>
			<column name="LedgerAmount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Entity amount: Debig=Negative, Credit=Positive]]></comment>
			</column>
			<index name="PK_LedgerManualItem" unique="PRIMARY_KEY" >
				<column name="LedgerManualItemId" />
			</index>
			<index name="IX_LedgerManualItem_LedgerManualId" unique="NORMAL" >
				<column name="LedgerManualId" />
			</index>
			<index name="IX_LedgerManualItem_LedgerAccountId" unique="NORMAL" >
				<column name="LedgerAccountId" />
			</index>
			<index name="IX_LedgerManualItem_LocationId" unique="NORMAL" >
				<column name="LocationId" />
			</index>
			<fk name="FK_LedgerManualItem_LedgerManual" to_schema="SnApp.dbo" to_table="tbLedgerManual" delete_action="cascade" >
				<fk_column name="LedgerManualId" pk="LedgerManualId" />
			</fk>
			<fk name="FK_LedgerManualItem_Location" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_LedgerManualItem_LedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="LedgerAccountId" pk="LedgerAccountId" />
			</fk>
		</table>
		<table name="tbLedgerQueue" >
			<column name="LedgerQueueId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="GroupEntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Id of the group entity]]></comment>
			</column>
			<column name="LedgerQueueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[319] Transaction, Redemption, Expiration, Breakage, Amortization]]></comment>
			</column>
			<column name="GroupEntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="LedgerQueueStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[318] Waiting, Working, Dependant, Success, Failed]]></comment>
			</column>
			<column name="LedgerDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time of record insertion into the queue]]></comment>
			</column>
			<column name="LockEntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Id of the lock entity]]></comment>
			</column>
			<column name="LockEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="AsyncProcessId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Id to the ledger regeneration async process]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="StartDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Internal use]]></comment>
			</column>
			<column name="EndDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Internal use]]></comment>
			</column>
			<index name="IX_LedgerQueue_StatusAndDateTime" unique="NORMAL" >
				<column name="LedgerQueueStatus" options="ASC" />
				<column name="LedgerDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerQueue_LockEntityId" unique="NORMAL" >
				<column name="LockEntityId" options="ASC" />
				<column name="LedgerQueueStatus" options="ASC" />
				<column name="LedgerDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerQueue_AsyncProcessId" unique="NORMAL" options="where AsyncProcessId is not null" >
				<column name="AsyncProcessId" options="ASC" />
				<column name="LedgerDateTime" options="ASC" />
			</index>
			<index name="IX_LedgerQueue_AsyncProcess" unique="NORMAL" >
				<column name="AsyncProcessId" options="ASC" />
			</index>
			<index name="IX_LedgerQueue_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
			</index>
			<index name="PK_LedgerQueue" unique="PRIMARY_KEY" >
				<column name="LedgerQueueId" />
			</index>
			<fk name="FK_LedgerQueue_AsyncProcess" to_schema="SnApp.dbo" to_table="tbAsyncProcess" >
				<fk_column name="AsyncProcessId" pk="AsyncProcessId" />
			</fk>
			<fk name="FK_LedgerQueue_Server" to_schema="SnApp.dbo" to_table="tbServer" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbLedgerRef" >
			<comment><![CDATA[Filled in case a ledger entry reference one or more system objects.
Used particulary to reference products (tbTicket) when affecting its clearing limit]]></comment>
			<column name="GroupEntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ledger entry (tbLedger)]]></comment>
			</column>
			<column name="LedgerSerial" type="tinyint" length="1" decimal="0" jt="-6" mandatory="y" >
				<comment><![CDATA[Reference to ledger entry (tbLedger)]]></comment>
			</column>
			<column name="LedgerRefSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting within the same ledger entry]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" length="1" decimal="0" jt="1" mandatory="y" >
				<comment><![CDATA[Referenced object]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131] Referenced object type]]></comment>
			</column>
			<column name="LedgerRefAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Portion of the (tbLedger.LedgerAmount) for the referenced object]]></comment>
			</column>
			<column name="AffectClearingLimit" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if this record should influence the clearing limit of the referenced object]]></comment>
			</column>
			<column name="UsedTicket" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="LedgerType" type="smallint" jt="5" >
				<comment><![CDATA[LK[183]]]></comment>
			</column>
			<column name="LedgerRuleId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to tbLedgerRule]]></comment>
			</column>
			<index name="IX_LedgerRef_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="AffectClearingLimit" options="ASC" />
			</index>
			<index name="PK_LedgerRef" unique="PRIMARY_KEY" >
				<column name="GroupEntityId" />
				<column name="LedgerSerial" />
				<column name="LedgerRefSerial" />
			</index>
			<index name="IX_LedgerRef_LedgerRuleId" unique="NORMAL" options="WHERE LedgerRuleId is not null" >
				<column name="LedgerRuleId" />
			</index>
			<fk name="FK_LedgerRef_Ledger" to_schema="SnApp.dbo" to_table="tbLedger" delete_action="cascade" >
				<fk_column name="GroupEntityId" pk="GroupEntityId" />
			</fk>
			<fk name="FK_LedgerRef_LedgerRule" to_schema="SnApp.dbo" to_table="tbLedgerRule" >
				<fk_column name="LedgerRuleId" pk="LedgerRuleId" />
			</fk>
		</table>
		<table name="tbLedgerRule" >
			<comment><![CDATA[Holds information about configured ledger rules]]></comment>
			<column name="LedgerRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LedgerTriggerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[183] Sale, RedeemEntry, RedeemReentry, etc]]></comment>
			</column>
			<column name="TriggerAccessPointId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Filter on access point during redemption]]></comment>
			</column>
			<column name="TriggerEntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131] Product/AttributeItem]]></comment>
			</column>
			<column name="TriggerEntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LedgerRuleAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="LedgerRuleAmountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[181]]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to external ledger rule]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" />
			<column name="SerialNumber" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Used in order to identify the ledger rule in order to keep track of the history details when the prices are changed]]></comment>
			</column>
			<column name="LedgerRuleStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[353] Active / Inactive / Deleted]]></comment>
			</column>
			<column name="AutoRevertLedgerAccountId" prior="AutoRevertDefRevLedgerAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[General deferred revenue ledger account ID to be used when rule is "Refund" and flag "Automatic revert" is checked.]]></comment>
			</column>
			<column name="AutoRevertLocationType" type="smallint" jt="5" >
				<comment><![CDATA[LK[182] - Fixed, SaleLocation, AdmissionLocation, ProductLocation, TransactionLocation, ReservationOwner]]></comment>
			</column>
			<column name="AutoRevertLocationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Location to be used when rule is "Refund" and "Automatic revert" flag is checked]]></comment>
			</column>
			<index name="IX_LedgerRule_TriggerEntityId" unique="NORMAL" >
				<column name="TriggerEntityId" options="ASC" />
			</index>
			<index name="PK_LedgerRule" unique="PRIMARY_KEY" >
				<column name="LedgerRuleId" />
			</index>
			<index name="IX_LedgerRule_PluginId" unique="NORMAL" options="where PluginId is not null" >
				<column name="PluginId" />
			</index>
			<index name="IX_LedgerRule_AutoRevertLedgerAccountId" unique="NORMAL" >
				<column name="AutoRevertLedgerAccountId" />
			</index>
			<index name="IX_LedgerRule_AutoRevertLocationId" unique="NORMAL" >
				<column name="AutoRevertLocationId" />
			</index>
			<fk name="FK_LedgerRule_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
			<fk name="FK_LedgerRule_AutoRevertLedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" delete_action="cascade" >
				<fk_column name="AutoRevertLedgerAccountId" pk="LedgerAccountId" />
			</fk>
			<fk name="FK_LedgerRule_AutoRevertLocation" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AutoRevertLocationId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbLedgerRuleDetail" >
			<column name="LedgerRuleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LedgerRuleDetailSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="DebitLedgerAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DebitAccountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[182] Fixed, SaleLocation, AdmissionLocation, ProductLocation, TransactionLocation, ReservationOwner]]></comment>
			</column>
			<column name="DebitAccountId" type="uniqueidentifier" jt="1" />
			<column name="CreditLedgerAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CreditAccountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[182] Fixed, SaleLocation, AdmissionLocation, ProductLocation, TransactionLocation, ReservationOwner]]></comment>
			</column>
			<column name="CreditAccountId" type="uniqueidentifier" jt="1" />
			<column name="UsageFilterLocationId" type="uniqueidentifier" jt="1" />
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" />
			<column name="Weight" type="money" length="0" jt="3" mandatory="y" />
			<column name="WeightType" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[Lk[340] 1=Absolute, 2=Percentage, 3=Gate category]]></comment>
			</column>
			<column name="LedgerRuleDetailStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Lk[354] Active / Deleted]]></comment>
			</column>
			<index name="IX_LedgerRuleDetail_DebitLedgerAccountId" unique="NORMAL" >
				<column name="DebitLedgerAccountId" options="ASC" />
			</index>
			<index name="IX_LedgerRuleDetail_DebitAccountId" unique="NORMAL" options="where DebitAccountId is not null" >
				<column name="DebitAccountId" options="ASC" />
			</index>
			<index name="IX_LedgerRuleDetail_CreditLedgerAccountId" unique="NORMAL" >
				<column name="CreditLedgerAccountId" options="ASC" />
			</index>
			<index name="IX_LedgerRuleDetail_CreditAccountId" unique="NORMAL" options="where CreditAccountId is not null" >
				<column name="CreditAccountId" options="ASC" />
			</index>
			<index name="IX_LedgerRuleDetail_UsageFilterLocationId" unique="NORMAL" options="where UsageFilterLocationId is not null" >
				<column name="UsageFilterLocationId" options="ASC" />
			</index>
			<index name="IX_LedgerRuleDetail_GateCategoryId" unique="NORMAL" options="where GateCategoryId is not null" >
				<column name="GateCategoryId" options="ASC" />
			</index>
			<index name="PK_LedgerRuleDetail" unique="PRIMARY_KEY" >
				<column name="LedgerRuleId" />
				<column name="LedgerRuleDetailSerial" />
			</index>
			<fk name="FK_LedgerRuleDetail_CreditAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="CreditAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_LedgerRuleDetail_DebitAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="DebitAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_LedgerRuleDetail_UsageFilterLocation" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UsageFilterLocationId" pk="AccountId" />
			</fk>
			<fk name="FK_LedgerRuleDetail_LedgerRule" to_schema="SnApp.dbo" to_table="tbLedgerRule" delete_action="cascade" >
				<fk_column name="LedgerRuleId" pk="LedgerRuleId" />
			</fk>
			<fk name="FK_LedgerRuleDetail_CreditLedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="CreditLedgerAccountId" pk="LedgerAccountId" />
			</fk>
			<fk name="FK_LedgerRuleDetail_DebitLedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="DebitLedgerAccountId" pk="LedgerAccountId" />
			</fk>
			<fk name="FK_LedgerRuleDetail_GateCategory" to_schema="SnApp.dbo" to_table="tbGateCategory" delete_action="cascade" >
				<fk_column name="GateCategoryId" pk="GateCategoryId" />
			</fk>
		</table>
		<table name="tbLedgerRuleFilter" prior="tbLedgerRule2EntityFilter" >
			<comment><![CDATA[List of filters of a ledger rule]]></comment>
			<column name="LedgerRuleFilterId" prior="LedgerRule2EntityFilterId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LedgerRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the ledger rule]]></comment>
			</column>
			<column name="LedgerRuleFilterType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[493]]]></comment>
			</column>
			<column name="Value" prior="EntityId" type="varchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Specific filter (ex. Sale location, gate category etc.)]]></comment>
			</column>
			<index name="PK_LedgerRuleFilter" unique="PRIMARY_KEY" >
				<column name="LedgerRuleFilterId" />
			</index>
			<index name="UQ_LedgerRuleFilter_LedgerRuleId" unique="UNIQUE_INDEX" >
				<column name="LedgerRuleId" />
				<column name="LedgerRuleFilterType" />
				<column name="Value" />
			</index>
			<index name="IX_LedgerRuleFilter_Value" unique="NORMAL" >
				<column name="Value" />
			</index>
			<fk name="FK_LedgerRuleFilter_LedgerRule" to_schema="SnApp.dbo" to_table="tbLedgerRule" delete_action="cascade" >
				<fk_column name="LedgerRuleId" pk="LedgerRuleId" />
			</fk>
		</table>
		<table name="tbLedgerRuleFlag" >
			<column name="LedgerRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ledger rule]]></comment>
			</column>
			<column name="LedgerRuleFlag" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[373]]]></comment>
			</column>
			<index name="PK_LedgerRuleFlag" unique="PRIMARY_KEY" >
				<column name="LedgerRuleId" />
				<column name="LedgerRuleFlag" />
			</index>
			<fk name="FK_LedgerRuleFlag_LedgerRule" to_schema="SnApp.dbo" to_table="tbLedgerRule" delete_action="cascade" >
				<fk_column name="LedgerRuleId" pk="LedgerRuleId" />
			</fk>
		</table>
		<table name="tbLedgerRuleTemplate" prior="FK_LedgerRuleTemplate_Category" >
			<comment><![CDATA[Holds information about configure ledger rule profiles]]></comment>
			<column name="LedgerRuleTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LedgerRuleTemplateCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intellegible alphanumeric user defined code]]></comment>
			</column>
			<column name="LedgerRuleTemplateName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the profile]]></comment>
			</column>
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Status]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" />
			<column name="CategoryId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Category of the ledgerRuleTemplate]]></comment>
			</column>
			<index name="UQ_LedgerRuleTemplate_Code" unique="UNIQUE_KEY" >
				<column name="LedgerRuleTemplateCode" options="ASC" />
			</index>
			<index name="PK_LedgerRuleTemplate" unique="PRIMARY_KEY" >
				<column name="LedgerRuleTemplateId" />
			</index>
			<index name="IX_LedgerRuleTemplate_CategoryId" unique="NORMAL" options="WHERE CategoryId IS NOT NULL" >
				<column name="CategoryId" />
			</index>
			<fk name="FK_LedgerRuleTemplate_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbLedgerRuleTemplate2Entity" >
			<comment><![CDATA[N to N table for generic entities (as for now is just product types)]]></comment>
			<column name="LedgerRuleTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ledger rule profile]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to generic object (normally product types)]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="IX_LedgerRuleTemplate2Entity_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_LedgerRuleTemplate2Entity" unique="PRIMARY_KEY" >
				<column name="LedgerRuleTemplateId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_LedgerRuleTemplate2Entity_LedgerRuleTemplate" to_schema="SnApp.dbo" to_table="tbLedgerRuleTemplate" delete_action="cascade" >
				<fk_column name="LedgerRuleTemplateId" pk="LedgerRuleTemplateId" />
			</fk>
		</table>
		<table name="tbLedgerRuleTemplateDate" prior="tbLedgerR" spec="" >
			<comment><![CDATA[For each ledger profile (template date) can be created several "template date" entities broken down by date range.
Each template date may contain a set of ledger rules valid within the date range specified by ValidDateFrom and ValidDateTo.

ValidDate from cannot be null and is set to "2011-09-01" for already existings ledger profiles.
If ValidDateTo  is null the template date won't expire.]]></comment>
			<column name="LedgerRuleTemplateDateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LedgerRuleTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the ledger profile (template)]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Start validity]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[End validity (null -> no expiration)]]></comment>
			</column>
			<index name="PK_LedgerRuleTemplateDate" unique="NORMAL" >
				<column name="LedgerRuleTemplateDateId" />
			</index>
			<index name="IX_LedgerRuleTemplateDate_LedgerRuleTemplate" unique="NORMAL" >
				<comment><![CDATA[index on the FK]]></comment>
				<column name="LedgerRuleTemplateId" />
			</index>
			<index name="IX_LedgerRuleTemplateDate_ValidDateFrom" unique="NORMAL" >
				<column name="LedgerRuleTemplateDateId" />
				<column name="ValidDateFrom" />
			</index>
			<index name="pk_tbLedgerRuleTemplateDate" unique="PRIMARY_KEY" >
				<column name="LedgerRuleTemplateDateId" />
			</index>
			<fk name="FK_LedgerRuleTemplateDate_LedgerRuleTemplate" to_schema="SnApp.dbo" to_table="tbLedgerRuleTemplate" delete_action="cascade" >
				<fk_column name="LedgerRuleTemplateId" pk="LedgerRuleTemplateId" />
			</fk>
		</table>
		<table name="tbLicense" >
			<column name="LicenseId" type="smallint" jt="5" mandatory="y" />
			<column name="AccountId" type="uniqueidentifier" jt="1" />
			<column name="LicenseParams" type="nvarchar(max)" jt="12" />
			<column name="LastUpdate" type="datetime" jt="92" />
			<column name="MainLicense" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="UQ_License_AccountId" unique="UNIQUE_KEY" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="UQ_License_MainLicense" unique="UNIQUE_KEY" options="where MainLicense=1" >
				<column name="MainLicense" options="ASC" />
			</index>
			<index name="PK_License" unique="PRIMARY_KEY" >
				<column name="LicenseId" />
			</index>
			<fk name="FK_License_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbLock" >
			<column name="LockId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" />
			<column name="LockDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="StrongLock" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Normally, if a usr/wks try to lock an entity, and this is already locked by the same usr/wks, the lock would be considered "acquired". If StrongLock=TRUE, the acquire would fail in any case]]></comment>
			</column>
			<index name="UQ_Lock_EntityId" unique="UNIQUE_KEY" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_Lock_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_Lock_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_Lock" unique="PRIMARY_KEY" >
				<column name="LockId" />
			</index>
			<fk name="FK_Lock_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Lock_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbLog" >
			<comment><![CDATA[Holds system logs produced by the application]]></comment>
			<column name="LogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LogDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/time about when the log was produced]]></comment>
			</column>
			<column name="LogType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[188]]]></comment>
			</column>
			<column name="LogSubType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[223]]]></comment>
			</column>
			<column name="LogLevel" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[165]]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Workstation generating the log]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[User logged in when the log was generated]]></comment>
			</column>
			<column name="DurationMS" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Used to store duration for loggind sql query execution]]></comment>
			</column>
			<column name="LogHash" type="uniqueidentifier" length="32" decimal="0" jt="1" mandatory="y" >
				<comment><![CDATA[When loggin sql queries, used for grouping same query for statistical purposes]]></comment>
			</column>
			<column name="LogRecap" type="varchar" length="100" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[First 100 chars of the log text]]></comment>
			</column>
			<column name="LogDataType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[166]]]></comment>
			</column>
			<column name="LogText" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Log text]]></comment>
			</column>
			<column name="LogData" type="varbinary(max)" jt="-3" >
				<comment><![CDATA[Zipped log text - DEPRECATED - use field LogText]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the object (when possible) this log refers to]]></comment>
			</column>
			<column name="AltEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131] Alternative entity type (ie: when EntityType=Plugin, AltEntityType=Driver)]]></comment>
			</column>
			<column name="AltEntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Alternative entity id (ie: when EntityType=Plugin, AltEntityId=DriverId)]]></comment>
			</column>
			<column name="Version" type="varchar" length="20" decimal="0" jt="12" >
				<comment><![CDATA[Version of software at time of log]]></comment>
			</column>
			<column name="ServerId" type="smallint" jt="5" >
				<comment><![CDATA[Server saving the log]]></comment>
			</column>
			<index name="IX_Log_LogLevel" unique="NORMAL" >
				<column name="LogLevel" options="ASC" />
				<column name="LogDateTime" options="ASC" />
			</index>
			<index name="IX_Log_LogHash" unique="NORMAL" >
				<column name="LogHash" options="ASC" />
			</index>
			<index name="IX_Log_LogDateTime" unique="NORMAL" >
				<column name="LogDateTime" options="DESC" />
			</index>
			<index name="IX_Log_EntityId_Level_DT" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="LogLevel" options="ASC" />
				<column name="LogDateTime" options="DESC" />
			</index>
			<index name="IX_Log_WorkstationId" unique="NORMAL" options="where WorkstationId is not null" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_Log_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_Log" unique="PRIMARY_KEY" >
				<column name="LogId" />
			</index>
			<index name="IX_Log_AltEntityId" unique="NORMAL" options="INCLUDE (LogLevel, LogType, LogSubType) WHERE (AltEntityId IS NOT NULL)" >
				<column name="AltEntityId" />
				<column name="LogDateTime" />
			</index>
			<fk name="FK_Log_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Log_SourceWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbLogin" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Password" type="varchar" length="100" decimal="0" jt="12" mandatory="y" />
			<column name="ValidFrom" type="datetime" length="1" decimal="0" jt="92" />
			<column name="ValidTo" type="datetime" length="1" decimal="0" jt="92" />
			<column name="BKO_SessionPoolId" type="uniqueidentifier" jt="1" />
			<column name="B2B_SessionPoolId" type="uniqueidentifier" jt="1" />
			<column name="B2B_RoleId" type="uniqueidentifier" jt="1" />
			<column name="FailedLoginAttempts" type="tinyint" length="1" decimal="0" jt="-6" />
			<column name="PasswordChangeDate" type="date" jt="91" mandatory="y" />
			<column name="CryptType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[236]]]></comment>
			</column>
			<column name="ForcePasswordChange" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="LoginStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[132]]]></comment>
			</column>
			<column name="TempBlockDateTime" type="datetime" jt="92" />
			<column name="LastLoginDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Last login timestamp, used to block the user for inactivity according to licensee configuration rights 925/26/27.
Null means that the user has been unblocked.]]></comment>
			</column>
			<index name="IX_Login_BKO_SessionPoolId" unique="NORMAL" >
				<column name="BKO_SessionPoolId" options="ASC" />
			</index>
			<index name="IX_Login_B2B_SessionPoolId" unique="NORMAL" >
				<column name="B2B_SessionPoolId" options="ASC" />
			</index>
			<index name="IX_Login_B2B_RoleId" unique="NORMAL" >
				<column name="B2B_RoleId" options="ASC" />
			</index>
			<index name="PK_Login" unique="PRIMARY_KEY" >
				<column name="AccountId" />
			</index>
			<index name="IX_Login_LastLoginDateTime" unique="NORMAL" options="where LastLoginDateTime is not null" >
				<column name="LastLoginDateTime" />
				<column name="LoginStatus" />
			</index>
			<fk name="FK_Login_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Login_RoleId_B2B" to_schema="SnApp.dbo" to_table="tbRole" >
				<fk_column name="B2B_RoleId" pk="RoleId" />
			</fk>
			<fk name="FK_Login_SessionPool_BKO" to_schema="SnApp.dbo" to_table="tbSessionPool" >
				<fk_column name="BKO_SessionPoolId" pk="SessionPoolId" />
			</fk>
			<fk name="FK_Login_SessionPool_B2B" to_schema="SnApp.dbo" to_table="tbSessionPool" >
				<fk_column name="B2B_SessionPoolId" pk="SessionPoolId" />
			</fk>
		</table>
		<table name="tbLoginAlias" >
			<column name="LoginAliasId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserName" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="LoginAliasType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[237]]]></comment>
			</column>
			<column name="CreateDate" type="datetime" length="1" decimal="0" jt="92" mandatory="y" />
			<column name="VerifyDate" type="datetime" length="1" decimal="0" jt="92" />
			<column name="VerifyCode" type="varchar" length="32" decimal="0" jt="12" />
			<column name="PrimaryAlias" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="UQ_LoginAlias_UserName" unique="UNIQUE_KEY" >
				<column name="UserName" options="ASC" />
			</index>
			<index name="IX_LoginAlias_VerifyCode" unique="NORMAL" >
				<column name="VerifyCode" options="ASC" />
			</index>
			<index name="PK_LoginAlias" unique="PRIMARY_KEY" >
				<column name="LoginAliasId" />
			</index>
			<index name="IX_LoginAlias_AccountId" unique="NORMAL" options="INCLUDE (UserName)" >
				<column name="AccountId" options="ASC" />
				<column name="LoginAliasType" />
			</index>
			<fk name="FK_LoginAlias_Login" to_schema="SnApp.dbo" to_table="tbLogin" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbLoginStats" >
			<column name="LoginStatsId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="WorkstationType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[19]]]></comment>
			</column>
			<column name="SessionPoolId" type="uniqueidentifier" jt="1" />
			<column name="QuantityMax" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="UQ_LoginStats" unique="UNIQUE_KEY" options="INCLUDE(QuantityMax)" >
				<column name="WorkstationType" options="ASC" />
				<column name="SessionPoolId" options="ASC" />
				<column name="DateTime" options="ASC" />
			</index>
			<index name="IX_LoginStats_WorkstationType" unique="NORMAL" options="INCLUDE(QuantityMax)" >
				<column name="WorkstationType" options="ASC" />
				<column name="DateTime" options="ASC" />
			</index>
			<index name="IX_LoginStats_SessionPoolId" unique="NORMAL" options="INCLUDE(QuantityMax) where SessionPoolId is not null" >
				<column name="SessionPoolId" options="ASC" />
				<column name="DateTime" options="ASC" />
			</index>
			<index name="PK_LoginStats" unique="PRIMARY_KEY" >
				<column name="LoginStatsId" />
			</index>
			<fk name="FK_LoginStats_SessionPool" to_schema="SnApp.dbo" to_table="tbSessionPool" >
				<fk_column name="SessionPoolId" pk="SessionPoolId" />
			</fk>
		</table>
		<table name="tbLookupItem" >
			<comment><![CDATA[Set of possible values for each lookup table]]></comment>
			<column name="TableCode" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Reference to the lookup table]]></comment>
			</column>
			<column name="ItemCode" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Numeric code of the option]]></comment>
			</column>
			<column name="ItemName" type="nvarchar" length="500" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the option (english)]]></comment>
			</column>
			<column name="ItemNameRaw" type="nvarchar" length="500" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the option (translation key)]]></comment>
			</column>
			<column name="DefaultValue" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Default value (used only for partucular tables like "rights")]]></comment>
			</column>
			<column name="RightDecodeLookupTable" type="smallint" jt="5" >
				<comment><![CDATA[Only for RightType items, and only if the right refers to a lookup value, indicates what the related lookup table]]></comment>
			</column>
			<column name="RightDecodeEntityType" type="smallint" jt="5" >
				<comment><![CDATA[Only for RightType items, and only if the right value is a UUID or UUIDArray, it tells what is the referred entity type LK[131]]]></comment>
			</column>
			<column name="RightIsSetup" type="bit" jt="-7" >
				<comment><![CDATA[Only for RightType items, indicates if it is a RIGHT (0) or a SETUP (1)]]></comment>
			</column>
			<index name="PK_LookupItem" unique="PRIMARY_KEY" >
				<column name="TableCode" />
				<column name="ItemCode" />
			</index>
			<fk name="FK_LookupItem_LookupTable" to_schema="SnApp.dbo" to_table="tbLookupTable" delete_action="cascade" >
				<fk_column name="TableCode" pk="TableCode" />
			</fk>
		</table>
		<table name="tbLookupTable" >
			<comment><![CDATA[The system has many numeric constants which are saved on DB as well for documentation/reporting purposes
The LookupTable is a set of options. Options are saved into tbLookupItem.]]></comment>
			<column name="TableCode" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Table code, referenced inside this schema fields content with the notation "LK[?]", where the question mark is the TableCode]]></comment>
			</column>
			<column name="TableName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the set of values (english)]]></comment>
			</column>
			<column name="TableNameRaw" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the set of values (translation key)]]></comment>
			</column>
			<index name="PK_LookupTable" unique="PRIMARY_KEY" >
				<column name="TableCode" />
			</index>
		</table>
		<table name="tbMask" >
			<comment><![CDATA[Used to sort masks]]></comment>
			<column name="MaskId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="MaskCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="MaskName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="PriorityOrder" type="int" jt="4" />
			<index name="UQ_Mask_Code" unique="UNIQUE_KEY" >
				<column name="MaskCode" options="ASC" />
			</index>
			<index name="PK_Mask" unique="PRIMARY_KEY" >
				<column name="MaskId" />
			</index>
		</table>
		<table name="tbMask2Entity" >
			<comment><![CDATA[many-2-many relationship between masks and entities which support multiple masks]]></comment>
			<column name="MaskId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the mask]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[ID of the entity this mask is attached to]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<index name="IX_Mask2Entity_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="PriorityOrder" options="ASC" />
			</index>
			<index name="PK_Mask2Entity" unique="PRIMARY_KEY" >
				<column name="MaskId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_Mask2Entity_Mask" to_schema="SnApp.dbo" to_table="tbMask" >
				<fk_column name="MaskId" pk="MaskId" />
			</fk>
		</table>
		<table name="tbMaskItem" >
			<column name="MaskItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MaskId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MetaFieldId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Caption" type="nvarchar" length="50" jt="12" />
			<column name="Hint" type="nvarchar" length="50" jt="12" />
			<column name="PosX" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="PosY" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="Required" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="MaskDefaultType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[161]]]></comment>
			</column>
			<column name="DefaultValue" type="nvarchar" length="100" jt="12" />
			<index name="UQ_MaskItem" unique="UNIQUE_INDEX" >
				<column name="MaskId" options="ASC" />
				<column name="MetaFieldId" options="ASC" />
			</index>
			<index name="PK_MaskItem" unique="PRIMARY_KEY" >
				<column name="MaskItemId" />
			</index>
			<index name="IX_MaskItem_MetaFieldId" unique="NORMAL" >
				<column name="MetaFieldId" />
			</index>
			<fk name="FK_MaskItem_MetaField" to_schema="SnApp.dbo" to_table="tbMetaField" >
				<fk_column name="MetaFieldId" pk="MetaFieldId" />
			</fk>
			<fk name="FK_MaskItem_Mask" to_schema="SnApp.dbo" to_table="tbMask" delete_action="cascade" >
				<fk_column name="MaskId" pk="MaskId" />
			</fk>
		</table>
		<table name="tbMaskItemCondition" prior="Tbl" >
			<comment><![CDATA[Conditional rules for mask items (such as: define max length based on another field's value)]]></comment>
			<column name="MaskItemConditionId" prior="MaskItemCondition" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="MaskItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the mask item this rulle applies to]]></comment>
			</column>
			<column name="MonitorMetaFieldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Meta field on which the condition is checked against]]></comment>
			</column>
			<column name="MonitorComparatorType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[434] comparation type: equals, greater than, etc...]]></comment>
			</column>
			<column name="MonitorValue" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[Value to be used for comarison]]></comment>
			</column>
			<column name="MaskItemProperty" prior="PropertyType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[435] Destination property on which to apply the conditional change (ie: MaxLength)]]></comment>
			</column>
			<column name="PropertyValue" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[Value to apply on "MaskItemProperty" when the condition is verified]]></comment>
			</column>
			<index name="PK_MaskItemCondition" unique="PRIMARY_KEY" >
				<column name="MaskItemConditionId" />
			</index>
			<index name="IX_MaskItemCondition_MaskItemId" unique="NORMAL" >
				<column name="MaskItemId" />
				<column name="MonitorMetaFieldId" />
			</index>
			<index name="IX_MaskItemCondition_MonitorMetaFieldId" unique="NORMAL" >
				<column name="MonitorMetaFieldId" />
				<column name="MaskItemId" />
			</index>
			<fk name="FK_MaskItemCondition_MaskItem" to_schema="SnApp.dbo" to_table="tbMaskItem" delete_action="cascade" >
				<fk_column name="MaskItemId" pk="MaskItemId" />
			</fk>
			<fk name="FK_MaskItemCondition_MonitorMetaField" to_schema="SnApp.dbo" to_table="tbMetaField" >
				<fk_column name="MonitorMetaFieldId" pk="MetaFieldId" />
			</fk>
		</table>
		<table name="tbMeasure" >
			<comment><![CDATA[Definitiion of Unit Of Measurement]]></comment>
			<column name="MeasureId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MeasureCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="MeasureName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="UQ_Measure_Code" unique="UNIQUE_KEY" >
				<column name="MeasureCode" options="ASC" />
			</index>
			<index name="PK_Measure" unique="PRIMARY_KEY" >
				<column name="MeasureId" />
			</index>
		</table>
		<table name="tbMeasureConversion" >
			<comment><![CDATA[Conversion table between different units of measure. Could be linked to tbMeasureProfile or tbProduct]]></comment>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AltMeasureId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="BaseMeasureId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="BaseQuantity" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<index name="IX_MeasureConversion_AltMeasureId" unique="NORMAL" >
				<column name="AltMeasureId" options="ASC" />
			</index>
			<index name="IX_MeasureConversion_BaseMeasureId" unique="NORMAL" >
				<column name="BaseMeasureId" options="ASC" />
			</index>
			<index name="PK_MeasureConversion" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="AltMeasureId" />
			</index>
			<fk name="FK_MeasureConversion_AltMeasure" to_schema="SnApp.dbo" to_table="tbMeasure" >
				<fk_column name="AltMeasureId" pk="MeasureId" />
			</fk>
			<fk name="FK_MeasureConversion_BaseMeasure" to_schema="SnApp.dbo" to_table="tbMeasure" >
				<fk_column name="BaseMeasureId" pk="MeasureId" />
			</fk>
		</table>
		<table name="tbMeasureProfile" >
			<comment><![CDATA[Definition of common (shared) unit of measure conversion tables]]></comment>
			<column name="MeasureProfileId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MeasureProfileCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="MeasureProfileName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="BaseMeasureId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="UQ_MeasureProfile_Code" unique="UNIQUE_KEY" >
				<column name="MeasureProfileCode" options="ASC" />
			</index>
			<index name="IX_MeasureProfile_BaseMeasureId" unique="NORMAL" >
				<column name="BaseMeasureId" options="ASC" />
			</index>
			<index name="PK_MeasureProfile" unique="PRIMARY_KEY" >
				<column name="MeasureProfileId" />
			</index>
			<fk name="FK_MeasureProfile_BaseMeasure" to_schema="SnApp.dbo" to_table="tbMeasure" >
				<fk_column name="BaseMeasureId" pk="MeasureId" />
			</fk>
		</table>
		<table name="tbMedia" >
			<comment><![CDATA[Holds information about encoded medias]]></comment>
			<column name="MediaId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="TicketMediaMatchId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Portfolio owing this media]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Transaction which created (encoded) this media]]></comment>
			</column>
			<column name="TransactionArcId" prior="TransactionArcRef" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<column name="LicenseId" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Licensee which this media belongs to]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Template used to print the media]]></comment>
			</column>
			<column name="MediaType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[80] Paper Ticket, Hard Card, Wristband]]></comment>
			</column>
			<column name="MediaStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[5] Active, Reissued, Dormant, Stolen]]></comment>
			</column>
			<column name="EncodeFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Media encoding fiscal date]]></comment>
			</column>
			<column name="StationSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Serial of the station which created (encoded) the media]]></comment>
			</column>
			<column name="MediaSerial" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Serial of the media]]></comment>
			</column>
			<column name="TransactionSerial" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Serial of the transaction which created the media]]></comment>
			</column>
			<column name="PrintDateTime" type="smalldatetime" jt="93" >
				<comment><![CDATA[Media print date/time. When null means media not printed]]></comment>
			</column>
			<column name="ExclusiveUse" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Media exclusive use (no other products can be attached to the media's portfolio)]]></comment>
			</column>
			<column name="PrintAtHome" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if media is a PDF like media]]></comment>
			</column>
			<column name="ExtSystemType" type="tinyint" jt="-6" >
				<comment><![CDATA[LK[258]]]></comment>
			</column>
			<column name="MediaVersion" type="bigint" jt="-5" >
				<comment><![CDATA[Autoinc field updated everytime the media(in this specific record or any dependant) is modified. To be used for differential reports]]></comment>
			</column>
			<column name="MediaSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number generate on creation starting from 1]]></comment>
			</column>
			<column name="MediaSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with MediaSequence to create encrypted barcodes]]></comment>
			</column>
			<index name="UQ_Media_TDSSN" unique="UNIQUE_KEY" >
				<column name="EncodeFiscalDate" options="ASC" />
				<column name="LicenseId" options="ASC" />
				<column name="StationSerial" options="ASC" />
				<column name="MediaSerial" options="ASC" />
			</index>
			<index name="IX_Media_PortfolioId" unique="NORMAL" >
				<column name="TicketMediaMatchId" options="ASC" />
				<column name="EncodeFiscalDate" options="ASC" />
				<column name="PrintDateTime" options="ASC" />
			</index>
			<index name="IX_Media_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
				<column name="EncodeFiscalDate" options="ASC" />
				<column name="PrintDateTime" options="ASC" />
			</index>
			<index name="PK_Media" unique="PRIMARY_KEY" >
				<column name="MediaId" />
			</index>
			<index name="UQ_Media_MediaSequence" unique="UNIQUE_INDEX" options="WHERE MediaSequence&lt;&gt;0 INCLUDE (MediaSeed, EncodeFiscalDate)" >
				<column name="MediaSequence" />
			</index>
			<index name="IX_Media_DocTemplateId_V2" unique="NORMAL" options="where DocTemplateId is not null" >
				<column name="DocTemplateId" options="ASC" />
				<column name="EncodeFiscalDate" />
				<column name="PrintDateTime" />
			</index>
			<index name="UQ_Media_MediaVersion" unique="UNIQUE_INDEX" options="INCLUDE (EncodeFiscalDate, PrintDateTime) WHERE MediaVersion is not null" >
				<column name="MediaVersion" />
			</index>
			<index name="IX_Media_TransactionArcId" unique="NORMAL" options="WHERE TransactionArcId IS NOT NULL" >
				<column name="TransactionArcId" />
			</index>
			<fk name="FK_Media_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_Media_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="TicketMediaMatchId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_Media_License" to_schema="SnApp.dbo" to_table="tbLicense" >
				<fk_column name="LicenseId" pk="LicenseId" />
			</fk>
			<fk name="FK_Media_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbMediaCode" >
			<comment><![CDATA[List the identifiers of each media]]></comment>
			<column name="MediaCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Actual identifier of a media (like a barcode, rfid, etc).
Max length for media code is 32. But since when a media gets recycled, the media code becomes "mediacode#PNR" we leave some extra space in the table field]]></comment>
			</column>
			<column name="MediaId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Media of this identifier]]></comment>
			</column>
			<column name="MediaCodeType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[62] Barcode, RFID, MagTrack]]></comment>
			</column>
			<index name="IX_MediaCode_MediaId" unique="NORMAL" >
				<column name="MediaId" options="ASC" />
			</index>
			<index name="PK_MediaCode" unique="PRIMARY_KEY" >
				<column name="MediaCode" />
			</index>
			<fk name="FK_MediaCode_Media" to_schema="SnApp.dbo" to_table="tbMedia" delete_action="cascade" >
				<fk_column name="MediaId" pk="MediaId" />
			</fk>
		</table>
		<table name="tbMembershipPoint" >
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ParentMembershipPointId" type="uniqueidentifier" jt="1" />
			<column name="MembershipPointCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="MembershipPointName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="SystemCode" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="ValidDateFrom" type="date" jt="91" />
			<column name="ValidDateTo" type="date" jt="91" />
			<column name="RoundDecimals" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="SmallestDenomination" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<column name="RoundingType" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="AlgebraicThreshold" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<column name="DebitLedgerAccountId" type="uniqueidentifier" jt="1" />
			<column name="CreditLedgerAccountId" type="uniqueidentifier" jt="1" />
			<column name="ValidForPayment" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="ValidityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[341]]]></comment>
			</column>
			<column name="ExpirationType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[392]]]></comment>
			</column>
			<column name="ExpirationDays" type="smallint" length="1" decimal="0" jt="5" />
			<column name="ClearingProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For future use. Will point to a product to be used by the wallet clearing task. When null will use a system product.]]></comment>
			</column>
			<column name="AllowTopup" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Allow user to add reward points to a guest portfolio using the manual reward point top up feature]]></comment>
			</column>
			<column name="ExpirationManualChange" prior="AllowExpManualChange" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When checked, the expiration of the specific wallet/reward point can be manually changed.]]></comment>
			</column>
			<index name="UQ_MembershipPoint_Code" unique="UNIQUE_KEY" >
				<column name="MembershipPointCode" options="ASC" />
			</index>
			<index name="IX_MembershipPoint_DebitLedgerAccountId" unique="NORMAL" options="where DebitLedgerAccountId is not null" >
				<column name="DebitLedgerAccountId" options="ASC" />
			</index>
			<index name="IX_MembershipPoint_CreditLedgerAccountId" unique="NORMAL" options="where CreditLedgerAccountId is not null" >
				<column name="CreditLedgerAccountId" options="ASC" />
			</index>
			<index name="IX_MembershipPoint_ClearingProductId" unique="NORMAL" options="where ClearingProductId is not null" >
				<column name="ClearingProductId" options="ASC" />
			</index>
			<index name="PK_MembershipPoint" unique="PRIMARY_KEY" >
				<column name="MembershipPointId" />
			</index>
			<index name="IX_MembershipPoint_ParentMembershipPointId" unique="NORMAL" >
				<column name="ParentMembershipPointId" />
			</index>
			<fk name="FK_MembershipPoint_ClearingProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ClearingProductId" pk="ProductId" />
			</fk>
			<fk name="FK_MembershipPoint_DebitLedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="DebitLedgerAccountId" pk="LedgerAccountId" />
			</fk>
			<fk name="FK_MembershipPoint_CreditLedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="CreditLedgerAccountId" pk="LedgerAccountId" />
			</fk>
			<fk name="FK_MembershipPoint_Parent" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="ParentMembershipPointId" pk="MembershipPointId" />
			</fk>
		</table>
		<table name="tbMembershipPointAccrualRule" prior="Tbl" >
			<comment><![CDATA[Contains the rules to manage the reward point accrual]]></comment>
			<column name="MembershipPointAccrualRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Rule unique identifier]]></comment>
			</column>
			<column name="MembershipPointAccrualRuleStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[504]]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the priviledge card product type]]></comment>
			</column>
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the membership point]]></comment>
			</column>
			<column name="ExchangeRate" type="decimal" length="38" decimal="19" jt="3" mandatory="y" >
				<comment><![CDATA[The number of points earn for every dollar of the product price]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[The rule is valid from this date. Infinite if is null.]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[The rule is valid to this date. Infinite if is null.]]></comment>
			</column>
			<column name="CalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the calendar]]></comment>
			</column>
			<column name="RestrictPaymentMethodsType" type="smallint" jt="5" >
				<comment><![CDATA[LK[508]]]></comment>
			</column>
			<index name="PK_MembershipPointAccrualRule" unique="PRIMARY_KEY" >
				<column name="MembershipPointAccrualRuleId" />
			</index>
			<index name="IX_MembershipPointAccrualRule_CalendarId" unique="NORMAL" options="where CalendarId is not null" >
				<column name="CalendarId" />
				<column name="MembershipPointAccrualRuleStatus" />
			</index>
			<index name="IX_tbMembershipPointAccrualRule_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" />
				<column name="ProductId" />
				<column name="MembershipPointAccrualRuleStatus" />
			</index>
			<index name="IX_tbMembershipPointAccrualRule_ProductId" unique="NORMAL" >
				<column name="ProductId" />
				<column name="MembershipPointId" />
				<column name="MembershipPointAccrualRuleStatus" />
			</index>
			<fk name="FK_MembershipPointAccrualRule_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
			<fk name="FK_MembershipPointAccrualRule_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_MembershipPointAccrualRule_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbMembershipPointAccrualRule2PaymentMethod" prior="Tbl" >
			<comment><![CDATA[Link table  membership point accrual rule to payment method]]></comment>
			<column name="MembershipPointAccrualRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Membership point accrual rule unique identifier]]></comment>
			</column>
			<column name="PaymentMethodId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Payment method unique identifier]]></comment>
			</column>
			<index name="PK_MembershipPointAccrualRule2PaymentMethod" unique="PRIMARY_KEY" >
				<column name="MembershipPointAccrualRuleId" />
				<column name="PaymentMethodId" />
			</index>
			<index name="IX_MembershipPointAccrualRule2PaymentMethod_PaymentMethodId" unique="NORMAL" >
				<column name="PaymentMethodId" />
			</index>
			<fk name="FK_MembershipPointAccrualRule2PaymentMethod_MembershipPointAccrualRule" to_schema="SnApp.dbo" to_table="tbMembershipPointAccrualRule" delete_action="cascade" >
				<fk_column name="MembershipPointAccrualRuleId" pk="MembershipPointAccrualRuleId" />
			</fk>
			<fk name="FK_MembershipPointAccrualRule2PaymentMethod_PaymentMethod" to_schema="SnApp.dbo" to_table="tbPluginPaymentMethod" delete_action="cascade" >
				<fk_column name="PaymentMethodId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbMembershipPointExchangeRate" prior="Tbl" >
			<comment><![CDATA[It's the calendar/date based table to identify which exchange rate to apply to a specific membership point.]]></comment>
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to a specifit membership point]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting]]></comment>
			</column>
			<column name="ExchangeRate" type="decimal" length="38" decimal="19" jt="3" mandatory="y" >
				<comment><![CDATA[Exchange rate]]></comment>
			</column>
			<column name="CalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to a specific calendar]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Start date. Null = no limit]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[End date. Null = no limit]]></comment>
			</column>
			<index name="IX_MembershipPointExchangeRate_CalendarId" unique="NORMAL" options="where CalendarId is not null" >
				<column name="CalendarId" />
			</index>
			<index name="PK_MembershipPointExchangeRate" unique="PRIMARY_KEY" >
				<column name="MembershipPointId" />
				<column name="PriorityOrder" />
			</index>
			<fk name="FK_MembershipPointExchangeRate_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" delete_action="cascade" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
			<fk name="FK_MembershipPointExchangeRate_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
		</table>
		<table name="tbMerchant" >
			<column name="MerchantId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LocationId" type="uniqueidentifier" jt="1" />
			<column name="OperatingAreaId" type="uniqueidentifier" jt="1" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CardType" type="smallint" jt="5" >
				<comment><![CDATA[LK[253]]]></comment>
			</column>
			<column name="MerchantCategory" type="varchar" length="10" jt="12" />
			<column name="MerchantCode" type="varchar" length="30" decimal="0" jt="12" mandatory="y" />
			<column name="MerchantTerminalId" type="varchar" length="15" jt="12" />
			<column name="MerchantStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[430]]]></comment>
			</column>
			<index name="IX_Merchant_LocationId" unique="NORMAL" >
				<column name="LocationId" options="ASC" />
				<column name="OperatingAreaId" options="ASC" />
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_Merchant_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="PK_Merchant" unique="PRIMARY_KEY" >
				<column name="MerchantId" />
			</index>
			<fk name="FK_Merchant_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_Merchant_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OperatingAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_Merchant_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Merchant_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbMessage" >
			<column name="MessageId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CategoryId" type="uniqueidentifier" jt="1" />
			<column name="MessageType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[25] (Not Used)]]></comment>
			</column>
			<column name="MessageName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="ForcePopupDialog" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="DateTimeFrom" type="smalldatetime" jt="93" mandatory="y" />
			<column name="DateTimeTo" type="smalldatetime" jt="93" />
			<column name="Message" type="nvarchar(max)" jt="12" />
			<column name="LastUpdate" type="smalldatetime" jt="93" mandatory="y" />
			<index name="IX_Message_DateTimeFrom" unique="NORMAL" >
				<column name="DateTimeFrom" options="ASC" />
			</index>
			<index name="IX_Message_LastUpdate" unique="NORMAL" >
				<column name="LastUpdate" options="ASC" />
			</index>
			<index name="IX_Message_CategoryId" unique="NORMAL" >
				<column name="CategoryId" options="ASC" />
			</index>
			<index name="PK_Message" unique="PRIMARY_KEY" >
				<column name="MessageId" />
			</index>
			<fk name="FK_Message_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbMessageRead" >
			<column name="MessageId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ReadDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<index name="IX_MessageRead_UserAccountId" unique="NORMAL" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="IX_MessageRead_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="PK_MessageRead" unique="PRIMARY_KEY" >
				<column name="MessageId" />
				<column name="UserAccountId" />
			</index>
			<fk name="FK_MessageRead_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_MessageRead_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_MessageRead_Message" to_schema="SnApp.dbo" to_table="tbMessage" delete_action="cascade" >
				<fk_column name="MessageId" pk="MessageId" />
			</fk>
		</table>
		<table name="tbMetaData" >
			<comment><![CDATA[Holds users defined field's data]]></comment>
			<column name="EntityId" type="uniqueidentifier" length="1" decimal="0" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the object this data is attached to]]></comment>
			</column>
			<column name="MetaFieldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the field definition]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131] nature of the object this data is attached to]]></comment>
			</column>
			<column name="ShortValue" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Data]]></comment>
			</column>
			<column name="LongValue" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[In case ShortValue was not enough, this containts the full data]]></comment>
			</column>
			<column name="CryptoKeyId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[In case the field was set to encrypt data, this field indicates the key used for the encryption]]></comment>
			</column>
			<index name="IX_MetaData_MetaFieldId" unique="NORMAL" >
				<column name="MetaFieldId" options="ASC" />
				<column name="ShortValue" options="ASC" />
				<column name="EntityType" options="ASC" />
			</index>
			<index name="IX_MetaData_CryptoKeyId" unique="NORMAL" options="where CryptoKeyId is not null" >
				<column name="CryptoKeyId" options="ASC" />
			</index>
			<index name="PK_MetaData" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="MetaFieldId" />
			</index>
			<fk name="FK_MetaData_MetaField" to_schema="SnApp.dbo" to_table="tbMetaField" >
				<fk_column name="MetaFieldId" pk="MetaFieldId" />
			</fk>
			<fk name="FK_MetaData_CryptoKey" to_schema="SnApp.dbo" to_table="tbCryptoKey" >
				<fk_column name="CryptoKeyId" pk="CryptoKeyId" />
			</fk>
		</table>
		<table name="tbMetaField" >
			<comment><![CDATA[Holds user defined fields]]></comment>
			<column name="MetaFieldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="MetaFieldCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="MetaFieldName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the field]]></comment>
			</column>
			<column name="FieldType" type="smallint" jt="5" >
				<comment><![CDATA[LK[9] (FirstName, LastName, Etc)]]></comment>
			</column>
			<column name="FieldDataType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[8] (Text, Numeric, Etc...)]]></comment>
			</column>
			<column name="FieldDataFormat" type="smallint" jt="5" >
				<comment><![CDATA[LK[270]]]></comment>
			</column>
			<column name="PurgeOption" type="smallint" jt="5" >
				<comment><![CDATA[LK[474]]]></comment>
			</column>
			<column name="SearchWeight" type="tinyint" length="1" decimal="0" jt="-6" >
				<comment><![CDATA[Used in account de-duplication search]]></comment>
			</column>
			<column name="RandomCombine" type="tinyint" length="1" decimal="0" jt="-6" >
				<comment><![CDATA[Used only for FieldType=Random.
Indicates how many of the MetaFieldItems should be combined togheter in order to generate the random value]]></comment>
			</column>
			<column name="MaxLength" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Defines field length limit for a specific meta data field]]></comment>
			</column>
			<column name="MetaFieldGroupId" type="uniqueidentifier" jt="1" />
			<column name="MaskingRule" type="smallint" jt="5" >
				<comment><![CDATA[LK[450] (General, Dynamic)]]></comment>
			</column>
			<column name="MaskStartChars" prior="StartUnmaskedChars" type="smallint" jt="5" >
				<comment><![CDATA[Number of chars not to be masked at the beginning of the text]]></comment>
			</column>
			<column name="MaskEndChars" prior="EndUnmaskedChars" type="smallint" jt="5" >
				<comment><![CDATA[Number of chars not to be masked at the end of the text]]></comment>
			</column>
			<column name="MaskSplitWords" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Mask each single word]]></comment>
			</column>
			<column name="MaskMinChars" type="smallint" jt="5" >
				<comment><![CDATA[Minimum number of chars to be masked]]></comment>
			</column>
			<column name="MaskMinCharsAlign" type="smallint" jt="5" >
				<comment><![CDATA[LK[451] Alignment type of the minimum number of chars to be masked]]></comment>
			</column>
			<column name="MaskingRulePluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the plugin used to mask this field]]></comment>
			</column>
			<index name="UQ_MetaField_Code" unique="UNIQUE_KEY" >
				<column name="MetaFieldCode" options="ASC" />
			</index>
			<index name="IX_MetaField_FieldDataType" unique="NORMAL" >
				<column name="FieldDataType" options="ASC" />
			</index>
			<index name="PK_MetaField" unique="PRIMARY_KEY" >
				<column name="MetaFieldId" />
			</index>
			<index name="IX_MetaField_MetaFieldGroupId" unique="NORMAL" options="where MetaFieldGroupId is not null" >
				<column name="MetaFieldGroupId" />
			</index>
			<index name="IX_MetaField_MaskingRulePluginId" unique="NORMAL" >
				<column name="MaskingRulePluginId" />
			</index>
			<fk name="FK_MetaField_MetaFieldGroup" to_schema="SnApp.dbo" to_table="tbMetaFieldGroup" >
				<fk_column name="MetaFieldGroupId" pk="MetaFieldGroupId" />
			</fk>
			<fk name="FK_MetaField_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="MaskingRulePluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbMetaFieldFlag" >
			<column name="MetaFieldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to meta field]]></comment>
			</column>
			<column name="MetaFieldFlag" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[398]]]></comment>
			</column>
			<index name="PK_MetaFieldFlag" unique="PRIMARY_KEY" >
				<column name="MetaFieldId" />
				<column name="MetaFieldFlag" />
			</index>
			<index name="IX_MetaFieldFlag_MetaFieldFlag" unique="NORMAL" >
				<column name="MetaFieldFlag" />
			</index>
			<fk name="FK_MetaFieldFlag_MetaField" to_schema="SnApp.dbo" to_table="tbMetaField" delete_action="cascade" >
				<fk_column name="MetaFieldId" pk="MetaFieldId" />
			</fk>
		</table>
		<table name="tbMetaFieldGroup" prior="Tbl" >
			<comment><![CDATA[Defines groups of metafields for searches]]></comment>
			<column name="MetaFieldGroupId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MetaFieldGroupCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="MetaFieldGroupName" type="nvarchar" length="50" jt="12" />
			<column name="SearchMatchType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[449] FullMatch, StartsWith]]></comment>
			</column>
			<index name="PK_MetaFieldGroup" unique="PRIMARY_KEY" >
				<column name="MetaFieldGroupId" />
			</index>
			<index name="UQ_MetaFieldGroup_MetaFieldGroupCode" unique="UNIQUE_INDEX" >
				<column name="MetaFieldGroupCode" />
			</index>
		</table>
		<table name="tbMetaFieldItem" >
			<comment><![CDATA[For metafields such as Single/Multiplechoice, stores the list of configures values]]></comment>
			<column name="MetaFieldItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="MetaFieldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the meta field]]></comment>
			</column>
			<column name="MetaFieldItemCode" type="varchar" length="15" jt="12" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="MetaFieldItemName" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Item name]]></comment>
			</column>
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Sorting within meta field]]></comment>
			</column>
			<index name="UQ_MetaFieldItem_Code" unique="UNIQUE_KEY" options="where MetaFieldItemCode is not null" >
				<column name="MetaFieldId" options="ASC" />
				<column name="MetaFieldItemCode" options="ASC" />
			</index>
			<index name="IX_MetaFieldItem_PriorityOrder" unique="NORMAL" >
				<column name="MetaFieldId" options="ASC" />
				<column name="PriorityOrder" options="ASC" />
				<column name="MetaFieldItemName" options="ASC" />
			</index>
			<index name="PK_MetaFieldItem" unique="PRIMARY_KEY" >
				<column name="MetaFieldItemId" />
			</index>
			<fk name="FK_MetaFieldItem_MetaField" to_schema="SnApp.dbo" to_table="tbMetaField" delete_action="cascade" >
				<fk_column name="MetaFieldId" pk="MetaFieldId" />
			</fk>
		</table>
		<table name="tbNote" >
			<column name="NoteId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[ID of the entity this note is attached to]]></comment>
			</column>
			<column name="NoteDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/time of when the note was created]]></comment>
			</column>
			<column name="NoteType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Define the note type (ex. Standard, Highlighted, etc...)]]></comment>
			</column>
			<column name="Note" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[Text/content of the note]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[User that wrote the note]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Workstation from which the note was written]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Transaction in which the note was written]]></comment>
			</column>
			<index name="IX_Note_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_Note_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="IX_Note_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="NoteDateTime" options="ASC" />
			</index>
			<index name="IX_Note_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="PK_Note" unique="PRIMARY_KEY" >
				<column name="NoteId" />
			</index>
			<fk name="FK_Note_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Note_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Note_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbNotifyLog" >
			<comment><![CDATA[Logs events happened according to what is configured in tbNotifyRule]]></comment>
			<column name="NotifyLogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the notification rule triggered]]></comment>
			</column>
			<column name="NotifyDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/time about when the event happened]]></comment>
			</column>
			<column name="ServerDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/time about when the record was saved at DB]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the workstation where the event happened]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[User logged in when the event happend]]></comment>
			</column>
			<column name="EmailSent" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if an email notification has been sent]]></comment>
			</column>
			<column name="SmsSent" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if an sms notification has been sent]]></comment>
			</column>
			<column name="DocData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Additional info in JSON]]></comment>
			</column>
			<column name="ActionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the generated action (email)]]></comment>
			</column>
			<index name="IX_NotifyLog_NotifyDateTime" unique="NORMAL" >
				<column name="NotifyDateTime" options="ASC" />
			</index>
			<index name="IX_NotifyLog_NotifyRuleId" unique="NORMAL" >
				<column name="NotifyRuleId" options="ASC" />
				<column name="NotifyDateTime" options="ASC" />
			</index>
			<index name="IX_NotifyLog_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="NotifyDateTime" options="ASC" />
			</index>
			<index name="IX_NotifyLog_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
				<column name="NotifyDateTime" options="ASC" />
			</index>
			<index name="IX_NotifyLog_ServerDateTime" unique="NORMAL" >
				<column name="ServerDateTime" options="ASC" />
			</index>
			<index name="PK_NotifyLog" unique="PRIMARY_KEY" >
				<column name="NotifyLogId" />
			</index>
			<index name="IX_NotifyLog_ActionId" unique="NORMAL" options="where ActionId is not null" >
				<column name="ActionId" />
			</index>
			<fk name="FK_NotifyLog_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_NotifyLog_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_NotifyLog_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
			<fk name="FK_NotifyLog_Action" to_schema="SnApp.dbo" to_table="tbAction" delete_action="setNull" >
				<fk_column name="ActionId" pk="ActionId" />
			</fk>
		</table>
		<table name="tbNotifyLogRef" >
			<column name="NotifyLogId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notify-log record]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to generic entity]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="NotifyDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Redund tbNotifyLog.NotifyDateTime]]></comment>
			</column>
			<column name="Invalidated" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates that the reference changed and needs to be re-notified.
Only used in particular cases, like Performance notifications]]></comment>
			</column>
			<index name="IX_NotifyLogRef_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="NotifyDateTime" options="ASC" />
			</index>
			<index name="PK_NotifyLogRef" unique="PRIMARY_KEY" >
				<column name="NotifyLogId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_NotifyLogRef_NotifyLog" to_schema="SnApp.dbo" to_table="tbNotifyLog" delete_action="cascade" >
				<fk_column name="NotifyLogId" pk="NotifyLogId" />
			</fk>
		</table>
		<table name="tbNotifyRule" >
			<comment><![CDATA[Definitions for notification rules]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Notification rule internal ID]]></comment>
			</column>
			<column name="NotifyRuleType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[321] EntityChange, Redemption, Sales]]></comment>
			</column>
			<column name="NotifyRuleName" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Notification rule name]]></comment>
			</column>
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Active / Inactive flag]]></comment>
			</column>
			<column name="SendEmail" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Send e-mail flag]]></comment>
			</column>
			<column name="SendSMS" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Send SMS flag]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Date from which the rule is considered active. When null, then rule is always active]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[Date until which the rule is considered active. When null, then rule is always active]]></comment>
			</column>
			<column name="DocData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[JSON object for NotifyRuleType specific settings]]></comment>
			</column>
			<index name="PK_NotifyRule" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
			</index>
		</table>
		<table name="tbNotifyRule2Category" prior="tbNotifyRule2Location_0" >
			<comment><![CDATA[List of trigger categories linked to the specific notify rule]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="CategoryId" prior="LocationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to category]]></comment>
			</column>
			<index name="PK_NotifyRule2Category" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
				<column name="CategoryId" />
			</index>
			<index name="IX_NotifyRule2Category_CategoryId" unique="NORMAL" >
				<column name="CategoryId" />
			</index>
			<fk name="FK_NotifyRule2Category_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
			<fk name="FK_NotifyRule2Category_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbNotifyRule2Event" prior="tbNotifyRule2Category_0" >
			<comment><![CDATA[List of trigger events linked to the specific notify rule]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="EventId" prior="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to event]]></comment>
			</column>
			<index name="PK_NotifyRule2Event" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
				<column name="EventId" />
			</index>
			<index name="IX_NotifyRule2Event_EventId" unique="NORMAL" >
				<column name="EventId" />
			</index>
			<fk name="FK_NotifyRule2Event_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
			<fk name="FK_NotifyRule2Event_Event" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
		</table>
		<table name="tbNotifyRule2Location" prior="Tbl" >
			<comment><![CDATA[List of trigger locations linked to the specific notify rule]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="LocationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to location]]></comment>
			</column>
			<index name="PK_NotifyRule2Location" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
				<column name="LocationId" />
			</index>
			<index name="IX_NotifyRule2Location_LocationId" unique="NORMAL" >
				<column name="LocationId" />
			</index>
			<fk name="FK_NotifyRule2Location_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
			<fk name="FK_NotifyRule2Location_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbNotifyRuleEntityChange" >
			<comment><![CDATA[List of entity types "listened" for change.
Used when tbNotifyRuleType=EntityChange]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="PK_NotifyRuleEntityChange" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
			</index>
			<fk name="FK_NotifyRuleEntityChange_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
		</table>
		<table name="tbNotifyRuleFlag" prior="Tbl" >
			<comment><![CDATA[List of flags used either as filters and triggers for the specific notification rule]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="NotifyRuleFlag" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[467] (Filter_Used, Filter_Approved, Filter_Paid, Trigger_Paid, etc.)]]></comment>
			</column>
			<index name="PK_NotifyRuleFlag" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
				<column name="NotifyRuleFlag" />
			</index>
			<fk name="FK_NotifyRuleFlag_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
		</table>
		<table name="tbNotifyRuleOrder" >
			<comment><![CDATA[List of notify rules specific for orders]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the specific doc template to be sent]]></comment>
			</column>
			<column name="NotifyRuleOrderTriggerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[466] (OrderStatusChange, DaysFromVisitDate)]]></comment>
			</column>
			<column name="OrderNotificationRecipientType" prior="SaleAccountType" type="smallint" jt="5" >
				<comment><![CDATA[LK[470] (Sale receipt address, Guest, Owner)]]></comment>
			</column>
			<column name="AlternativeEmailAddress" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Fixed email address]]></comment>
			</column>
			<column name="TransactionType" type="smallint" jt="5" >
				<comment><![CDATA[LK[3] (Normal, Upgrade, etc.)]]></comment>
			</column>
			<column name="WorkstationType" type="smallint" jt="5" >
				<comment><![CDATA[LK[19] (POS, B2B, etc.)]]></comment>
			</column>
			<column name="LocationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to location]]></comment>
			</column>
			<column name="OpAreaId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the operation area]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to workstation]]></comment>
			</column>
			<column name="DocData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[JSON object for NotifyRuleOrder specific settings, for example DaysFromVisitDate or FilterBySellingChannel]]></comment>
			</column>
			<index name="IX_NotifyRuleOrder_DocTemplateId" unique="NORMAL" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="PK_NotifyRuleOrder" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
			</index>
			<index name="IX_NotifyRuleOrder_LocationId" unique="NORMAL" options="where LocationId is not null" >
				<column name="LocationId" />
			</index>
			<index name="IX_NotifyRuleOrder_OpArea" unique="NORMAL" options="where OpAreaId is not null" >
				<column name="OpAreaId" />
			</index>
			<index name="IX_NotifyRuleOrder_Workstation" unique="NORMAL" options="where WorkstationId is not null" >
				<column name="WorkstationId" />
			</index>
			<fk name="FK_NotifyRuleOrder_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
			<fk name="FK_NotifyRuleOrder_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
			<fk name="FK_NotifyRuleOrder_AccountLocation" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_NotifyRuleOrder_AccountOpArea" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_NotifyRuleOrder_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbNotifyRuleOrder2Sale" prior="Tbl" >
			<comment><![CDATA[List of all notifications already sent, filled only when RuleOrderTriggerType is different from "OrderStatusChange"]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="NotifyRuleOrderTriggerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[466] (OrderSatusChange, DaysFromVistitDate)]]></comment>
			</column>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to order]]></comment>
			</column>
			<column name="NotifyDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/time of when the notification was sent]]></comment>
			</column>
			<index name="PK_NotifyRuleOrder2Sale" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
				<column name="NotifyRuleOrderTriggerType" />
				<column name="SaleId" />
			</index>
			<index name="IX_NotifyRuleOrder2Sale_SaleId" unique="NORMAL" >
				<column name="SaleId" />
				<column name="NotifyDateTime" />
			</index>
			<fk name="FK_NotifyRuleOrder2Sale_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
			<fk name="FK_NotifyRuleOrder2Sale_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
		</table>
		<table name="tbNotifyRuleRedemption2Type" >
			<comment><![CDATA[List of redemption event to be listening to.
Used when tbNotifyRuleType=Redemption]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="NotifyRedemptionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[324] Stolen, Void, Lost]]></comment>
			</column>
			<index name="PK_NotifyRuleRedemption2Type" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
			</index>
			<fk name="FK_NotifyRuleRedemption2Type_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
		</table>
		<table name="tbNotifyRuleSale" >
			<comment><![CDATA[List of sale/operator events to be listening to
Used when tbNotifyRuleType=Sale]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="NotifySaleType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[325] Drawer, Lookup]]></comment>
			</column>
			<column name="NotifySaleFrequency" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[IE: if NotifySaleFrequency=2 and NotifySaleRange=HOUR, it means "notify if the event occurs at least 2 times in an hour"]]></comment>
			</column>
			<column name="NotifySaleRange" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[326] hour, day, week, month]]></comment>
			</column>
			<column name="NotifySaleConfig" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[JSON for additional event configuration/filtering]]></comment>
			</column>
			<index name="PK_NotifyRuleSale" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
			</index>
			<fk name="FK_NotifyRuleSale_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
		</table>
		<table name="tbNotifyRuleUser" >
			<comment><![CDATA[List of users / roles which will be notified by the notification rule]]></comment>
			<column name="NotifyRuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to notification rule]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the "listening" entity (user / role)]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="PK_NotifyRuleUser" unique="PRIMARY_KEY" >
				<column name="NotifyRuleId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_NotifyRuleUser_NotifyRule" to_schema="SnApp.dbo" to_table="tbNotifyRule" delete_action="cascade" >
				<fk_column name="NotifyRuleId" pk="NotifyRuleId" />
			</fk>
		</table>
		<table name="tbOpArea2AccessArea" >
			<comment><![CDATA[N to N relationsship between Operating Areas and Access Areas.
Used as a default for access points beloning to the operating area]]></comment>
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the operating area]]></comment>
			</column>
			<column name="AccessAreaId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the access area]]></comment>
			</column>
			<index name="IX_OpArea2AccessArea_AccessAreaId" unique="NORMAL" >
				<column name="AccessAreaId" options="ASC" />
			</index>
			<index name="PK_OpArea2AccessArea" unique="PRIMARY_KEY" >
				<column name="OpAreaId" />
				<column name="AccessAreaId" />
			</index>
			<fk name="FK_OpArea2AccessArea_OpArea" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_OpArea2AccessArea_AccessArea" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccessAreaId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbOpArea2Role" >
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RoleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OpAreaRoleType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[291]]]></comment>
			</column>
			<index name="IX_OpArea2Role_RoleId" unique="NORMAL" >
				<column name="RoleId" options="ASC" />
				<column name="OpAreaRoleType" options="ASC" />
			</index>
			<index name="PK_OpArea2Role" unique="PRIMARY_KEY" >
				<column name="OpAreaId" />
				<column name="RoleId" />
				<column name="OpAreaRoleType" />
			</index>
			<fk name="FK_OpArea2Role_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_OpArea2Role_Role" to_schema="SnApp.dbo" to_table="tbRole" >
				<fk_column name="RoleId" pk="RoleId" />
			</fk>
		</table>
		<table name="tbOpArea2User" prior="tbAccount2OpArea" >
			<comment><![CDATA[Consolidate rights data to simplify link between op.areas and users allowed to log in to them]]></comment>
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="PK_OpArea2User" unique="PRIMARY_KEY" >
				<column name="OpAreaId" />
				<column name="UserAccountId" />
			</index>
			<index name="IX_OpArea2User_UserAccountId" unique="NORMAL" >
				<column name="UserAccountId" />
			</index>
			<fk name="FK_OpArea2User_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_OpArea2User_Login" to_schema="SnApp.dbo" to_table="tbLogin" delete_action="cascade" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbOptionSet" >
			<column name="OptionSetId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OptionsDesc" type="nvarchar" length="4000" decimal="0" jt="12" mandatory="y" />
			<index name="PK_OptionSet" unique="PRIMARY_KEY" >
				<column name="OptionSetId" />
			</index>
		</table>
		<table name="tbOptionSetDetail" >
			<column name="OptionSetId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_OptionSetDetail_AttributeItemId" unique="NORMAL" >
				<column name="AttributeItemId" options="ASC" />
			</index>
			<index name="PK_OptionSetDetail" unique="PRIMARY_KEY" >
				<column name="OptionSetId" />
				<column name="AttributeItemId" />
			</index>
			<fk name="FK_OptionSetDetail_AttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="AttributeItemId" pk="AttributeItemId" />
			</fk>
			<fk name="FK_OptionSetDetail_OptionSet" to_schema="SnApp.dbo" to_table="tbOptionSet" delete_action="cascade" >
				<fk_column name="OptionSetId" pk="OptionSetId" />
			</fk>
		</table>
		<table name="tbOutboundMessage" >
			<comment><![CDATA[Enlist outbound message types handled in the system]]></comment>
			<column name="OutboundMessageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="OutboundMessageCode" type="varchar" length="100" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Message type code]]></comment>
			</column>
			<column name="OutboundMessageName" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Message type name]]></comment>
			</column>
			<column name="OutboundMessageStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[329]]]></comment>
			</column>
			<column name="OutboundMessagePriority" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[328]]]></comment>
			</column>
			<column name="WorkerClassName" type="varchar" length="100" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Internal java class representing the messate type handler]]></comment>
			</column>
			<column name="Itemized" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if stacked vs itemized message]]></comment>
			</column>
			<column name="OutboundMessageDesc" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Message type description]]></comment>
			</column>
			<column name="ExtensionPackageId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the external package owning this message type]]></comment>
			</column>
			<column name="BrokerPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the broker in charge to dispatch the message]]></comment>
			</column>
			<column name="DataSourceId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Connection datasource to be queried for filling the message. When null, main/prod connection will be used]]></comment>
			</column>
			<index name="UQ_OutboudMessage_Code" unique="UNIQUE_KEY" >
				<column name="OutboundMessageCode" options="ASC" />
			</index>
			<index name="IX_OutboundMessage_ExtensionPackageId" unique="NORMAL" options="where ExtensionPackageId is not null" >
				<column name="ExtensionPackageId" options="ASC" />
			</index>
			<index name="IX_OutboundMessage_DataSourceId" unique="NORMAL" options="where DataSourceId is not null" >
				<column name="DataSourceId" options="ASC" />
			</index>
			<index name="PK_OutboundMessage" unique="PRIMARY_KEY" >
				<column name="OutboundMessageId" />
			</index>
			<index name="IX_OutboundMessage_BrokerPluginId" unique="NORMAL" >
				<column name="BrokerPluginId" />
			</index>
			<fk name="FK_OutboundMessage_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="BrokerPluginId" pk="PluginId" />
			</fk>
			<fk name="FK_OutboundMessage_ExtensionPackage" to_schema="SnApp.dbo" to_table="tbExtensionPackage" >
				<fk_column name="ExtensionPackageId" pk="ExtensionPackageId" />
			</fk>
			<fk name="FK_OutboundMessage_DataSource" to_schema="SnApp.dbo" to_table="tbDataSource" >
				<fk_column name="DataSourceId" pk="DataSourceId" />
			</fk>
		</table>
		<table name="tbOutboundOffline" >
			<column name="OutboundOfflineId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Unique ID]]></comment>
			</column>
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Creation date/time]]></comment>
			</column>
			<column name="OutboundOfflineStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[364] Waiting, Working, Succeded, Failed]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the entity subject of this message (ie: transaction)]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Reference to the server which is processing this item]]></comment>
			</column>
			<column name="DocRef" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Entity subject of this message (ie: transaction)]]></comment>
			</column>
			<column name="DocRefClassName" type="varchar" length="255" decimal="0" jt="12" >
				<comment><![CDATA[Java class name of the entity]]></comment>
			</column>
			<column name="OutboundEventType" type="smallint" jt="5" >
				<comment><![CDATA[LK[342]]]></comment>
			</column>
			<column name="CorrelationId" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Passthrough information to be included in the outbound message]]></comment>
			</column>
			<column name="SuppressEvent" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Passthrough information to be included in the outbound message]]></comment>
			</column>
			<index name="IX_OutboundOffline_OutboundOfflineStatus" unique="NORMAL" >
				<column name="OutboundOfflineStatus" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundOffline_ServerId" unique="NORMAL" options="where ServerId is not null" >
				<column name="ServerId" options="ASC" />
			</index>
			<index name="PK_OutboundOffline" unique="PRIMARY_KEY" >
				<column name="OutboundOfflineId" />
			</index>
			<fk name="FK_OutboundOffline_Server" to_schema="SnApp.dbo" to_table="tbServer" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbOutboundQueue" >
			<comment><![CDATA[Enlist triggered outbound messages]]></comment>
			<column name="OutboundQueueId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="OutboundMessageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the message type]]></comment>
			</column>
			<column name="OutboundQueueStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[327]]]></comment>
			</column>
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Creation date/time]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the entity subject of this message (ie: transaction)]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityLastUpdate" type="datetime" jt="92" >
				<comment><![CDATA[Entity's last update date time. Used only for "update" events (ie: product type change)]]></comment>
			</column>
			<column name="EntityRef" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Alternatively to EntityLastUpdate, contains a reference to check if the record in replica db is up to date]]></comment>
			</column>
			<column name="OutboundEventType" type="smallint" jt="5" >
				<comment><![CDATA[LK[342]]]></comment>
			</column>
			<column name="FailedAttemptCount" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Number of failed message deliverings]]></comment>
			</column>
			<column name="DocRef" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[When an item is pushed to the queue, it might already have a small data object base on memry information]]></comment>
			</column>
			<column name="DocData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Content of the message]]></comment>
			</column>
			<column name="CorrelationId" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[Passthrough of "CorrelationId" field in API header]]></comment>
			</column>
			<column name="RecoveryJobId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the "Outbound recovery" task-job which re-pushed the event]]></comment>
			</column>
			<column name="SuppressEvent" type="bit" length="1" jt="-7" >
				<comment><![CDATA[Passthrough of "SuppressEvent" field in API header]]></comment>
			</column>
			<index name="IX_OutboundQueue_CreateDateTime" unique="NORMAL" >
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundQueue_OutboundMessageId" unique="NORMAL" >
				<column name="OutboundMessageId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundQueue_Status" unique="NORMAL" >
				<column name="OutboundQueueStatus" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundQueue_CorrelationId" unique="NORMAL" options="where CorrelationId is not null" >
				<column name="CorrelationId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundQueue_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_OutboundQueue" unique="PRIMARY_KEY" >
				<column name="OutboundQueueId" />
			</index>
			<index name="IX_OutboundQueue_RecoveryJobId" unique="NORMAL" options="where RecoveryJobId is not null" >
				<column name="RecoveryJobId" />
				<column name="CreateDateTime" />
			</index>
			<fk name="FK_OutboundQueue_OutboundMessage" to_schema="SnApp.dbo" to_table="tbOutboundMessage" delete_action="cascade" >
				<fk_column name="OutboundMessageId" pk="OutboundMessageId" />
			</fk>
			<fk name="FK_OutboundQueue_Job" to_schema="SnApp.dbo" to_table="tbJob" >
				<fk_column name="RecoveryJobId" pk="JobId" />
			</fk>
		</table>
		<table name="tbOutboundQueueHistory" >
			<comment><![CDATA[History of actions made on a outbound queue item. This is the table actually polled by the oubound queue task]]></comment>
			<column name="OutboundQueueHistoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="OutboundQueueId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the outbound queue item]]></comment>
			</column>
			<column name="OutboundQueueHistoryStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[327]]]></comment>
			</column>
			<column name="OutboundMessagePriority" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[328]]]></comment>
			</column>
			<column name="OutboundQueueAction" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[332]]]></comment>
			</column>
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Creation date/time]]></comment>
			</column>
			<column name="ScheduleDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Delivery scheduled date/time. If null it matches with CreateDateTime]]></comment>
			</column>
			<column name="StartDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Message handling/production/delivery start time]]></comment>
			</column>
			<column name="EndDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Message handling/production/delivery end time]]></comment>
			</column>
			<column name="DataSourceId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Connection datasource to be queried for filling the message. When null, main/prod connection will be used]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Reference to the server which is processing this item]]></comment>
			</column>
			<column name="RequestData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Broker request data]]></comment>
			</column>
			<column name="ResponseData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Broker response data]]></comment>
			</column>
			<column name="Notes" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[User notes]]></comment>
			</column>
			<column name="UserAccountName" type="nvarchar" length="100" jt="12" />
			<index name="IX_OutboundQueueHistory_OutboundQueueId" unique="NORMAL" >
				<column name="OutboundQueueId" options="ASC" />
			</index>
			<index name="IX_OutboundQueueHistory_Waiting" unique="NORMAL" >
				<column name="OutboundQueueHistoryStatus" options="ASC" />
				<column name="ScheduleDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundQueueHistory_WaitingByPriority" unique="NORMAL" >
				<column name="OutboundQueueHistoryStatus" options="ASC" />
				<column name="OutboundMessagePriority" options="ASC" />
				<column name="ScheduleDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundQueueHistory_ServerId" unique="NORMAL" options="where ServerId is not null" >
				<column name="ServerId" options="ASC" />
				<column name="OutboundQueueHistoryStatus" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundQueueHistory_DataSourceId" unique="NORMAL" options="where DataSourceId is not null" >
				<column name="DataSourceId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="PK_OutboundQueueHistory" unique="PRIMARY_KEY" >
				<column name="OutboundQueueHistoryId" />
				<column name="OutboundQueueId" />
			</index>
			<index name="Unq_tbOutboundQueueHistory_OutboundQueueHistoryId" unique="UNIQUE_KEY" >
				<column name="OutboundQueueHistoryId" />
			</index>
			<fk name="FK_OutboundQueueHistory_Server" to_schema="SnApp.dbo" to_table="tbServer" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
			<fk name="FK_OutboundQueueHistory_DataSource" to_schema="SnApp.dbo" to_table="tbDataSource" >
				<fk_column name="DataSourceId" pk="DataSourceId" />
			</fk>
			<fk name="FK_OutboundQueueHistory_OutboundQueue" to_schema="SnApp.dbo" to_table="tbOutboundQueue" delete_action="cascade" >
				<fk_column name="OutboundQueueId" pk="OutboundQueueId" />
			</fk>
		</table>
		<table name="tbOutboundQueueHistoryConsQueue" prior="tbOutboundQueueConsQueue" >
			<column name="OutboundQueueHistoryId" prior="OutboundQueueId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the outbound queue]]></comment>
			</column>
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="ConsQueueStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[266]]]></comment>
			</column>
			<column name="QueueDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="StartDateTime" type="datetime" jt="92" />
			<column name="EndDateTime" type="datetime" jt="92" />
			<index name="IX_OutboundQueueHistoryConsQueue_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="ConsQueueStatus" options="ASC" />
			</index>
			<index name="PK_OutboundQueueHistoryConsQueue" unique="PRIMARY_KEY" >
				<column name="OutboundQueueHistoryId" />
			</index>
			<index name="IX_OutboundQueueHistoryConsQueue_ConsQueueStatus" unique="NORMAL" options="INCLUDE (ServerId)" >
				<column name="ConsQueueStatus" />
				<column name="QueueDateTime" />
			</index>
			<fk name="FK_OutboundQueueHistoryConsQueue_OutboundQueueHistory" to_schema="SnApp.dbo" to_table="tbOutboundQueueHistory" delete_action="cascade" >
				<fk_column name="OutboundQueueHistoryId" pk="OutboundQueueHistoryId" />
			</fk>
		</table>
		<table name="tbOutboundQueueItem" >
			<comment><![CDATA[For SnApp events (ie. transaction) which need to break down into multiple sub messages (ie: one message for each ticket encoded by the transaction)]]></comment>
			<column name="OutboundQueueItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="OutboundQueueId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the outbound queue (event)]]></comment>
			</column>
			<column name="OutboundQueueItemStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[343]]]></comment>
			</column>
			<column name="ItemEntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the sub entity (ie: TicketId on Transaction events)]]></comment>
			</column>
			<column name="ItemEntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="DocData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Content of the message]]></comment>
			</column>
			<column name="StartDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/time the document was started to be produced]]></comment>
			</column>
			<column name="SendDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/time the document was produced and sent to the broker]]></comment>
			</column>
			<column name="EndDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/time the document was sent and completed]]></comment>
			</column>
			<index name="IX_OutboundQueueItem_OutboundQueueId" unique="NORMAL" >
				<column name="OutboundQueueId" options="ASC" />
			</index>
			<index name="PK_OutboundQueueItem" unique="PRIMARY_KEY" >
				<column name="OutboundQueueItemId" />
			</index>
			<fk name="FK_OutboundQueueItem_OutboundQueue" to_schema="SnApp.dbo" to_table="tbOutboundQueue" delete_action="cascade" >
				<fk_column name="OutboundQueueId" pk="OutboundQueueId" />
			</fk>
		</table>
		<table name="tbOutboundTrigger" >
			<comment><![CDATA[Holds request for outbound events manual triggers]]></comment>
			<column name="OutboundTriggerId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="TriggerDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Request date/time]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference entity ID for outbound trigger]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Reference entity type for outbound trigger]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Workstation which posted the request]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[User which posted the request]]></comment>
			</column>
			<column name="TriggerOptions" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[- not used -]]></comment>
			</column>
			<index name="IX_OutboundTrigger_TriggerDateTime" unique="NORMAL" >
				<column name="TriggerDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundTrigger_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="TriggerDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundTrigger_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="TriggerDateTime" options="ASC" />
			</index>
			<index name="IX_OutboundTrigger_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
				<column name="TriggerDateTime" options="ASC" />
			</index>
			<index name="PK_OutboundTrigger" unique="PRIMARY_KEY" >
				<column name="OutboundTriggerId" />
			</index>
			<fk name="FK_OutboundTrigger_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_OutboundTrigger_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbPPURule" >
			<comment><![CDATA[Pay-per-use rules to be applied on redemptions]]></comment>
			<column name="PPURuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Rule sorting]]></comment>
			</column>
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="StopRule" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When true and the rule is applicable, the system will stop processing subsequent rules]]></comment>
			</column>
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the membership point that will be added/deducted to the portfolio]]></comment>
			</column>
			<column name="MembershipPointValue" type="money" length="1" decimal="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount/Points to be added/deducted from portfolio]]></comment>
			</column>
			<column name="CalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Rule applicability calendar]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Rule applicable only starting from this date. Null = no limitations]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[Rule applicable only up to this date. Null = no limitations]]></comment>
			</column>
			<column name="ValidTimeFrom" type="smalldatetime" jt="93" >
				<comment><![CDATA[Rule applicable only starting from this time (date part is ignored). Null = no limitations]]></comment>
			</column>
			<column name="ValidTimeTo" type="datetime" jt="92" >
				<comment><![CDATA[Rule applicable only up to this time (date part is ignored). Null = no limitations]]></comment>
			</column>
			<column name="LocationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Restrict rule applicability to a redemption location]]></comment>
			</column>
			<column name="OpAreaId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Restrict rule applicability to a redemption op.area (gate)]]></comment>
			</column>
			<column name="AccessPointId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Restrict rule applicability to a specific access point]]></comment>
			</column>
			<index name="IX_PPURule_PriorityOrder" unique="NORMAL" >
				<column name="PriorityOrder" options="ASC" />
			</index>
			<index name="IX_PPURule_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="IX_PPURule_CalendarId" unique="NORMAL" options="where CalendarId is not null" >
				<column name="CalendarId" options="ASC" />
			</index>
			<index name="IX_PPURule_LocationId" unique="NORMAL" options="where LocationId is not null" >
				<column name="LocationId" options="ASC" />
				<column name="OpAreaId" options="ASC" />
				<column name="AccessPointId" options="ASC" />
			</index>
			<index name="IX_PPURule_OpAreaId" unique="NORMAL" options="where OpAreaId is not null" >
				<column name="OpAreaId" options="ASC" />
				<column name="AccessPointId" options="ASC" />
			</index>
			<index name="IX_PPURule_AccessPointId" unique="NORMAL" options="where AccessPointId is not null" >
				<column name="AccessPointId" options="ASC" />
			</index>
			<index name="PK_PPURule" unique="PRIMARY_KEY" >
				<column name="PPURuleId" />
			</index>
			<fk name="FK_PPURule_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_PPURule_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_PPURule_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="AccessPointId" pk="WorkstationId" />
			</fk>
			<fk name="FK_PPURule_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" delete_action="cascade" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
			<fk name="FK_PPURule_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
		</table>
		<table name="tbPPURuleLink" >
			<comment><![CDATA[Stores links for pay-par-use rules
- Events
- Event tags
- ProductTypes
- ProductType tags]]></comment>
			<column name="PPURuleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to pay-per-use rule]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to linked entity]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="IX_PPURuleLink_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_PPURuleLink" unique="PRIMARY_KEY" >
				<column name="PPURuleId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_PPURuleLink_PPURule" to_schema="SnApp.dbo" to_table="tbPPURule" delete_action="cascade" >
				<fk_column name="PPURuleId" pk="PPURuleId" />
			</fk>
		</table>
		<table name="tbPasswordHistory" >
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ChangeDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="Password" type="varchar" length="100" decimal="0" jt="12" mandatory="y" />
			<index name="PK_PasswordHistory" unique="PRIMARY_KEY" >
				<column name="AccountId" />
				<column name="ChangeDateTime" />
			</index>
			<fk name="FK_PasswordHistory_Login" to_schema="SnApp.dbo" to_table="tbLogin" delete_action="cascade" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbPayment" >
			<comment><![CDATA[Holds information about payments of a transaction (one transaction 0 or N payments)]]></comment>
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Transaction which this payment line belogs to]]></comment>
			</column>
			<column name="PaymentStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[54] (to be approved, approved, failed, voided, aborted, partially approved)]]></comment>
			</column>
			<column name="PaymentType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[7]]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Payment Method]]></comment>
			</column>
			<column name="PaymentAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount of the payment line]]></comment>
			</column>
			<column name="Change" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if this line was a "change" (returned money in a positive trasaction)]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Apperently used for "advanced payments" only. It might be a good idea to drop this column and create a tbPaymentAdvanced]]></comment>
			</column>
			<column name="PaymentCount" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Used mainly to count "number of vouchers" for CoopCulture]]></comment>
			</column>
			<index name="IX_Payment_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="IX_Payment_PluginId" unique="NORMAL" >
				<column name="PluginId" options="ASC" />
			</index>
			<index name="IX_Payment_AccountId" unique="NORMAL" options="where AccountId is not null" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="PK_Payment" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<fk name="FK_Payment_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Payment_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_Payment_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbPaymentCard" >
			<comment><![CDATA[Extension table for tbPayment. Holds additiona information for credit/card payment methods]]></comment>
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="PaymentTokenId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to token table in case payment needs it for later operations such as refund/void (or other pre-auth sales)]]></comment>
			</column>
			<column name="VoidPaymentId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to original payment record which has been voided]]></comment>
			</column>
			<column name="CardType" type="nvarchar" length="15" jt="12" >
				<comment><![CDATA[VISA, MASTERCARD, AMEX, etc...]]></comment>
			</column>
			<column name="CardNumber" type="varchar" length="20" decimal="0" jt="12" >
				<comment><![CDATA[Masked credit card number (usually last 4 digits are in clear, but it could change country by country)]]></comment>
			</column>
			<column name="CardExpDate" type="varchar" length="4" decimal="0" jt="12" >
				<comment><![CDATA[Credit card expiration date (MMYY)]]></comment>
			</column>
			<column name="CardHolderName" type="varchar" length="30" decimal="0" jt="12" >
				<comment><![CDATA[Name written on the card. Depending on local/country laws, and wheter the device tells us this information, we might fill it in or not.]]></comment>
			</column>
			<column name="AuthorizationCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Authorization code of the transaction]]></comment>
			</column>
			<column name="Settled" type="bit" length="1" jt="-7" >
				<comment><![CDATA[Not used yet - True if record has been settled]]></comment>
			</column>
			<column name="InputType" type="smallint" jt="5" >
				<comment><![CDATA[LK[98]]]></comment>
			</column>
			<index name="IX_PaymentCard_AuthorizationCode" unique="NORMAL" options="where AuthorizationCode is not null" >
				<column name="AuthorizationCode" options="ASC" />
			</index>
			<index name="IX_PaymentCard_PaymentTokenId" unique="NORMAL" options="where PaymentTokenId is not null" >
				<column name="PaymentTokenId" options="ASC" />
			</index>
			<index name="IX_PaymentCard_VoidPaymentId" unique="NORMAL" options="where VoidPaymentId is not null" >
				<column name="VoidPaymentId" options="ASC" />
			</index>
			<index name="PK_PaymentCard" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<fk name="FK_PaymentCard_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_PaymentCard_VoidPayment" to_schema="SnApp.dbo" to_table="tbPaymentCard" >
				<fk_column name="VoidPaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_PaymentCard_PaymentToken" to_schema="SnApp.dbo" to_table="tbPaymentToken" >
				<fk_column name="PaymentTokenId" pk="PaymentTokenId" />
			</fk>
		</table>
		<table name="tbPaymentCredit" >
			<comment><![CDATA[Extension table for tbPayment. Holds additional information for "credit" (major client credit line) payment methods]]></comment>
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CreditStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[90]]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the organization "owning" this credit line]]></comment>
			</column>
			<column name="DueDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Date when the credit line should be settled]]></comment>
			</column>
			<column name="SettleTransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Transaction which settled the credit line]]></comment>
			</column>
			<column name="SettleTransactionArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference of the original settlement transaction, now archived&purged]]></comment>
			</column>
			<column name="SettleTransactionArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Reference of the original settlement transaction, now archived&purged]]></comment>
			</column>
			<column name="VoucherId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For voucher only payment methods. Link to the individual voucher which created the credit line]]></comment>
			</column>
			<column name="CreateDateTime" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Creation date/time]]></comment>
			</column>
			<index name="IX_PaymentCredit_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
				<column name="CreditStatus" options="ASC" />
				<column name="DueDate" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_PaymentCredit_VoucherId" unique="NORMAL" options="where VoucherId is not null" >
				<column name="VoucherId" options="ASC" />
			</index>
			<index name="IX_PaymentCredit_SettleTransactionId" unique="NORMAL" options="where SettleTransactionId is not null" >
				<column name="SettleTransactionId" options="ASC" />
			</index>
			<index name="PK_PaymentCredit" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<index name="IX_PaymentCredit_CreditStatus_CreateDateTime" unique="NORMAL" options="INCLUDE (AccountId)" >
				<column name="CreditStatus" />
				<column name="CreateDateTime" />
			</index>
			<index name="IX_PaymentCredit_SettleTransactionArcId" unique="NORMAL" >
				<column name="SettleTransactionArcId" />
			</index>
			<fk name="FK_PaymentCredit_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_PaymentCredit_SettleTransaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="SettleTransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_PaymentCredit_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_PaymentCredit_Voucher" to_schema="SnApp.dbo" to_table="tbVoucher" delete_action="cascade" >
				<fk_column name="VoucherId" pk="VoucherId" />
			</fk>
		</table>
		<table name="tbPaymentCurrency" >
			<comment><![CDATA[Extension table fpr tbPayment. Holds addiotional information about foreign currency payments.
It is used for "foreign currency" payment methods, but, if the device provides this information, could be used for credit card payments as well]]></comment>
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CurrencyISO" type="varchar" length="3" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[ISO 4217]]></comment>
			</column>
			<column name="CurrencyAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Foreign currency amount]]></comment>
			</column>
			<column name="ExchangeRate" type="decimal" length="38" decimal="19" jt="3" mandatory="y" >
				<comment><![CDATA[Exchange rate applied at transaction time]]></comment>
			</column>
			<index name="PK_PaymentCurrency" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<fk name="FK_PaymentCurrency_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
		</table>
		<table name="tbPaymentData" >
			<comment><![CDATA[Table designed to store additional custom data for payments.
Especially useful for credit card integration with external devices returning custom/specific data]]></comment>
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to tbPayment table]]></comment>
			</column>
			<column name="ParamName" type="varchar" length="30" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the parameter]]></comment>
			</column>
			<column name="ParamValue" type="nvarchar" length="100" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Value of the parameter]]></comment>
			</column>
			<column name="ParamValueLong" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Value of the parameter if longer then 100 chars]]></comment>
			</column>
			<index name="PK_PaymentData" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
				<column name="ParamName" />
			</index>
			<index name="IX_PaymentData_ParamNameAndValue" unique="NORMAL" >
				<column name="ParamName" options="ASC" />
				<column name="ParamValue" options="ASC" />
			</index>
			<fk name="FK_PaymentData_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
		</table>
		<table name="tbPaymentDoc" >
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DocFiscalDate" type="date" jt="91" mandatory="y" />
			<column name="DocDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="DocData" type="nvarchar(max)" jt="12" mandatory="y" />
			<index name="IX_PaymentDoc_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="IX_PaymentDoc_DocFiscalDate" unique="NORMAL" >
				<column name="DocFiscalDate" options="ASC" />
			</index>
			<index name="IX_PaymentDoc_DocTemplateId" unique="NORMAL" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="PK_PaymentDoc" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<fk name="FK_PaymentDoc_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_PaymentDoc_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_PaymentDoc_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbPaymentInstallment" >
			<comment><![CDATA[Extension table for tbPayment. Holds reference to the installment contract created to "pay" the transaction]]></comment>
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="InstallmentContractId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the installment contract]]></comment>
			</column>
			<index name="IX_PaymentInstallment_InstallmentContractId" unique="NORMAL" >
				<column name="InstallmentContractId" options="ASC" />
			</index>
			<index name="PK_PaymentInstallment" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<fk name="FK_PaymentInstallment_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_PaymentInstallment_InstallmentContract" to_schema="SnApp.dbo" to_table="tbInstallmentContract" >
				<fk_column name="InstallmentContractId" pk="InstallmentContractId" />
			</fk>
		</table>
		<table name="tbPaymentIntercompany" >
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="IntercompanyCostCenterId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="PK_PaymentIntercompany" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<index name="IX_PaymentIntercompany_IntercompanyCostCenterId" unique="NORMAL" >
				<column name="IntercompanyCostCenterId" />
			</index>
			<fk name="FK_PaymentIntercompany_IntercompanyCostCenter" to_schema="SnApp.dbo" to_table="tbIntercompanyCostCenter" >
				<fk_column name="IntercompanyCostCenterId" pk="IntercompanyCostCenterId" />
			</fk>
		</table>
		<table name="tbPaymentMembership" prior="Tbl" >
			<comment><![CDATA[Extension table for tbPayment. Holds additional information for "membership" payment methods]]></comment>
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="MembershipPlanProductId" prior="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbProduct.ProductId]]></comment>
			</column>
			<column name="MembershipCardCode" type="varchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Unique membership card identifier for internal use]]></comment>
			</column>
			<column name="MembershipCardCodeDisplay" type="varchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Membership card code to be displayed]]></comment>
			</column>
			<column name="CardHolderName" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Card holder name (could be masked)]]></comment>
			</column>
			<index name="PK_PaymentMembership" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<index name="IX_PaymentMembership_MembershipPlanProductId" unique="NORMAL" >
				<column name="MembershipPlanProductId" />
			</index>
			<index name="IX_PaymentMembership_MembershipCardCode" unique="NORMAL" >
				<column name="MembershipCardCode" />
			</index>
			<fk name="FK_PaymentMembership_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_PaymentMembership_MembershipPlanProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="MembershipPlanProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbPaymentProfile" >
			<column name="PaymentProfileId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RestrictPaymentMethods" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="AllowMembershipPoints" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="RestrictMembershipPoints" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="PaymentProfileCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="PaymentProfileName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="UQ_PaymentProfile_Code" unique="UNIQUE_KEY" >
				<column name="PaymentProfileCode" options="ASC" />
			</index>
			<index name="PK_PaymentProfile" unique="PRIMARY_KEY" >
				<column name="PaymentProfileId" />
			</index>
		</table>
		<table name="tbPaymentProfile2InstallmentPlan" >
			<column name="PaymentProfileId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="InstallmentPlanId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DownPaymentType" type="smallint" jt="5" >
				<comment><![CDATA[LK[135] Absolute/Percentage]]></comment>
			</column>
			<column name="DownPaymentValue" type="money" length="0" jt="3" />
			<column name="ProductFeeType" type="smallint" jt="5" >
				<comment><![CDATA[LK[135] Absolute/Percentage]]></comment>
			</column>
			<column name="ProductFeeValue" type="money" length="0" jt="3" />
			<column name="CalendarId" type="uniqueidentifier" jt="1" />
			<index name="IX_PaymentProfile2InstallmentPlan_InstallmentPlanId" unique="NORMAL" >
				<column name="InstallmentPlanId" options="ASC" />
			</index>
			<index name="IX_PraymentProfile2InstallmentPlan_CalendarId" unique="NORMAL" options="where CalendarId is not null" >
				<column name="CalendarId" options="ASC" />
			</index>
			<index name="PK_PaymentProfile2InstallmentPlan" unique="PRIMARY_KEY" >
				<column name="PaymentProfileId" />
				<column name="InstallmentPlanId" />
			</index>
			<fk name="FK_PaymentProfile2InstallmentPlan_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_PaymentProfile2InstallmentPlan_InstallmentPlan" to_schema="SnApp.dbo" to_table="tbInstallmentPlan" >
				<fk_column name="InstallmentPlanId" pk="InstallmentPlanId" />
			</fk>
			<fk name="FK_PaymentProfile2Installment_PaymentProfile" to_schema="SnApp.dbo" to_table="tbPaymentProfile" delete_action="cascade" >
				<fk_column name="PaymentProfileId" pk="PaymentProfileId" />
			</fk>
		</table>
		<table name="tbPaymentProfileMembershipPoint" >
			<column name="PaymentProfileId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="PK_PaymentProfileMembershipPoint" unique="PRIMARY_KEY" >
				<column name="PaymentProfileId" />
				<column name="MembershipPointId" />
			</index>
			<index name="IX_PaymentProfileMembershipPoint_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" />
			</index>
			<fk name="FK_ProductMembershipPoint_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
			<fk name="FK_PaymentProfileMembershipPoint_PaymentProfile" to_schema="SnApp.dbo" to_table="tbPaymentProfile" delete_action="cascade" >
				<fk_column name="PaymentProfileId" pk="PaymentProfileId" />
			</fk>
		</table>
		<table name="tbPaymentProfileMethod" >
			<column name="PaymentProfileId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PaymentMethodId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="PK_PaymentProfileMethod" unique="PRIMARY_KEY" >
				<column name="PaymentProfileId" />
				<column name="PaymentMethodId" />
			</index>
			<index name="IX_PaymentProfileMethod_PaymentMethodId" unique="NORMAL" >
				<column name="PaymentMethodId" />
			</index>
			<fk name="FK_PaymentProfileMethod_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PaymentMethodId" pk="PluginId" />
			</fk>
			<fk name="FK_PaymentProfileMethod_PaymentProfile" to_schema="SnApp.dbo" to_table="tbPaymentProfile" delete_action="cascade" >
				<fk_column name="PaymentProfileId" pk="PaymentProfileId" />
			</fk>
		</table>
		<table name="tbPaymentToken" >
			<comment><![CDATA[Holds information about payments which require token storage for future transactions]]></comment>
			<column name="PaymentTokenId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal Id]]></comment>
			</column>
			<column name="PaymentTokenCode" type="varchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Token value]]></comment>
			</column>
			<column name="PaymentTokenType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[218] - Internal use]]></comment>
			</column>
			<column name="PaymentTokenDesc" type="varchar" length="30" jt="12" >
				<comment><![CDATA["Alias" or description that could be associated with a card+token]]></comment>
			</column>
			<column name="CreateDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Date of creation of the token]]></comment>
			</column>
			<column name="ExpirationDate" type="date" jt="91" >
				<comment><![CDATA[Date of expiration of the token (null means no expiration)]]></comment>
			</column>
			<column name="CardType" type="varchar" length="15" jt="12" >
				<comment><![CDATA[VISA, AMEX, etc....]]></comment>
			</column>
			<column name="CardNumber" type="varchar" length="20" decimal="0" jt="12" >
				<comment><![CDATA[Masked credit card number]]></comment>
			</column>
			<column name="CardExpDate" type="varchar" length="4" jt="12" >
				<comment><![CDATA[Credit card expiration date (MMYY)]]></comment>
			</column>
			<column name="CardHolderName" type="varchar" length="30" jt="12" >
				<comment><![CDATA[Name written on the card. Depending on local/country laws, and wheter the device tells us this information, we might fill it in or not.]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the account in the account table (if any)]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the payment plugin which inserted the token]]></comment>
			</column>
			<index name="UQ_PaymentToken_Code" unique="UNIQUE_KEY" >
				<column name="PaymentTokenCode" options="ASC" />
			</index>
			<index name="IX_PaymentToken_AccountId" unique="NORMAL" options="where AccountId is not null" >
				<column name="AccountId" options="ASC" />
				<column name="CreateDate" options="ASC" />
			</index>
			<index name="IX_PaymentToken_ExpirationDate" unique="NORMAL" options="where ExpirationDate is not null" >
				<column name="ExpirationDate" options="ASC" />
			</index>
			<index name="IX_PaymentToken_CreateDate" unique="NORMAL" >
				<column name="CreateDate" options="ASC" />
			</index>
			<index name="PK_PaymentToken" unique="PRIMARY_KEY" >
				<column name="PaymentTokenId" />
			</index>
			<index name="IX_PaymentToken_PluginId" unique="NORMAL" options="WHERE PluginId is not null" >
				<column name="PluginId" />
			</index>
			<constraint name="CK_PaymentToken_PluginId" >
				<string><![CDATA[((PaymentTokenType <> 1) OR ((PaymentTokenType = 1) AND (PluginId is not null)))]]></string>
				<comment><![CDATA[Plugin ID becomes mandatory when PaymentTokenType is 1=PayByToken]]></comment>
			</constraint>
			<fk name="FK_PaymentToken_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_PaymentToken_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbPaymentTokenData" prior="tbPaymentData_0" >
			<comment><![CDATA[Table designed to store additional custom data for payment tokens.
Especially useful for credit card integration with external devices returning custom/specific data]]></comment>
			<column name="PaymentTokenId" prior="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to tbPaymentToken table]]></comment>
			</column>
			<column name="ParamName" type="varchar" length="30" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the parameter]]></comment>
			</column>
			<column name="ParamValue" type="nvarchar" length="100" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Value of the parameter]]></comment>
			</column>
			<column name="ParamValueLong" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Value of the parameter if longer then 100 chars]]></comment>
			</column>
			<index name="PK_PaymentTokenData" unique="PRIMARY_KEY" >
				<column name="PaymentTokenId" />
				<column name="ParamName" />
			</index>
			<fk name="FK_PaymentTokenData_PaymentToken" to_schema="SnApp.dbo" to_table="tbPaymentToken" delete_action="cascade" >
				<fk_column name="PaymentTokenId" pk="PaymentTokenId" />
			</fk>
		</table>
		<table name="tbPaymentWallet" >
			<column name="PaymentId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketMediaMatchId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ExchangeRate" type="decimal" length="38" decimal="19" jt="3" mandatory="y" />
			<column name="PointAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="MediaId" type="uniqueidentifier" jt="1" />
			<column name="PortfolioSlotHoldId" type="uniqueidentifier" jt="1" />
			<column name="PortfolioSlotLogId" prior="PorfolioSlotLogId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to PortfolioSlotLog]]></comment>
			</column>
			<index name="IX_PaymentWallet_PortfolioId" unique="NORMAL" >
				<column name="TicketMediaMatchId" options="ASC" />
			</index>
			<index name="IX_PaymentWallet_MediaId" unique="NORMAL" options="where MediaId is not null" >
				<column name="MediaId" options="ASC" />
			</index>
			<index name="IX_PaymentWallet_PortfolioHoldId" unique="NORMAL" options="where PortfolioHoldSlotId is not null" >
				<column name="PortfolioSlotHoldId" options="ASC" />
			</index>
			<index name="IX_PaymentWallet_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="PK_PaymentWallet" unique="PRIMARY_KEY" >
				<column name="PaymentId" />
			</index>
			<index name="IX_PaymentWallet_PortfolioSlotLogId" unique="NORMAL" options="where PortfolioSlotLogId is not null" >
				<column name="PortfolioSlotLogId" />
			</index>
			<fk name="FK_PaymentWallet_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="TicketMediaMatchId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_PaymentWallet_Media" to_schema="SnApp.dbo" to_table="tbMedia" >
				<fk_column name="MediaId" pk="MediaId" />
			</fk>
			<fk name="FK_PaymentWallet_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_PaymentWallet_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
			<fk name="FK_PaymentWallet_PortfolioSlotHold" to_schema="SnApp.dbo" to_table="tbPortfolioSlotHold" >
				<fk_column name="PortfolioSlotHoldId" pk="PortfolioSlotHoldId" />
			</fk>
			<fk name="FK_PaymentWallet_PortfolioSlotLog" to_schema="SnApp.dbo" to_table="tbPortfolioSlotLog" >
				<fk_column name="PortfolioSlotLogId" pk="PortfolioSlotLogId" />
			</fk>
		</table>
		<table name="tbPerformance" >
			<comment><![CDATA[Holds information abount event's performances]]></comment>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Event of the performance]]></comment>
			</column>
			<column name="CalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Calendar of the performance. Used  to autmatically assign PerformanceType and RateCode]]></comment>
			</column>
			<column name="PerformanceTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[PerformanceType of the performance. Used to access different price lists]]></comment>
			</column>
			<column name="RateCodeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[RateCode of the performance. Used to access different price lists]]></comment>
			</column>
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Location where the performance will actually take place]]></comment>
			</column>
			<column name="AccessAreaAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For admission control purposes, tells what is the access area which grant access to the performance]]></comment>
			</column>
			<column name="AllocateResourcesOnCreate" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="DateTimeFrom" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Location's timezone]]></comment>
			</column>
			<column name="DateTimeTo" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Location's timezone]]></comment>
			</column>
			<column name="TimeZone" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[238]]]></comment>
			</column>
			<column name="DBDateTimeFrom" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Date/time of the performance related to DB timezone]]></comment>
			</column>
			<column name="DBDateTimeTo" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Date/time of the performance related to DB timezone]]></comment>
			</column>
			<column name="PerformanceStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[104]]]></comment>
			</column>
			<column name="OnSaleFrom" type="date" jt="91" >
				<comment><![CDATA[Performance sellable only starting from date.
Null = no limits]]></comment>
			</column>
			<column name="OnSaleTo" type="date" jt="91" >
				<comment><![CDATA[Performance sellable only within date.
Null = no limits]]></comment>
			</column>
			<column name="CustomSeat" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the performance has a custom seat template instead of the access area default]]></comment>
			</column>
			<column name="PerformanceTypeFromCalendar" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells to inherit PerformanceType and RateCode from calendar (event's calendar will be used if not defined at performance levell)]]></comment>
			</column>
			<column name="DynRateCode" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if rate-code should be automatically calculated based on "yield pricing" configuration]]></comment>
			</column>
			<column name="RestrictOpenOrder" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If flagged, orders cannot be left open but must be paid on creation]]></comment>
			</column>
			<column name="QuantityRedeemed" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for Entries]]></comment>
			</column>
			<column name="QuantityInside" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for (Entries - Exits)]]></comment>
			</column>
			<column name="AdmissionOpenMins" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[look at tbEvent.AdmissionOpenMins]]></comment>
			</column>
			<column name="AdmissionCloseMins" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[look at tbEvent.AdmissionCloseMins]]></comment>
			</column>
			<column name="AutoCreated" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="EnvelopeSwapDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/time when the performance was checked the last time for seat envelope automatic swap]]></comment>
			</column>
			<column name="InheritFulfilmentArea " type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[If TRUE, inherits the fulfilment access area id from the configured access area]]></comment>
			</column>
			<column name="FulfilmentAreaTagId " type="uniqueidentifier" jt="1" >
				<comment><![CDATA[ID of the fulfillment access area group label (tag) created in BKO]]></comment>
			</column>
			<column name="LastCapacityThreshold" type="money" jt="3" >
				<comment><![CDATA[Value of the last capacity threshold applied]]></comment>
			</column>
			<column name="PerformanceSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number generate on creation starting from 1]]></comment>
			</column>
			<column name="PerformanceSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with PerformanceSequence to create encrypted barcodes]]></comment>
			</column>
			<column name="PerformanceVersion" type="bigint" jt="-5" >
				<comment><![CDATA[Autoinc field updated everytime the entity (in this specific record or any dependant) is modified. To be used for differential reports]]></comment>
			</column>
			<index name="IX_Performance_EventDateTime" unique="NORMAL" >
				<column name="EventId" options="ASC" />
				<column name="DBDateTimeFrom" options="ASC" />
			</index>
			<index name="IX_Performance_DateTimeFromTo" unique="NORMAL" options="include (EventId)" >
				<column name="DBDateTimeFrom" options="ASC" />
				<column name="DBDateTimeTo" options="ASC" />
			</index>
			<index name="IX_Performance_LocationDateTime" unique="NORMAL" options="include ([EventId])" >
				<column name="LocationAccountId" options="ASC" />
				<column name="DBDateTimeFrom" options="ASC" />
			</index>
			<index name="IX_Performance_AcAreaDateTime" unique="NORMAL" >
				<column name="AccessAreaAccountId" options="ASC" />
				<column name="DBDateTimeFrom" options="ASC" />
			</index>
			<index name="IX_Performance_Event_Status_DateTimeTo" unique="NORMAL" >
				<column name="EventId" options="ASC" />
				<column name="PerformanceStatus" options="ASC" />
				<column name="DBDateTimeTo" options="ASC" />
			</index>
			<index name="IX_Performance_AcAreaDateTimeTo" unique="NORMAL" >
				<column name="AccessAreaAccountId" options="ASC" />
				<column name="DateTimeTo" options="ASC" />
			</index>
			<index name="IX_Performance_EventAutoCreated" unique="NORMAL" >
				<column name="EventId" options="ASC" />
				<column name="AutoCreated" options="ASC" />
				<column name="DBDateTimeTo" options="ASC" />
			</index>
			<index name="IX_Performance_RateCodeId" unique="NORMAL" options="where RateCodeId is not null" >
				<column name="RateCodeId" options="ASC" />
				<column name="DBDateTimeFrom" options="ASC" />
			</index>
			<index name="IX_Performance_CalendarId" unique="NORMAL" options="where CalendarId is not null" >
				<column name="CalendarId" options="ASC" />
				<column name="DBDateTimeFrom" options="ASC" />
			</index>
			<index name="PK_Performance" unique="PRIMARY_KEY" >
				<column name="PerformanceId" />
			</index>
			<index name="IX_Performance_PerformaneTypeId" unique="NORMAL" options="where PerformanceTypeId is not null" >
				<column name="PerformanceTypeId" />
			</index>
			<index name="IX_Performance_FulfilmentAreaTagId" unique="NORMAL" options="where FulfilmentAreaTagId is not null" >
				<column name="FulfilmentAreaTagId " />
			</index>
			<index name="IX_Performance_EventId_DateTimeFrom" unique="NORMAL" options="INCLUDE DateTimeTo, PerformanceStatus" >
				<column name="EventId" />
				<column name="DateTimeFrom" />
			</index>
			<index name="UQ_Performance_PerformanceSequence" unique="UNIQUE_INDEX" options="WHERE PerformanceSequence&lt;&gt;0 INCLUDE PerformanceSeed" >
				<column name="PerformanceSequence" />
			</index>
			<index name="UQ_Performance_PerformanceVersion" unique="UNIQUE_INDEX" options="where PerformanceVersion&lt;&gt;0" >
				<column name="PerformanceVersion" />
			</index>
			<fk name="FK_Performance_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Performance_AcAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccessAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Performance_Event" to_schema="SnApp.dbo" to_table="tbEvent" delete_action="cascade" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
			<fk name="FK_Performance_PerformanceType" to_schema="SnApp.dbo" to_table="tbPerformanceType" >
				<fk_column name="PerformanceTypeId" pk="PerformanceTypeId" />
			</fk>
			<fk name="FK_Performance_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_Performance_RateCode" to_schema="SnApp.dbo" to_table="tbRateCode" >
				<fk_column name="RateCodeId" pk="RateCodeId" />
			</fk>
			<fk name="FK_Performance_FulfilmentAreaTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="FulfilmentAreaTagId " pk="TagId" />
			</fk>
		</table>
		<table name="tbPerformanceDetail" >
			<comment><![CDATA[Extension table for tbPerformance. Holds information set only on a small portion of all the performances]]></comment>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Guest account "booking" the performance. Used for events like "birthday party"]]></comment>
			</column>
			<column name="PerformanceName" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Textual manual description of the performance]]></comment>
			</column>
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to saleitem detail. Filled when performance is auto-created because of tbProduct.CreateEventId]]></comment>
			</column>
			<index name="IX_PerformanceDetail_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="IX_Performance_SaleItemDetailId" unique="NORMAL" options="where SaleItemDetailId is not null" >
				<column name="SaleItemDetailId" options="ASC" />
			</index>
			<index name="PK_PerformanceDetail" unique="PRIMARY_KEY" >
				<column name="PerformanceId" />
			</index>
			<fk name="FK_PerformanceDetail_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_PerformanceDetail_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" delete_action="cascade" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_PerformanceDetail_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
		</table>
		<table name="tbPerformanceSet" >
			<comment><![CDATA[A product could reference more than one performance.
For each different set of performance group, a PerformanceSetId is generated, and then recycled to all other products pointing to the same se of performances]]></comment>
			<column name="PerformanceSetId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="HashMD5" type="varchar" length="32" jt="12" mandatory="y" >
				<comment><![CDATA[MD5 hash or all PerformanceId (concatenated in varchar, eachvalue separated by a "," comma) belonging to the set]]></comment>
			</column>
			<index name="PK_PerformanceSet" unique="PRIMARY_KEY" >
				<column name="PerformanceSetId" />
			</index>
			<index name="IX_PerformanceSet_HashMD5" unique="NORMAL" >
				<column name="HashMD5" />
			</index>
			<fk name="Relationship225" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column pk="TicketId" />
			</fk>
			<fk name="Relationship224" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbPerformanceSetDetail" >
			<comment><![CDATA[Contains the "explosion" of all performances belonging to a performance set.
One performance set, 1 o N performances]]></comment>
			<column name="PerformanceSetId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the performance set]]></comment>
			</column>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the performance]]></comment>
			</column>
			<column name="Quantity" type="smallint" jt="5" mandatory="y" >
				<defo><![CDATA[1]]></defo>
				<comment><![CDATA[Used on scenarios when the same performance can be booked multiple times on the same item, else it's always 1]]></comment>
			</column>
			<index name="IX_PerformanceSetDetail_PerformanceId" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="PK_PerformanceSetDetail" unique="PRIMARY_KEY" >
				<column name="PerformanceSetId" />
				<column name="PerformanceId" />
			</index>
			<fk name="FK_PerformanceSetDetail_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_PerformanceSetDetail_PerformanceSet" to_schema="SnApp.dbo" to_table="tbPerformanceSet" delete_action="cascade" >
				<fk_column name="PerformanceSetId" pk="PerformanceSetId" />
			</fk>
		</table>
		<table name="tbPerformanceType" >
			<comment><![CDATA[Definition table of PerformanceType.
Performance types define access to differt price lists]]></comment>
			<column name="PerformanceTypeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="PerformanceTypeCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="PerformanceTypeName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the performance type]]></comment>
			</column>
			<column name="ParentEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="ParentEntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Performance type could be overall available (this field = null) or beloning only to a subset entity (like an event)]]></comment>
			</column>
			<column name="ValidFrom" type="datetime" length="1" decimal="0" jt="92" >
				<comment><![CDATA[Usable only from date.
Null = no limit]]></comment>
			</column>
			<column name="ValidTo" type="datetime" length="1" decimal="0" jt="92" >
				<comment><![CDATA[Usable only up to date.
Null = no limit]]></comment>
			</column>
			<column name="PriceActionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[134]]]></comment>
			</column>
			<column name="PriceValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135]]]></comment>
			</column>
			<column name="PriceValue" type="money" length="0" jt="3" >
				<comment><![CDATA[Could be absolute of percentage value depending on PriceActionTyoe and PriceValueType]]></comment>
			</column>
			<column name="PerformanceTypeColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<index name="UQ_PerformanceType_Code" unique="UNIQUE_KEY" >
				<column name="PerformanceTypeCode" options="ASC" />
			</index>
			<index name="IX_PerformanceType_ParentEntity" unique="NORMAL" >
				<column name="ParentEntityType" options="ASC" />
				<column name="ParentEntityId" options="ASC" />
			</index>
			<index name="IX_PerformanceType_ParentEntityId" unique="NORMAL" >
				<column name="ParentEntityId" options="ASC" />
			</index>
			<index name="PK_PerformanceType" unique="PRIMARY_KEY" >
				<column name="PerformanceTypeId" />
			</index>
		</table>
		<table name="tbPlugin" >
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DriverId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" />
			<column name="PluginName" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[If Null is the DriverName]]></comment>
			</column>
			<column name="PluginEnabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="PluginSettings" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[XML/JSON driver specific settings]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" />
			<column name="PluginDefault" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Used for payment only]]></comment>
			</column>
			<column name="DeviceAlias" type="varchar" length="15" jt="12" />
			<column name="PluginCode" type="varchar" length="15" jt="12" >
				<comment><![CDATA[Used to identify plugin in web-payment callbacks]]></comment>
			</column>
			<column name="PrintableErrorReceiptId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[DocTemplcateId used to print specific errors]]></comment>
			</column>
			<index name="IX_Plugin_DriverId" unique="NORMAL" >
				<column name="DriverId" options="ASC" />
			</index>
			<index name="IX_Plugin_WorkstationId" unique="NORMAL" options="where WorkstationId is not null" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="UQ_Plugin_PluginCode" unique="UNIQUE_KEY" options="where PluginCode is not null" >
				<column name="PluginCode" options="ASC" />
			</index>
			<index name="PK_Plugin" unique="PRIMARY_KEY" >
				<column name="PluginId" />
			</index>
			<index name="IX_Plugin_PrintableErrorReceiptId" unique="NORMAL" options="where PrintableErrorReceiptIdis not null" >
				<column name="PrintableErrorReceiptId" options="ASC" />
			</index>
			<fk name="FK_Plugin_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Plugin_Driver" to_schema="SnApp.dbo" to_table="tbDriver" >
				<fk_column name="DriverId" pk="DriverId" />
			</fk>
			<fk name="FK_Plugin_PrintableErrorReceipt" to_schema="SnApp.dbo" to_table="tbDocTemplate" delete_action="cascade" >
				<fk_column name="PrintableErrorReceiptId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbPlugin2PaymentMethod" prior="TbPlugin2PaymentMethod" >
			<comment><![CDATA[Relation between paymentmethods and external payment device plugin]]></comment>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Plugin internal ID]]></comment>
			</column>
			<column name="PaymentMethodId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Payment method internal ID]]></comment>
			</column>
			<index name="PK_Plugin2PaymentMethod" unique="PRIMARY_KEY" >
				<column name="PluginId" />
				<column name="PaymentMethodId" />
			</index>
			<index name="IX_Plugin2PaymentMethod_PaymentMehotdId" unique="NORMAL" >
				<column name="PaymentMethodId" />
			</index>
			<fk name="FK_Plugin2PaymentMethod_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" delete_action="cascade" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
			<fk name="FK_Plugin2PaymentMethod_PaymentMethod" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PaymentMethodId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbPluginPayment2IntercompanyCostCenter" >
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="IntercompanyCostCenterId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_PluginPayment2IntercompanyCostCenter_IntercompanyCostCenterId" unique="NORMAL" >
				<column name="IntercompanyCostCenterId" options="ASC" />
			</index>
			<index name="PK_PluginPayment2IntercompanyCostCenter" unique="PRIMARY_KEY" >
				<column name="PluginId" />
				<column name="IntercompanyCostCenterId" />
			</index>
			<fk name="FK_PluginPayment2IntercompanyCostCenter_PluginPaymentMethod" to_schema="SnApp.dbo" to_table="tbPluginPaymentMethod" delete_action="cascade" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
			<fk name="FK_PluginPayment2IntercompanyCostCenter_IntercompanyCostCenter" to_schema="SnApp.dbo" to_table="tbIntercompanyCostCenter" >
				<fk_column name="IntercompanyCostCenterId" pk="IntercompanyCostCenterId" />
			</fk>
		</table>
		<table name="tbPluginPaymentMethod" >
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PaymentMethodCode" type="varchar" length="15" jt="12" />
			<column name="PaymentGroupTagId" type="uniqueidentifier" jt="1" />
			<column name="AutoFill" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="IconName" type="varchar" length="20" decimal="0" jt="12" />
			<column name="IconAlias" type="varchar" length="50" jt="12" >
				<comment><![CDATA[font-awesome icon alias]]></comment>
			</column>
			<column name="BackgroundColor" type="varchar" length="6" jt="12" >
				<comment><![CDATA[Hex color for background (null = transparent)]]></comment>
			</column>
			<column name="ForegroundColor" type="varchar" length="6" jt="12" >
				<comment><![CDATA[Hex color for foreground (null = black)]]></comment>
			</column>
			<column name="PaymentCountMessage" type="nvarchar" length="100" jt="12" />
			<column name="DebitLedgerAccountId" type="uniqueidentifier" jt="1" />
			<column name="CreditLedgerAccountId" type="uniqueidentifier" jt="1" />
			<column name="MaxChangeAmount" type="money" length="0" jt="3" >
				<comment><![CDATA[Max amount of change that can be given back when overpaying with payment method]]></comment>
			</column>
			<column name="EnabledOnSale" prior="EnableOnSale" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Used to define if a payment method can be used for sale (orders/straight)]]></comment>
			</column>
			<column name="Refundable" type="bit" length="1" jt="-7" mandatory="y" >
				<defo><![CDATA[1]]></defo>
				<comment><![CDATA[Used to define if a payment method can be used for refund]]></comment>
			</column>
			<column name="CashPayment " type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Indicates if the payment method is cash]]></comment>
			</column>
			<column name="StraightSale" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Payment can be used in straight sales]]></comment>
			</column>
			<column name="OpenCashDrawer" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Define if cash drawer has to be opened when this payment method is used to pay/partially pay a transaction]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" >
				<comment><![CDATA[Last update of payment method]]></comment>
			</column>
			<column name="TargetPaymentMethodId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Currently used for "credit" payment methods only, define which "advanced payment" method should be used in place of the selected "credit" payment method when the organization has deposit to be deducted]]></comment>
			</column>
			<column name="OnlineStatus" type="smallint" jt="5" >
				<comment><![CDATA[LK[502]]]></comment>
			</column>
			<column name="PaymentAbort" type="bit" jt="-7" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[define the ability to abort a payment charge after the request have been posted to the device]]></comment>
			</column>
			<index name="IX_PluginPaymentMethod_PaymentGroupTagId" unique="NORMAL" >
				<column name="PaymentGroupTagId" options="ASC" />
			</index>
			<index name="IX_PluginPaymentMethod_DebitLedgerAccountId" unique="NORMAL" >
				<column name="DebitLedgerAccountId" options="ASC" />
			</index>
			<index name="IX_PluginPaymentMethod_CreditLedgerAccountId" unique="NORMAL" >
				<column name="CreditLedgerAccountId" options="ASC" />
			</index>
			<index name="UQ_PluginPaymentMethod_PaymentMethodCode" unique="UNIQUE_KEY" options="where PaymentMethodCode is not null" >
				<column name="PaymentMethodCode" options="ASC" />
			</index>
			<index name="PK_PluginPaymentMethod" unique="PRIMARY_KEY" >
				<column name="PluginId" />
			</index>
			<index name="IX_PluginPaymentMethod_TargetPaymentMethodId" unique="NORMAL" >
				<column name="TargetPaymentMethodId" />
			</index>
			<fk name="FK_PluginPaymentMethod_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
			<fk name="FK_PluginPaymentMethod_PaymentGroupTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="PaymentGroupTagId" pk="TagId" />
			</fk>
			<fk name="FK_PluginPaymentMethod_DebitLedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="DebitLedgerAccountId" pk="LedgerAccountId" />
			</fk>
			<fk name="FK_PluginPaymentMethod_CreditLedgerAccount" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="CreditLedgerAccountId" pk="LedgerAccountId" />
			</fk>
			<fk name="FK_PluginPaymentMethod_TargetPaymentMethod" to_schema="SnApp.dbo" to_table="tbPlugin" delete_action="setNull" >
				<fk_column name="TargetPaymentMethodId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbPortfolioInPerformance" >
			<comment><![CDATA[Keep trace of people (portfolios) inside a performance]]></comment>
			<column name="PortfolioId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Inside" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="FirstEntryTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="LastEntryTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="LastExitTime" type="smalldatetime" jt="93" />
			<index name="PK_PortfolioInPerformance" unique="PRIMARY_KEY" >
				<column name="PortfolioId" />
				<column name="PerformanceId" />
			</index>
			<index name="IX_PortfolioInPerformance_PerformanceId" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
				<column name="Inside" options="ASC" />
			</index>
			<fk name="FK_PortfolioInPerformance_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" delete_action="cascade" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_PortfolioInPerformance_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" delete_action="cascade" >
				<fk_column name="PortfolioId" pk="TicketMediaMatchId" />
			</fk>
		</table>
		<table name="tbPortfolioShare" >
			<column name="PortfolioShareId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketMediaMatchId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IDX_PortfolioShare_Entity" unique="NORMAL" >
				<column name="EntityType" options="ASC" />
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IDX_PortfolioShare_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_PortfolioShare" unique="PRIMARY_KEY" >
				<column name="PortfolioShareId" />
			</index>
			<fk name="FK_PortfolioShare_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="TicketMediaMatchId" pk="TicketMediaMatchId" />
			</fk>
		</table>
		<table name="tbPortfolioSlot" >
			<comment><![CDATA[Stores Balance/CreditLimit for portfolio wallet and membership points]]></comment>
			<column name="PortfolioId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to portfolio iternal ID]]></comment>
			</column>
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to membership point internal ID]]></comment>
			</column>
			<column name="PortfolioSlotType" type="tinyint" length="1" decimal="0" jt="-6" mandatory="y" >
				<comment><![CDATA[Not handled internally. Potentially used by external systems]]></comment>
			</column>
			<column name="SlotBalance" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Currente balance]]></comment>
			</column>
			<column name="SlotCreditLimit" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Allowed credit limit]]></comment>
			</column>
			<column name="AmountOnHold" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount that cannot be counted as available yet]]></comment>
			</column>
			<column name="ExpireDate" type="date" jt="91" >
				<comment><![CDATA[Expiration date]]></comment>
			</column>
			<index name="IX_PortfolioSlot_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
				<column name="PortfolioSlotType" options="ASC" />
				<column name="ExpireDate" options="ASC" />
			</index>
			<index name="PK_PortfolioSlot" unique="PRIMARY_KEY" >
				<column name="PortfolioId" />
				<column name="MembershipPointId" />
				<column name="PortfolioSlotType" />
			</index>
			<index name="unq_tbPortfolioSlot_PortfolioId" unique="UNIQUE_KEY" >
				<column name="PortfolioId" />
			</index>
			<fk name="FK_PortfolioSlot_TicketMediaMatch" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" delete_action="cascade" >
				<fk_column name="PortfolioId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_PortfolioSlot_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
		</table>
		<table name="tbPortfolioSlotBalance" >
			<column name="PortfolioId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to portfolio internal ID]]></comment>
			</column>
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to membership point internal ID]]></comment>
			</column>
			<column name="PortfolioSlotType" type="tinyint" length="1" decimal="0" jt="-6" mandatory="y" >
				<comment><![CDATA[Not handled internally. Potentially used by external systems]]></comment>
			</column>
			<column name="PortfolioSlotBalanceSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Progressive number]]></comment>
			</column>
			<column name="PortfolioSlotBalanceType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[368]]]></comment>
			</column>
			<column name="ExchangeRate" type="decimal" length="38" decimal="19" jt="3" mandatory="y" >
				<comment><![CDATA[Exchange rate]]></comment>
			</column>
			<column name="Balance" type="money" length="1" decimal="0" jt="3" mandatory="y" >
				<comment><![CDATA[Current balance]]></comment>
			</column>
			<column name="BalanceMoney" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Current balance converted to Money (Balance * ExchangeRate)]]></comment>
			</column>
			<column name="InitialValue" type="money" length="1" decimal="0" jt="3" mandatory="y" >
				<comment><![CDATA[Initial value at the time of creation]]></comment>
			</column>
			<column name="InitialValueMoney" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Initial value at the time of creation converted to Money (InitialValue* ExchangeRate)]]></comment>
			</column>
			<column name="ExpireDate" type="date" jt="91" >
				<comment><![CDATA[Expiration date, null means no expiration]]></comment>
			</column>
			<column name="Status" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[Lk[365] Active, Expired]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the specific ticket when product is configured to bind wallet/reward points to the ticket itself]]></comment>
			</column>
			<index name="IX_PortfolioSlotBalance_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
				<column name="PortfolioSlotType" options="ASC" />
				<column name="ExpireDate" options="ASC" />
			</index>
			<index name="PK_PortfolioSlotBalance" unique="PRIMARY_KEY" >
				<column name="PortfolioId" />
				<column name="MembershipPointId" />
				<column name="PortfolioSlotType" />
				<column name="PortfolioSlotBalanceSerial" />
			</index>
			<index name="IX_PortfolioSlotBalance_TicketId" unique="NORMAL" options="where TicketId is not null" >
				<column name="TicketId" />
				<column name="PortfolioId" />
				<column name="MembershipPointId" />
				<column name="PortfolioSlotType" />
				<column name="PortfolioSlotBalanceSerial" />
			</index>
			<fk name="FK_PortfolioSlotBalance_PortfolioSlot" to_schema="SnApp.dbo" to_table="tbPortfolioSlot" delete_action="cascade" >
				<fk_column name="PortfolioId" pk="PortfolioId" />
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
				<fk_column name="PortfolioSlotBalanceType" pk="PortfolioSlotType" />
			</fk>
			<fk name="FK_PortfolioSlotBalance_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbPortfolioSlotHold" >
			<column name="PortfolioSlotHoldId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PortfolioId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="HoldDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="HoldStatus" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[260]]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" />
			<column name="TransactionId" type="uniqueidentifier" jt="1" />
			<index name="IX_PortfolioSlotHold_PortfolioId" unique="NORMAL" >
				<column name="PortfolioId" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotHold_HoldDateTime" unique="NORMAL" >
				<column name="HoldDateTime" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotHold_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotHold_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotHold_TransactionId" unique="NORMAL" options="where TransactionId is not null" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="PK_PortfolioSlotHold" unique="PRIMARY_KEY" >
				<column name="PortfolioSlotHoldId" />
			</index>
			<fk name="FK_PortfolioSlotHold_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_PortfolioSlotHold_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_PortfolioSlotHold_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="setNull" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_PortfolioSlotHold_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" delete_action="cascade" >
				<fk_column name="PortfolioId" pk="TicketMediaMatchId" />
			</fk>
		</table>
		<table name="tbPortfolioSlotLog" >
			<column name="PortfolioSlotLogId" type="char" length="1" decimal="0" jt="1" mandatory="y" />
			<column name="PortfolioId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PortfolioSlotType" type="tinyint" length="1" decimal="0" jt="-6" mandatory="y" />
			<column name="LogFiscalDate" type="date" jt="91" mandatory="y" />
			<column name="LogSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Progressive number]]></comment>
			</column>
			<column name="LogDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="LogAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="LogAmountMoney" type="money" jt="3" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" >
				<comment><![CDATA[[20] Transaction when performing the following operations:
"Ledger Clearing","Payment, Deposit","Initial deposit","Merge","Discount","Bonus points by promo"

[58] Ticket Usage when performing "PPU"]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" />
			<column name="SubEntityType" type="smallint" jt="5" >
				<comment><![CDATA[[12] Product type when performing "Initial deposit"

[55] Promo rule when performing "Bonus points by promo" and "Discount"

[58] Ticket usage when performing "Payment"]]></comment>
			</column>
			<column name="SubEntityId" type="uniqueidentifier" jt="1" />
			<column name="LogNote" type="nvarchar(max)" jt="12" />
			<column name="SettleTransactionId" type="uniqueidentifier" jt="1" />
			<column name="SettleTransactionArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<column name="SettleTransactionArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Reference of the original transaction, now archived&purged]]></comment>
			</column>
			<column name="PortfolioSlotHoldId" type="uniqueidentifier" jt="1" />
			<column name="PortfolioSlotLogType" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[261]]]></comment>
			</column>
			<column name="PortfolioSlotBalanceSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Link to PortfolioSlotBalance record (PortfolioId+MembershipId+PortfolioSlotType+PortfolioSlotBalanceSerial)]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Filled on clearing portfolio slot logs caused by ticket Expiration/Breakage/Clearing]]></comment>
			</column>
			<column name="ParentPortfolioSlotLogId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to parent ID when more logs are created during payment]]></comment>
			</column>
			<column name="VoidPortfolioSlotLogId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to original slot log that has been voided]]></comment>
			</column>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the performance that generated the money/points movement]]></comment>
			</column>
			<column name="PerformanceExpireDate" type="date" jt="91" >
				<comment><![CDATA[Expire date (no time) of the performance that generated the charge]]></comment>
			</column>
			<column name="LogReference" type="varchar" length="100" jt="12" >
				<comment><![CDATA[External reference]]></comment>
			</column>
			<index name="IX_PortfolioSlotLog_SettleTransactionId" unique="NORMAL" options="where SettleTransactionId is not null" >
				<column name="SettleTransactionId" options="ASC" />
				<column name="PortfolioId" options="ASC" />
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotLog_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotLog_EntityId" unique="NORMAL" options="where EntityId is not null" >
				<column name="EntityId" options="ASC" />
				<column name="SubEntityId" options="ASC" />
				<column name="MembershipPointId" options="ASC" />
				<column name="PortfolioSlotType" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotLog_PortfolioSlotHoldId" unique="NORMAL" options="where PortfolioSlotHoldId is not null" >
				<column name="PortfolioSlotHoldId" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotLog_SubEntityId" unique="NORMAL" options="where SubEntityId is not null" >
				<column name="SubEntityId" options="ASC" />
				<column name="MembershipPointId" options="ASC" />
				<column name="PortfolioSlotType" options="ASC" />
			</index>
			<index name="PK_PortfolioSlotLog" unique="PRIMARY_KEY" >
				<column name="PortfolioSlotLogId" />
			</index>
			<index name="IX_PortfolioSlotLog_TicketId" unique="NORMAL" options="where TicketId is not null" >
				<column name="TicketId" />
			</index>
			<index name="IX_PortfolioSlotLog_PortfolioId" unique="NORMAL" >
				<column name="PortfolioId" options="ASC" />
				<column name="MembershipPointId" options="ASC" />
				<column name="PortfolioSlotType" options="ASC" />
				<column name="PortfolioSlotBalanceSerial" />
				<column name="LogFiscalDate" options="ASC" />
			</index>
			<index name="IX_PortfolioSlotLog_ParentPortfolioSlotLogId" unique="NORMAL" options="where ParentPortfolioSlotLogId is not null" >
				<column name="ParentPortfolioSlotLogId" />
			</index>
			<index name="IX_PortfolioSlotLog_VoidPortfolioSlotLogId" unique="NORMAL" options="where VoidPortfolioSlotLogId is not null" >
				<column name="VoidPortfolioSlotLogId" />
			</index>
			<index name="IX_PortfolioSlotLog_PerformanceId" unique="NORMAL" options="where PerformanceId is not null" >
				<column name="PerformanceId" />
			</index>
			<index name="IX_PortfolioSlotLog_PerformanceExpireDate" unique="NORMAL" options="where PerformanceExpireDate is not null" >
				<column name="PerformanceExpireDate" />
				<column name="PortfolioSlotLogType" />
			</index>
			<fk name="FK_PortfolioSlotLog_SettleTransactionId" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="SettleTransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_PortfolioSlotLog_PortfolioSlotHold" to_schema="SnApp.dbo" to_table="tbPortfolioSlotHold" >
				<fk_column name="PortfolioSlotHoldId" pk="PortfolioSlotHoldId" />
			</fk>
			<fk name="FK_PortfolioSlotLog_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_PortfolioSlotLog_PortfolioSlotBalance" to_schema="SnApp.dbo" to_table="tbPortfolioSlotBalance" delete_action="cascade" >
				<fk_column name="PortfolioId" pk="PortfolioId" />
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
				<fk_column name="PortfolioSlotType" pk="PortfolioSlotType" />
				<fk_column name="PortfolioSlotBalanceSerial" pk="PortfolioSlotBalanceSerial" />
			</fk>
			<fk name="FK_PortfolioSlotLog_ParentPortfolioSlotLog" to_schema="SnApp.dbo" to_table="tbPortfolioSlotLog" >
				<fk_column name="ParentPortfolioSlotLogId" pk="PortfolioSlotLogId" />
			</fk>
			<fk name="FK_PortfolioSlotLog_VoidPortfolioSlotLog" to_schema="SnApp.dbo" to_table="tbPortfolioSlotLog" >
				<fk_column name="VoidPortfolioSlotLogId" pk="PortfolioSlotLogId" />
			</fk>
			<fk name="FK_PortfolioSlotLog_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
		</table>
		<table name="tbProduct" >
			<comment><![CDATA[Holds information about configured product types]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Category of the event (determins applicable data masks)]]></comment>
			</column>
			<column name="ProductType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[18] Family / Product / Package]]></comment>
			</column>
			<column name="ProductStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[49]]]></comment>
			</column>
			<column name="ProductCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="ProductName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Product type name]]></comment>
			</column>
			<column name="ProductNameExt" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Product type additional description]]></comment>
			</column>
			<column name="ShowNameExt" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if ProductNameExt should display or not. Changes POS UI representation of the product type]]></comment>
			</column>
			<column name="ParentEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="ParentEntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Product type could be overall available (this field = null) or beloning only to a subset entity (like an event)]]></comment>
			</column>
			<column name="QuantityMin" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Minumum sellable quantity. Default 1]]></comment>
			</column>
			<column name="QuantityStep" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity increment/decrement minumum. For example setting to 2 grant having only even quantities. Default 1]]></comment>
			</column>
			<column name="TrnMaxQty" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Maxi quantity of the specific product type allowed in a transaction]]></comment>
			</column>
			<column name="PricePoints" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="MembershipPoints" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="PrintGroupTagId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Statistical grouping - Print Group]]></comment>
			</column>
			<column name="FinanceGroupTagId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Statistical grouping - Finance Group]]></comment>
			</column>
			<column name="TimeRounding" type="smallint" jt="5" >
				<comment><![CDATA[LK[202] ResourceMan: define allocation start fragmentation. Even if PriceStep is set hourly, you may want to allow allocation to start every 15mins]]></comment>
			</column>
			<column name="AdmGroupTagId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Statistical grouping - Admission Group]]></comment>
			</column>
			<column name="AreaGroupTagId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Statistical grouping - Area Group]]></comment>
			</column>
			<column name="ExtMediaGroupId" type="uniqueidentifier" jt="1" />
			<column name="GroupTicketOption" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[153]]]></comment>
			</column>
			<column name="TaxCalcType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[25] included, excluded, exempt]]></comment>
			</column>
			<column name="ClearingLimitPerc" type="money" length="0" jt="3" >
				<comment><![CDATA[Used by ledger rules to calculate the "max value" of a ticket. When null equals 100% of selling price]]></comment>
			</column>
			<column name="WalletCreditLimit" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Not used anymore]]></comment>
			</column>
			<column name="AccountCategoryId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Default category for products requiring account]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Used for sorting purposes in the selling UI]]></comment>
			</column>
			<column name="PackageExplode" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[For packages only. Indicates that package price is the sum of its products and that shoud be exploded in statistics]]></comment>
			</column>
			<column name="AutoGenDocStep" type="smallint" jt="5" >
				<comment><![CDATA[LK[199]]]></comment>
			</column>
			<column name="AutoGenDocActivation" type="smallint" jt="5" >
				<comment><![CDATA[LK[200]]]></comment>
			</column>
			<column name="PriceStepValue" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[ResourceMan: define if price is daily, hourly, 10mins, etc]]></comment>
			</column>
			<column name="PriceStepType" type="smallint" jt="5" >
				<comment><![CDATA[LK[201]]]></comment>
			</column>
			<column name="MinStepQuantity" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[ResourceMan: define minimum allocation duration (multiplier for PriceStepValue)]]></comment>
			</column>
			<column name="DefaultStepQuantity" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[ResourceMan: define default allocation duration (multiplier for PriceStepValue)]]></comment>
			</column>
			<column name="ResourceEndOfDay" type="bit" length="1" jt="-7" >
				<comment><![CDATA[Occupy resource for the rest of the day]]></comment>
			</column>
			<column name="CreateEventId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Auto-create a performance for this event when the product gets sold. Date/time will reflect resource allocation. Used for bitrhday party scenarios]]></comment>
			</column>
			<column name="CalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Defines which days the product is sellable. If null is always sellable]]></comment>
			</column>
			<column name="DatedCalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Calendar to be used for "dated products" selection]]></comment>
			</column>
			<column name="VisitCalendarId" prior="VisitCalendar" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Defines if a product can be sold for the date selected at POS (performance/dated products) based on the calendar specified.]]></comment>
			</column>
			<column name="StopSaleCalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to calendar for "stop sale" dates]]></comment>
			</column>
			<column name="EntryQty" type="int" jt="4" >
				<comment><![CDATA[Used along with StopSaleCalendar determines buiness rules for upgrades]]></comment>
			</column>
			<column name="OnSaleTimeFrom" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Minutes from 00:00]]></comment>
			</column>
			<column name="OnSaleTimeTo" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Minutes from 00:00]]></comment>
			</column>
			<column name="OnSaleDateFrom" type="date" jt="91" >
				<comment><![CDATA[Date from]]></comment>
			</column>
			<column name="OnSaleDateTo" type="date" jt="91" >
				<comment><![CDATA[Date to]]></comment>
			</column>
			<column name="PerformanceTimeFrom" type="smallint" jt="5" >
				<comment><![CDATA[Sellable only when tied to performance starting from time...
(stores total minutes starting from 00:00)]]></comment>
			</column>
			<column name="PerformanceTimeTo" type="smallint" jt="5" >
				<comment><![CDATA[Sellable only when tied to performance starting before time...
(stores total minutes starting from 00:00)]]></comment>
			</column>
			<column name="ChargeToWallet" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When sold in "Portfolio SaleFlowType", the price will be charged on that portfolio, incresing the credit limit]]></comment>
			</column>
			<column name="VariablePrice" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if price matrix whould be ignored and price should be defined dymaically by operator at sale time]]></comment>
			</column>
			<column name="VariablePriceMin" type="money" length="0" jt="3" >
				<comment><![CDATA[Variable price minimum amount selectable by operator]]></comment>
			</column>
			<column name="VariablePriceMax" type="money" length="0" jt="3" >
				<comment><![CDATA[Variable price maximum amount selectable by operator]]></comment>
			</column>
			<column name="BiometricCheckLevel" type="smallint" jt="5" >
				<comment><![CDATA[LK[231]]]></comment>
			</column>
			<column name="BiometricEnrollment" type="smallint" jt="5" >
				<comment><![CDATA[LK[296]]]></comment>
			</column>
			<column name="BioValidityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[273] Used with BioValidityQuantity in order to set the expiration date of a biometric template linked to a secondary ticket]]></comment>
			</column>
			<column name="BioValidityQuantity" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Used with BioValidityType in order to set the expiration date of a biometric template linked to a secondary ticket]]></comment>
			</column>
			<column name="ManualVerificationType" prior="BiometricFrequencyType" type="smallint" jt="5" >
				<comment><![CDATA[LK[429]]]></comment>
			</column>
			<column name="ManualVerificationMessage" prior="IDVerificationMessage" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Custom/specific manual verification message when needed at admission]]></comment>
			</column>
			<column name="PresaleValue" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Italian SIAE Prevendita]]></comment>
			</column>
			<column name="PresaleValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Lk[135] 1=Absolute, 2=Percentage]]></comment>
			</column>
			<column name="PresaleProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Statistical product type, to be use instead of the "system presale product type" when accounting presales]]></comment>
			</column>
			<column name="ProductPriorityLevel" type="smallint" jt="5" >
				<comment><![CDATA[Lk[250] 10=Primary, 15=Co-Primary,  20=Secondary
Secondary products are linked to all the Primary and Co-Primary products sold in the same transaction.
Secondary products are also linked to all the products that belong to the same portfolio of the Primary products]]></comment>
			</column>
			<column name="ExpirationUsageType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[255]]]></comment>
			</column>
			<column name="POS_AllowPrint" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Product can be printed from POS]]></comment>
			</column>
			<column name="CLC_AllowPrint" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Product can be printed from CallCenter]]></comment>
			</column>
			<column name="B2B_AllowPrint" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Product can be printed from B2B]]></comment>
			</column>
			<column name="B2C_AllowPrint" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Product can be printed from B2C]]></comment>
			</column>
			<column name="MWLT_AllowPrint" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Allow Mobile Wallet Printing]]></comment>
			</column>
			<column name="LocationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="TaxProfileId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Tax profile]]></comment>
			</column>
			<column name="BackgroundColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<column name="ForegroundColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<column name="IconAlias" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[FontAwesome icon name]]></comment>
			</column>
			<column name="ProductPriceAdvanceType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[285]]]></comment>
			</column>
			<column name="PaymentProfileId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Payment profile (set of rules on how the product type can be paid with)]]></comment>
			</column>
			<column name="MeasureProfileId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Measure profile - Invetory management]]></comment>
			</column>
			<column name="PreparationMins" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Time (minutes) required for the preparation of the product. Used primarly for food preparation.]]></comment>
			</column>
			<column name="PosPricingPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the pricing plugin to be used from POS]]></comment>
			</column>
			<column name="WebPricingPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the pricing plugin to be used from WEB]]></comment>
			</column>
			<column name="AgeCategory" type="smallint" jt="5" >
				<comment><![CDATA[LK[456] Adult, Child, Senior, etc...]]></comment>
			</column>
			<column name="MinAge" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Used to add a sell constraint based on the age]]></comment>
			</column>
			<column name="MaxAge" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Used to add a sell constraint based on the age]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" >
				<comment><![CDATA[Last update of the product]]></comment>
			</column>
			<column name="RenewWindowStartDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Selta days, calculated on source ticket expiration, from which renewal can be done. Null = Always]]></comment>
			</column>
			<column name="RenewWindowEndDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Delta days, calculated on source ticket expiration, up to which renewal can be done. Null = Always]]></comment>
			</column>
			<column name="PriorityOrderCheckType" type="smallint" jt="5" >
				<comment><![CDATA[LK[347] How many times the system checks the primary accesses against a secondary entry attempt]]></comment>
			</column>
			<column name="RevalidateFeeProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Product id of the Fee to be used in the revalidation transaction]]></comment>
			</column>
			<column name="RevalidateExtensionDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Number of days the product expiration will be extened for]]></comment>
			</column>
			<column name="RevalidateWindowStartDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Revalidation window opening. Delta days from the original expiration date.]]></comment>
			</column>
			<column name="RevalidateWindowEndDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Revalidation window closure. Delta days from the original expiration date.]]></comment>
			</column>
			<column name="ChangePerformanceAdvanceDays" type="smallint" jt="5" >
				<comment><![CDATA[Number of days before visit date, until which a performance change is possible.
Value is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date]]></comment>
			</column>
			<column name="ChangeVisitDateFeeProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the "fee" product ID to be used to chanrge a fee when visit date on a ticket is changed]]></comment>
			</column>
			<column name="ChangeVisitDateFeeDays" type="smallint" jt="5" >
				<comment><![CDATA[Number of days, after visit date, from which a fee will be applied when changing visit date on a ticket]]></comment>
			</column>
			<column name="TicketVoidAdvanceDays" type="smallint" jt="5" >
				<comment><![CDATA[Number of days before visit date, until which refund is allowed.
Value is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date]]></comment>
			</column>
			<column name="TicketVoidAdvanceFeeDays" type="smallint" jt="5" >
				<comment><![CDATA[Number of days before visit date, until which refund is allowed with chargeable fees.
Value is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date]]></comment>
			</column>
			<column name="TicketVoidFeeProductId" type="int" jt="4" >
				<comment><![CDATA[Reference to the product fee, that will be applied in case "TicketvoidAdvanceFeeDays" field is configured]]></comment>
			</column>
			<column name="WalletClearingTriggerType" prior="WalletClearingType" type="smallint" jt="5" >
				<comment><![CDATA[LK[182] Expiration, Clearing, Breakage]]></comment>
			</column>
			<column name="MembershipPointClearingTriggerType" prior="MembershipPointClearingType" type="smallint" jt="5" >
				<comment><![CDATA[LK[182] Expiration, Clearing, Breakage]]></comment>
			</column>
			<column name="PerformanceFutureDays" type="int" jt="4" >
				<comment><![CDATA[For "before usage" events, indicates how far in the future a performance can be booked]]></comment>
			</column>
			<column name="PerformanceFutureDaysExt" type="int" jt="4" >
				<comment><![CDATA[For "before usage" events, indicates how far in the future a performance can be booked with override]]></comment>
			</column>
			<column name="PerformanceFutureQty" type="int" jt="4" >
				<comment><![CDATA[For "before usage" events, indicates the max number of bookable performances]]></comment>
			</column>
			<column name="PerformanceFutureQtyExt" type="int" jt="4" >
				<comment><![CDATA[For "before usage" events, indicates the max number of bookable performances with override]]></comment>
			</column>
			<column name="ProductPackageType" type="smallint" jt="5" >
				<comment><![CDATA[LK[481] (Merged products, Itemized products)]]></comment>
			</column>
			<column name="ProductPackageReadType" type="smallint" jt="5" >
				<comment><![CDATA[LK[482] (Grouped)]]></comment>
			</column>
			<column name="MediaEncoderPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Product media encoder pluginId]]></comment>
			</column>
			<column name="MediaPrintCodeAliasTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[define the codealiastype where the external encoded code will be saved]]></comment>
			</column>
			<column name="PerformanceSelectionType" type="smallint" jt="5" >
				<comment><![CDATA[LK[66] Entry Type - Automatic, Before encoding, before usage]]></comment>
			</column>
			<column name="PortfolioPriority" type="smallint" jt="5" >
				<comment><![CDATA[When configured, will determine the priority (of usage) of the product in the portfolio when sold.
Null value means the product will be inserted as last (lowest priority) in the portfolio.]]></comment>
			</column>
			<column name="TaxablePrice" type="money" jt="3" >
				<comment><![CDATA[Defines the percentage of the product’s price that is subject to taxes.]]></comment>
			</column>
			<column name="PriceGroupTagId" prior="PriceGroupId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Statistica grouping - Price group]]></comment>
			</column>
			<index name="UQ_Product_ProductCode" unique="UNIQUE_KEY" >
				<column name="ProductCode" options="ASC" />
			</index>
			<index name="IX_Product_ParentEntityId" unique="NORMAL" options="where ParentEntityId is not null" >
				<column name="ParentEntityId" options="ASC" />
			</index>
			<index name="IX_Product_CategoryId" unique="NORMAL" >
				<column name="CategoryId" options="ASC" />
			</index>
			<index name="IX_Product_AccountCategoryId" unique="NORMAL" >
				<column name="AccountCategoryId" options="ASC" />
			</index>
			<index name="IX_Product_CalendarId" unique="NORMAL" options="where CalendarId is not null" >
				<column name="CalendarId" options="ASC" />
			</index>
			<index name="IX_Product_PrintGroupTagId" unique="NORMAL" options="where PrintGroupTagId is not null" >
				<column name="PrintGroupTagId" options="ASC" />
			</index>
			<index name="IX_Product_FinanceGroupTagId" unique="NORMAL" options="where FinanceGroupTagId is not null" >
				<column name="FinanceGroupTagId" options="ASC" />
			</index>
			<index name="IX_Product_AdmGroupTagId" unique="NORMAL" options="where AdmGroupTagId is not null" >
				<column name="AdmGroupTagId" options="ASC" />
			</index>
			<index name="IX_Product_AreaGroupTagId" unique="NORMAL" options="where AreaGroupTagId is not null" >
				<column name="AreaGroupTagId" options="ASC" />
			</index>
			<index name="IX_Product_ExtMediaGroupId" unique="NORMAL" options="where ExtMediaGroupId is not null" >
				<column name="ExtMediaGroupId" options="ASC" />
			</index>
			<index name="IX_Product_TaxProfileId" unique="NORMAL" options="where TaxProfileId is not null" >
				<column name="TaxProfileId" options="ASC" />
			</index>
			<index name="IX_Product_LocationId" unique="NORMAL" options="where LocationId is not null" >
				<column name="LocationId" options="ASC" />
			</index>
			<index name="IX_Product_PaymentProfileId" unique="NORMAL" options="where PaymentProfileId is not null" >
				<column name="PaymentProfileId" options="ASC" />
			</index>
			<index name="IX_Product_MeasureProfileId" unique="NORMAL" options="where MeasureProfileId is not null" >
				<column name="MeasureProfileId" options="ASC" />
			</index>
			<index name="IX_Product_PresaleProductId" unique="NORMAL" options="where PresaleProductId is not null" >
				<column name="PresaleProductId" options="ASC" />
			</index>
			<index name="IX_Performance_CreateEventId" unique="NORMAL" options="where CreateEventId is not null" >
				<column name="CreateEventId" options="ASC" />
			</index>
			<index name="IX_Product_PosPricingPluginId" unique="NORMAL" options="where PosPricingPluginId is not null" >
				<column name="PosPricingPluginId" options="ASC" />
			</index>
			<index name="IX_Product_WebPricingPluginId" unique="NORMAL" options="where WebPricingPluginId is not null" >
				<column name="WebPricingPluginId" options="ASC" />
			</index>
			<index name="IX_Product_DatedCalendarId" unique="NORMAL" options="where DatedCalendarId is not null" >
				<column name="DatedCalendarId" options="ASC" />
			</index>
			<index name="IX_Product_RevalidateFeeProductId" unique="NORMAL" options="where RevalidateFeeProductId is not null" >
				<column name="RevalidateFeeProductId" options="ASC" />
			</index>
			<index name="PK_Product" unique="PRIMARY_KEY" >
				<column name="ProductId" />
			</index>
			<index name="IX_Product_VisitCalendarId" unique="NORMAL" options="where VisitCalendarId is not null" >
				<column name="VisitCalendarId" />
			</index>
			<index name="IX_Product_TicketVoidFeeProductId" unique="NORMAL" options="where TicketVoidFeeProductId is not null" >
				<column name="TicketVoidFeeProductId" />
			</index>
			<index name="IX_Product_StopSaleCalendarId" unique="NORMAL" options="WHERE StopSaleCalendarId is not null" >
				<column name="StopSaleCalendarId" />
			</index>
			<index name="IX_Product_ChangeVisitDateFeeProductId" unique="NORMAL" options="WHERE ChangeVisitDateFeeProductId is not NULL" >
				<column name="ChangeVisitDateFeeProductId" />
			</index>
			<index name="IX_Product_PriceGroupTagId" unique="NORMAL" options="where PriceGroupTagId is not null" >
				<column name="PriceGroupTagId" options="ASC" />
			</index>
			<fk name="FK_Product_Location" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_Product_CreateEvent" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="CreateEventId" pk="EventId" />
			</fk>
			<fk name="FK_Product_PresaleProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="PresaleProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Product_RevalidateFeeProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="RevalidateFeeProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Product_AccountCategory" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="AccountCategoryId" pk="CategoryId" />
			</fk>
			<fk name="FK_Product_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
			<fk name="FK_Product_PosPricingPlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PosPricingPluginId" pk="PluginId" />
			</fk>
			<fk name="FK_Product_WebPricingPlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="WebPricingPluginId" pk="PluginId" />
			</fk>
			<fk name="FK_Product_PrintGroupTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="PrintGroupTagId" pk="TagId" />
			</fk>
			<fk name="FK_Product_FinanceGroupTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="FinanceGroupTagId" pk="TagId" />
			</fk>
			<fk name="FK_Product_AdmGroupTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="AdmGroupTagId" pk="TagId" />
			</fk>
			<fk name="FK_Product_AreaGroupTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="AreaGroupTagId" pk="TagId" />
			</fk>
			<fk name="FK_Product_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_Product_DatedCalendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="DatedCalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_Product_TaxProfile" to_schema="SnApp.dbo" to_table="tbTaxProfile" >
				<fk_column name="TaxProfileId" pk="TaxProfileId" />
			</fk>
			<fk name="FK_Product_PaymentProfile" to_schema="SnApp.dbo" to_table="tbPaymentProfile" >
				<fk_column name="PaymentProfileId" pk="PaymentProfileId" />
			</fk>
			<fk name="FK_Product_MeasureProfile" to_schema="SnApp.dbo" to_table="tbMeasureProfile" >
				<fk_column name="MeasureProfileId" pk="MeasureProfileId" />
			</fk>
			<fk name="FK_Product_ExtMediaGroup" to_schema="SnApp.dbo" to_table="tbExtMediaGroup" >
				<fk_column name="ExtMediaGroupId" pk="ExtMediaGroupId" />
			</fk>
			<fk name="FK_Product_TicketVoidFeeProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="TicketVoidFeeProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Product_VisitCalendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="VisitCalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_Product_StopSaleCalendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="StopSaleCalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_Product_ChangeVisitDateFeeProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ChangeVisitDateFeeProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Product_PriceGroupTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="PriceGroupTagId" pk="TagId" />
			</fk>
		</table>
		<table name="tbProduct2AttributeItem" >
			<comment><![CDATA[Configured attribute items attached to a product type]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the attribute item]]></comment>
			</column>
			<column name="SelectionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[138]]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Sorting withing the product type]]></comment>
			</column>
			<column name="DynamicEntitlement" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Indicate how the attribute item entitlements portion should be merge on the product one. 0=Static; 1=Dynamic]]></comment>
			</column>
			<index name="IX_Product2AttributeItem_AttributeItemId" unique="NORMAL" >
				<column name="AttributeItemId" options="ASC" />
			</index>
			<index name="PK_Product2AttributeItem" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="AttributeItemId" />
			</index>
			<fk name="FK_Product2AttributeItem_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Product2AttributeItem_AttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="AttributeItemId" pk="AttributeItemId" />
			</fk>
		</table>
		<table name="tbProduct2CardType" >
			<comment><![CDATA[Enlist which product types (SourceProductId) are eligible to upgrade to the current product type (ProductId)]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CardTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_Product2CardType_CardTypeId" unique="NORMAL" >
				<column name="CardTypeId" options="ASC" />
			</index>
			<index name="PK_Product2CardType" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="CardTypeId" />
			</index>
			<fk name="FK_Product2CardType_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Product2CardType_CardType" to_schema="SnApp.dbo" to_table="tbCardType" >
				<fk_column name="CardTypeId" pk="CardTypeId" />
			</fk>
		</table>
		<table name="tbProduct2DocTemplate" >
			<comment><![CDATA[Holds the configured doc templates for each product type]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product type]]></comment>
			</column>
			<column name="ProductTemplateType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[275] Indicates the nature of the link between the product type and the doc template]]></comment>
			</column>
			<column name="Serial" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Sorting]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the doc template]]></comment>
			</column>
			<index name="IX_Product2DocTemplate_DocTemplateId" unique="NORMAL" options="where DocTemplateId is not null" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="PK_Product2DocTemplate" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="ProductTemplateType" />
				<column name="Serial" />
			</index>
			<fk name="FK_Product2DocTemplate_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Product2DocTemplate_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbProduct2Plugin" >
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the product]]></comment>
			</column>
			<column name="Product2PluginType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[375] = Dependency]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the plugin]]></comment>
			</column>
			<index name="PK_Product2Plugin" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="Product2PluginType" />
				<column name="PluginId" />
			</index>
			<index name="IX_Product2Plugin_PluginId" unique="NORMAL" >
				<column name="PluginId" options="ASC" />
				<column name="Product2PluginType" options="ASC" />
			</index>
			<fk name="FK_Product2Plugin_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Product2Plugin_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbProductAccountRule" >
			<comment><![CDATA[Sale's restrictions.
In order to sell the ProductId, it needs to be linked to an account which already owns RuleProductId]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="RuleProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="ExpToleranceDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Number of days, after RuleProduct expiration, until the rule is still applicable]]></comment>
			</column>
			<index name="IX_ProductAccountRule_RuleProductId" unique="NORMAL" >
				<column name="RuleProductId" options="ASC" />
			</index>
			<index name="PK_ProductAccountRule" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="RuleProductId" />
			</index>
			<fk name="FK_ProductAccountRule_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductAccountRule_RuleProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="RuleProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductBOM" >
			<comment><![CDATA[Bill of Materials per product]]></comment>
			<column name="ProductBOMId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ParentBOMId" type="uniqueidentifier" jt="1" />
			<column name="MaterialProductId" type="uniqueidentifier" jt="1" />
			<column name="MeasureId" type="uniqueidentifier" jt="1" />
			<column name="Quantity" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<column name="Optional" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="Included" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Determine if the material is included or not by default]]></comment>
			</column>
			<column name="GroupItem" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="GroupName" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Filled in only in case the record is the group header]]></comment>
			</column>
			<index name="IX_ProductBOM_MaterialProductId" unique="NORMAL" options="where MaterialProductId is not null" >
				<column name="MaterialProductId" options="ASC" />
			</index>
			<index name="IX_ProductBOM_MeasureId" unique="NORMAL" options="where MeasureId is not null" >
				<column name="MeasureId" options="ASC" />
			</index>
			<index name="IX_ProductBOM_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
				<column name="PriorityOrder" options="ASC" />
			</index>
			<index name="IX_ProductBOM_ParentBOMId" unique="NORMAL" >
				<column name="ParentBOMId" options="ASC" />
			</index>
			<index name="PK_ProductBOM" unique="PRIMARY_KEY" >
				<column name="ProductBOMId" />
			</index>
			<fk name="FK_ProductBOM_MaterialProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="MaterialProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductBOM_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductBOM_Measure" to_schema="SnApp.dbo" to_table="tbMeasure" >
				<fk_column name="MeasureId" pk="MeasureId" />
			</fk>
			<fk name="FK_ProductBOM_ParentBOM" to_schema="SnApp.dbo" to_table="tbProductBOM" >
				<fk_column name="ParentBOMId" pk="ProductBOMId" />
			</fk>
		</table>
		<table name="tbProductCrossSell" >
			<comment><![CDATA[List of third party products sellable by this system]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product type]]></comment>
			</column>
			<column name="CrossPlatformId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the external platform]]></comment>
			</column>
			<column name="CrossProductId" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[In case of SnApp will contain cross platform product id]]></comment>
			</column>
			<column name="CrossProductCode" type="varchar" length="15" jt="12" >
				<comment><![CDATA[In case of SnApp will contain cross platform product code]]></comment>
			</column>
			<column name="CrossProductName" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[In case of SnApp will contain cross platform product name]]></comment>
			</column>
			<column name="CrossProductStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[301]]]></comment>
			</column>
			<column name="UnitPrice" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Price charged between the 2 platform, not the selling to guest price]]></comment>
			</column>
			<index name="IX_ProductCrossSell_CrossPlatformId" unique="NORMAL" >
				<column name="CrossPlatformId" options="ASC" />
			</index>
			<index name="PK_ProductCrossSell" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="CrossPlatformId" />
				<column name="CrossProductId" />
			</index>
			<fk name="FK_ProductCrossSell_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductCrossSell_AccountCrossPlatform" to_schema="SnApp.dbo" to_table="tbAccountCrossPlatform" >
				<fk_column name="CrossPlatformId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbProductFamily" >
			<comment><![CDATA[Holds information about configured product families]]></comment>
			<column name="ProductFamilyId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Category of the product family (determins applicable data masks)]]></comment>
			</column>
			<column name="ProductFamilyStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[49]]]></comment>
			</column>
			<column name="ProductFamilyCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeri user defined code]]></comment>
			</column>
			<column name="ProductFamilyName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the product family]]></comment>
			</column>
			<column name="ProductFamilyNameExt" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Additional description]]></comment>
			</column>
			<column name="ShowNameExt" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if ProductFamilyNameExt should display or not. Changes POS UI representation of the family]]></comment>
			</column>
			<column name="TargetProductFamilyId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Used for up selling.
Example: "Silver Annual Pass" links to "Gold Annual Pass"]]></comment>
			</column>
			<column name="ParentEntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="ParentEntityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Product family could be overall available (this field = null) or beloning only to a subset entity (like an event)]]></comment>
			</column>
			<column name="BackgroundColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<column name="ForegroundColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[RGB hex color]]></comment>
			</column>
			<column name="IconAlias" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[Font-Awesome icon name]]></comment>
			</column>
			<index name="IX_ProductFamily_CategoryId" unique="NORMAL" >
				<column name="CategoryId" options="ASC" />
			</index>
			<index name="IX_ProductFamily_TargetProductFamilyId" unique="NORMAL" options="where TargetProductFamilyId is not null" >
				<column name="TargetProductFamilyId" options="ASC" />
			</index>
			<index name="IX_ProductFamily_ParentEntityId" unique="NORMAL" options="where ParentEntityId is not null" >
				<column name="ParentEntityId" options="ASC" />
			</index>
			<index name="PK_ProductFamily" unique="PRIMARY_KEY" >
				<column name="ProductFamilyId" />
			</index>
			<fk name="FK_ProductFamily_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
			<fk name="FK_ProductFamily_TargetProductFamily" to_schema="SnApp.dbo" to_table="tbProductFamily" >
				<fk_column name="TargetProductFamilyId" pk="ProductFamilyId" />
			</fk>
		</table>
		<table name="tbProductFlag" >
			<comment><![CDATA[Holds configure optional flags for product types]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product type]]></comment>
			</column>
			<column name="ProductFlag" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[274]]]></comment>
			</column>
			<index name="PK_ProductFlag" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="ProductFlag" />
			</index>
			<fk name="FK_ProductFlag_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductGuest" >
			<comment><![CDATA[Product types can include "guest tickets". This table defines quantities and limitations]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="GuestProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the "guset"/included product type]]></comment>
			</column>
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="AddToHostPortfolio" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the guest ticket should have its own portfolio or should be attached to the host portfolio]]></comment>
			</column>
			<column name="AutoAddToCart" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Automatically add guest product when the host product is added to cart]]></comment>
			</column>
			<column name="BindPerformance" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicate that guest product should inherit performance set on host product when sold]]></comment>
			</column>
			<index name="IX_ProductGuest_GuestProductId" unique="NORMAL" >
				<column name="GuestProductId" options="ASC" />
			</index>
			<index name="PK_ProductGuest" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="GuestProductId" />
			</index>
			<fk name="FK_ProductGuest_HostProduct" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductGuest_GuestProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="GuestProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductMediaConstraint" prior="Tbl" >
			<comment><![CDATA[Constraints for media assignable to product's portfolio]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[ProductType internal ID]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Media template internal ID]]></comment>
			</column>
			<column name="QuantityMin" type="smallint" jt="5" >
				<comment><![CDATA[Minimum assignable quantity]]></comment>
			</column>
			<column name="QuantityMax" type="smallint" jt="5" >
				<comment><![CDATA[Maximum assignable quantity]]></comment>
			</column>
			<index name="PK_ProductMediaConstraint" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="DocTemplateId" />
			</index>
			<index name="IX_ProductMediaConstraint_DocTemplateId" unique="NORMAL" >
				<column name="DocTemplateId" />
			</index>
			<fk name="FK_ProductMediaConstraint_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductMediaConstraint_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbProductPackage" prior="tbProductLink" >
			<comment><![CDATA[Package child products]]></comment>
			<column name="PackageId" prior="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the package]]></comment>
			</column>
			<column name="ProductId" prior="ChildProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the included product type]]></comment>
			</column>
			<column name="OptionSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the option set]]></comment>
			</column>
			<column name="Quantity" type="smallint" jt="5" mandatory="y" />
			<column name="PriceValueType" type="smallint" jt="5" >
				<comment><![CDATA[LK[135]]]></comment>
			</column>
			<column name="PriceValue" type="money" jt="3" >
				<comment><![CDATA[Value of the single product type, depends from PriceValueType]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting]]></comment>
			</column>
			<index name="IX_ProductPackage_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="PK_ProductPackage" unique="PRIMARY_KEY" >
				<column name="PackageId" />
				<column name="ProductId" />
			</index>
			<index name="IX_ProductPackage_OptionSetId" unique="NORMAL" >
				<column name="OptionSetId" />
			</index>
			<fk name="FK_ProductPackage_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="PackageId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductPackage_LinkedProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductPackage_OptionSet" to_schema="SnApp.dbo" to_table="tbOptionSet" delete_action="cascade" >
				<fk_column name="OptionSetId" pk="OptionSetId" />
			</fk>
		</table>
		<table name="tbProductPrice" >
			<comment><![CDATA[it's the product type's price matrix]]></comment>
			<column name="ProductPriceDateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ProductPriceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the sale channel. NULL = default]]></comment>
			</column>
			<column name="PerformanceTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the performance type. NULL = default]]></comment>
			</column>
			<column name="PriceActionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[134]]]></comment>
			</column>
			<column name="PriceValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135]]]></comment>
			</column>
			<column name="PriceValue" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Value of the cell. Meaning depends on PriceActionType and PriceActionValue]]></comment>
			</column>
			<index name="UQ_ProductPrice" unique="UNIQUE_KEY" >
				<column name="ProductPriceDateId" options="ASC" />
				<column name="SaleChannelId" options="ASC" />
				<column name="PerformanceTypeId" options="ASC" />
			</index>
			<index name="IX_ProductPrice_SaleChannelId" unique="NORMAL" >
				<column name="SaleChannelId" options="ASC" />
			</index>
			<index name="IX_ProductPrice_PerformanceTypeId" unique="NORMAL" >
				<column name="PerformanceTypeId" options="ASC" />
			</index>
			<index name="PK_ProductPrice" unique="PRIMARY_KEY" >
				<column name="ProductPriceDateId" />
				<column name="ProductPriceId" />
			</index>
			<fk name="FK_ProductPrice_PerformanceType" to_schema="SnApp.dbo" to_table="tbPerformanceType" >
				<fk_column name="PerformanceTypeId" pk="PerformanceTypeId" />
			</fk>
			<fk name="FK_ProductPrice_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_ProductPrice_ProductPriceDate" to_schema="SnApp.dbo" to_table="tbProductPriceDate" delete_action="cascade" >
				<fk_column name="ProductPriceDateId" pk="ProductPriceDateId" />
			</fk>
		</table>
		<table name="tbProductPriceAdvance" >
			<comment><![CDATA[It's the product type's advanced sale rules matrix]]></comment>
			<column name="ProductPriceDateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CellIndex" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Sequential number used just to complete the primary key]]></comment>
			</column>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Mutually exclusive with PerformanceTypeId and RateCodeId]]></comment>
			</column>
			<column name="PerformanceTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Mutually exclusive with SaleChannelId and RateCodeId]]></comment>
			</column>
			<column name="RateCodeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Mutually exclusive with SaleChannelId and PerformanceTypeId]]></comment>
			</column>
			<column name="AdvanceDays" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="PriceActionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[134]]]></comment>
			</column>
			<column name="PriceValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135]]]></comment>
			</column>
			<column name="PriceValue" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Value of the cell. Meaning depends on PriceActionType and PriceActionValue]]></comment>
			</column>
			<column name="TimeUnitType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[513]]]></comment>
			</column>
			<index name="IX_ProductPriceAdvance_SaleChannelId" unique="NORMAL" >
				<column name="SaleChannelId" options="ASC" />
			</index>
			<index name="IX_ProductPriceAdvance_PerformanceTypeId" unique="NORMAL" >
				<column name="PerformanceTypeId" options="ASC" />
			</index>
			<index name="IX_ProductPriceAdvance_RateCodeId" unique="NORMAL" >
				<column name="RateCodeId" options="ASC" />
			</index>
			<index name="PK_ProductPriceAdvance" unique="PRIMARY_KEY" >
				<column name="ProductPriceDateId" />
				<column name="CellIndex" />
			</index>
			<index name="UQ_ProductPriceAdvance" unique="UNIQUE_KEY" >
				<column name="ProductPriceDateId" options="ASC" />
				<column name="SaleChannelId" options="ASC" />
				<column name="PerformanceTypeId" options="ASC" />
				<column name="RateCodeId" options="ASC" />
				<column name="AdvanceDays" options="ASC" />
				<column name="TimeUnitType" options="ASC" />
			</index>
			<fk name="FK_ProductPriceAdvance_PerformanceType" to_schema="SnApp.dbo" to_table="tbPerformanceType" >
				<fk_column name="PerformanceTypeId" pk="PerformanceTypeId" />
			</fk>
			<fk name="FK_ProductPriceAdvance_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_ProductPriceAdvance_ProductPriceDate" to_schema="SnApp.dbo" to_table="tbProductPriceDate" delete_action="cascade" >
				<fk_column name="ProductPriceDateId" pk="ProductPriceDateId" />
			</fk>
			<fk name="FK_ProductPriceAdvance_RateCode" to_schema="SnApp.dbo" to_table="tbRateCode" >
				<fk_column name="RateCodeId" pk="RateCodeId" />
			</fk>
		</table>
		<table name="tbProductPriceDate" >
			<comment><![CDATA[It's the date based grouping for all price matrixes attached to a product type]]></comment>
			<column name="ProductPriceDateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Used to identify the price tabs in the configuration price configuration. It alllows SnApp to track the modifications into tbHistoryDetail]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Start date. Null = no limit]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[End date. Null = no limit]]></comment>
			</column>
			<column name="ValidTimeFrom" type="smalldatetime" jt="93" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="ValidTimeTo" type="smalldatetime" jt="93" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="ProductPriceDateSerialNumber" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Used to identify the exact ProductPriceDate in order to keep track of the history details when the configuration is changed]]></comment>
			</column>
			<column name="ProductPriceDateStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[378] Active / Deleted]]></comment>
			</column>
			<column name="FeePercValue" type="money" jt="3" >
				<comment><![CDATA[Percentage value of the transaction amount to be used to calculate the fee price]]></comment>
			</column>
			<index name="UQ_ProductPriceDate" unique="NORMAL" >
				<column name="ValidDateFrom" options="ASC" />
				<column name="ValidDateTo" options="ASC" />
				<column name="ValidTimeFrom" options="ASC" />
				<column name="ValidTimeTo" options="ASC" />
			</index>
			<index name="PK_ProductPriceDate" unique="PRIMARY_KEY" >
				<column name="ProductPriceDateId" />
			</index>
			<fk name="FK_ProductPriceDate_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductPriceMembershipPoint" >
			<comment><![CDATA[set how many rewards points are needed to purchase the product]]></comment>
			<column name="ProductPriceDateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriceValue" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_ProductPriceMembershipPoint_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="PK_ProductPriceMembershipPoint" unique="PRIMARY_KEY" >
				<column name="ProductPriceDateId" />
				<column name="MembershipPointId" />
			</index>
			<fk name="FK_ProductPriceMembershipPoint_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
			<fk name="FK_ProductPriceMembershipPoint_ProductPriceDate" to_schema="SnApp.dbo" to_table="tbProductPriceDate" delete_action="cascade" >
				<fk_column name="ProductPriceDateId" pk="ProductPriceDateId" />
			</fk>
		</table>
		<table name="tbProductPriceVariable" prior="tbProductVarPrice" >
			<comment><![CDATA[Contains preset amounts for "variable price" products]]></comment>
			<column name="ProductPriceVariableId" prior="ProductVarPriceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbProduct]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting]]></comment>
			</column>
			<column name="PriceValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135] absolute/percentage]]></comment>
			</column>
			<column name="PriceValue" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Amount]]></comment>
			</column>
			<index name="PK_ProductPriceVariable" unique="PRIMARY_KEY" >
				<column name="ProductPriceVariableId" />
			</index>
			<index name="IX_ProductPriceVariable_ProductId" unique="NORMAL" >
				<column name="ProductId" />
				<column name="PriorityOrder" />
			</index>
			<fk name="FK_ProductPriceVariable_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductRefund" >
			<comment><![CDATA[Product type's refund policies]]></comment>
			<column name="ProductRefundId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="EventId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[When null, represents the default for product]]></comment>
			</column>
			<column name="EntryAmountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135] Abs/Perc]]></comment>
			</column>
			<column name="EntryAmountValue" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount/Percentage to deduct for each entry]]></comment>
			</column>
			<column name="GuestEntryAmountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135] Abs/Perc]]></comment>
			</column>
			<column name="GuestEntryAmountValue" type="money" length="0" jt="3" >
				<comment><![CDATA[When null, guest products use same value as host products]]></comment>
			</column>
			<index name="UQ_ProductRefund_ProductId" unique="UNIQUE_KEY" >
				<column name="ProductId" options="ASC" />
				<column name="EventId" options="ASC" />
			</index>
			<index name="IX_ProductRefund_EventId" unique="NORMAL" options="where EventId is not null" >
				<column name="EventId" options="ASC" />
			</index>
			<index name="PK_ProductRefund" unique="PRIMARY_KEY" >
				<column name="ProductRefundId" />
			</index>
			<fk name="FK_ProductRefund_Event" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
			<fk name="FK_ProductRefund_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductRenewFromProduct" >
			<comment><![CDATA[Enlist which product types (SourceProductId) are eligible to upgrade to the current product type (ProductId)]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="SourceProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_ProductRenewFromProduct_SourceProductId" unique="NORMAL" >
				<column name="SourceProductId" options="ASC" />
			</index>
			<index name="PK_ProductRenewFromProduct" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="PriorityOrder" />
			</index>
		</table>
		<table name="tbProductRevenueDate" >
			<comment><![CDATA[Date ranges for revenue recognition configurations]]></comment>
			<column name="ProductRevenueDateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Used in order to identify the revenue recognition tabs in the configuration. It alllows SnApp to track the modifications into tbHistoryDetail]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Sequence for multiple record on the same product type]]></comment>
			</column>
			<column name="DateFrom" type="date" jt="91" >
				<comment><![CDATA[Date from. When null = unlimited]]></comment>
			</column>
			<column name="DateTo" type="date" jt="91" >
				<comment><![CDATA[Date to. When null = unlimited]]></comment>
			</column>
			<column name="BreakageDaysType" type="smallint" jt="5" >
				<comment><![CDATA[LK[349] Never, Sale date, Validation date, Expiration date]]></comment>
			</column>
			<column name="BreakageDays" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Number of days, after the sale of an unused ticket, where revenue should be anyway recognized (supposely the guest will never show up)]]></comment>
			</column>
			<column name="ProductVPT" type="money" length="0" jt="3" >
				<comment><![CDATA[VPT value (Visits Per Ticket). IE: a 3 day ticket is used on the average of only 2 times, so VPT=2. It means that the revenue should be recognized on 50% of the ticket value each entry]]></comment>
			</column>
			<column name="SerialNumber" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Used in order to identify the exact ProductRevenueDate in order to keep track of the history details when the configuration is changed]]></comment>
			</column>
			<column name="ProductRevenueDateStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Lk[355] Active / Deleted]]></comment>
			</column>
			<column name="GateCategoryConfigurationType" type="smallint" jt="5" >
				<comment><![CDATA[LK[505]]]></comment>
			</column>
			<index name="UQ_ProductRevenueDate_SerialNumber" unique="UNIQUE_KEY" >
				<column name="ProductId" options="ASC" />
				<column name="SerialNumber" options="ASC" />
			</index>
			<index name="PK_ProductRevenueDate" unique="PRIMARY_KEY" >
				<column name="ProductRevenueDateId" />
			</index>
			<fk name="FK_ProductRevenueDate_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductRevenueDateWeight" prior="Tbl" >
			<column name="ProductRevenueDateId" prior="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Used in order to identify the revenue recognition tabs in the configuration. It alllows SnApp to track the modifications into tbHistoryDetail]]></comment>
			</column>
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the location]]></comment>
			</column>
			<column name="Weight" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Always represents a percentage]]></comment>
			</column>
			<index name="IX_ProductRevenueDateWeight_LocationAccountId" unique="NORMAL" >
				<column name="LocationAccountId" />
			</index>
			<index name="PK_ProductRevenueDateWeight" unique="PRIMARY_KEY" >
				<column name="ProductRevenueDateId" />
				<column name="LocationAccountId" />
			</index>
			<fk name="FK_ProductRevenueDateWeight_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ProductRevenueDateWeight_ProductRevenueDate" to_schema="SnApp.dbo" to_table="tbProductRevenueDate" delete_action="cascade" >
				<fk_column name="ProductRevenueDateId" pk="ProductRevenueDateId" />
			</fk>
		</table>
		<table name="tbProductRevenueGateCategory" >
			<comment><![CDATA[Multiply tbProductRevenueDate by gate categories and defines the calendar to be used]]></comment>
			<column name="ProductRevenueDateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Used in order to identify the revenue recognition tabs in the configuration. It alllows SnApp to track the modifications into tbHistoryDetail]]></comment>
			</column>
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to gate category]]></comment>
			</column>
			<column name="RevenueRecognitionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[315] VPT, Amortization]]></comment>
			</column>
			<column name="ClearingLimit" type="money" length="0" jt="3" >
				<comment><![CDATA[Clearing limit]]></comment>
			</column>
			<column name="ClearingLimitType" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[135] Absolute, Percentage]]></comment>
			</column>
			<column name="CalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to calendar. It is used to retrieve the the performance type on a given date]]></comment>
			</column>
			<column name="AmortizationPeriods" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Works along with AmortizationPeriodType. IE: AmortizationPeriods=52, AmortizationPeriodType=WEEK]]></comment>
			</column>
			<column name="AmortizationPeriodType" type="smallint" jt="5" >
				<comment><![CDATA[LK[316] Day, Week, Month, Calendar]]></comment>
			</column>
			<column name="AmortizationCalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to calendar. It is used to generate amortization periods]]></comment>
			</column>
			<column name="AmortizationWithinExpiration" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When checked, amortization period generation will never generate periods after product expiration]]></comment>
			</column>
			<column name="AmortizationTrigger" type="smallint" jt="5" >
				<comment><![CDATA[LK[317] Sale, First usage]]></comment>
			</column>
			<column name="AmortizationDelay" type="smallint" jt="5" >
				<comment><![CDATA[First amortization period will start "ProductAmortizationDelay" days after start validity]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting order]]></comment>
			</column>
			<column name="ApplyOnTotal" type="bit" jt="-7" >
				<comment><![CDATA[Apply percentage calculation base on clearing limit total, instead of "non absolute residual"]]></comment>
			</column>
			<column name="ExtractFromGross" type="bit" jt="-7" >
				<comment><![CDATA[Indicates that the percentage has to be "deducted" from the clearing limit]]></comment>
			</column>
			<index name="IX_ProductRevenueGateCategory_GateCategoryId" unique="NORMAL" >
				<column name="GateCategoryId" options="ASC" />
			</index>
			<index name="IX_ProductRevenueGateCategory_CalendarId" unique="NORMAL" >
				<column name="CalendarId" options="ASC" />
			</index>
			<index name="IX_ProductRevenueGateCategory_AmortizationCalendarId" unique="NORMAL" >
				<column name="AmortizationCalendarId" options="ASC" />
			</index>
			<index name="PK_ProductRevenueGateCategory" unique="PRIMARY_KEY" >
				<column name="ProductRevenueDateId" />
				<column name="GateCategoryId" />
			</index>
			<index name="IX_ProductRevenueGateCategory_PriorityOrder" unique="NORMAL" >
				<column name="ProductRevenueDateId" />
				<column name="PriorityOrder" />
			</index>
			<fk name="FK_ProductRevenueGateCategory_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="CalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_ProductRevenueGateCategory_AmortizationCalendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="AmortizationCalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_ProductRevenueGateCategory_GateCategory" to_schema="SnApp.dbo" to_table="tbGateCategory" >
				<fk_column name="GateCategoryId" pk="GateCategoryId" />
			</fk>
			<fk name="FK_ProductRevenueGateCategory_ProductRevenueDate" to_schema="SnApp.dbo" to_table="tbProductRevenueDate" delete_action="cascade" >
				<fk_column name="ProductRevenueDateId" pk="ProductRevenueDateId" />
			</fk>
		</table>
		<table name="tbProductShare" >
			<comment><![CDATA[List of this system products shared with third party systems]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product type]]></comment>
			</column>
			<column name="CrossPlatformId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the external platform]]></comment>
			</column>
			<column name="UnitPrice" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Selling price (to the 3rd party system)]]></comment>
			</column>
			<index name="IX_PlatformShare_CrossPlatformId" unique="NORMAL" >
				<column name="CrossPlatformId" options="ASC" />
			</index>
			<index name="PK_ProductShare" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="CrossPlatformId" />
			</index>
			<fk name="FK_ProductShare_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductShare_AccountCrossPlatform" to_schema="SnApp.dbo" to_table="tbAccountCrossPlatform" >
				<fk_column name="CrossPlatformId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbProductSuspend" prior="Tbl" >
			<comment><![CDATA[Table to store periods of suspension by product type]]></comment>
			<column name="ProductSuspendId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="ProductSuspendSerial" prior="ProductSuspensionSerial" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Incremental value unique for product type]]></comment>
			</column>
			<column name="SuspendDateFrom" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Start of suspension period]]></comment>
			</column>
			<column name="SuspendDateTo" type="date" jt="91" >
				<comment><![CDATA[End of suspension period. When "null" suspension period does not end]]></comment>
			</column>
			<index name="PK_ProductSuspend" unique="PRIMARY_KEY" >
				<column name="ProductSuspendId" />
			</index>
			<index name="UQ_ProductSuspend_ProductSerial" unique="UNIQUE_INDEX" >
				<column name="ProductId" />
				<column name="ProductSuspendSerial" />
			</index>
			<index name="IX_ProductSuspend_ProductId" unique="NORMAL" options="INCLUDE (SuspendDateFrom, ProductSuspendSerial)" >
				<column name="ProductId" />
				<column name="SuspendDateTo" />
			</index>
			<fk name="FK_ProductSuspend_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductUpgrade" >
			<comment><![CDATA[Product type's upgrade/downgrade policy]]></comment>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Source object (product/category)]]></comment>
			</column>
			<column name="EntityType" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="FirstUsageUpgradeDays" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Number of days from first usage, after which is still permitted to upgrade]]></comment>
			</column>
			<column name="ExpirationUpgradeDays" type="smallint" jt="5" >
				<comment><![CDATA[Number of days from product expiration, after which upgrade will be prevented]]></comment>
			</column>
			<column name="FromVisitUpgradeDays" type="smallint" jt="5" >
				<comment><![CDATA[Number of days before visit date, until which upgrade is allowed.
Value is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date]]></comment>
			</column>
			<column name="FromVisitUpgradePerfDays" type="smallint" jt="5" >
				<comment><![CDATA[Number of days before visit date, until which is possible to change visit date while upgrading.
Value is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date]]></comment>
			</column>
			<column name="AllowCrossLocationUpg" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Limits the applicability of the upgrade on product belonging to different locations]]></comment>
			</column>
			<column name="InheritFromCat" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Inherit from category]]></comment>
			</column>
			<index name="PK_ProductUpgrade" unique="PRIMARY_KEY" >
				<column name="EntityId" />
			</index>
		</table>
		<table name="tbProductUpgrade2Location" >
			<comment><![CDATA[List of allowed cross-location-upgrade]]></comment>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product type]]></comment>
			</column>
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to location]]></comment>
			</column>
			<index name="IX_ProductUpgrade2Location_LocationAccountId" unique="NORMAL" >
				<column name="LocationAccountId" options="ASC" />
			</index>
			<index name="PK_ProductUpgrade2Location" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="LocationAccountId" />
			</index>
			<fk name="FK_ProductUpgrade2Location_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ProductUpgrade2Location_ProductUpgrade" to_schema="SnApp.dbo" to_table="tbProductUpgrade" >
				<fk_column name="EntityId" pk="EntityId" />
			</fk>
		</table>
		<table name="tbProductUpgrade2Product" >
			<comment><![CDATA[List of quick upgrades]]></comment>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product type]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Destination product type]]></comment>
			</column>
			<column name="UpgradePrice" type="money" length="0" jt="3" >
				<comment><![CDATA[If null the upgrade price follows base rules, if present, flat upgrade.]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting]]></comment>
			</column>
			<index name="IX_ProductUpgrade2Product_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="PK_ProductUpgrade2Product" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="ProductId" />
			</index>
			<fk name="FK_ProductUpgrade2Product_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductUpgrade2Product_ProductUpgrade" to_schema="SnApp.dbo" to_table="tbProductUpgrade" >
				<fk_column name="EntityId" pk="EntityId" />
			</fk>
		</table>
		<table name="tbProductUpsell" prior="Tbl" >
			<comment><![CDATA[Suggested upsell products for each product]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product internal ID]]></comment>
			</column>
			<column name="TargetProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product suggested for upsell]]></comment>
			</column>
			<column name="PriorityOrder" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Sorting index]]></comment>
			</column>
			<column name="UpsellType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[488] Alternative / AddOn]]></comment>
			</column>
			<column name="SamePortfolio" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Indicates if the product "TargetProductId" suggested for upsell (add-on only) should be added to the same portfolio as "ProductId"]]></comment>
			</column>
			<column name="BindPerformance" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Auto-select triggering product's performance]]></comment>
			</column>
			<column name="QuantityMin" type="int" jt="4" >
				<comment><![CDATA[Minimun quantity constraint]]></comment>
			</column>
			<column name="QuantityMax" type="int" jt="4" >
				<comment><![CDATA[Max quantity constraint]]></comment>
			</column>
			<index name="PK_ProductUpsell" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="TargetProductId" />
			</index>
			<index name="IX_ProductUpsell_PriorityOrder" unique="NORMAL" >
				<column name="ProductId" />
				<column name="PriorityOrder" />
			</index>
			<index name="IX_ProductUpsell_TargetProductId" unique="NORMAL" >
				<column name="TargetProductId" />
			</index>
			<fk name="FK_ProductUpsell_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ProductUpsell_TargetProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="TargetProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbProductVPT" >
			<comment><![CDATA[Each record represent a cell in a bi-dimensional (sale channel / performance type) matrix for VPT (Visits Per Ticket) configuration]]></comment>
			<column name="ProductVPTId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Primary Key]]></comment>
			</column>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to sale channel]]></comment>
			</column>
			<column name="PerformanceTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to performance type]]></comment>
			</column>
			<column name="ProductVPT" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[VPT value (Visits Per Ticket). IE: a 3 day ticket is used on the average of only 2 times, so VPT=2. It means that the revenue should be recognized on 50% of the ticket value each entry]]></comment>
			</column>
			<column name="ProductRevenueDateId" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Used in order to identify the revenue recognition tabs in the configuration. It alllows SnApp to track the modifications into tbHistoryDetail]]></comment>
			</column>
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ProductRevenueDateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="UQ_ProductVPT_ProductRevenue" unique="UNIQUE_KEY" >
				<column name="SaleChannelId" options="ASC" />
				<column name="PerformanceTypeId" options="ASC" />
				<column name="ProductRevenueDateId" options="ASC" />
			</index>
			<index name="IX_ProductVPT_SaleChannelId" unique="NORMAL" >
				<column name="SaleChannelId" options="ASC" />
			</index>
			<index name="IX_ProductVPT_PerformanceTypeId" unique="NORMAL" >
				<column name="PerformanceTypeId" options="ASC" />
			</index>
			<index name="IX_ProductVPT_ProductGateCategory" unique="NORMAL" >
				<column name="ProductRevenueDateId" options="ASC" />
				<column name="GateCategoryId" options="ASC" />
			</index>
			<index name="PK_ProductVPT" unique="PRIMARY_KEY" >
				<column name="ProductVPTId" />
			</index>
			<fk name="FK_ProductVPT_PerformanceType" to_schema="SnApp.dbo" to_table="tbPerformanceType" >
				<fk_column name="PerformanceTypeId" pk="PerformanceTypeId" />
			</fk>
			<fk name="FK_ProductVPT_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_ProductVPT_ProductRevenueGateCategory" to_schema="SnApp.dbo" to_table="tbProductRevenueGateCategory" >
				<fk_column name="GateCategoryId" pk="ProductRevenueDateId" />
			</fk>
		</table>
		<table name="tbPromoAction" >
			<column name="PromoActionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ActionProductId" type="uniqueidentifier" jt="1" />
			<column name="ActionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[[176] Percentage/Absolute]]></comment>
			</column>
			<column name="ActionValue" type="money" length="0" jt="3" mandatory="y" />
			<index name="PK_PromoAction" unique="PRIMARY_KEY" >
				<column name="PromoActionId" />
			</index>
			<index name="IX_PromoAction_ProductId" unique="NORMAL" >
				<column name="ProductId" />
			</index>
			<index name="IX_PromoAction_ActionProductId" unique="NORMAL" >
				<column name="ActionProductId" />
			</index>
			<fk name="FK_PromoAction_ActionProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ActionProductId" pk="ProductId" />
			</fk>
			<fk name="FK_PromoAction_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbPromoActionMembershipPoint" >
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Points" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_PromoActionMembershipPoint_MembershiPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="PK_PromoActionMembershipPoint" unique="PRIMARY_KEY" >
				<column name="ProductId" />
				<column name="MembershipPointId" />
			</index>
			<fk name="FK_PromoActionMembershipPoint_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_PromoActionMembershipPoint_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
		</table>
		<table name="tbPromoRule" >
			<comment><![CDATA[Holds information about configured promotion rules]]></comment>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="Combinable" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Combinable with other promotions]]></comment>
			</column>
			<column name="PromoRuleType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[239] Generic / Individual / Common]]></comment>
			</column>
			<column name="PromoSelectionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[175] Optional / Automatic / Manual]]></comment>
			</column>
			<column name="ValidityDateFrom" type="date" jt="91" >
				<comment><![CDATA[Validity constraint of the promotion.
Null = no limits]]></comment>
			</column>
			<column name="ValidityDateTo" type="date" jt="91" >
				<comment><![CDATA[Validity constraint of the promotion.
Null = no limits]]></comment>
			</column>
			<column name="MinTrnAmount" type="money" length="0" jt="3" >
				<comment><![CDATA[Minimum transaction amount to activate the promotion. Null = no limit.]]></comment>
			</column>
			<column name="MinItemCount" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Mimimum number of items to activate the promotion. Null = no limit.]]></comment>
			</column>
			<column name="MinItemAmount" type="money" length="0" jt="3" >
				<comment><![CDATA[Only items with an amount equal or higher than this value will be conunted to check the MinItemCount. Null = no limit]]></comment>
			</column>
			<column name="PrdType" prior="BenefitPeriodType" type="smallint" jt="5" >
				<comment><![CDATA[LK[487] Determines how the system should calculate the benefit period.]]></comment>
			</column>
			<column name="PrdMaxItemCount" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Maximum number of items in the period]]></comment>
			</column>
			<column name="PrdLimit" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Number of days]]></comment>
			</column>
			<column name="PromoActionTarget" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[177] Trn / Item / Single item / Membership Point]]></comment>
			</column>
			<column name="PromoDiscountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[176] Abs price / Abs discount / Perc]]></comment>
			</column>
			<column name="PromoDiscountValue" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Discount amount o minimum discount amount if PromoDiscountValueMax is set.]]></comment>
			</column>
			<column name="PromoDiscountValueMax" type="money" length="0" jt="3" >
				<comment><![CDATA[Maximum discount amount]]></comment>
			</column>
			<column name="HideOnPOS" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Hide the promotion button on the POS]]></comment>
			</column>
			<column name="MaxRulePerTrans" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Maximum number of times the promotion can be appied to a single transaction. Null = no limits]]></comment>
			</column>
			<column name="VariableDiscount" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true it allows a variable discount with a value between the PromoDiscountValue and the PromoDiscountValueMax]]></comment>
			</column>
			<column name="PromoMembershipPointTarget" type="smallint" jt="5" >
				<comment><![CDATA[LK[3076] Privilege/Purchased Item]]></comment>
			</column>
			<column name="PosPromoRulePluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the promo rule plugin to be used from POS]]></comment>
			</column>
			<column name="WebPromoRulePluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the promo rule plugin to be used from Web]]></comment>
			</column>
			<column name="CouponExpirationRule" type="smallint" jt="5" >
				<comment><![CDATA[LK[499] CouponExpirationRule]]></comment>
			</column>
			<column name="CouponExpirationRuleQuantity" type="smallint" jt="5" >
				<comment><![CDATA[This quantity counts the number fo days works along with the field CouponExpirationRule]]></comment>
			</column>
			<index name="PK_PromoRule" unique="PRIMARY_KEY" >
				<column name="ProductId" />
			</index>
			<index name="IX_PromoRule_PosPromoRulePluginId" unique="NORMAL" options="where PosPromoRulePluginId is not null" >
				<column name="PosPromoRulePluginId" />
			</index>
			<index name="IX_PromoRule_WebPromoRulePluginId" unique="NORMAL" options="where WebPromoRulePluginId is not null" >
				<column name="WebPromoRulePluginId" />
			</index>
			<fk name="FK_PromoRule_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_PromoRule_PosPromoRulePlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PosPromoRulePluginId" pk="PluginId" />
			</fk>
			<fk name="FK_PromoRule_WebPromoRulePlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="WebPromoRulePluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbPromoTrigger" >
			<column name="PromoTriggerId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TriggerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK [188] RuleTrigger/RuleActivation]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TriggerCategoryId" type="uniqueidentifier" jt="1" />
			<column name="TriggerProductId" type="uniqueidentifier" jt="1" />
			<column name="QuantityMin" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantityStep" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_PromoTrigger_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="PK_PromoTrigger" unique="PRIMARY_KEY" >
				<column name="PromoTriggerId" />
			</index>
			<index name="IX_PromoTrigger_TriggerCategoryId" unique="NORMAL" >
				<column name="TriggerCategoryId" />
			</index>
			<index name="IX_PromoTrigger_TriggerProductId" unique="NORMAL" >
				<column name="TriggerProductId" />
			</index>
			<fk name="FK_PromoTrigger_TriggerProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="TriggerProductId" pk="ProductId" />
			</fk>
			<fk name="FK_PromoTrigger_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_PromoTrigger_TriggerCategory" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="TriggerCategoryId" pk="CategoryId" />
			</fk>
		</table>
		<table name="tbQueueStat" >
			<comment><![CDATA[Consolidated statistics for outbound messages/eventing]]></comment>
			<column name="QueueStatType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[330]]]></comment>
			</column>
			<column name="TimeSlot" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[15 minutes timeslot]]></comment>
			</column>
			<column name="GroupCode" type="varchar" length="100" decimal="0" jt="12" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Reference to server]]></comment>
			</column>
			<column name="GroupName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="ProcMinMS" type="bigint" jt="-5" mandatory="y" >
				<comment><![CDATA[Minimum processing time msecs in the slot]]></comment>
			</column>
			<column name="ProcMaxMS" type="bigint" jt="-5" mandatory="y" >
				<comment><![CDATA[Maximum processing time msecs in the slot]]></comment>
			</column>
			<column name="ProcAvgMS" type="bigint" jt="-5" mandatory="y" >
				<comment><![CDATA[Average processing time msecs in the slot]]></comment>
			</column>
			<column name="ProcTotalMS" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" >
				<comment><![CDATA[Total processing msecs in the slot]]></comment>
			</column>
			<column name="QueueMinMS" type="bigint" jt="-5" mandatory="y" >
				<comment><![CDATA[Minimum queue time msecs in the slot]]></comment>
			</column>
			<column name="QueueMaxMS" type="bigint" jt="-5" mandatory="y" >
				<comment><![CDATA[Maximum queue time msecs in the slot]]></comment>
			</column>
			<column name="QueueAvgMS" type="bigint" jt="-5" mandatory="y" >
				<comment><![CDATA[Average queue time msecs in the slot]]></comment>
			</column>
			<column name="QueueTotalMS" type="bigint" length="1" decimal="0" jt="-5" mandatory="y" >
				<comment><![CDATA[Total queue time msecs in the slot]]></comment>
			</column>
			<column name="ItemCount" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Total number of queue items in the slot]]></comment>
			</column>
			<index name="IX_OutboundStat_ServerId" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="QueueStatType" options="ASC" />
				<column name="TimeSlot" options="ASC" />
			</index>
			<index name="PK_QueueStat" unique="PRIMARY_KEY" >
				<column name="QueueStatType" />
				<column name="TimeSlot" />
				<column name="GroupCode" />
				<column name="ServerId" />
			</index>
			<fk name="FK_QueueStat_Server" to_schema="SnApp.dbo" to_table="tbServer" delete_action="cascade" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbQueueWait" prior="tbQueueWaits" >
			<comment><![CDATA[Contains statistics about queue wait & working count/times]]></comment>
			<column name="QueueStatType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[330]]]></comment>
			</column>
			<column name="ConsolidateType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[167]]]></comment>
			</column>
			<column name="TimeSlot" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[15 mins timeslot]]></comment>
			</column>
			<column name="QueueCountMin" prior="QueueAvgCount" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Min number of queued items seen]]></comment>
			</column>
			<column name="QueueCountMax" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Max number of queued items seen]]></comment>
			</column>
			<column name="QueueWaitMaxMS" type="bigint" jt="-5" mandatory="y" >
				<comment><![CDATA[Max queue time seen]]></comment>
			</column>
			<column name="WorkCountMin" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Min number of working items seen]]></comment>
			</column>
			<column name="WorkCountMax" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Max number of working items seen]]></comment>
			</column>
			<column name="WorkProcMaxMS" type="bigint" jt="-5" mandatory="y" >
				<comment><![CDATA[Max processing time seen]]></comment>
			</column>
			<index name="PK_QueueWait" unique="PRIMARY_KEY" >
				<column name="QueueStatType" />
				<column name="ConsolidateType" />
				<column name="TimeSlot" />
			</index>
			<index name="IX_QueueWait_TimeSlot" unique="NORMAL" >
				<column name="TimeSlot" />
				<column name="ConsolidateType" />
				<column name="QueueStatType" />
			</index>
		</table>
		<table name="tbRateCode" >
			<comment><![CDATA[Holds information about configured rate codes]]></comment>
			<column name="RateCodeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="RateCodeCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric (limited to 2 chars) user defined code]]></comment>
			</column>
			<column name="RateCodeName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the rate code]]></comment>
			</column>
			<column name="RateCodeColor" type="varchar" length="6" decimal="0" jt="12" >
				<comment><![CDATA[HEX color]]></comment>
			</column>
			<column name="RateCodeSymbol" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[Font-awesome code for icon]]></comment>
			</column>
			<column name="PriceActionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[134]]]></comment>
			</column>
			<column name="PriceValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135]]]></comment>
			</column>
			<column name="PriceValue" type="money" length="0" jt="3" >
				<comment><![CDATA[Value of the cell. Meaning depends on PriceActionType and PriceActionValue]]></comment>
			</column>
			<index name="UQ_RateCode_Code" unique="UNIQUE_KEY" >
				<column name="RateCodeCode" options="ASC" />
			</index>
			<index name="PK_RateCode" unique="PRIMARY_KEY" >
				<column name="RateCodeId" />
			</index>
		</table>
		<table name="tbReceiptSpool" >
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the transaction which receipt needs to be printed]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the doc template to be printed]]></comment>
			</column>
			<column name="PrintFull" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When true the receipt will contain full list of items of the order, when false will contain only elements added/modified in the specific transaction]]></comment>
			</column>
			<column name="ReceiptSpoolStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[267] - To be printed, Waiting confirm, Printed]]></comment>
			</column>
			<column name="TransactionFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Transaction fisca date]]></comment>
			</column>
			<column name="PrintDateTime" type="smalldatetime" jt="93" >
				<comment><![CDATA[Date/Time of printing]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the workstation that performed the transaction. When empty every spooler can potentially print the receipt, when specified only spoolers configured to print recepits of that particular workstation can print the receipt]]></comment>
			</column>
			<column name="OpAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the Operating area of the workstation that performed the transction. Only spoolers configured to print recepits of that particular operating area can print the receipt]]></comment>
			</column>
			<index name="IX_ReceiptSpool_DocTemplateId" unique="NORMAL" >
				<column name="DocTemplateId" options="ASC" />
				<column name="ReceiptSpoolStatus" options="ASC" />
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_ReceiptSpool_TransactionFiscalDate" unique="NORMAL" >
				<column name="TransactionFiscalDate" options="ASC" />
				<column name="ReceiptSpoolStatus" options="ASC" />
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_ReceiptSpool_OpAreaAccountId" unique="NORMAL" >
				<column name="OpAreaAccountId" options="ASC" />
			</index>
			<index name="PK_ReceiptSpool" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="DocTemplateId" />
				<column name="PrintFull" />
			</index>
			<fk name="FK_ReceiptSpooler_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ReceiptSpool_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_ReceiptSpool_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbRedemptionCommissionRule" >
			<column name="RedemptionCommissionRuleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AccessPointId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LocationId" type="uniqueidentifier" jt="1" />
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" />
			<column name="ValidDateFrom" type="date" jt="91" />
			<column name="ValidDateTo" type="date" jt="91" />
			<column name="CommissionRuleValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135]]]></comment>
			</column>
			<column name="CommissionRuleValue" type="money" length="0" jt="3" mandatory="y" />
			<column name="CommissionRuleFormula" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[390]]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="CommissionRuleStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[396]]]></comment>
			</column>
			<column name="CalculationAmountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[510]]]></comment>
			</column>
			<column name="TaxProfileId" type="uniqueidentifier" jt="1" />
			<index name="IX_RedemptionCommissionRule_LocationId" unique="NORMAL" options="where LocationId is not null" >
				<column name="LocationId" options="ASC" />
			</index>
			<index name="IX_RedemptionCommissionRule_PriorityOrder" unique="NORMAL" >
				<column name="PriorityOrder" options="ASC" />
			</index>
			<index name="IX_RedemptionCommissionRule_AccessPointId" unique="NORMAL" options="where AccessPointId is not null" >
				<column name="AccessPointId" options="ASC" />
			</index>
			<index name="IX_RedemptionCommissionRule_OpAreaId" unique="NORMAL" options="where OpAreaId is not null" >
				<column name="OpAreaId" options="ASC" />
			</index>
			<index name="IX_RedemptionCommissionRule_MembershipPointId" unique="NORMAL" options="where MembershipPointId is not null" >
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="PK_RedemptionCommissionRule" unique="PRIMARY_KEY" >
				<column name="RedemptionCommissionRuleId" />
			</index>
			<index name="IX_RedemptionCommissionRule_TaxProfileId" unique="NORMAL" options="where TaxProfileId is not null" >
				<column name="TaxProfileId" options="ASC" />
			</index>
			<fk name="FK_RedemptionCommissionRule_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
			<fk name="FK_RedemptionCommissionRule_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
			<fk name="FK_RedemptionCommissionRule_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="AccessPointId" pk="WorkstationId" />
			</fk>
			<fk name="FK_RedemptionCommissionRule_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
			<fk name="FK_RedemptionCommissionRule_TaxProfile" to_schema="SnApp.dbo" to_table="tbTaxProfile" delete_action="setNull" update_action="cascade" >
				<fk_column name="TaxProfileId" pk="TaxProfileId" />
			</fk>
		</table>
		<table name="tbRedemptionCommissionRuleLink" >
			<comment><![CDATA[Stores links for pay-par-use rules
- Events
- Event tags
- ProductTypes
- ProductType tags]]></comment>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to linked entity]]></comment>
			</column>
			<column name="RedemptionCommissionRuleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="PK_RedemptionCommissionRuleLink" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="RedemptionCommissionRuleId" />
			</index>
			<index name="IX_RedemptionCommissionRuleLink_RedemptionCommissionRuleId" unique="NORMAL" >
				<column name="RedemptionCommissionRuleId" />
			</index>
			<fk name="FK_RedemptionCommissionRuleLink_RedemptionCommissionRule" to_schema="SnApp.dbo" to_table="tbRedemptionCommissionRule" delete_action="cascade" >
				<fk_column name="RedemptionCommissionRuleId" pk="RedemptionCommissionRuleId" />
			</fk>
		</table>
		<table name="tbRelation" >
			<column name="RelationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RelationName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="ReverseRelationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_Relation_ReverseRelationId" unique="NORMAL" >
				<column name="ReverseRelationId" options="ASC" />
			</index>
			<index name="PK_Relation" unique="PRIMARY_KEY" >
				<column name="RelationId" />
			</index>
		</table>
		<table name="tbRepository" >
			<column name="RepositoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RepositoryCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="FileName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Description" type="nvarchar" length="50" jt="12" />
			<column name="Version" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="Shared" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="RequireParsing" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When attached to order confirmation emails, the document gets parsed and filled with dynamic data]]></comment>
			</column>
			<column name="DistinctAttachment" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When attached to order confirmation emails, attach 1 copy for each guest]]></comment>
			</column>
			<column name="ConvertToPDF" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When attached to order confirmation emails gets converted into PDF format]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" />
			<column name="DocData" type="varbinary(max)" jt="-3" mandatory="y" />
			<column name="Thumb" type="varbinary(max)" jt="-3" >
				<comment><![CDATA[50px smooth scaled]]></comment>
			</column>
			<column name="Small" type="varbinary(max)" jt="-3" >
				<comment><![CDATA[150px smooth scaled]]></comment>
			</column>
			<column name="Large" type="varbinary(max)" jt="-3" >
				<comment><![CDATA[400px width, not scaled]]></comment>
			</column>
			<column name="Hash" type="nvarchar" length="32" decimal="0" jt="12" >
				<comment><![CDATA[md5 hash]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Beginning of validity]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[Expiration of validity]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to "waiver" template (tbDocTemplate)]]></comment>
			</column>
			<index name="IX_Repository_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_Repository_EntityType" unique="NORMAL" >
				<column name="EntityType" options="ASC" />
				<column name="FileName" options="ASC" />
			</index>
			<index name="UQ_Repository_RepositoryCode" unique="UNIQUE_KEY" >
				<column name="RepositoryCode" options="ASC" />
			</index>
			<index name="PK_Repository" unique="PRIMARY_KEY" >
				<column name="RepositoryId" />
			</index>
			<index name="IX_Repository_DocTemplateId" unique="NORMAL" options="INCLUDE (ValidDateFrom) WHERE DocTemplateId is NOT NULL" >
				<column name="DocTemplateId" />
				<column name="EntityId" />
				<column name="ValidDateTo" />
			</index>
			<index name="IX_Repository_ValidDateTo" unique="NORMAL" options="WHERE ValidDateTo IS NOT NULL" >
				<column name="ValidDateTo" />
			</index>
		</table>
		<table name="tbRepositoryIndex" >
			<column name="RepositoryIndexId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RepositoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RepositoryIndexType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[133]]]></comment>
			</column>
			<index name="IX_RepositoryIndex_EntityId" unique="NORMAL" options="include (RepositoryId)" >
				<column name="EntityId" options="ASC" />
				<column name="RepositoryIndexType" options="ASC" />
			</index>
			<index name="PK_RepositoryIndex" unique="PRIMARY_KEY" >
				<column name="RepositoryIndexId" />
			</index>
			<index name="IX_RepositoryIndex_RepositoryId" unique="NORMAL" >
				<column name="RepositoryId" />
			</index>
			<fk name="FK_RepositoryIndex_Repository" to_schema="SnApp.dbo" to_table="tbRepository" delete_action="cascade" >
				<fk_column name="RepositoryId" pk="RepositoryId" />
			</fk>
		</table>
		<table name="tbResourceConfig" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[EventId / ProductId]]></comment>
			</column>
			<column name="ResourceTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="Mandatory" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="Main" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="AutoSelect" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="GroupByPerformance" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates that the resource is booked at order level (instead of individual item)]]></comment>
			</column>
			<index name="IX_ResourceConfig_ResourceTypeId" unique="NORMAL" >
				<column name="ResourceTypeId" options="ASC" />
			</index>
			<index name="PK_ResourceConfig" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="ResourceTypeId" />
			</index>
			<fk name="FK_ResourceConfig_ResourceType" to_schema="SnApp.dbo" to_table="tbResourceType" >
				<fk_column name="ResourceTypeId" pk="ResourceTypeId" />
			</fk>
		</table>
		<table name="tbResourceHold" prior="Tbl" >
			<comment><![CDATA[Information about resource "hold ids"]]></comment>
			<column name="ResourceHoldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="ResourceHoldStatus" type="int" length="1" jt="4" mandatory="y" >
				<comment><![CDATA[LK[455]]]></comment>
			</column>
			<column name="GroupHold" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the hold is referred to a group of tickets (ie restaurant booking) instead of individual ticket resource]]></comment>
			</column>
			<column name="HoldDateTimeFrom" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Resource hold starting time]]></comment>
			</column>
			<column name="HoldDateTimeTo" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Resource hold ending time]]></comment>
			</column>
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Hold creation timestamp]]></comment>
			</column>
			<column name="ExpireDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Expiration timestamp]]></comment>
			</column>
			<column name="ExtResourceHold" type="varchar" length="50" jt="12" >
				<comment><![CDATA[HoldId given by 3rd party integration]]></comment>
			</column>
			<column name="ExtResourceDesc" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Visual resource name returned by 3rd party integration]]></comment>
			</column>
			<column name="ExtResourceData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Any other proprietary data (JSON/XML) given by 3rd party integration]]></comment>
			</column>
			<column name="AvailabilityPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Plugin in charge of handling external capacity availability]]></comment>
			</column>
			<index name="PK_ResourceHold" unique="PRIMARY_KEY" >
				<column name="ResourceHoldId" />
			</index>
			<index name="IX_ResourceHold_ExpireDateTime" unique="NORMAL" options="include (ResourceHoldStatus) where ExpireDateTime is not null" >
				<column name="ExpireDateTime" />
			</index>
			<index name="IX_ResourceHold_ExtResourceHold" unique="NORMAL" options="where ExtResourceHold is not null" >
				<column name="ExtResourceHold" />
			</index>
			<index name="IX_ResourceHold_AvailabilityPluginId" unique="NORMAL" options="where AvailabilityPluginId is not null" >
				<column name="AvailabilityPluginId" />
			</index>
			<fk name="FK_ResourceHold_AvailabilityPlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="AvailabilityPluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbResourceSchedule" >
			<column name="ResourceScheduleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ResourceSerialId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DateTimeFrom" type="smalldatetime" jt="93" mandatory="y" />
			<column name="DateTimeTo" type="smalldatetime" jt="93" mandatory="y" />
			<column name="DurationMins" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Could be greater than the difference between DateTimeFrom/To, if the product type has ResourceEndOfDay flagged]]></comment>
			</column>
			<column name="ScheduleStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[204] Hold, Book, Collected, Returned]]></comment>
			</column>
			<column name="MainResource" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="ResourceHoldId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ExtResourceHold" type="varchar" length="50" jt="12" >
				<comment><![CDATA[HoldId given by 3rd party integration (when using AvailabilityPluginId)]]></comment>
			</column>
			<column name="ExtResourceDesc" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Visual resource name returned by 3rd party integration (when using AvailabilityPluginId)]]></comment>
			</column>
			<column name="ExtResourceData" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Any other proprietary data (JSON/XML) given by 3rd party integration (when using AvailabilityPluginId)]]></comment>
			</column>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For pre-scheduled classes. Mutually exclusive with ProductId]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For free scheduling. Mutually exclusive with PerformanceId]]></comment>
			</column>
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" />
			<column name="TicketId" type="uniqueidentifier" jt="1" />
			<column name="HoldExpire" type="smalldatetime" jt="93" />
			<column name="HandOverTransactionId" type="uniqueidentifier" jt="1" />
			<column name="ReturnTransactionId" type="uniqueidentifier" jt="1" />
			<column name="AdvancedSaleQuantity" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Quantity sellable in advance (not on the same day of the schedule). Null = NoLimits]]></comment>
			</column>
			<index name="IX_ResourceSchedule_PerformanceId" unique="NORMAL" options="where PerformanceId is not null" >
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_ResourceSchedule_ProductId" unique="NORMAL" options="where ProductId is not null" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_ResourceSchedule_ResourceHoldId" unique="NORMAL" >
				<column name="ResourceHoldId" options="ASC" />
			</index>
			<index name="IX_ResourceSchedule_HoldExpire" unique="NORMAL" options="where HoldExpire is not null" >
				<column name="HoldExpire" options="ASC" />
			</index>
			<index name="IX_ResourceSchedule_SaleItemDetailId" unique="NORMAL" options="where SaleItemDetailId is not null" >
				<column name="SaleItemDetailId" options="ASC" />
			</index>
			<index name="IX_ResourceSchedule_HandOverTransactionId" unique="NORMAL" options="where HandOverTransactionId is not null" >
				<column name="HandOverTransactionId" options="ASC" />
			</index>
			<index name="IX_ResourceSchedule_ReturnTransactionId" unique="NORMAL" options="where ReturnTransactionId is not null" >
				<column name="ReturnTransactionId" options="ASC" />
			</index>
			<index name="IX_ResourceSchedule_ResourceSerialId" unique="NORMAL" options="INCLUDE(DateTimeTo,ReturnTransactionId)" >
				<column name="ResourceSerialId" options="ASC" />
				<column name="DateTimeFrom" options="ASC" />
			</index>
			<index name="PK_ResourceSchedule" unique="PRIMARY_KEY" >
				<column name="ResourceScheduleId" />
			</index>
			<index name="UQ_ResourceSchedule_ExtResourceHold" unique="UNIQUE_INDEX" options="where ExtResourceHold is not null" >
				<column name="ExtResourceHold" />
			</index>
			<index name="IX_ResourceSchedule_TicketId_ScheduleStatus" unique="NORMAL" options="INCLUDE (DateTimeFrom, DateTimeTo) WHERE TicketId IS NOT NULL" >
				<column name="TicketId" options="ASC" />
				<column name="ScheduleStatus" />
			</index>
			<index name="IX_ResourceSchedule_TicketId_DateTimeFrom" unique="NORMAL" options="INCLUDE (ScheduleStatus, DateTimeTo) WHERE TicketId IS NOT NULL" >
				<column name="TicketId" />
				<column name="DateTimeFrom" />
			</index>
			<index name="IX_ResourceSchedule_TicketId_DateTimeTo" unique="NORMAL" options="INCLUDE (ScheduleStatus, DateTimeFrom) WHERE TicketId IS NOT NULL" >
				<column name="TicketId" />
				<column name="DateTimeTo" />
			</index>
			<fk name="FK_ResourceSchedule_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_ResourceSchedule_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_ResourceSchedule_HandOverTransaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="HandOverTransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_ResourceSchedule_ReturnTransaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="ReturnTransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_ResourceSchedule_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_ResourceSchedule_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
			<fk name="FK_ResourceSchedule_ResourceSerial" to_schema="SnApp.dbo" to_table="tbResourceSerial" delete_action="cascade" >
				<fk_column name="ResourceSerialId" pk="ResourceSerialId" />
			</fk>
		</table>
		<table name="tbResourceSerial" >
			<column name="ResourceSerialId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ResourceTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" />
			<column name="ResourceSerialCode" type="varchar" length="50" decimal="0" jt="12" />
			<column name="PortfolioId" type="uniqueidentifier" jt="1" />
			<column name="HandOverScheduleId" type="uniqueidentifier" jt="1" />
			<index name="UQ_ResourceSerial_ResourceSerialCode" unique="UNIQUE_KEY" options="where ResourceSerialCode is not null" >
				<column name="ResourceTypeId" options="ASC" />
				<column name="ResourceSerialCode" options="ASC" />
			</index>
			<index name="IX_ResourceSerial_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_ResourceSerial_ResourceTypeId" unique="NORMAL" >
				<column name="ResourceTypeId" options="ASC" />
				<column name="Enabled" options="ASC" />
			</index>
			<index name="IX_ResourceSerial_PortfolioId" unique="NORMAL" options="where PortfolioId is not null" >
				<column name="PortfolioId" options="ASC" />
			</index>
			<index name="IX_ResourceSerial_HandOverScheduleId" unique="NORMAL" options="where HandOverScheduleId is not null" >
				<column name="HandOverScheduleId" options="ASC" />
			</index>
			<index name="PK_ResourceSerial" unique="PRIMARY_KEY" >
				<column name="ResourceSerialId" />
			</index>
			<fk name="FK_ResourceSerial_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="PortfolioId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_ResourceSerial_ResourceType" to_schema="SnApp.dbo" to_table="tbResourceType" >
				<fk_column name="ResourceTypeId" pk="ResourceTypeId" />
			</fk>
			<fk name="FK_ResourceSerial_HandOverSchedule" to_schema="SnApp.dbo" to_table="tbResourceSchedule" delete_action="setNull" >
				<fk_column name="HandOverScheduleId" pk="ResourceScheduleId" />
			</fk>
		</table>
		<table name="tbResourceSkill" >
			<column name="ResourceSkillId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ResourceTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ResourceSkillName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="IX_ResourceSkill_ResourceTypeId" unique="NORMAL" >
				<column name="ResourceTypeId" options="ASC" />
			</index>
			<index name="PK_ResourceSkill" unique="PRIMARY_KEY" >
				<column name="ResourceSkillId" />
			</index>
			<fk name="FK_ResourceSkill_ResourceType" to_schema="SnApp.dbo" to_table="tbResourceType" >
				<fk_column name="ResourceTypeId" pk="ResourceTypeId" />
			</fk>
		</table>
		<table name="tbResourceSkillLink" >
			<column name="ResourceSkillId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="IX_ResourceSkillLink_EntityId" unique="NORMAL" options="INCLUDE(EntityType)" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="PK_ResourceSkillLink" unique="PRIMARY_KEY" >
				<column name="ResourceSkillId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_ResourceSkillLink_ResourceSkill" to_schema="SnApp.dbo" to_table="tbResourceSkill" >
				<fk_column name="ResourceSkillId" pk="ResourceSkillId" />
			</fk>
		</table>
		<table name="tbResourceType" >
			<column name="ResourceTypeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="ResourceTypeCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="ResourceTypeName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" />
			<column name="VisibleInRecap" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="PersonOnly" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="SerialTrack" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[205]]]></comment>
			</column>
			<column name="AvailabilityPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Plugin in charge of handling external capacity availability]]></comment>
			</column>
			<index name="UQ_ResourceType_Code" unique="UNIQUE_KEY" >
				<column name="ResourceTypeCode" options="ASC" />
			</index>
			<index name="PK_ResourceType" unique="PRIMARY_KEY" >
				<column name="ResourceTypeId" />
			</index>
			<index name="IX_ResourceType_AvailabilityPluginId" unique="NORMAL" options="where AvailabilityPluginId is not null" >
				<column name="AvailabilityPluginId" />
			</index>
			<fk name="FK_ResourceType_AvailabilityPlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="AvailabilityPluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbRichDesc" >
			<column name="RichDescId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LangISO" type="varchar" length="3" decimal="0" jt="12" mandatory="y" />
			<column name="Description" type="nvarchar(max)" jt="12" mandatory="y" />
			<index name="IDX_RichDesc_EntityLang" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="LangISO" options="ASC" />
			</index>
			<index name="PK_RichDesc" unique="PRIMARY_KEY" >
				<column name="RichDescId" />
			</index>
		</table>
		<table name="tbRight" >
			<comment><![CDATA[Holds information about system rights/setup.
Rights/setup can be attached to any element of the topology (licensee, locations, op.areas, workstations, access points) and security roles and users]]></comment>
			<column name="RightId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the system object this right is attached to]]></comment>
			</column>
			<column name="RightType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[34]]]></comment>
			</column>
			<column name="RightValue" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[Value of the right. Format vary depending on RightType]]></comment>
			</column>
			<index name="IX_Right_RightType" unique="NORMAL" >
				<column name="RightType" options="ASC" />
			</index>
			<index name="PK_Right" unique="PRIMARY_KEY" >
				<column name="RightId" />
			</index>
			<index name="UQ_Right_EntityId_RightType" unique="UNIQUE_INDEX" options="INCLUDE (RightValue)" >
				<column name="EntityId" options="ASC" />
				<column name="RightType" options="ASC" />
			</index>
		</table>
		<table name="tbRole" >
			<comment><![CDATA[Holds information about configured security roles]]></comment>
			<column name="RoleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="RoleCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="RoleName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the security role]]></comment>
			</column>
			<column name="RoleType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[256]]]></comment>
			</column>
			<column name="Active" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[1]]></defo>
				<comment><![CDATA[Indicates if the security role is currently active (1) or not (0)]]></comment>
			</column>
			<column name="PreventInactiveUserBlock" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When active, users linked to this role will not be blocked even after a period of inactivity longer than the configured one.
Inactivity period is configured on Licensee configuration:
Security > Horizon/B2B/B2C user inactivity days.]]></comment>
			</column>
			<index name="UQ_Role_Code" unique="UNIQUE_KEY" >
				<column name="RoleCode" options="ASC" />
			</index>
			<index name="PK_Role" unique="PRIMARY_KEY" >
				<column name="RoleId" />
			</index>
		</table>
		<table name="tbSale" >
			<comment><![CDATA[Header of the orders]]></comment>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LicenseId" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Licensee this order belongs to]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Operator which created the order]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Workstation from which the order was created]]></comment>
			</column>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Sale channel used for princing in the order]]></comment>
			</column>
			<column name="SaleStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[39]]]></comment>
			</column>
			<column name="SaleDateTime" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Date/time the order when was created]]></comment>
			</column>
			<column name="SaleFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date the order when was created]]></comment>
			</column>
			<column name="SaleCode" type="varchar" length="15" jt="12" >
				<comment><![CDATA[PNR]]></comment>
			</column>
			<column name="Approved" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Order Approved]]></comment>
			</column>
			<column name="Invoiced" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Order invoiced (An invoice was issued for the items of the order)]]></comment>
			</column>
			<column name="Consignment" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Order will be paid when tickets are redeemed]]></comment>
			</column>
			<column name="Paid" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Order fully Paid]]></comment>
			</column>
			<column name="Encoded" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Order Encoded (ticket/media records created)]]></comment>
			</column>
			<column name="Printed" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Order Printed (medias printed)]]></comment>
			</column>
			<column name="Validated" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Order Validated - tickets activated]]></comment>
			</column>
			<column name="Completed" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Order Completed - cannot be modified anymore]]></comment>
			</column>
			<column name="TotalAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Algebric Sum of the field TotalAmount of each transaction]]></comment>
			</column>
			<column name="PaidAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Algebric Sum of the field PaidAmount of each transaction]]></comment>
			</column>
			<column name="ItemCount" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Algebric Sum of the field ItemCount of each transaction]]></comment>
			</column>
			<column name="HoldId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[In case the order contains limited capacity events, this points to the record locking seats]]></comment>
			</column>
			<column name="ReceiptEmailAddress" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Used for order confirmation emails]]></comment>
			</column>
			<column name="ReceiptPhoneNumber" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Used for product phone delivery]]></comment>
			</column>
			<column name="AutoPurge" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When false, task "Reservation Maintenance" will skip it]]></comment>
			</column>
			<column name="SaleFlowType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[197]]]></comment>
			</column>
			<column name="BatchDate" type="date" jt="91" >
				<comment><![CDATA[Batch printing scheduled date]]></comment>
			</column>
			<column name="BatchNumber" type="tinyint" length="1" decimal="0" jt="-6" >
				<comment><![CDATA[Batch printing scheduled number]]></comment>
			</column>
			<column name="SaleSequence" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Sale sequence number]]></comment>
			</column>
			<column name="TaxExempt" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if the order is a tax exempt order]]></comment>
			</column>
			<column name="VisitDateMin" type="date" jt="91" >
				<comment><![CDATA[Estimated visit date. If order reference more dates, the eldest will be used]]></comment>
			</column>
			<column name="VisitDateMax" type="date" jt="91" >
				<comment><![CDATA[Estimated visit date. If order reference more dates, the youngest will be used]]></comment>
			</column>
			<column name="FulfilmentAreaTagId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[ID of the fulfillment access area group label (tag) created in BKO]]></comment>
			</column>
			<column name="ScheduledPaymentDate" type="date" jt="91" >
				<comment><![CDATA[Date of when the order is due for payment. Is filled on sale creation/modification, based on the organization config.]]></comment>
			</column>
			<column name="OrderVersion" type="bigint" jt="-5" >
				<comment><![CDATA[Autoinc field updated everytime the entity (in this specific record or any dependant) is modified. To be used for differential reports]]></comment>
			</column>
			<column name="OrderSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number generate on creation starting from 1]]></comment>
			</column>
			<column name="OrderSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with OrderSequence to create encrypted barcodes]]></comment>
			</column>
			<column name="Archivable" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Indicates if the sale is eligible for archiving]]></comment>
			</column>
			<column name="ArchivableDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/Time of where field "Archivable" was set to 1. Should be NULL when "Archivable"=0]]></comment>
			</column>
			<column name="Archived" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Indicates that the sale was serialized/archived on an external archiving database]]></comment>
			</column>
			<column name="ArchivedDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/Time of where field "Archived" was set to 1. Should be NULL when "Archived"=0]]></comment>
			</column>
			<column name="ArchivedTickets" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[One or more tickets linked to this order have been archived and purged from production DB]]></comment>
			</column>
			<column name="ArchivedMedias" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[One or more medias linked to this order have been archived and purged from production DB]]></comment>
			</column>
			<index name="IX_Sale_HoldId" unique="NORMAL" options="where HoldId is not null" >
				<column name="HoldId" options="ASC" />
			</index>
			<index name="IX_Sale_SaleCode" unique="NORMAL" >
				<column name="SaleCode" options="ASC" />
			</index>
			<index name="IX_Sale_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="SaleDateTime" options="ASC" />
			</index>
			<index name="IX_Sale_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
				<column name="SaleDateTime" options="ASC" />
			</index>
			<index name="IX_Sale_SaleFiscalDate" unique="NORMAL" >
				<column name="SaleFiscalDate" options="ASC" />
				<column name="SaleDateTime" options="DESC" />
			</index>
			<index name="IX_Sale_SaleChannelId" unique="NORMAL" options="where SaleChannelId is not null" >
				<column name="SaleChannelId" options="ASC" />
			</index>
			<index name="IX_Sale_VisitDateMin" unique="NORMAL" options="where VisitDateMin is not null" >
				<column name="VisitDateMin" options="ASC" />
				<column name="SaleDateTime" options="ASC" />
			</index>
			<index name="IX_Sale_VisitDateMax" unique="NORMAL" options="where VisitDateMax is not null" >
				<column name="VisitDateMax" options="ASC" />
				<column name="SaleDateTime" options="ASC" />
			</index>
			<index name="IX_Sale_VisitDateMaxNotEncoded" unique="NORMAL" options="where &#10;  VisitDateMax is not null and&#10;  Paid=1 and&#10;  Encoded=0" >
				<column name="VisitDateMax" options="ASC" />
			</index>
			<index name="UQ_Sale_SaleSequence" unique="UNIQUE_KEY" options="where BatchSequence is not null" >
				<column name="SaleSequence" options="ASC" />
			</index>
			<index name="PK_Sale" unique="PRIMARY_KEY" >
				<column name="SaleId" />
			</index>
			<index name="IX_Sale_FulfilmentAreaTagId" unique="NORMAL" options="where FulfilmentAreaTagId is not null" >
				<column name="FulfilmentAreaTagId" />
			</index>
			<index name="IX_Sale_Batch" unique="NORMAL" options="where BatchDate is not null" >
				<column name="BatchDate" options="ASC" />
				<column name="FulfilmentAreaTagId" options="" />
				<column name="BatchNumber" options="ASC" />
				<column name="Printed" options="ASC" />
			</index>
			<index name="IX_Sale_FulfilmentTagId " unique="NORMAL" options="where FulfilmentTagId is not null" >
				<column name="FulfilmentAreaTagId" />
				<column name="BatchDate" options="ASC" />
				<column name="BatchNumber" options="ASC" />
				<column name="Printed" options="ASC" />
			</index>
			<index name="IX_Sale_ScheduledPaymentDate" unique="NORMAL" options="where (ScheduledPaymentDate) is not null and (Paid=0)" >
				<column name="ScheduledPaymentDate" />
			</index>
			<index name="UQ_Sale_OrderSequence" unique="UNIQUE_INDEX" options="WHERE OrderSequence&lt;&gt;0 INCLUDE OrderSeed" >
				<column name="OrderSequence" />
			</index>
			<index name="UQ_Sale_OrderVersion" unique="UNIQUE_INDEX" options="WHERE OrderVersion is not null INCLUDE SaleFiscalDate" >
				<column name="OrderVersion" />
			</index>
			<index name="IX_Sale_WaitingForPayment" unique="NORMAL" options="where SaleStatus=200" >
				<column name="SaleStatus" />
				<column name="SaleDateTime" />
			</index>
			<index name="IX_Sale_ToBeArchived" unique="NORMAL" options="INCLUDE (ArchivedDateTime) WHERE (Archivable=1 AND Archived=0)" >
				<comment><![CDATA[Contains sales eligible for archiving but not yet archived]]></comment>
				<column name="Archivable" />
				<column name="Archived" />
				<column name="ArchivableDateTime" />
			</index>
			<index name="IX_Sale_Archived" unique="NORMAL" options="WHERE Archived=1" >
				<column name="Archived" />
				<column name="ArchivedDateTime" />
			</index>
			<fk name="FK_Sale_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Sale_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Sale_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_Sale_License" to_schema="SnApp.dbo" to_table="tbLicense" >
				<fk_column name="LicenseId" pk="LicenseId" />
			</fk>
			<fk name="FK_Sale_FulfimentAreaTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="FulfilmentAreaTagId" pk="TagId" />
			</fk>
		</table>
		<table name="tbSale2Account" >
			<comment><![CDATA[Hold information of different accounts associated to the order (IE: owner, agent, final guest, etc...)
1 Sale = 0 or N accounts]]></comment>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the order]]></comment>
			</column>
			<column name="SaleAccountType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[190]]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the account]]></comment>
			</column>
			<column name="SaleDateTime" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Redound tbSale.SaleDateTime - Used for indexing purposes]]></comment>
			</column>
			<index name="IX_Sale2Account_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
				<column name="SaleDateTime" options="ASC" />
			</index>
			<index name="PK_Sale2Account" unique="PRIMARY_KEY" >
				<column name="SaleId" />
				<column name="SaleAccountType" />
				<column name="AccountId" />
			</index>
			<fk name="FK_Sale2Account_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Sale2Account_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
		</table>
		<table name="tbSale2Performance" >
			<comment><![CDATA[Hold information about the performances this order refers to]]></comment>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the order]]></comment>
			</column>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the performance]]></comment>
			</column>
			<column name="MainPerformance" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[In case of multiple performance per order, this field identifies "the main one" which will be display in lists of orders]]></comment>
			</column>
			<index name="IX_Sale2Performance_PerformanceId" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="PK_Sale2Performance" unique="PRIMARY_KEY" >
				<column name="SaleId" />
				<column name="PerformanceId" />
				<column name="MainPerformance" />
			</index>
			<fk name="FK_Sale2Performance_PerformanceId" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_Sale2Performance_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
		</table>
		<table name="tbSale2SaleTab" prior="tbSaleToSaleTab" >
			<comment><![CDATA[Hold information about the Sale Tabs this order refers to]]></comment>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the Order]]></comment>
			</column>
			<column name="SaleTabId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the SaleTab]]></comment>
			</column>
			<index name="UQ_Sale2SaleTab_SaleTab" unique="UNIQUE_INDEX" >
				<column name="SaleTabId" options=" ASC " />
				<column name="SaleId" />
			</index>
			<index name="PK_Sale2SaleTab" unique="PRIMARY_KEY" >
				<column name="SaleId" />
			</index>
			<fk name="FK_Sale2SaleTab_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
			<fk name="FK_Sale2SaleTab_SaleTabId" to_schema="SnApp.dbo" to_table="tbSaleTab" delete_action="cascade" >
				<fk_column name="SaleTabId" pk="SaleTabId" />
			</fk>
		</table>
		<table name="tbSaleApprove" >
			<comment><![CDATA[Extension table for tbSale. Holds information about order approved amounts/quantities]]></comment>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the order]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Approving user]]></comment>
			</column>
			<column name="MinQty" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="MaxQty" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="MinAmount" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<column name="MaxAmount" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<column name="DateTime" type="smalldatetime" length="1" decimal="0" jt="93" mandatory="y" >
				<comment><![CDATA[Approval date/time]]></comment>
			</column>
			<index name="IX_SaleApprove_UserAccountId" unique="NORMAL" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_SaleApprove" unique="PRIMARY_KEY" >
				<column name="SaleId" />
			</index>
			<fk name="FK_SaleApprove_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_SaleApprove_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
		</table>
		<table name="tbSaleCapacity" >
			<comment><![CDATA[Contains the configuration for the capacity controlled sale of Products and Promotions]]></comment>
			<column name="SaleCapacityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[ProductType or Promotion this configuration is applied to]]></comment>
			</column>
			<column name="SaleCapacityStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[411]]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Define the prioritization of the rules]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Initial validity date of the rule. If null there is no limitation on the beginning of the validity.]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[End of the validity of the rule. If null, the rule validity doesn't have an end.]]></comment>
			</column>
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Maximum quantity of Product/Promotion allowed by this rule]]></comment>
			</column>
			<column name="TimeSlotType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[412]]]></comment>
			</column>
			<column name="TimeSlotStep" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Number of SlotType used to define the length of a SaleCapacitySlot]]></comment>
			</column>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Filter by Sale Channel. If null applies to all the Sale Channels]]></comment>
			</column>
			<column name="ParentSaleCapacityId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the parent rule. This allows a herarchical configuration of the rules]]></comment>
			</column>
			<column name="Serial" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_SaleCapacity_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_SaleCapacity_SaleChannelId" unique="NORMAL" options="where SaleChannelId is not null" >
				<column name="SaleChannelId" options="ASC" />
			</index>
			<index name="IX_SaleCapacity_ParentSaleCapacityId" unique="NORMAL" options="where ParentSaleCapacityId is not null" >
				<column name="ParentSaleCapacityId" options="ASC" />
			</index>
			<index name="PK_SaleCapacity" unique="PRIMARY_KEY" >
				<column name="SaleCapacityId" />
			</index>
			<fk name="FK_SaleCapacity_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SaleCapacity_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_SaleCapacity_ParentSaleCapacity" to_schema="SnApp.dbo" to_table="tbSaleCapacity" >
				<fk_column name="ParentSaleCapacityId" pk="SaleCapacityId" />
			</fk>
		</table>
		<table name="tbSaleCapacityAccount" prior="tbSaleCatacityAccount" >
			<comment><![CDATA[Sale capacity restrictions per account.
Counting on reservation owners, gives the ability to cap the maximum quantity per product tags sold to a single account per period.]]></comment>
			<column name="SaleCapacityAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="Enabled" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Rule enabled/disabled]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Rule valid from date]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[Rule valid to date]]></comment>
			</column>
			<column name="SaleCapacityTimeSlotType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[410] Days, Week, etc...]]></comment>
			</column>
			<index name="PK_SaleCatacityAccount" unique="PRIMARY_KEY" >
				<column name="SaleCapacityAccountId" />
			</index>
		</table>
		<table name="tbSaleCapacityAccountDetail" prior="tbSaleCapacityAccountSlot" >
			<comment><![CDATA[Detail table for tbSaleCapacityAccount.
List of ProductTags/Quantity]]></comment>
			<column name="SaleCapacityAccountDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="SaleCapacityAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Refers to tbSaleCapacityAccount internal ID]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting index]]></comment>
			</column>
			<column name="Quantity" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Max quantity per period]]></comment>
			</column>
			<index name="PK_SaleCapacityAccountDetail" unique="PRIMARY_KEY" >
				<column name="SaleCapacityAccountDetailId" />
			</index>
			<index name="IX_SaleCapacityAccountDetail_SaleCapacityAccountId" unique="NORMAL" >
				<column name="SaleCapacityAccountId" />
				<column name="PriorityOrder" />
			</index>
			<fk name="FK_SaleCapacityAccountDetail_SaleCapacityAccount" to_schema="SnApp.dbo" to_table="tbSaleCapacityAccount" delete_action="cascade" >
				<fk_column name="SaleCapacityAccountId" pk="SaleCapacityAccountId" />
			</fk>
		</table>
		<table name="tbSaleCapacityHold" >
			<comment><![CDATA[When a bunch of products capacity in the shopcart get put in hold/book, a SaleCapacityGroupHoldId is generated and this table contains a more information about what/who did the hold]]></comment>
			<column name="SaleCapacityHoldId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SaleCapacitySlotId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[CapacitySlot to which the hold is applied]]></comment>
			</column>
			<column name="SaleCapacityGroupHoldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID. Shopcart level hold id]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Workstation that sent the request to hod the quantity]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[User logged in when the hold was made]]></comment>
			</column>
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity on hold]]></comment>
			</column>
			<column name="HoldDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[DateTime when the hold was made]]></comment>
			</column>
			<column name="HoldStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[410]]]></comment>
			</column>
			<column name="ExpireDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Hold exipre/date time. The capacity will be released by the application when this date/time is reached.
Field is set to null by the application when the "hold" becomes a "booking" (shopcart have turned into a real order present at DB)]]></comment>
			</column>
			<index name="IX_SaleCapacityHold_SaleCapacitySlotId" unique="NORMAL" >
				<column name="SaleCapacitySlotId" options="ASC" />
			</index>
			<index name="IX_SaleCapacityHold_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_SaleCapacityHold_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_SaleCapacityHold" unique="PRIMARY_KEY" >
				<column name="SaleCapacityHoldId" />
			</index>
			<index name="IX_SaleCapacityHold_SaleCapacityGroupHoldId" unique="NORMAL" >
				<column name="SaleCapacityGroupHoldId" options=" ASC " />
			</index>
			<index name="IX_SaleCapacityHold_StatusExpired" unique="NORMAL" options="where ExpireDateTime is not null" >
				<column name="HoldStatus" options=" ASC " />
				<column name="ExpireDateTime" options=" ASC " />
			</index>
			<fk name="FK_SaleCapacityHold_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_SaleCapacityHold_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_SaleCapacityHold_SaleCapacitySlot" to_schema="SnApp.dbo" to_table="tbSaleCapacitySlot" delete_action="cascade" >
				<fk_column name="SaleCapacitySlotId" pk="SaleCapacitySlotId" />
			</fk>
		</table>
		<table name="tbSaleCapacityLog" >
			<comment><![CDATA[Log every allocation made on the SaleCapacitySlot]]></comment>
			<column name="SaleCapacityLogId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SaleCapacitySlotId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[SaleCapacitySlot on wich the allocation was made]]></comment>
			</column>
			<column name="SaleCapacityLogType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[431]]]></comment>
			</column>
			<column name="QuantityDelta" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity allocated]]></comment>
			</column>
			<column name="DateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Log date time]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Log fiscal date]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Transaction that requested the allocation]]></comment>
			</column>
			<column name="SaleCapacityHoldId" type="uniqueidentifier" jt="1" />
			<column name="EntityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" length="1" decimal="0" jt="1" >
				<comment><![CDATA[Entity linked to this log. Could be a SaleItem]]></comment>
			</column>
			<index name="IX_SaleCapacityLog_SaleCapacitySlotId" unique="NORMAL" >
				<column name="SaleCapacitySlotId" options="ASC" />
			</index>
			<index name="IX_SaleCapacityLog_TransactionId" unique="NORMAL" options="where TransactionId is not null" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="IX_SaleCapacityLog_SaleCapacityHoldId" unique="NORMAL" options="where SaleCapacityHoldId is not null" >
				<column name="SaleCapacityHoldId" options="ASC" />
			</index>
			<index name="PK_SaleCapacityLog" unique="PRIMARY_KEY" >
				<column name="SaleCapacityLogId" />
			</index>
			<fk name="FK_SaleCapacityLog_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_SaleCapacityLog_SaleCapacitySlot" to_schema="SnApp.dbo" to_table="tbSaleCapacitySlot" delete_action="cascade" >
				<fk_column name="SaleCapacitySlotId" pk="SaleCapacitySlotId" />
			</fk>
			<fk name="FK_SaleCapacityLog_SaleCapacityHold" to_schema="SnApp.dbo" to_table="tbSaleCapacityHold" >
				<fk_column name="SaleCapacityHoldId" pk="SaleCapacityHoldId" />
			</fk>
		</table>
		<table name="tbSaleCapacitySlot" >
			<column name="SaleCapacitySlotId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SaleCapacityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="QuantityMax" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Slot maximum capacity]]></comment>
			</column>
			<column name="QuantityFree" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Available capacity]]></comment>
			</column>
			<column name="QuantityHeld" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Capacity on hold]]></comment>
			</column>
			<column name="QuantityReserved" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Capacity assigned to reservations not yet paid]]></comment>
			</column>
			<column name="QuantityPaid" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Capacity assigned to paid reservations]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Beginning of the slot]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[End of the slot]]></comment>
			</column>
			<index name="IX_SaleCapacitySlot_SaleCapacityId" unique="NORMAL" >
				<column name="SaleCapacityId" options="ASC" />
			</index>
			<index name="PK_SaleCapacitySlot" unique="PRIMARY_KEY" >
				<column name="SaleCapacitySlotId" />
			</index>
			<fk name="FK_SaleCapacitySlot_SaleCapacity" to_schema="SnApp.dbo" to_table="tbSaleCapacity" delete_action="cascade" >
				<fk_column name="SaleCapacityId" pk="SaleCapacityId" />
			</fk>
		</table>
		<table name="tbSaleChannel" >
			<comment><![CDATA[Definition table of sale channels
Sale channels arre attached to workstations or organizations.
Sale channels determine what price use for a product type]]></comment>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="SaleChannelType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[51] Internal/External Distrubution]]></comment>
			</column>
			<column name="SaleChannelCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="SaleChannelName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Sale channel name]]></comment>
			</column>
			<column name="OutstandingSaleChannelId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Sale channel used when account has credits outstandings]]></comment>
			</column>
			<column name="ValidFrom" type="datetime" length="1" decimal="0" jt="92" >
				<comment><![CDATA[Validity constraint of the sale channel. 
Null = no limits]]></comment>
			</column>
			<column name="ValidTo" type="datetime" length="1" decimal="0" jt="92" >
				<comment><![CDATA[Validity constraint of the sale channel. 
Null = no limits]]></comment>
			</column>
			<column name="PriceActionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[134]]]></comment>
			</column>
			<column name="PriceValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135]]]></comment>
			</column>
			<column name="PriceValue" type="money" length="0" jt="3" >
				<comment><![CDATA[Could be absolute or percentage value depending on PriceActionTyoe and PriceValueType]]></comment>
			</column>
			<column name="UpgradeFromFacePrice" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If true the upgrade price to be paid will be determined using face price of the original product and not what paid for the original ticket.]]></comment>
			</column>
			<column name="RestrictOpenOrder" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If flagged, orders cannot be left open but must be paid on creation.]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" />
			<column name="Upgradable" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[The ticket purchased from this sale channel, if attempting to upgrade at POS, will not be allowed to do so if the option is not active]]></comment>
			</column>
			<column name="Downgradable" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[The ticket purchased from this sale channel, if attempting to downgrade at POS, will not be allowed to do so if the option is not active]]></comment>
			</column>
			<index name="UQ_SaleChannel_Code" unique="UNIQUE_KEY" >
				<column name="SaleChannelCode" options="ASC" />
			</index>
			<index name="IX_OutstandingSaleChannelId" unique="NORMAL" options="where OutstandingSaleChannelId is not null" >
				<column name="OutstandingSaleChannelId" options="ASC" />
			</index>
			<index name="PK_SaleChannel" unique="PRIMARY_KEY" >
				<column name="SaleChannelId" />
			</index>
			<fk name="FK_SaleChannel_OutstandingSaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="OutstandingSaleChannelId" pk="SaleChannelId" />
			</fk>
		</table>
		<table name="tbSaleChannelPriceGroup" prior="tbSaleChannel_0" >
			<comment><![CDATA[Product type price groups can be  associated to a sale channel to provide more flexibility.
In a sale channel can be configured product type price groupd with their own price modificator (add or subtrac an absolute or percentage value)]]></comment>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriceGroupTagId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the price group tag]]></comment>
			</column>
			<column name="PriceActionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[134]]]></comment>
			</column>
			<column name="PriceValueType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[135]]]></comment>
			</column>
			<column name="PriceValue" type="money" length="0" jt="3" >
				<comment><![CDATA[Could be absolute or percentage value depending on PriceActionTyoe and PriceValueType]]></comment>
			</column>
			<index name="PK_SaleChannelPriceGroup" unique="PRIMARY_KEY" >
				<column name="SaleChannelId" />
				<column name="PriceGroupTagId" />
			</index>
			<index name="IX_SaleChannelPriceGroup_PriceGroupTagId" unique="NORMAL" >
				<column name="PriceGroupTagId" />
			</index>
			<fk name="FK_SaleChannelPriceGroup_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" delete_action="cascade" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_SaleChannelPriceGroup_PriceGroupTag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="PriceGroupTagId" pk="TagId" />
			</fk>
		</table>
		<table name="tbSaleFlag" prior="Tbl" >
			<comment><![CDATA[Optional flags for tbSale]]></comment>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale internal ID]]></comment>
			</column>
			<column name="SaleFlag" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[490]]]></comment>
			</column>
			<index name="PK_SaleFlag" unique="PRIMARY_KEY" >
				<column name="SaleId" />
				<column name="SaleFlag" />
			</index>
			<index name="IX_SaleFlag_SaleFlag" unique="NORMAL" >
				<column name="SaleFlag" />
			</index>
			<fk name="FK_SaleFlag_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
		</table>
		<table name="tbSaleItem" >
			<comment><![CDATA[Items of an order]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the order]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the product type]]></comment>
			</column>
			<column name="MainSaleItemId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[If not null, it mean this is a statistical item added as part of an attribute item]]></comment>
			</column>
			<column name="HostSaleItemId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For guest product items, indicates their "host product"]]></comment>
			</column>
			<column name="PerformanceTypeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[PerformanceType used to determin the price]]></comment>
			</column>
			<column name="PerformanceSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the performance set]]></comment>
			</column>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[It's the first of the performance set]]></comment>
			</column>
			<column name="OptionSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Set of dynamic options selected for this item]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the source ticket ID in case of upgrade/downgrade.]]></comment>
			</column>
			<column name="MultiPerformance" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the perfromance set has more than one performance]]></comment>
			</column>
			<column name="UnitRawPrice" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Price from the prodtype price matrix, including dynamic attributes]]></comment>
			</column>
			<column name="TaxCalcType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[25] included, excluded, exempt]]></comment>
			</column>
			<column name="UnitAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Unit amount (discounted, tax inclusive)]]></comment>
			</column>
			<column name="UnitTax" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Unit taxes]]></comment>
			</column>
			<column name="UnitFaceAmount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Original price of the item, could have been sold at a different price.]]></comment>
			</column>
			<column name="UnitFaceTax" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Tax amount of the FacePrice]]></comment>
			</column>
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity, algebraic sum of tbTransactionItem.Quantity]]></comment>
			</column>
			<column name="QuantityUnit" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[ResourceMan: indicates time units... if a price is set hourly, this field indicates how many hours]]></comment>
			</column>
			<column name="TotalAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[UnitAmount * Quantity]]></comment>
			</column>
			<column name="TotalTax" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[UnitTax * Quantity]]></comment>
			</column>
			<column name="StatAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount to be used for statistical purposes. Tax included.
Depending on configuration, one sold sale item could be split by the system into two sale items. The sum of the StatAmount is the price of the original item.]]></comment>
			</column>
			<column name="StatTax" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Tax amount to be used for statistical purposes.]]></comment>
			</column>
			<column name="DistinctItem" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the item was splitted for different discount/taxes.
For example: in shopcart you have 1 item qty 3, and a promotion giving 1 of the item as free; in the table you'll end up with 2 records, [A] qty 2 full price, [B] qty 1 price 0.]]></comment>
			</column>
			<column name="PriceQuoteToken" type="varchar" length="256" jt="12" >
				<comment><![CDATA[Used to store 3rd party pricing plugin token (when available)
Will be dismissed in autumn 2024, replaced by detailed info saved into tbSaleItemData]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Filled in for variable expiration rule products]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[Filled in for variable expiration rule products]]></comment>
			</column>
			<column name="FeeType" type="tinyint" jt="-6" >
				<comment><![CDATA[LK[415]]]></comment>
			</column>
			<index name="IX_SaleItem_SaleId" unique="NORMAL" >
				<column name="SaleId" options="ASC" />
			</index>
			<index name="IX_SaleItem_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_SaleItem_PerformanceId" unique="NORMAL" options="where PerformanceId is not null" >
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_SaleItem_PerformanceSetId" unique="NORMAL" options="include(SaleId)&#10;where PerformanceSetId is not null" >
				<column name="PerformanceSetId" options="ASC" />
			</index>
			<index name="IX_SaleItem_MainSaleItemId" unique="NORMAL" options="where MainSaleItemId is not null" >
				<column name="MainSaleItemId" options="ASC" />
			</index>
			<index name="PK_SaleItem" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
			</index>
			<index name="IX_SaleItem_OptionSetId" unique="NORMAL" options="where OptionSetId is not null" >
				<column name="OptionSetId" />
			</index>
			<index name="IX_SaleItem_PerformanceTypeId" unique="NORMAL" options="where PerformanceTypeId is not null" >
				<column name="PerformanceTypeId" />
			</index>
			<index name="IX_SaleItem_TicketId" unique="NORMAL" options="where TicketId is not null" >
				<column name="TicketId" />
			</index>
			<index name="IX_SaleItem_HostSaleItem" unique="NORMAL" options="where HostSaleItemId is not null" >
				<column name="HostSaleItemId" />
			</index>
			<fk name="FK_SaleItem_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SaleItem_PerformanceType" to_schema="SnApp.dbo" to_table="tbPerformanceType" >
				<fk_column name="PerformanceTypeId" pk="PerformanceTypeId" />
			</fk>
			<fk name="FK_SaleItem_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_SaleItem_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
			<fk name="FK_SaleItem_MainSaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column name="MainSaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItem_OptionSet" to_schema="SnApp.dbo" to_table="tbOptionSet" >
				<fk_column name="OptionSetId" pk="OptionSetId" />
			</fk>
			<fk name="FK_SaleItem_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="setNull" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_SaleItem_HostSaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column name="HostSaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbSaleItem2AttributeItem" >
			<comment><![CDATA[Stores selected attribute items for each sale item]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to attribute item]]></comment>
			</column>
			<column name="OptionalPrice" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Price variation applied]]></comment>
			</column>
			<column name="Optional" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the selection was fixed (0) or dynamic (1)]]></comment>
			</column>
			<index name="IX_SaleItem2AttributeItem_AttributeItemId" unique="NORMAL" >
				<column name="AttributeItemId" options="ASC" />
			</index>
			<index name="PK_SaleItem2AttributeItem" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="AttributeItemId" />
			</index>
			<fk name="FK_SaleItem2AttributeItem_AttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="AttributeItemId" pk="AttributeItemId" />
			</fk>
			<fk name="FK_SaleItem2AttributeItem_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbSaleItem2TimedTicketStatement" >
			<comment><![CDATA[For timed tickets, stores the applied fee on settlement]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="TimedTicketStatementId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the ticed ticket usage statement]]></comment>
			</column>
			<column name="StatementAmount" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_SaleItem2TimedTicketStatement_TimedTicketStatementId" unique="NORMAL" >
				<column name="TimedTicketStatementId" options="ASC" />
			</index>
			<index name="PK_SaleItem2TimedTicketStatement" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="TimedTicketStatementId" />
			</index>
			<fk name="FK_SaleItem2TimedTicketStatement_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItem2TimedTicketStatement_TimedTicketStatementId" to_schema="SnApp.dbo" to_table="tbTimedTicketStatement" >
				<fk_column name="TimedTicketStatementId" pk="TimedTicketStatementId" />
			</fk>
		</table>
		<table name="tbSaleItemAccrual" prior="tbSaleItemData_0" >
			<comment><![CDATA[Table designed to store the reward point accruals for the item]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to tbSaleItem table]]></comment>
			</column>
			<column name="MembershipPointId" prior="ParamName" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to tbMembershipPoint table]]></comment>
			</column>
			<column name="MembershipPointAccrualRuleId" prior="ParamValue" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to tbMembershipPointAccrualRule table]]></comment>
			</column>
			<column name="ExchangeRate" prior="ParamValueLong" type="decimal" length="38" decimal="19" jt="3" mandatory="y" >
				<comment><![CDATA[Membership point exchange rate]]></comment>
			</column>
			<column name="UnitCalcAmount" type="decimal" length="38" decimal="19" jt="3" mandatory="y" />
			<column name="ApplicablePaymentTotal" type="money" jt="3" mandatory="y" />
			<index name="PK_SaleItemAccrual" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="MembershipPointId" />
			</index>
			<index name="IX_SaleItemAccrual_MembershipPointAccrualRuleId" unique="NORMAL" >
				<column name="MembershipPointAccrualRuleId" />
			</index>
			<index name="IX_SaleItemAccrual_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" />
			</index>
			<fk name="FK_SaleItemAccrual_SaleItemId" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemAccrual_MembershipPointId" to_schema="SnApp.dbo" to_table="tbMembershipPoint" delete_action="cascade" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
			<fk name="FK_SaleItemAccrual_MembershipPointAccrualRuleId" to_schema="SnApp.dbo" to_table="tbMembershipPointAccrualRule" >
				<fk_column name="MembershipPointAccrualRuleId" pk="MembershipPointAccrualRuleId" />
			</fk>
		</table>
		<table name="tbSaleItemData" prior="Tbl" >
			<comment><![CDATA[Table designed to store additional custom data for sale items.]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Lin to tbSaleItem table]]></comment>
			</column>
			<column name="ParamName" type="varchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the parameter]]></comment>
			</column>
			<column name="ParamValue" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Value of the parameter]]></comment>
			</column>
			<column name="ParamValueLong" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Value of the parameter if longer then 100 chars]]></comment>
			</column>
			<index name="PK_SaleItemData" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="ParamName" />
			</index>
			<fk name="FK_SaleItemData_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbSaleItemDepositAccount" >
			<comment><![CDATA[Extension table for tbSaleItem.
When doing deposit on account transactions, this store whats the destination account for the deposit]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the account (organization) destination of the deposit]]></comment>
			</column>
			<index name="IX_SaleItemDepositAccount_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="PK_SaleItemDepositAccount" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
			</index>
			<fk name="FK_SaleItemDepositAccount_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_SaleItemDepositAccount_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbSaleItemDetail" >
			<comment><![CDATA[Holds the explosion of tbSaleItem by its quantity.
tbSaleItem.Quantity=3 will reflects in 3 records here.
Exception to this rule is for group tickets, where only 1 record per sale item will be crated regardless of quantity]]></comment>
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="TicketMediaMatchId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to portfolio]]></comment>
			</column>
			<column name="SeatHoldId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For limited capacity events, reference to seat locking information]]></comment>
			</column>
			<column name="WalletDeposit" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount for wallet deposit]]></comment>
			</column>
			<column name="Position" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Sorting within sale item]]></comment>
			</column>
			<column name="SubItem" type="bit" length="1" jt="-7" >
				<comment><![CDATA[Set to true when composing portfolios directly in shopcart using standard SaleFlowType (see SIT-2631)]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[DEPRECATED - See tbSaleItem.ValidDateFrom - Filled in for variable expiration rule products]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[DEPRECATED - See tbSaleItem.ValidDateFrom - Filled in for variable expiration rule products]]></comment>
			</column>
			<column name="FirstUsageDateFrom" type="date" jt="91" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="FirstUsageDateTo" type="date" jt="91" >
				<comment><![CDATA["]]></comment>
			</column>
			<column name="ClearingLimit" type="money" length="0" jt="3" >
				<comment><![CDATA[Used to store clearing limit in case of ledger rule on sale that should affect clearing limit]]></comment>
			</column>
			<column name="ClearingAllocated" type="money" length="0" jt="3" >
				<comment><![CDATA[Used to store clearing allocated in case of ledger rule on sale that should affect clearing limit]]></comment>
			</column>
			<column name="SetAsMain" type="bit" length="1" jt="-7" >
				<comment><![CDATA[Set to true when composing portfolios using "Order organize" to mark what sale item detail was used as reference to print media.]]></comment>
			</column>
			<column name="Description" type="nvarchar(max)" length="1" jt="12" >
				<comment><![CDATA[Free text to add notes about the sale item detail]]></comment>
			</column>
			<index name="IX_SaleItemDetail_SaleItemId" unique="NORMAL" >
				<column name="SaleItemId" options="ASC" />
			</index>
			<index name="IX_SaleItemDetail_SeatHoldId" unique="NORMAL" options="where SeatHoldId is not null" >
				<column name="SeatHoldId" options="ASC" />
			</index>
			<index name="IX_SaleItemDetail_PortfolioId" unique="NORMAL" options="where TicketMediaMatchId is not null" >
				<column name="TicketMediaMatchId" options="ASC" />
			</index>
			<index name="PK_SaleItemDetail" unique="PRIMARY_KEY" >
				<column name="SaleItemDetailId" />
			</index>
			<fk name="FK_SaleItemDetail_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="TicketMediaMatchId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_SaleItemDetail_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemDetail_SeatHold" to_schema="SnApp.dbo" to_table="tbSeatHold" >
				<fk_column name="SeatHoldId" pk="SeatHoldId" />
			</fk>
		</table>
		<table name="tbSaleItemDetailMaterial" >
			<comment><![CDATA[Contains list of selected optional materials]]></comment>
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item detail]]></comment>
			</column>
			<column name="MaterialProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to material product]]></comment>
			</column>
			<index name="IX_SaleItemDetailMaterial_MaterialProductId" unique="NORMAL" >
				<column name="MaterialProductId" options="ASC" />
			</index>
			<index name="PK_SaleItemDetailMaterial" unique="PRIMARY_KEY" >
				<column name="SaleItemDetailId" />
				<column name="MaterialProductId" />
			</index>
			<fk name="FK_SaleItemDetailMaterial_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="MaterialProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SaleItemDetailMaterial_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" delete_action="cascade" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
		</table>
		<table name="tbSaleItemDetailRevalidate" >
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the revalidated sale item detail]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference the transaction that revalidated the referenced detail]]></comment>
			</column>
			<column name="ExtensionDays" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Number of days the expiration has been extended by]]></comment>
			</column>
			<column name="OldExpirationDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Original expiration date of the sale item detail]]></comment>
			</column>
			<column name="NewExpirationDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[New expiration date of the sale item]]></comment>
			</column>
			<column name="FeeProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the fee paid for the revalidation]]></comment>
			</column>
			<column name="FeeAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount paid for the revalidation]]></comment>
			</column>
			<column name="FeeTax" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Tax amount paid for the revalidation]]></comment>
			</column>
			<index name="IX_SaleItemDetailRevalidate_FeeProductId" unique="NORMAL" options="where PaymentTokenId is not null" >
				<column name="FeeProductId" options="ASC" />
			</index>
			<index name="PK_SaleItemDetailRevalidate" unique="PRIMARY_KEY" >
				<column name="SaleItemDetailId" />
				<column name="TransactionId" />
			</index>
			<index name="IX_SaleItemDetailRevalidate_TransactionId" unique="NORMAL" >
				<column name="TransactionId" />
			</index>
			<fk name="FK_SaleItemDetailRevalidate_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_SaleItemDetailRevalidate_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" delete_action="cascade" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
		</table>
		<table name="tbSaleItemDetailRevenue" >
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to SaleItemDetail]]></comment>
			</column>
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to GateCategory]]></comment>
			</column>
			<column name="ClearingLimit" type="money" length="0" jt="3" mandatory="y" />
			<column name="ClearingAllocated" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_SaleItemDetailRevenue_GateCategoryId" unique="NORMAL" options="where GateCategoryId is not null" >
				<column name="GateCategoryId" options="ASC" />
			</index>
			<index name="PK_SaleItemDetailRevenue" unique="PRIMARY_KEY" >
				<column name="SaleItemDetailId" />
				<column name="GateCategoryId" />
			</index>
			<fk name="FK_SaleItemDetailRevenue_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" delete_action="cascade" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
			<fk name="FK_SaleItemDetailRevenue_GateCategory" to_schema="SnApp.dbo" to_table="tbGateCategory" >
				<fk_column name="GateCategoryId" pk="GateCategoryId" />
			</fk>
		</table>
		<table name="tbSaleItemDiscount" >
			<comment><![CDATA[If a sale item is discounted, this table contains the break down of each discount type and amount]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="PromoProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to promo rule (discount type)]]></comment>
			</column>
			<column name="DiscountAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Discounted gross amount]]></comment>
			</column>
			<column name="DiscountTax" type="money" jt="3" spec="computed" mandatory="y" >
				<comment><![CDATA[Discount tax amount]]></comment>
			</column>
			<column name="VariableDiscountValue" type="money" length="0" jt="3" >
				<comment><![CDATA[Selected discount amount for variable discount promos]]></comment>
			</column>
			<column name="IndividualCouponId" type="uniqueidentifier" jt="1" />
			<index name="IX_SaleItemDiscount_PromoProductId" unique="NORMAL" >
				<column name="PromoProductId" options="ASC" />
			</index>
			<index name="IX_SaleItemDiscount_IndividualCouponId" unique="NORMAL" options="where IndividualCouponId is not null" >
				<column name="IndividualCouponId" options="ASC" />
			</index>
			<index name="PK_SaleItemDiscount" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="PromoProductId" />
			</index>
			<fk name="FK_SaleItemDiscount_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="PromoProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SaleItemDiscount_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemDiscount_IndividualCoupon" to_schema="SnApp.dbo" to_table="tbIndividualCoupon" >
				<fk_column name="IndividualCouponId" pk="IndividualCouponId" />
			</fk>
		</table>
		<table name="tbSaleItemDiscountPoint" >
			<comment><![CDATA[If a sale item is discounted by membership points, this table contains the break down of each membership point type and amount]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="PromoProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to promo rule (discount type)]]></comment>
			</column>
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the Membership Point]]></comment>
			</column>
			<column name="PortfolioId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reverence to the Portfolio charged for this discount]]></comment>
			</column>
			<column name="DiscountAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Discounted amount]]></comment>
			</column>
			<column name="DiscountPoints" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Discounted points]]></comment>
			</column>
			<index name="IX_SaleItemDiscountPoint_PromoProductId" unique="NORMAL" >
				<column name="PromoProductId" options="ASC" />
			</index>
			<index name="IX_SaleItemDiscountPoint_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="IX_SaleItemDiscountPoint_PortfolioId" unique="NORMAL" >
				<column name="PortfolioId" options="ASC" />
			</index>
			<index name="PK_SaleItemDiscountPoint" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="PromoProductId" />
				<column name="MembershipPointId" />
				<column name="PortfolioId" />
			</index>
			<fk name="FK_SaleItemDiscountPoint_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="PromoProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SaleItemDiscountPoint_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="PortfolioId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_SaleItemDiscountPoint_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemDiscountPoint_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
		</table>
		<table name="tbSaleItemGiftCard" >
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the corresponding sale item]]></comment>
			</column>
			<column name="CardNumber" type="varchar" length="20" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Gift card number (should always be masked)]]></comment>
			</column>
			<column name="Balance" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Balance of the card at the time of operation]]></comment>
			</column>
			<column name="AuthorizationCode" type="varchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Operation authorization code]]></comment>
			</column>
			<column name="ReferenceCode" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[Reference code of third party authorizer]]></comment>
			</column>
			<index name="IX_SaleItemGiftCard_AuthorizationCode" unique="NORMAL" >
				<column name="AuthorizationCode" options="ASC" />
			</index>
			<index name="IX_SaleItemGiftCard_ReferenceCode" unique="NORMAL" options="where ReferenceCode is not null" >
				<column name="ReferenceCode" options="ASC" />
			</index>
			<index name="PK_SaleItemGiftCard" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
			</index>
			<fk name="FK_SaleItemGiftCard_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbSaleItemInstallment" >
			<comment><![CDATA[Store information for installment schedule settlements.
When the system perform automatic credit card charges related to installment plans, a transaction/order is created and here the is reference to what has been paid]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="InstallmentContractId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to installment contract]]></comment>
			</column>
			<column name="InstallmentNumber" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Reference to specific installment contract schedule item]]></comment>
			</column>
			<index name="IX_SaleItemInstallment_Installment" unique="NORMAL" >
				<column name="InstallmentContractId" options="ASC" />
				<column name="InstallmentNumber" options="ASC" />
			</index>
			<index name="PK_SaleItemInstallment" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="InstallmentContractId" />
				<column name="InstallmentNumber" />
			</index>
			<fk name="FK_SaleItemInstallment_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemInstallment_InstallmentContractDetail" to_schema="SnApp.dbo" to_table="tbInstallmentContractDetail" >
				<fk_column name="InstallmentContractId" pk="InstallmentContractId" />
				<fk_column name="InstallmentNumber" pk="InstallmentNumber" />
			</fk>
		</table>
		<table name="tbSaleItemPackage" >
			<comment><![CDATA[For sale items representing the explosion of a package]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="PackageProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to package product type]]></comment>
			</column>
			<index name="IX_SaleItemPackage_PackageProductId" unique="NORMAL" >
				<column name="PackageProductId" options="ASC" />
			</index>
			<index name="PK_SaleItemPackage" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
			</index>
			<fk name="FK_SaleItemPackage_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="PackageProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SaleItemPackage_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbSaleItemPaymentTransaction" >
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the SaleItemId]]></comment>
			</column>
			<column name="SourceSaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the original saleItem that was paid by the transaction]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the payment transaction]]></comment>
			</column>
			<column name="Quantity" type="int" length="50" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity of items paid by the transaction]]></comment>
			</column>
			<index name="IX_SaleItemPaymentTransaction_SourceSaleItemId" unique="NORMAL" >
				<column name="SourceSaleItemId" options="ASC" />
			</index>
			<index name="IX_SaleItemPaymentTransaction_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="PK_SaleItemPaymentTransaction" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="SourceSaleItemId" />
				<column name="TransactionId" />
			</index>
			<fk name="FK_SaleItemPaymentTransaction_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_SaleItemPaymentTransaction_SourceSaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column name="SourceSaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemPaymentTransaction_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbSaleItemResourceHold" >
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ResourceHoldId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_SaleItemResourceHold_ResourceHoldId" unique="NORMAL" >
				<column name="ResourceHoldId" options="ASC" />
			</index>
			<index name="PK_SaleItemResourceHold" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
			</index>
			<fk name="FK_SaleItemResourceHold_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemResourceHold_ResourceHold" to_schema="SnApp.dbo" to_table="tbResourceHold" >
				<fk_column name="ResourceHoldId" pk="ResourceHoldId" />
			</fk>
		</table>
		<table name="tbSaleItemTax" >
			<comment><![CDATA[Breakdown of takes applied to sale items]]></comment>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="TaxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tax definition]]></comment>
			</column>
			<column name="TaxAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Tax amount]]></comment>
			</column>
			<column name="TaxRate" type="money" jt="3" >
				<comment><![CDATA[Tax rate of the applied tax]]></comment>
			</column>
			<index name="IX_SaleItemTax_TaxId" unique="NORMAL" >
				<column name="TaxId" options="ASC" />
			</index>
			<index name="PK_SaleItemTax" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="TaxId" />
			</index>
			<fk name="FK_SaleItemTax_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemTax_Tax" to_schema="SnApp.dbo" to_table="tbTax" >
				<fk_column name="TaxId" pk="TaxId" />
			</fk>
		</table>
		<table name="tbSaleItemVoucher" >
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="VoucherId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Quantity" type="tinyint" length="1" decimal="0" jt="-6" mandatory="y" />
			<index name="IX_SaleItemVoucher_VoucherId" unique="NORMAL" >
				<column name="VoucherId" options="ASC" />
			</index>
			<index name="PK_SaleItemVoucher" unique="PRIMARY_KEY" >
				<column name="SaleItemId" />
				<column name="VoucherId" />
			</index>
			<fk name="FK_SaleItemVoucher_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" delete_action="cascade" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_SaleItemVoucher_Voucher" to_schema="SnApp.dbo" to_table="tbVoucher" >
				<fk_column name="VoucherId" pk="VoucherId" />
			</fk>
		</table>
		<table name="tbSaleMembership" >
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_SaleMembership_TicketId" unique="NORMAL" >
				<column name="TicketId" options="ASC" />
			</index>
			<index name="PK_SaleMembership" unique="PRIMARY_KEY" >
				<column name="SaleId" />
			</index>
			<fk name="FK_SaleMembership_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
			<fk name="FK_SaleMembership_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbSalePromotion" prior="Tbl" >
			<comment><![CDATA[Contains the quantity of each promotion applied to the sale]]></comment>
			<column name="SalePromotionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the Sale]]></comment>
			</column>
			<column name="PromoProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the Promotion]]></comment>
			</column>
			<column name="IndividualCouponId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the individual coupon that added this promotion to the sale]]></comment>
			</column>
			<column name="SaleFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date of the Sale]]></comment>
			</column>
			<column name="Quantity" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity of the promotion applied to the sale]]></comment>
			</column>
			<column name="DiscountAmount" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Amount discounted by this promotion]]></comment>
			</column>
			<index name="PK_SalePromotion" unique="PRIMARY_KEY" >
				<column name="SalePromotionId" />
			</index>
			<index name="UQ_SalePromotion" unique="UNIQUE_KEY" >
				<column name="SaleId" />
				<column name="PromoProductId" />
				<column name="IndividualCouponId" />
			</index>
			<index name="IX_SalePromotion_PromoProductId" unique="NORMAL" >
				<column name="PromoProductId" />
				<column name="SaleFiscalDate" />
			</index>
			<index name="IX_SalePromotion_SaleId" unique="NORMAL" >
				<column name="SaleId" />
				<column name="SaleFiscalDate" />
			</index>
			<index name="IX_SalePromotion_IndividualCouponId" unique="NORMAL" options="where IndividualCouponId is not null" >
				<column name="IndividualCouponId" />
				<column name="SaleFiscalDate" />
			</index>
			<fk name="FK_SalePromotion_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
			<fk name="FK_SalePromotion_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="PromoProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SalePromotion_IndividualCoupon" to_schema="SnApp.dbo" to_table="tbIndividualCoupon" >
				<fk_column name="IndividualCouponId" pk="IndividualCouponId" />
			</fk>
		</table>
		<table name="tbSaleRefund" >
			<comment><![CDATA[Contains recap of refunds made on this order, or any of its tickets]]></comment>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the order]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the payment method]]></comment>
			</column>
			<column name="RefundAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Refunded amount]]></comment>
			</column>
			<index name="IX_SaleRefund_PluginId" unique="NORMAL" >
				<column name="PluginId" options="ASC" />
			</index>
			<index name="PK_SaleRefund" unique="PRIMARY_KEY" >
				<column name="SaleId" />
				<column name="PluginId" />
			</index>
			<fk name="FK_SaleRefund_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
			<fk name="FK_SaleRefund_PluginPaymentMethod" to_schema="SnApp.dbo" to_table="tbPluginPaymentMethod" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbSaleTab" >
			<column name="SaleTabId" prior="SaletTabId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OpAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" />
			<column name="SaleTabFiscalDate" prior="SaleFiscalDate" type="date" jt="91" mandatory="y" />
			<column name="SaleTabDateTime" prior="SaleDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="SaleTabPrefix" type="varchar" length="3" decimal="0" jt="12" mandatory="y" />
			<column name="SaleTabSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="SaleTabStatus" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[262]]]></comment>
			</column>
			<column name="SaleTabDesc" type="nvarchar" length="50" jt="12" />
			<column name="SaleTableId" type="uniqueidentifier" jt="1" />
			<column name="DateTimeFrom" type="smalldatetime" jt="93" />
			<column name="DateTimeTo" type="smalldatetime" jt="93" />
			<column name="PartyNumber" type="smallint" length="1" decimal="0" jt="5" />
			<column name="Owner" type="varchar" length="100" decimal="0" jt="12" />
			<index name="UQ_SaleTab_SaleTabCode" unique="UNIQUE_KEY" >
				<column name="OpAreaAccountId" options="ASC" />
				<column name="SaleTabFiscalDate" options="ASC" />
				<column name="SaleTabPrefix" options="ASC" />
				<column name="SaleTabSerial" options="ASC" />
			</index>
			<index name="IX_SaleTab_Status" unique="NORMAL" >
				<column name="SaleTabStatus" options="ASC" />
				<column name="OpAreaAccountId" options="ASC" />
				<column name="SaleTabFiscalDate" options="ASC" />
				<column name="SaleTabSerial" options="ASC" />
			</index>
			<index name="IX_SaleTab_SaleTableId" unique="NORMAL" options="where SaleTableId is not null" >
				<column name="SaleTableId" options="ASC" />
				<column name="SaleTabStatus" options="ASC" />
				<column name="SaleTabFiscalDate" options="ASC" />
			</index>
			<index name="IX_SaleTab_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_SaleTab" unique="PRIMARY_KEY" >
				<column name="SaleTabId" />
			</index>
			<fk name="FK_SaleTab_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_SaleTab_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_SaleTab_SaleTable" to_schema="SnApp.dbo" to_table="tbSaleTable" >
				<fk_column name="SaleTableId" pk="SaleTableId" />
			</fk>
		</table>
		<table name="tbSaleTable" >
			<column name="SaleTableId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OpAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SaleTableCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="SaleTableName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="SaleTableStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[290]]]></comment>
			</column>
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<index name="IX_SaleTable_OpAreaAccountId" unique="NORMAL" >
				<column name="OpAreaAccountId" options="ASC" />
			</index>
			<index name="PK_SaleTable" unique="PRIMARY_KEY" >
				<column name="SaleTableId" />
			</index>
			<fk name="FK_SaleTable_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaAccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbSaleTempEmptyAccount" prior="Tbl" >
			<comment><![CDATA[Table used during post transactions. It is used for "empty account" creation optimized for bulk orders. The table is filled and emptied within a SQL transaction, so it should always be empty if queried.
Since it is just a temp/support table, there is no need for indexes or foreign keys which would make any operation heavier]]></comment>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbSale internal ID]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbAccount internal ID]]></comment>
			</column>
			<column name="AccountCode" type="varchar" length="20" jt="12" >
				<comment><![CDATA[Temporarly stores the AccountCode as it will be saved into tbAccount]]></comment>
			</column>
			<column name="PortfolioId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to tbTicketMediamatch internal ID]]></comment>
			</column>
			<index name="Pk_SaleTempEmptyAccount" unique="PRIMARY_KEY" >
				<column name="SaleId" />
				<column name="AccountId" />
			</index>
		</table>
		<table name="tbSaleToken" prior="Tbl" >
			<comment><![CDATA[Information about "pay by link" tokens]]></comment>
			<column name="SaleTokenId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the order]]></comment>
			</column>
			<column name="SaleTokenType" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[457]]]></comment>
			</column>
			<column name="SaleTokenStatus" type="tinyint" length="1" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[458]]]></comment>
			</column>
			<column name="ExpireDateTime" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Data/Time of the expiration of the token]]></comment>
			</column>
			<column name="WebAuthId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to web auth request]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to the workstation that generate the saleToken]]></comment>
			</column>
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Order confirmation email template]]></comment>
			</column>
			<column name="PaymentAmount" type="money" jt="3" >
				<comment><![CDATA[paybylik amount to pay]]></comment>
			</column>
			<index name="PK_SaleToken_SaleTokenId" unique="PRIMARY_KEY" >
				<column name="SaleTokenId" />
			</index>
			<index name="IX_SaleToken_SaleId" unique="NORMAL" >
				<column name="SaleId" />
				<column name="ExpireDateTime" />
			</index>
			<index name="IX_SaleToken_StatusAndExpire" unique="NORMAL" >
				<column name="SaleTokenStatus" />
				<column name="ExpireDateTime" />
			</index>
			<index name="IX_SaleToken_WebAuthId" unique="NORMAL" options="where WebAuthId is not null" >
				<column name="WebAuthId" />
			</index>
			<index name="IX_SaleToken_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" />
			</index>
			<index name="IX_SaleToken_DocTemplateId" unique="NORMAL" options="WHERE DocTemplateId IS NOT NULL" >
				<column name="DocTemplateId" />
			</index>
			<fk name="FK_SaleToken_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
			<fk name="FK_SaleToken_WebAuth" to_schema="SnApp.dbo" to_table="tbWebAuth" >
				<fk_column name="WebAuthId" pk="WebAuthId" />
			</fk>
			<fk name="FK_SaleToken_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_SaleToken_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbSeat" >
			<comment><![CDATA[Seat Definition]]></comment>
			<column name="SeatId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SeatSectorId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SeatEnvelopeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="QuantityMin" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantityMax" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="Weight" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="SeqNumber" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="BreakType" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[?]]]></comment>
			</column>
			<column name="AisleLeft" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="AisleRight" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="CustomPerf" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="IX_Seat_SeatSectorId" unique="NORMAL" >
				<column name="SeatSectorId" options="ASC" />
				<column name="CustomPerf" options="ASC" />
			</index>
			<index name="IX_Seat_AttributeItemId" unique="NORMAL" >
				<column name="AttributeItemId" options="ASC" />
			</index>
			<index name="IX_Seat_SeatEnvelopeId" unique="NORMAL" >
				<column name="SeatEnvelopeId" options="ASC" />
			</index>
			<index name="PK_Seat" unique="PRIMARY_KEY" >
				<column name="SeatId" />
			</index>
			<fk name="FK_Seat_AttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="AttributeItemId" pk="AttributeItemId" />
			</fk>
			<fk name="FK_Seat_SeatSector" to_schema="SnApp.dbo" to_table="tbSeatSector" >
				<fk_column name="SeatSectorId" pk="SeatSectorId" />
			</fk>
			<fk name="FK_Seat_SeatEnvelope" to_schema="SnApp.dbo" to_table="tbSeatEnvelope" >
				<fk_column name="SeatEnvelopeId" pk="SeatEnvelopeId" />
			</fk>
		</table>
		<table name="tbSeatEnvelope" >
			<column name="SeatEnvelopeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SeatEnvelopeCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="SeatEnvelopeName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="SeatEnvelopeColor" type="varchar" length="6" decimal="0" jt="12" />
			<column name="ExclusiveUse" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="Extra" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Extra contingency (availability for extra-contingency envelopes can be limited by rights)]]></comment>
			</column>
			<column name="SwapHours" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Allotment release]]></comment>
			</column>
			<column name="SwapSeatEnvelopeId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Allotment release]]></comment>
			</column>
			<column name="SeatEnvelopePriority" type="smallint" jt="5" />
			<index name="UQ_SeatEnvelope_SeatEnvelopeCode" unique="UNIQUE_KEY" >
				<column name="SeatEnvelopeCode" options="ASC" />
			</index>
			<index name="IX_SeatEnvelope_SwapSeatEnvelopeId" unique="NORMAL" >
				<column name="SwapSeatEnvelopeId" options="ASC" />
			</index>
			<index name="PK_SeatEnvelope" unique="PRIMARY_KEY" >
				<column name="SeatEnvelopeId" />
			</index>
			<fk name="FK_SeatEnvelope_SwapSeatEnvelope" to_schema="SnApp.dbo" to_table="tbSeatEnvelope" >
				<fk_column name="SwapSeatEnvelopeId" pk="SeatEnvelopeId" />
			</fk>
		</table>
		<table name="tbSeatHold" >
			<comment><![CDATA[When a bunch of seat in the shopcart get put in hold/book, an HoldId is generated and this table contains a little more information about what/who did the hold]]></comment>
			<column name="SeatHoldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID. Item/ticket level hold id]]></comment>
			</column>
			<column name="HoldId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID. Shopcart level hold id]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to workstation]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to user]]></comment>
			</column>
			<column name="HoldStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[144]]]></comment>
			</column>
			<column name="HoldDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Hold date/time]]></comment>
			</column>
			<column name="ExpireDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Hold exipre/date time. The seat will be released by the application when this date/time is reached.
Field is set to null by the application when the "hold" becomes a "booking" (shopcart have turned into a real order present at DB)]]></comment>
			</column>
			<column name="PerformanceSetId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to performance set]]></comment>
			</column>
			<column name="SeatSectorId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sector]]></comment>
			</column>
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to seat category]]></comment>
			</column>
			<column name="SaleCode" type="varchar" length="20" jt="12" >
				<comment><![CDATA[Order PNR]]></comment>
			</column>
			<column name="Paid" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicated if the order is oper or paid]]></comment>
			</column>
			<index name="IX_SeatHold_HoldId" unique="NORMAL" >
				<column name="HoldId" options="ASC" />
			</index>
			<index name="IX_SeatHold_WorkstationStatus" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="HoldStatus" options="ASC" />
			</index>
			<index name="IX_SeatHold_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="IX_SeatHold_PerformanceSetId" unique="NORMAL" >
				<column name="PerformanceSetId" options="ASC" />
			</index>
			<index name="IX_SeatHold_SeatSectorId" unique="NORMAL" >
				<column name="SeatSectorId" options="ASC" />
			</index>
			<index name="IX_SeatHold_AttributeItemId" unique="NORMAL" >
				<column name="AttributeItemId" options="ASC" />
			</index>
			<index name="PK_SeatHold" unique="PRIMARY_KEY" >
				<column name="SeatHoldId" />
			</index>
			<index name="IX_SeatHold_StatusExpired" unique="NORMAL" options="where ExpireDateTime is not null" >
				<column name="HoldStatus" options=" ASC " />
				<column name="ExpireDateTime" options=" ASC " />
			</index>
			<index name="IX_SeatHold_HoldStatusDateTime" unique="NORMAL" >
				<comment><![CDATA[Index on "hold status" and "hold date time" used to release frozen seats before a certain date/time]]></comment>
				<column name="HoldStatus" options="ASC" />
				<column name="HoldDateTime" options="ASC" />
			</index>
			<fk name="FK_SeatHold_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_SeatHold_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_SeatHold_AttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="AttributeItemId" pk="AttributeItemId" />
			</fk>
			<fk name="FK_SeatHold_PerformanceSet" to_schema="SnApp.dbo" to_table="tbPerformanceSet" >
				<fk_column name="PerformanceSetId" pk="PerformanceSetId" />
			</fk>
			<fk name="FK_SeatHold_SeatSector" to_schema="SnApp.dbo" to_table="tbSeatSector" >
				<fk_column name="SeatSectorId" pk="SeatSectorId" />
			</fk>
		</table>
		<table name="tbSeatInfo" >
			<comment><![CDATA[Contains seat informations which do not get cloned on each performance.... so cannot be customized performance by performance]]></comment>
			<column name="SeatId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to seat]]></comment>
			</column>
			<column name="ColLabel" type="varchar" length="15" decimal="0" jt="12" >
				<comment><![CDATA[Column label (usually a number)]]></comment>
			</column>
			<column name="RowLabel" type="varchar" length="15" decimal="0" jt="12" >
				<comment><![CDATA[Row label (usually a letter)]]></comment>
			</column>
			<index name="PK_SeatInfo" unique="PRIMARY_KEY" >
				<column name="SeatId" />
			</index>
			<fk name="FK_SeatInfo_Seat" to_schema="SnApp.dbo" to_table="tbSeat" delete_action="cascade" >
				<fk_column name="SeatId" pk="SeatId" />
			</fk>
		</table>
		<table name="tbSeatMap" >
			<column name="SeatMapId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SeatSectorId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="BackgroundRepositoryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SeatMapName" type="nvarchar" length="30" jt="12" mandatory="y" />
			<column name="NumSeats" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="MapData" type="nvarchar(max)" jt="12" mandatory="y" />
			<index name="UQ_SeatMap" unique="UNIQUE_KEY" >
				<column name="SeatSectorId" options="ASC" />
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_SeatMap_PerformanceId" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_SeatMap_BackgroundRepositoryId" unique="NORMAL" >
				<column name="BackgroundRepositoryId" options="ASC" />
			</index>
			<index name="PK_SeatMap" unique="PRIMARY_KEY" >
				<column name="SeatMapId" />
			</index>
			<fk name="FK_SeatMap_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_SeatMap_BackgroundRepository" to_schema="SnApp.dbo" to_table="tbRepository" >
				<fk_column name="BackgroundRepositoryId" pk="RepositoryId" />
			</fk>
			<fk name="FK_SeatMap_SeatSector" to_schema="SnApp.dbo" to_table="tbSeatSector" >
				<fk_column name="SeatSectorId" pk="SeatSectorId" />
			</fk>
		</table>
		<table name="tbSeatPerformance" >
			<comment><![CDATA[Seat info on each performance. Basically a clone of the seat map, with performance specific values.
A "seat" could be a real seat, in this case max quantity will be one, or a limited capacity slot, where quantities could be greater than one]]></comment>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the performance]]></comment>
			</column>
			<column name="SeatId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the configured seat definition]]></comment>
			</column>
			<column name="SeatSectorId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to seat sector]]></comment>
			</column>
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to seat category]]></comment>
			</column>
			<column name="SeatEnvelopeId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to seat envelope]]></comment>
			</column>
			<column name="QuantityHeld" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity in HOLD]]></comment>
			</column>
			<column name="QuantityReserved" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity BOOKED]]></comment>
			</column>
			<column name="QuantityPaid" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity PAID]]></comment>
			</column>
			<column name="QuantityFree" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity STILL AVAILABLE]]></comment>
			</column>
			<column name="QuantityMax" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Max configured quantity]]></comment>
			</column>
			<column name="QuantityMin" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[not used - designed for table assignment, is the nim quantity required to book a table]]></comment>
			</column>
			<column name="QuantityRedeemed" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity already redeemed]]></comment>
			</column>
			<column name="QuantityInside" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Quantity in-park (valid values avalible only if scanning tickets on exit)]]></comment>
			</column>
			<column name="Weight" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Sorting criteria for best allocation algorythm]]></comment>
			</column>
			<column name="SeqNumber" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Used to determin seat contiguous-ness]]></comment>
			</column>
			<column name="BreakType" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[234]]]></comment>
			</column>
			<column name="AisleLeft" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Aisle available on the seat's left?]]></comment>
			</column>
			<column name="AisleRight" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Aisle available on the seat's right?]]></comment>
			</column>
			<column name="Available" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[0 if seat has bean disabled]]></comment>
			</column>
			<column name="ManualPick" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[0 = seat assigned with best allocation; 1 = seat manually picked]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Last record modification date/time]]></comment>
			</column>
			<index name="IX_SeatPerformance_SeatId" unique="NORMAL" >
				<column name="SeatId" options="ASC" />
			</index>
			<index name="IX_SeatPerformance_SeatSectorId" unique="NORMAL" >
				<column name="SeatSectorId" options="ASC" />
				<column name="AttributeItemId" options="ASC" />
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_SeatPerformance_AttributeItemId" unique="NORMAL" >
				<column name="AttributeItemId" options="ASC" />
				<column name="SeatSectorId" options="ASC" />
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_SeatPerformance_SeatEnvelopeId" unique="NORMAL" >
				<column name="SeatEnvelopeId" options="ASC" />
			</index>
			<index name="IX_SeatPerformance_BestSeat" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
				<column name="SeatEnvelopeId" options="ASC" />
				<column name="AttributeItemId" options="ASC" />
				<column name="Available" options="ASC" />
				<column name="Weight" options="ASC" />
				<column name="SeqNumber" options="ASC" />
			</index>
			<index name="IX_SeatPerformance_LastUpdate" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
				<column name="LastUpdate" options="ASC" />
			</index>
			<index name="PK_SeatPerformance" unique="PRIMARY_KEY" >
				<column name="PerformanceId" />
				<column name="SeatId" />
			</index>
			<index name="unq_tbSeatPerformance_PerformanceId" unique="UNIQUE_KEY" >
				<column name="PerformanceId" />
			</index>
			<constraint name="CK_SeatPerformance_QuantityReserved_Max" >
				<string><![CDATA[(QuantityReserved <= QuantityMax)]]></string>
			</constraint>
			<constraint name="CK_SeatPerformance_QuantityHeld_Max" >
				<string><![CDATA[(QuantityHeld <= QuantityMax-QuantityReserved)]]></string>
			</constraint>
			<constraint name="CK_SeatPerformance_QuantityHeld_Positive" >
				<string><![CDATA[(QuantityHeld >= 0)]]></string>
			</constraint>
			<constraint name="CK_SeatPerformance_QuantityReserved_Positive" >
				<string><![CDATA[(QuantityReserved >= 0)]]></string>
			</constraint>
			<constraint name="CK_SeatPerformance_QuantityPaid_Positive" >
				<string><![CDATA[(QuantityPaid >= 0)]]></string>
			</constraint>
			<constraint name="CK_SeatPerformance_QuantityPaid_Reserved" >
				<string><![CDATA[(QuantityPaid <= QuantityReserved)]]></string>
			</constraint>
			<constraint name="CK_SeatPerformance_QuantityFree" >
				<string><![CDATA[(QuantityFree = QuantityMax-QuantityReserved-QuantityHeld)]]></string>
			</constraint>
			<fk name="FK_SeatPerformance_AttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="AttributeItemId" pk="AttributeItemId" />
			</fk>
			<fk name="FK_SeatPerformance_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" delete_action="cascade" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_SeatPerformance_SeatSector" to_schema="SnApp.dbo" to_table="tbSeatSector" >
				<fk_column name="SeatSectorId" pk="SeatSectorId" />
			</fk>
			<fk name="FK_SeatPerformance_Seat" to_schema="SnApp.dbo" to_table="tbSeat" >
				<fk_column name="SeatId" pk="SeatId" />
			</fk>
			<fk name="FK_SeatPerformance_SeatEnvelope" to_schema="SnApp.dbo" to_table="tbSeatEnvelope" >
				<fk_column name="SeatEnvelopeId" pk="SeatEnvelopeId" />
			</fk>
		</table>
		<table name="tbSeatPerformanceCategory" >
			<comment><![CDATA[Consolidates quantities on Performance/SeatCategory level]]></comment>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SeatEnvelopeId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AttributeItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="QuantityHeld" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantityReserved" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantityPaid" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantityFree" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantityMax" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="QuantityRedeemed" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for Entries]]></comment>
			</column>
			<column name="QuantityInside" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Counter for (Entries - Exits)]]></comment>
			</column>
			<column name="PerformanceDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<index name="IX_SeatPerformanceCategory_AttributeItemId" unique="NORMAL" >
				<column name="AttributeItemId" options="ASC" />
			</index>
			<index name="IX_SeatPerformanceCategory_SeatEnvelopeId" unique="NORMAL" >
				<column name="SeatEnvelopeId" options="ASC" />
				<column name="PerformanceDateTime" options="ASC" />
			</index>
			<index name="PK_SeatPerformanceCategory" unique="PRIMARY_KEY" >
				<column name="PerformanceId" />
				<column name="SeatEnvelopeId" />
				<column name="AttributeItemId" />
			</index>
			<fk name="FK_SeatPerformanceCategory_AttributeItem" to_schema="SnApp.dbo" to_table="tbAttributeItem" >
				<fk_column name="AttributeItemId" pk="AttributeItemId" />
			</fk>
			<fk name="FK_SeatPerformanceCategory_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" delete_action="cascade" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_SeatPerformanceCategory_SeatEnvelope" to_schema="SnApp.dbo" to_table="tbSeatEnvelope" >
				<fk_column name="SeatEnvelopeId" pk="SeatEnvelopeId" />
			</fk>
		</table>
		<table name="tbSeatPerformanceLink" >
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SeatId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="Quantity" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_SeatPerformanceLink_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_SeatPerformanceLink_SeatId" unique="NORMAL" >
				<column name="SeatId" options="ASC" />
			</index>
			<index name="PK_SeatPerformanceLink" unique="PRIMARY_KEY" >
				<column name="PerformanceId" />
				<column name="SeatId" />
				<column name="EntityId" />
			</index>
			<fk name="FK_SeatPerformanceLink_SeatPerformance" to_schema="SnApp.dbo" to_table="tbSeatPerformance" delete_action="cascade" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
		</table>
		<table name="tbSeatSector" >
			<comment><![CDATA[Sectors definition table.
Structure is recursive cause you could have multiple maps per access area]]></comment>
			<column name="SeatSectorId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="AcAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to access area]]></comment>
			</column>
			<column name="ParentSectorId" type="uniqueidentifier" jt="1" />
			<column name="RootSectorId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the top-most sector on the hierarchy tree]]></comment>
			</column>
			<column name="SeatSectorType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[140] (Folder, Sector)]]></comment>
			</column>
			<column name="SeatSectorStatus" type="smallint" length="1" jt="5" mandatory="y" >
				<defo><![CDATA[10]]></defo>
				<comment><![CDATA[LK[494]]]></comment>
			</column>
			<column name="SeatSectorCode" type="varchar" length="10" jt="12" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="SeatSectorName" type="nvarchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[Sector name]]></comment>
			</column>
			<index name="IX_SeatSector_AcAreaAccountId" unique="NORMAL" >
				<column name="AcAreaAccountId" options="ASC" />
			</index>
			<index name="IX_SeatSector_ParentSectorId" unique="NORMAL" >
				<column name="ParentSectorId" options="ASC" />
			</index>
			<index name="PK_SeatSector" unique="PRIMARY_KEY" >
				<column name="SeatSectorId" />
			</index>
			<index name="IX_SeatSector_RootSectorId" unique="NORMAL" >
				<column name="RootSectorId" />
			</index>
			<fk name="FK_SeatSector_AcAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AcAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_SeatSector_ParentSector" to_schema="SnApp.dbo" to_table="tbSeatSector" >
				<fk_column name="ParentSectorId" pk="SeatSectorId" />
			</fk>
			<fk name="FK_SeatSector_RootSector" to_schema="SnApp.dbo" to_table="tbSeatSector" >
				<fk_column name="RootSectorId" pk="SeatSectorId" />
			</fk>
		</table>
		<table name="tbSerial" >
			<column name="IdentifierAK" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="Serial" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="LockId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="PK_Serial" unique="PRIMARY_KEY" >
				<column name="IdentifierAK" />
			</index>
		</table>
		<table name="tbServer" >
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ServerProfileId" type="uniqueidentifier" jt="1" />
			<column name="ServerCode" type="varchar" length="20" decimal="0" jt="12" mandatory="y" />
			<column name="ServerName" type="nvarchar" length="100" jt="12" />
			<column name="CheckDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="StartupDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="ShutdownDateTime" type="datetime" jt="92" />
			<column name="WarVersion" type="varchar" length="15" jt="12" />
			<index name="UQ_Server_Code" unique="UNIQUE_KEY" >
				<column name="ServerCode" options="ASC" />
			</index>
			<index name="PK_Server" unique="PRIMARY_KEY" >
				<column name="ServerId" />
			</index>
			<index name="IX_Server_ServerProfileId" unique="NORMAL" >
				<column name="ServerProfileId" />
			</index>
			<fk name="FK_Server_ServerProfile" to_schema="SnApp.dbo" to_table="tbServerProfile" delete_action="cascade" >
				<fk_column name="ServerProfileId" pk="ServerProfileId" />
			</fk>
		</table>
		<table name="tbServerParam" >
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="ParamType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[282]]]></comment>
			</column>
			<column name="ParamName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="ParamValue" type="nvarchar(max)" jt="12" mandatory="y" />
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" />
			<index name="IX_ServerParam_LastUpdate" unique="NORMAL" >
				<column name="LastUpdate" options="ASC" />
			</index>
			<index name="PK_ServerParam" unique="PRIMARY_KEY" >
				<column name="ServerId" />
				<column name="ParamType" />
				<column name="ParamName" />
			</index>
			<fk name="FK_ServerParam_Server" to_schema="SnApp.dbo" to_table="tbServer" delete_action="cascade" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbServerProfile" >
			<column name="ServerProfileId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ServerProfileCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="ServerProfileName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<index name="UQ_ServerProfile_ProfileCode" unique="UNIQUE_KEY" >
				<column name="ServerProfileCode" options="ASC" />
			</index>
			<index name="PK_ServerProfile" unique="PRIMARY_KEY" >
				<column name="ServerProfileId" />
			</index>
		</table>
		<table name="tbServerStartUp" >
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="StartupDateTime" type="datetime" jt="92" mandatory="y" />
			<index name="PK_ServerStartUp" unique="PRIMARY_KEY" >
				<column name="ServerId" />
				<column name="StartupDateTime" />
			</index>
			<fk name="FK_ServerStartUp_Server" to_schema="SnApp.dbo" to_table="tbServer" delete_action="cascade" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbServerWarVersion" prior="TbServerWarVersion" spec="" >
			<comment><![CDATA[History of WAR upgrade version]]></comment>
			<column name="ServerId" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Server Internal ID]]></comment>
			</column>
			<column name="InstallDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Record installation timestamp]]></comment>
			</column>
			<column name="WarVersion" type="nvarchar" length="15" jt="12" mandatory="y" />
			<column name="UpgradeDuration" type="int" jt="4" >
				<comment><![CDATA[Duration of upgarde in milliseconds not yet implemented]]></comment>
			</column>
			<index name="PK_ServerWarVersion" unique="PRIMARY_KEY" >
				<column name="ServerId" />
				<column name="InstallDateTime" />
			</index>
			<fk name="FK_ServerWarVersion_Server" to_schema="SnApp.dbo" to_table="tbServer" delete_action="cascade" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbServiceStatus" prior="Tbl" >
			<comment><![CDATA[Contain updated snapshot of the status of each service per each running server]]></comment>
			<column name="ServerId" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Server internal ID]]></comment>
			</column>
			<column name="ServiceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Service internal ID]]></comment>
			</column>
			<column name="ServiceName" type="varchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Service name]]></comment>
			</column>
			<column name="ServiceStatus" type="int" jt="4" mandatory="y" >
				<comment><![CDATA[LK[170]]]></comment>
			</column>
			<column name="ErrorMessage" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Service current error message. When NULL, the service is not "in error"]]></comment>
			</column>
			<column name="ErrorMessageDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/Time of the error]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Record last update timestamp]]></comment>
			</column>
			<index name="PK_ServiceStatus" unique="PRIMARY_KEY" >
				<column name="ServerId" />
				<column name="ServiceId" />
			</index>
			<index name="IX_ServiceStatus_ServiceId" unique="NORMAL" >
				<column name="ServiceId" />
			</index>
			<fk name="FK_ServiceStatus_Server" to_schema="SnApp.dbo" to_table="tbServer" delete_action="cascade" >
				<fk_column name="ServerId" pk="ServerId" />
			</fk>
		</table>
		<table name="tbSession" >
			<column name="SessionId" type="varchar" length="40" decimal="0" jt="12" mandatory="y" />
			<column name="SessionPoolId" type="uniqueidentifier" jt="1" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CreateDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="ExpireDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="IPAddress" type="varchar" length="40" decimal="0" jt="12" mandatory="y" />
			<column name="WorkstationType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[19]]]></comment>
			</column>
			<column name="SuperUser" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="SecureFingerprint" type="varchar" length="100" decimal="0" jt="12" />
			<column name="SessionData" type="nvarchar(max)" jt="12" />
			<index name="IX_Session_SessionPoolId" unique="NORMAL" >
				<column name="SessionPoolId" options="ASC" />
			</index>
			<index name="IX_Session_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_Session_UserAccountId" unique="NORMAL" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="IX_Session_ExpireDateTime" unique="NORMAL" >
				<column name="ExpireDateTime" options="ASC" />
			</index>
			<index name="IX_Session_WorkstationType" unique="NORMAL" >
				<column name="WorkstationType" options="ASC" />
				<column name="SessionPoolId" options="ASC" />
				<column name="SuperUser" options="ASC" />
			</index>
			<index name="PK_Session" unique="PRIMARY_KEY" >
				<column name="SessionId" />
			</index>
			<fk name="FK_Session_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Session_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Session_SessionPool" to_schema="SnApp.dbo" to_table="tbSessionPool" >
				<fk_column name="SessionPoolId" pk="SessionPoolId" />
			</fk>
		</table>
		<table name="tbSessionPool" >
			<column name="SessionPoolId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SessionPoolName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="WorkstationType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[19]]]></comment>
			</column>
			<index name="PK_SessionPool" unique="PRIMARY_KEY" >
				<column name="SessionPoolId" />
			</index>
		</table>
		<table name="tbSessionToken" >
			<column name="SessionTokenId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SecureFingerprint" type="varchar" length="100" decimal="0" jt="12" mandatory="y" />
			<column name="TokenExpiration" type="datetime" jt="92" mandatory="y" />
			<column name="SessionId" type="varchar" length="40" decimal="0" jt="12" mandatory="y" />
			<column name="TokenStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[359]]]></comment>
			</column>
			<column name="PreviousSessionTokenId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_SessionToken_TokenExpiration" unique="NORMAL" >
				<column name="TokenExpiration" options="ASC" />
			</index>
			<index name="IX_SessionToken_SessionId" unique="NORMAL" >
				<column name="SessionId" options="ASC" />
			</index>
			<index name="IX_SessionToken_Previous" unique="NORMAL" >
				<column name="PreviousSessionTokenId" options="ASC" />
			</index>
			<index name="UQ_SessionToken_SecureFingerprintExpiration" unique="NORMAL" >
				<column name="SecureFingerprint" options="ASC" />
				<column name="TokenExpiration" options="ASC" />
			</index>
			<index name="PK_SessionToken" unique="PRIMARY_KEY" >
				<column name="SessionTokenId" />
			</index>
			<fk name="FK_SessionToken_PreviousSessionToken" to_schema="SnApp.dbo" to_table="tbSessionToken" >
				<fk_column name="PreviousSessionTokenId" pk="SessionTokenId" />
			</fk>
		</table>
		<table name="tbSessionTokenBlackList" >
			<comment><![CDATA[Enlist black listed session tokens for POS/B2C/External workstations]]></comment>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TokenExpiration" type="datetime" jt="92" mandatory="y" />
			<index name="IX_SessionTokenBlackList_Expiration" unique="NORMAL" >
				<column name="TokenExpiration" options="ASC" />
			</index>
			<index name="PK_SessionTokenBlackList" unique="PRIMARY_KEY" >
				<column name="WorkstationId" />
				<column name="TokenExpiration" />
			</index>
			<fk name="FK_SessionTokenBlackList_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbShopCart" >
			<column name="ShopCartId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ShopCartStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[304]]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" />
			<column name="CreateFiscalDate" type="date" jt="91" mandatory="y" />
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="UpdateDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="ItemCount" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="TotalAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" />
			<column name="UploadId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ShopCartData" type="nvarchar(max)" jt="12" />
			<column name="SessionId" type="varchar" length="40" decimal="0" jt="12" >
				<comment><![CDATA[Reference to the session which last touched the shopcart. To be evaluated if in the future we can put a FK to tbSession]]></comment>
			</column>
			<index name="IX_ShopCart_CreateDateTime" unique="NORMAL" >
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_ShopCart_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_ShopCart_TransactionId" unique="NORMAL" options="where TransactionId is not null" >
				<column name="TransactionId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_ShopCart_Status" unique="NORMAL" >
				<column name="ShopCartStatus" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_ShopCart_CreateFiscalDate" unique="NORMAL" >
				<column name="CreateFiscalDate" options="ASC" />
			</index>
			<index name="IX_ShopCart_UploadId" unique="NORMAL" options="where UploadId is not null" >
				<column name="UploadId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_ShopCart_ServerId" unique="NORMAL" options="where ServerId is not null" >
				<column name="ServerId" options="ASC" />
				<column name="ShopCartStatus" options="ASC" />
			</index>
			<index name="IX_ShopCart_UserAccount" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="IX_ShopCart_Session" unique="NORMAL" options="where SessionId is not null" >
				<column name="SessionId" options="ASC" />
			</index>
			<index name="PK_ShopCart" unique="PRIMARY_KEY" >
				<column name="ShopCartId" />
			</index>
			<fk name="FK_ShopCart_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_ShopCart_WorkstationId" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_ShopCart_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_ShopCart_Upload" to_schema="SnApp.dbo" to_table="tbUpload" delete_action="cascade" >
				<fk_column name="UploadId" pk="UploadId" />
			</fk>
		</table>
		<table name="tbSiaeBox" >
			<column name="SiaeBoxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SiaeBoxName" type="nvarchar" length="30" jt="12" mandatory="y" />
			<column name="SiaeBoxUrl" type="nvarchar" length="255" decimal="0" jt="12" mandatory="y" />
			<index name="PK_SiaeBox" unique="PRIMARY_KEY" >
				<column name="SiaeBoxId" />
			</index>
		</table>
		<table name="tbSiaeCard" >
			<column name="CodiceCarta" type="varchar" length="8" decimal="0" jt="12" mandatory="y" />
			<column name="CardStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[?]]]></comment>
			</column>
			<column name="LoginDateTime" type="smalldatetime" jt="93" />
			<column name="CodiceSistema" type="varchar" length="8" decimal="0" jt="12" mandatory="y" />
			<column name="Contatore" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="Balance" type="money" length="0" jt="3" mandatory="y" />
			<column name="Titolare" type="nvarchar" length="50" jt="12" />
			<column name="Firmatario" type="nvarchar" length="50" jt="12" />
			<column name="CodiceFiscale" type="varchar" length="16" decimal="0" jt="12" />
			<column name="Indirizzo" type="nvarchar" length="100" jt="12" />
			<column name="EmailMittente" type="nvarchar" length="50" jt="12" />
			<column name="EmailDestinazione" type="nvarchar" length="50" jt="12" />
			<column name="NomeSistema" type="nvarchar" length="100" jt="12" />
			<column name="CodiceFiscaleSistema" type="varchar" length="16" decimal="0" jt="12" />
			<column name="REA" type="varchar" length="18" decimal="0" jt="12" />
			<column name="Nazione" type="varchar" length="3" decimal="0" jt="12" >
				<comment><![CDATA[IT per Italia]]></comment>
			</column>
			<column name="NumeroDelibera" type="varchar" length="20" decimal="0" jt="12" />
			<column name="DataDelibera" type="date" jt="91" />
			<column name="ContactType" type="varchar" length="1" decimal="0" jt="12" />
			<column name="FileSystemVer" type="varchar" length="5" decimal="0" jt="12" >
				<comment><![CDATA[Versione File System]]></comment>
			</column>
			<column name="Pool" type="varchar" length="8" decimal="0" jt="12" >
				<comment><![CDATA[Nome Smart Card Reader]]></comment>
			</column>
			<column name="IP" type="varchar" length="15" decimal="0" jt="12" >
				<comment><![CDATA[Card IP Address]]></comment>
			</column>
			<column name="Port" type="int" length="1" decimal="0" jt="4" />
			<column name="SiaeBoxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DataScadenza" type="date" jt="91" />
			<column name="Pin" type="nvarchar" length="100" jt="12" />
			<index name="IX_SiaeCard_CodiceSystema" unique="NORMAL" >
				<column name="CodiceSistema" options="ASC" />
			</index>
			<index name="IX_SiaeCard_SiaeBoxId" unique="NORMAL" >
				<column name="SiaeBoxId" options="ASC" />
			</index>
			<index name="PK_SiaeCard" unique="PRIMARY_KEY" >
				<column name="CodiceCarta" />
			</index>
			<fk name="FK_SiaeCard_SiaeSystem" to_schema="SnApp.dbo" to_table="tbSiaeSystem" delete_action="cascade" >
				<fk_column name="CodiceSistema" pk="CodiceSistema" />
			</fk>
			<fk name="FK_SiaeCard_SiaeBox" to_schema="SnApp.dbo" to_table="tbSiaeBox" >
				<fk_column name="SiaeBoxId" pk="SiaeBoxId" />
			</fk>
		</table>
		<table name="tbSiaeConfig" >
			<column name="ParamKey" type="varchar" length="255" decimal="0" jt="12" mandatory="y" />
			<column name="ParamValue" type="varchar" length="255" decimal="0" jt="12" mandatory="y" />
			<index name="PK_SiaeConfig" unique="PRIMARY_KEY" >
				<column name="ParamKey" />
			</index>
		</table>
		<table name="tbSiaeEvent" >
			<comment><![CDATA[Event]]></comment>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OrganizerId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TipoGenere" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Lookup Table "Tipo evento"]]></comment>
			</column>
			<column name="EventType" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Lookup Table "Spettacolo / Intrattenimento"]]></comment>
			</column>
			<column name="TitoloEvento" type="varchar" length="40" decimal="0" jt="12" mandatory="y" />
			<column name="Incidenza" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Incidenza intrattenimento in %]]></comment>
			</column>
			<column name="Autore" type="varchar" length="30" decimal="0" jt="12" />
			<column name="Esecutore" type="varchar" length="80" decimal="0" jt="12" />
			<column name="NazionalitaFilm" type="varchar" length="4" decimal="0" jt="12" />
			<column name="NumeroOpere" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Numero Opere Rappresentate; Default value for performance]]></comment>
			</column>
			<column name="DataInizio" type="datetime" jt="92" />
			<column name="DataFine" type="datetime" jt="92" />
			<column name="IvaOmaggioTitolo" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Default value for performance]]></comment>
			</column>
			<column name="IvaOmaggioAbbFisso" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Default value for performance]]></comment>
			</column>
			<column name="IvaOmaggioAbbLibero" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Default value for performance]]></comment>
			</column>
			<column name="Distributore" type="varchar" length="80" decimal="0" jt="12" />
			<column name="MainEventId" type="uniqueidentifier" jt="1" />
			<column name="SiaeTaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SiaePrevenditaTaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EventoInviti" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Definisce l'evento come a inviti. Un evento a inviti ammette solo "SN" come tipologia di titolo]]></comment>
			</column>
			<index name="IX_SiaeEvent_OrganizerId" unique="NORMAL" >
				<column name="OrganizerId" options="ASC" />
			</index>
			<index name="IX_SiaeEvent_MainEventId" unique="NORMAL" options="where MainEventId is not null" >
				<column name="MainEventId" options="ASC" />
			</index>
			<index name="IX_SiaeEvent_SiaeTaxId" unique="NORMAL" >
				<column name="SiaeTaxId" options="ASC" />
			</index>
			<index name="IX_SiaeEvent_SiaePrevenditaTaxId" unique="NORMAL" >
				<column name="SiaePrevenditaTaxId" options="ASC" />
			</index>
			<index name="PK_SiaeEvent" unique="PRIMARY_KEY" >
				<column name="EventId" />
			</index>
			<fk name="FK_SiaeEvent_SiaeOrganizer" to_schema="SnApp.dbo" to_table="tbSiaeOrganizer" >
				<fk_column name="OrganizerId" pk="OrganizerId" />
			</fk>
			<fk name="FK_SiaeEvent_SiaeEvent" to_schema="SnApp.dbo" to_table="tbSiaeEvent" >
				<fk_column name="MainEventId" pk="EventId" />
			</fk>
			<fk name="FK_SiaeEvent_SiaeTax" to_schema="SnApp.dbo" to_table="tbSiaeTax" >
				<fk_column name="SiaeTaxId" pk="SiaeTaxId" />
			</fk>
			<fk name="FK_SiaeEvent_SiaePrevenditaTax" to_schema="SnApp.dbo" to_table="tbSiaeTax" >
				<fk_column name="SiaePrevenditaTaxId" pk="SiaeTaxId" />
			</fk>
		</table>
		<table name="tbSiaeEventSector" >
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SectorCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Capienza" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_SiaeEventSector_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="PK_SiaeEventSector" unique="PRIMARY_KEY" >
				<column name="EventId" />
				<column name="SectorCode" />
			</index>
			<fk name="FK_SiaeEventSector_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SiaeEventSector_SiaeEvent" to_schema="SnApp.dbo" to_table="tbSiaeEvent" delete_action="cascade" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
		</table>
		<table name="tbSiaeLocation" >
			<column name="LocationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CodiceLocale" type="varchar" length="13" decimal="0" jt="12" mandatory="y" />
			<column name="Denominazione" type="nvarchar" length="30" jt="12" mandatory="y" />
			<column name="Indirizzo" type="nvarchar" length="100" jt="12" />
			<column name="Citta" type="nvarchar" length="30" jt="12" />
			<column name="Provincia" type="varchar" length="2" decimal="0" jt="12" />
			<column name="Capienza" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="UQ_SiaeLocation_CodiceLocale" unique="UNIQUE_KEY" >
				<column name="CodiceLocale" options="ASC" />
			</index>
			<index name="PK_SiaeLocation" unique="PRIMARY_KEY" >
				<column name="LocationId" />
			</index>
			<fk name="FK_SiaeLocation_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="LocationId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbSiaeLog" >
			<comment><![CDATA[Siae Log]]></comment>
			<column name="LogId" type="int" jt="4" mandatory="y" >
				<identity><![CDATA[IDENTITY(1,1)]]></identity>
			</column>
			<column name="Sigillo" type="varchar" length="16" decimal="0" jt="12" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="EventId" type="uniqueidentifier" jt="1" />
			<column name="PerformanceId" type="uniqueidentifier" jt="1" />
			<column name="CodiceSistema" type="varchar" length="8" decimal="0" jt="12" mandatory="y" />
			<column name="CodiceCarta" type="varchar" length="8" decimal="0" jt="12" mandatory="y" />
			<column name="OrganizerId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LocationId" type="uniqueidentifier" jt="1" />
			<column name="PartnerAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[B2B major client]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketId" type="uniqueidentifier" jt="1" />
			<column name="MediaId" type="uniqueidentifier" jt="1" />
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" />
			<column name="Stato" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Lookup Table "Stato del titolo"]]></comment>
			</column>
			<column name="Operazione" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[0=Emissione 1=Annullo]]></comment>
			</column>
			<column name="OriginalLogId" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Link to voided LogId]]></comment>
			</column>
			<column name="DataOraEmissione" type="smalldatetime" jt="93" mandatory="y" />
			<column name="OrdinePosto" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="Posto" type="varchar" length="6" decimal="0" jt="12" />
			<column name="TitoloBase" type="varchar" length="1" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[A=Abbonamento, T=Titolo, F=Figurativo]]></comment>
			</column>
			<column name="IvaPreassolta" type="varchar" length="1" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Y or N]]></comment>
			</column>
			<column name="TipoTurno" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[0=Fisso 1=Libero]]></comment>
			</column>
			<column name="ProgressivoCarta" type="int" length="8" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Contatore in tbSiaeCard]]></comment>
			</column>
			<column name="TipoTassazione" type="varchar" length="1" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[DTD says its I or S;  
-N=Normale B=Abbonamento F=Iva Preassolta-]]></comment>
			</column>
			<column name="PrezzoTitolo" type="money" length="0" jt="3" mandatory="y" />
			<column name="IvaTitolo" type="money" length="0" jt="3" mandatory="y" />
			<column name="PrezzoPrevendita" type="money" length="0" jt="3" mandatory="y" />
			<column name="IvaPrevendita" type="money" length="0" jt="3" mandatory="y" />
			<column name="Rateo" type="money" length="0" jt="3" mandatory="y" />
			<column name="IvaRateo" type="money" length="0" jt="3" mandatory="y" />
			<column name="TipoTitolo" type="varchar" length="10" jt="12" >
				<comment><![CDATA[Lookup Table "Tipo titolo"]]></comment>
			</column>
			<column name="RateoIntrattenimenti" type="money" length="0" jt="3" />
			<column name="ImponibileIntrattenimenti" type="money" length="0" jt="3" />
			<column name="IvaIntrattenimenti" type="money" length="0" jt="3" />
			<column name="Smaterializzato" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[0=Normale 1=Smaterializzato]]></comment>
			</column>
			<column name="IvaRateoIntrattenimenti" type="money" length="0" jt="3" />
			<column name="DataOraEvento" type="smalldatetime" jt="93" />
			<column name="Capienza" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="IsOrphan" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Flag if we need generate void seal for this row]]></comment>
			</column>
			<column name="StatoCorrente" type="varchar" length="10" jt="12" />
			<column name="CausaleAnnullamento" type="varchar" length="10" jt="12" >
				<comment><![CDATA[Lookup table CausaleAnnullamento]]></comment>
			</column>
			<index name="IX_SiaeLog_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="DataOraEmissione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_PerformanceId" unique="NORMAL" options="where PerformanceId is not null" >
				<column name="PerformanceId" options="ASC" />
				<column name="DataOraEmissione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_CodiceSistema" unique="NORMAL" >
				<column name="CodiceSistema" options="ASC" />
				<column name="DataOraEmissione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_CodiceCarta" unique="NORMAL" >
				<column name="CodiceCarta" options="ASC" />
				<column name="DataOraEmissione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_OrganizerId" unique="NORMAL" >
				<column name="OrganizerId" options="ASC" />
				<column name="DataOraEmissione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_LocationId" unique="NORMAL" options="where LocationId is not null" >
				<column name="LocationId" options="ASC" />
				<column name="DataOraEmissione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_TicketId" unique="NORMAL" options="where TicketId is not null" >
				<column name="TicketId" options="ASC" />
				<column name="DataOraEmissione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_MediaId" unique="NORMAL" options="where MediaId is not null" >
				<column name="MediaId" options="ASC" />
				<column name="DataOraEmissione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_SiaeLog_SaleItemDetailId" unique="NORMAL" options="where SaleItemDetailId is not null" >
				<column name="SaleItemDetailId" options="ASC" />
				<column name="PerformanceId" options="ASC" />
				<column name="Posto" options="ASC" />
			</index>
			<index name="IX_SiaeLog_OriginalLogId" unique="NORMAL" options="where OriginalLogId is not null" >
				<column name="OriginalLogId" options="ASC" />
			</index>
			<index name="UQ_SiaeLog_Sigillo" unique="UNIQUE_KEY" >
				<column name="Sigillo" options="ASC" />
			</index>
			<index name="UQ_SiaeLog_Media" unique="UNIQUE_KEY" options="where TitoloBase = &#039;T&#039;&#10;and MediaId is not null&#10;and PerformanceId is not null&#10;and CausaleAnnullamento is null" >
				<column name="MediaId" options="ASC" />
				<column name="PerformanceId" options="ASC" />
				<column name="Operazione" options="ASC" />
			</index>
			<index name="IX_SiaeLog_PartnerAccountId" unique="NORMAL" options="where PartnerAccountId is not null" >
				<column name="PartnerAccountId" options="ASC" />
			</index>
			<index name="PK_SiaeLog" unique="PRIMARY_KEY" >
				<column name="LogId" />
			</index>
			<index name="IX_SiaeLog_EventId" unique="NORMAL" options="where EventId is not null" >
				<column name="EventId" />
			</index>
			<fk name="FK_SiaeLog_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="PartnerAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_SiaeLog_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_SiaeLog_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_SiaeLog_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_SiaeLog_Media" to_schema="SnApp.dbo" to_table="tbMedia" >
				<fk_column name="MediaId" pk="MediaId" />
			</fk>
			<fk name="FK_SiaeLog_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
			<fk name="FK_SiaeLog_SiaeOrganizer" to_schema="SnApp.dbo" to_table="tbSiaeOrganizer" >
				<fk_column name="OrganizerId" pk="OrganizerId" />
			</fk>
			<fk name="FK_SiaeLog_SiaeLocation" to_schema="SnApp.dbo" to_table="tbSiaeLocation" >
				<fk_column name="LocationId" pk="LocationId" />
			</fk>
			<fk name="FK_SiaeLog_SiaeSystem" to_schema="SnApp.dbo" to_table="tbSiaeSystem" >
				<fk_column name="CodiceSistema" pk="CodiceSistema" />
			</fk>
			<fk name="FK_SiaeLog_SiaeCard" to_schema="SnApp.dbo" to_table="tbSiaeCard" >
				<fk_column name="CodiceCarta" pk="CodiceCarta" />
			</fk>
			<fk name="FK_SiaeLog_SiaeEvent" to_schema="SnApp.dbo" to_table="tbSiaeEvent" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
			<fk name="FK_SiaeLog_Original" to_schema="SnApp.dbo" to_table="tbSiaeLog" >
				<fk_column name="OriginalLogId" pk="LogId" />
			</fk>
			<fk name="FK_SiaeLog_SiaeProduct" to_schema="SnApp.dbo" to_table="tbSiaeProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbSiaeLogAbbonamento" >
			<column name="LogId" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="ProductCode" type="varchar" length="8" decimal="0" jt="12" mandatory="y" />
			<column name="SerialCode" type="int" length="1" decimal="0" jt="4" />
			<index name="PK_SiaeLogAbbonamento" unique="PRIMARY_KEY" >
				<column name="LogId" />
			</index>
			<fk name="FK_SiaeLogAbbonamento_SiaeLog" to_schema="SnApp.dbo" to_table="tbSiaeLog" delete_action="cascade" >
				<fk_column name="LogId" pk="LogId" />
			</fk>
		</table>
		<table name="tbSiaeLookup" >
			<column name="LookupTableId" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="LookupItemCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="LookupItemName" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="Note" type="nvarchar(max)" length="600" jt="12" >
				<comment><![CDATA[Additional note describing the details if any]]></comment>
			</column>
			<index name="PK_SiaeLookup" unique="PRIMARY_KEY" >
				<column name="LookupTableId" />
				<column name="LookupItemCode" />
			</index>
		</table>
		<table name="tbSiaeOrganizer" >
			<column name="OrganizerId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Denominazione" type="nvarchar" length="30" jt="12" mandatory="y" />
			<column name="CodiceFiscale" type="varchar" length="16" decimal="0" jt="12" />
			<column name="PartitaIva" type="varchar" length="11" decimal="0" jt="12" />
			<column name="TipoOrganizzatore" type="varchar" length="1" decimal="0" jt="12" mandatory="y" />
			<index name="PK_SiaeOrganizer" unique="PRIMARY_KEY" >
				<column name="OrganizerId" />
			</index>
			<fk name="FK_SiaeOrganizer_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OrganizerId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbSiaePerformance" >
			<comment><![CDATA[Performance]]></comment>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="NumeroOpere" type="int" length="0" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Numero Opere Rappresentate]]></comment>
			</column>
			<column name="IvaOmaggioTitolo" type="money" length="0" jt="3" mandatory="y" />
			<column name="IvaOmaggioAbbFisso" type="money" length="0" jt="3" mandatory="y" />
			<column name="IvaOmaggioAbbLibero" type="money" length="0" jt="3" mandatory="y" />
			<index name="PK_SiaePerformance" unique="PRIMARY_KEY" >
				<column name="PerformanceId" />
			</index>
			<fk name="FK_SiaePerformance_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
		</table>
		<table name="tbSiaePerformanceSector" >
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SectorCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Prezzo" type="money" length="0" jt="3" mandatory="y" />
			<column name="Capienza" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_SiaePerformanceSector_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="PK_SiaePerformanceSector" unique="PRIMARY_KEY" >
				<column name="PerformanceId" />
				<column name="SectorCode" />
			</index>
			<fk name="FK_SiaePerformanceSector_SiaePerformance" to_schema="SnApp.dbo" to_table="tbSiaePerformance" delete_action="cascade" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_SiaePerformanceSector_SiaeProduct" to_schema="SnApp.dbo" to_table="tbSiaeProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbSiaeProduct" >
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OrganizerId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="OrdinePosto" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Lookup table OrdiniDiPosto]]></comment>
			</column>
			<column name="TipoTitolo" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Lookup table TipoTitolo]]></comment>
			</column>
			<column name="EventiAbilitati" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="ProductType" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="CodiceSupporto" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="Smaterializzato" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="SiaeTaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SiaePrevenditaTaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_SiaeProduct_OrganizerId" unique="NORMAL" >
				<column name="OrganizerId" options="ASC" />
			</index>
			<index name="IX_SiaeProduct_SiaeTaxId" unique="NORMAL" >
				<column name="SiaeTaxId" options="ASC" />
			</index>
			<index name="IX_SiaeProduct_SiaePrevenditaTaxId" unique="NORMAL" >
				<column name="SiaePrevenditaTaxId" options="ASC" />
			</index>
			<index name="PK_SiaeProduct" unique="PRIMARY_KEY" >
				<column name="ProductId" />
			</index>
			<fk name="FK_SiaeProduct_Product" to_schema="SnApp.dbo" to_table="tbProduct" delete_action="cascade" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_SiaeProduct_SiaeOrganizer" to_schema="SnApp.dbo" to_table="tbSiaeOrganizer" >
				<fk_column name="OrganizerId" pk="OrganizerId" />
			</fk>
			<fk name="FK_SiaeProduct_SiaeTax" to_schema="SnApp.dbo" to_table="tbSiaeTax" >
				<fk_column name="SiaeTaxId" pk="SiaeTaxId" />
			</fk>
			<fk name="FK_SiaeProduct_SiaePrevenditaTax" to_schema="SnApp.dbo" to_table="tbSiaeTax" >
				<fk_column name="SiaePrevenditaTaxId" pk="SiaeTaxId" />
			</fk>
		</table>
		<table name="tbSiaeReport" >
			<column name="RiepilogoId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Nome" type="nvarchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[Nome del File]]></comment>
			</column>
			<column name="DataRiferimento" type="smalldatetime" jt="93" />
			<column name="Tipo" type="char" length="1" decimal="0" jt="1" mandatory="y" >
				<comment><![CDATA[Tipologia L=LTA, G=Giornaliero, M=Mensile, T=Log Transazione, R=RCA]]></comment>
			</column>
			<column name="Stato" type="char" length="1" decimal="0" jt="1" mandatory="y" >
				<comment><![CDATA[N=non inviato, I=inviato]]></comment>
			</column>
			<column name="DataGenerazione" type="smalldatetime" jt="93" mandatory="y" />
			<column name="DataSalvataggio" type="smalldatetime" jt="93" />
			<column name="DataInvio" type="smalldatetime" jt="93" />
			<column name="Progressivo" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="Sostituzione" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="Riepilogo" type="nvarchar(max)" jt="12" mandatory="y" />
			<column name="LastLogId" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="PK_SiaeReport" unique="PRIMARY_KEY" >
				<column name="RiepilogoId" />
			</index>
		</table>
		<table name="tbSiaeSystem" >
			<column name="CodiceSistema" type="varchar" length="8" decimal="0" jt="12" mandatory="y" />
			<column name="MainSystem" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="Denominazione" type="nvarchar" length="100" jt="12" mandatory="y" />
			<column name="CodiceFiscale" type="varchar" length="16" decimal="0" jt="12" mandatory="y" />
			<column name="Ubicazione" type="nvarchar" length="100" jt="12" />
			<column name="EmailMittente" type="nvarchar" length="50" jt="12" />
			<column name="EmailDestinazione" type="nvarchar" length="50" jt="12" />
			<column name="REA" type="varchar" length="18" decimal="0" jt="12" />
			<column name="Nazione" type="varchar" length="3" decimal="0" jt="12" />
			<column name="CodiceProvvedimento" type="varchar" length="20" decimal="0" jt="12" />
			<column name="DataProvvedimento" type="date" jt="91" />
			<column name="SiaeCompetenza" type="nvarchar" length="100" jt="12" />
			<index name="PK_SiaeSystem" unique="PRIMARY_KEY" >
				<column name="CodiceSistema" />
			</index>
		</table>
		<table name="tbSiaeTax" >
			<column name="SiaeTaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TaxName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<index name="PK_SiaeTax" unique="PRIMARY_KEY" >
				<column name="SiaeTaxId" />
			</index>
		</table>
		<table name="tbSiaeTaxRate" >
			<column name="SiaeTaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ValidDateFrom" type="date" jt="91" mandatory="y" />
			<column name="ValidDateTo" type="date" jt="91" />
			<column name="TaxValue" type="money" length="0" jt="3" mandatory="y" />
			<index name="PK_SiaeTaxRate" unique="PRIMARY_KEY" >
				<column name="SiaeTaxId" />
				<column name="ValidDateFrom" />
			</index>
			<fk name="FK_SiaeTaxRate_SiaeTax" to_schema="SnApp.dbo" to_table="tbSiaeTax" delete_action="cascade" >
				<fk_column name="SiaeTaxId" pk="SiaeTaxId" />
			</fk>
		</table>
		<table name="tbSiaeWorkstation" prior="TbSiaeWorkstation" >
			<column name="NumericCode" type="int" jt="4" mandatory="y" >
				<identity><![CDATA[IDENTITY(1,1)]]></identity>
				<comment><![CDATA[Codice richiedente consists of two parts: 1) prefix 2) Numeric code
This is the numeric code part]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AlphaCode" type="nvarchar" length="2" jt="12" mandatory="y" >
				<comment><![CDATA[Codice richiedente consists of two parts: 1) prefix 2) Numeric code
This is the prefix.]]></comment>
			</column>
			<index name="PK_SiaeWorkstation" unique="PRIMARY_KEY" >
				<column name="NumericCode" />
			</index>
			<index name="UQ_SiaeWorkstation_Workstation" unique="UNIQUE_INDEX" >
				<column name="WorkstationId" />
			</index>
			<fk name="FK_SiaeWorkstation_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbSignature" >
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SignatureSerial" type="tinyint" length="1" decimal="0" jt="-6" mandatory="y" >
				<comment><![CDATA[Allows to identify the proper signature image in case of multiple signature linked to an EntityId (ex. Installment contract with multiple signatures required).]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="DocData" type="varbinary(max)" jt="-3" mandatory="y" />
			<column name="ImageFormat" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[248]]]></comment>
			</column>
			<index name="PK_Signature" unique="PRIMARY_KEY" >
				<column name="EntityId" />
				<column name="SignatureSerial" />
			</index>
		</table>
		<table name="tbStatDate" >
			<column name="CalendarDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[The calendar date in mm/dd/yyyy format.
Example:  2000-01-01, 1999-04-21]]></comment>
			</column>
			<column name="CalendarDayNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The day number within the calendar year for this calendar date. 
Synonym: Julian Day

Examples: 5 (Jan 5, 2000), 33 (Feb 2, 2000)]]></comment>
			</column>
			<column name="CalendarWeekNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the week within the calendar year in which this calendar date occurs.

Examples: 2 (Jan 12, 2000)]]></comment>
			</column>
			<column name="CalendarMonthNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the month in the year on which this calendar date occurs.

Examples:1 (January), 2 (February), 3  (March), 4 (April), 5 (May), 6 (June), 7 (July), 8 (August), 9 (September), 10 (October), 11 (November), 12 (December)]]></comment>
			</column>
			<column name="CalendarMonthName" type="nvarchar" length="20" decimal="0" jt="12" >
				<comment><![CDATA[The name for the month in the year on which this calendar date occurs.

Examples:
January,
February,
March,
April,
May,
June,
July,
August,
September,
October,
November,
December]]></comment>
			</column>
			<column name="CalendarQuarterNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the calendar quarter in which the calendar date occurs.

Example: 1 (January 12, 2000)]]></comment>
			</column>
			<column name="CalendarSeasonName" type="nvarchar" length="40" decimal="0" jt="12" >
				<comment><![CDATA[The season to which this calendar date belongs.

Examples: Spring, Summer, Fall, Winter]]></comment>
			</column>
			<column name="CalendarYearNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The year in which this calendar date occurs.

Example:  2000, 2001]]></comment>
			</column>
			<column name="CalendarWeekDayNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the day of the week on which this calendar date occurs.

Examples:
01 (Sunday), 
02 (Monday),
03 (Tuesday),
04 (Wednesday),
05 (Thursday),
06 (Friday),
07 (Saturday)]]></comment>
			</column>
			<column name="CalendarWeekDayName" type="nvarchar" length="20" decimal="0" jt="12" >
				<comment><![CDATA[The name for the calendar week day.

Examples:
Sunday, Monday, Tuesday, Wednesday, Thursday, Friday, Saturday]]></comment>
			</column>
			<column name="CalendarWeekDayIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[Indicates that this date value is a week day (Monday through Friday are Calendar Week Days)

Example: Y, N]]></comment>
			</column>
			<column name="CalendarWeekEndIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[Indicates that this date value is  Saturday or Sunday.

Example: Y, N]]></comment>
			</column>
			<column name="CalendarWeekEndDate" type="date" jt="91" >
				<comment><![CDATA[The Saturday week ending date for the calendar day in the week.

Example: 1999-07-31(For calendar date 1999-07-27)]]></comment>
			</column>
			<column name="CalendarMonthDayNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The day within the calendar month.

Example: 1 (The first of the month), 20 (the twentieth day of the month)]]></comment>
			</column>
			<column name="CalendarMonthWeekNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The week number within the calendar month in which the date value occurs. 

Example: 2 (Feb 12, 2000)]]></comment>
			</column>
			<column name="CalendarMonthEndIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[Indicates that this day is the last day of the month.]]></comment>
			</column>
			<column name="FiscalDayNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[A number representing the day within a fiscal calendar year.

Example: 22 (Correlates to 1999-10-24: fiscal year month October and Year 2000)]]></comment>
			</column>
			<column name="FiscalWeekNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the fiscal week in which the calendar date occurs.

Example:  3 (1999-10-24)"]]></comment>
			</column>
			<column name="FiscalWeekStartDate" type="date" jt="91" >
				<comment><![CDATA[The starting date for the fiscal week.]]></comment>
			</column>
			<column name="FiscalWeekEndDate" type="date" jt="91" >
				<comment><![CDATA[The  week ending date for the fiscal week.]]></comment>
			</column>
			<column name="FiscalWeekDayNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the day of the fiscal week on which this calendar date occurs.  This is for the case where the fiscal week starts on a different day then the Calendar week.]]></comment>
			</column>
			<column name="FiscalWeekDayIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[Indicates that this date value is considered a week day by the business which may be different than the calendar date of  Monday through Friday.

Example: Y, N]]></comment>
			</column>
			<column name="FiscalWeekEndIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[Indicates that this date value is considered a week end day

Example: Y, N]]></comment>
			</column>
			<column name="FiscalMonthNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the fiscal month in which the calendar date occurs.

Examples:  1 (October), 2 (November), 3 (December), 4 (January), 5 (February), 6 (March), 7 (April), 8 (May), 9 (June), 10 (July), 11 (August), 12 (September)]]></comment>
			</column>
			<column name="FiscalMonthName" type="nvarchar" length="20" decimal="0" jt="12" >
				<comment><![CDATA[Name of Month for Fiscal Year.

Example: 
January,
February,
March,
April,
May,
June,
July,
August,
September,
October,
November,
December]]></comment>
			</column>
			<column name="FiscalMonthStartDate" type="date" jt="91" >
				<comment><![CDATA[The starting date for the fiscal month.]]></comment>
			</column>
			<column name="FiscalMonthEndDate" type="date" jt="91" >
				<comment><![CDATA[The ending date for the fiscal month.]]></comment>
			</column>
			<column name="FiscalQuarterNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the fiscal quarter in which the calendar date occurs.

Example:  2 (January 12, 2000)]]></comment>
			</column>
			<column name="FiscalQuarterStartDate" type="date" jt="91" >
				<comment><![CDATA[The starting date for the fiscal quarter in which the calendar date occurs.]]></comment>
			</column>
			<column name="FiscalHalfNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the fiscal half in which the calendar date occurs.

Example:  1 (first half of the year) 2 (second half of the year)]]></comment>
			</column>
			<column name="FiscalYearNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The number for the fiscal year in which the calendar date occurs. Example:  2000 (1999-10-24)]]></comment>
			</column>
			<column name="FiscalYearStartDate" type="date" jt="91" >
				<comment><![CDATA[The starting date for the fiscal year in which the calendar date occurs.]]></comment>
			</column>
			<column name="FiscalMonthDayNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The day within the fiscal month.

Example: 1 (May 30), 2 (May 31), 3 (June 1)]]></comment>
			</column>
			<column name="FiscalMonthWeekNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The ordinal number of the week within the fiscal month.  A fiscal month contains either 4, 5 or 6 weeks.

Examples:  1, 2, 3, 4, 5, 6.]]></comment>
			</column>
			<column name="FiscalMonthEndIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[Indicates that this day is the last day of the fiscal month.]]></comment>
			</column>
			<column name="PriorCalendarYearNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The prior year represented as a number

Examples: 1999, 2002, 2005]]></comment>
			</column>
			<column name="PriorFiscalMonthEndDate" type="date" jt="91" >
				<comment><![CDATA[The end date for the prior fiscal month.]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalYearEndDate" type="date" jt="91" >
				<comment><![CDATA[The end date for the fiscal year of the prior year.]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalQuarterEndDate" type="date" jt="91" >
				<comment><![CDATA[The end date for the fiscal quarter of the prior year.]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalMonthEndDate" type="date" jt="91" >
				<comment><![CDATA[The end date for the fiscal monrh of the prior year.]]></comment>
			</column>
			<column name="SpecialEventName" type="nvarchar" length="40" decimal="0" jt="12" >
				<comment><![CDATA[Identifies any special event that is scheduled to occur or has occurred on this date.]]></comment>
			</column>
			<column name="BusinessSeasonName" type="nvarchar" length="40" decimal="0" jt="12" >
				<comment><![CDATA[Identifies the business season under which this date falls.]]></comment>
			</column>
			<column name="HolidayName" type="nvarchar" length="40" decimal="0" jt="12" >
				<comment><![CDATA[Identifies a recognized holiday which occurs on this date.]]></comment>
			</column>
			<column name="HolidayObserveName" type="nvarchar" length="40" decimal="0" jt="12" >
				<comment><![CDATA[Identifies a recognized holiday which is observed by the organization on this date.]]></comment>
			</column>
			<column name="HolidaySeasonName" type="nvarchar" length="40" decimal="0" jt="12" >
				<comment><![CDATA[HolidaySeasonName]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalYearNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[The fiscal year  prior to the fiscal year in which this calendar date occurs. Example:  2000, 2001]]></comment>
			</column>
			<column name="CurrentDayIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag indicating that the calendar date is today's date, where 'Y' is today's date.  This flag is reset daily. Only one record should be flagged as today's day.]]></comment>
			</column>
			<column name="PreviousDayIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag indicating the calendar date is yesterday's date, This flag is reset daily. Only one record should be flagged as yesterday's date]]></comment>
			</column>
			<column name="PriorFiscalWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) indicating the dates belonging to last fiscal week, relative to today's date.   This flag is reset weekly, with only 7 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalMonthIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) indicating the dates belonging to last fiscal month, relative to today's date.  This flag is reset weekly, with only 28 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalQuarterIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) indicating the dates belonging to last fiscal quarter, relative to today's date.  This flag is reset weekly, with only 90 or 91 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalYearIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) indicating the dates belonging to last fiscal year, relative to today's date.  This flag is reset yearly, with only 364-365 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="Previous14DaysIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the 14 calendar days previous to today's date.  This flag is reset daily, with only 14 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="Previous5DaysIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the 5 calendar days previous to today's date.  This flag is reset daily, with only 5 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="Previous7DaysIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the 7 calendar days previous to today's date.  This flag is reset daily, with only 5 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="Previous90DaysIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the 90 calendar days previous to today's date.  This flag is reset daily, with only 90 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="CurrentFiscalMonthLastWeekEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the week-ending date for the last fiscal week of the current fiscal month, relative to today's date.  This flag is reset weekly, with only one record being marked, and all others remaining null.]]></comment>
			</column>
			<column name="CurrentFiscalYearWeekEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the week-ending dates occuring in the current fiscal year, up until today's date.  This flag is reset daily, with between 1 - 52 records being marked, and others remaining null.]]></comment>
			</column>
			<column name="CurrentFiscalYearToWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the prior dates occuring in the current fiscal year, relative to today's date, prior to the current fiscal week.  This flag is reset daily, with between 1 - 357 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="CurrentFiscalYearToDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the prior dates occuring in the current fiscal year, relative to today's date, including the current fiscal week.  This flag is reset daily, with between 1 - 365 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="CurrentFiscalQuarterToWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the prior dates occuring in the current fiscal quarter, relative to today's date, prior to the current fiscal week.  This flag is reset daily, with between 1 - 83 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="CurrentFiscalYearMonthToWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the prior dates occuring in the current fiscal month, relative to today's date, prior to the current fiscal week.  This flag is reset daily, with between 1 - 21 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalYearPriorWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the seven days in the prior fiscal week of the last fiscal year, relative to the last year's corresponding date to today's date.   This flag is reset weekly, with only 7 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalMonthToWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the prior dates occuring in the prior fiscal month, relative to today's date, prior to the current fiscal week.  This flag is reset daily, with between 1 - 21 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalQuarterToWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the prior dates occuring in the prior fiscal quarter, relative to today's date, prior to the current fiscal week.  This flag is reset daily, with between 1 - 83 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalYearToWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the prior dates occuring in the prior fiscal year, relative to today's date, prior to the current fiscal week.  This flag is reset daily, with between 1 - 357 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="CurrentFiscalYearPrevious12MonthEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the month-ending dates of the last12 fiscal months, relative to today's date.  This flag is reset daily, with 12 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalYearPrevious12MonthEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the month-ending dates of the prior year's last12 fiscal months, relative to the Prior Year Calendar Date for today's date.  This flag is reset daily, with 12 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalWeekEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the week-ending date for the last fiscal week (usually a Saturday) relative to today's date.  This flag is reset weekly, with only one record being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorYearLastFiscalWeekEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the week-ending date for the last fiscal week of the prior fiscal year, relative to the Prior Year Calendar Date for today's date.  This flag is reset weekly, with only one record being marked, and all others remaining null.]]></comment>
			</column>
			<column name="Previous2DaysIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the 2 calendar dates prevoius to today's date.  This flag is reset daily, with only 2 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalMonthEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the last date of previous fiscal month, relative to today's date.  This flag is reset monthly, with only one record being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalYearEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the last date of previous fiscal year, relative to today's date.  This flag is reset yearly, with only one record being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalMonthWeekEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the week-ending dates for the fiscal weeks in the prior fiscal month, relative to today's date.  This flag is reset weekly, with 4-5 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="CurrentFiscalYearFiscalWeekStartDate" type="date" jt="91" >
				<comment><![CDATA[The date of the start of the current fiscal week for this calendar date.]]></comment>
			</column>
			<column name="CurrentFiscalYearFiscalMonthStartDate" type="date" jt="91" >
				<comment><![CDATA[The date of the start of the current fiscal month for this calendar date.]]></comment>
			</column>
			<column name="CurrentFiscalYearFiscalQuarterStartDate" type="date" jt="91" >
				<comment><![CDATA[The date of the start of the current fiscal quarter for this calendar date.]]></comment>
			</column>
			<column name="CurrentFiscalYearFiscalYearStartDate" type="date" jt="91" >
				<comment><![CDATA[The date of the start of the current fiscal year for this calendar date.]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalWeekEndDate" type="date" jt="91" >
				<comment><![CDATA[The date of the end of the fiscal week in the prior fiscal year, relative to the corresponding calendar date in the prior year.]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalWeekStartDate" type="date" jt="91" >
				<comment><![CDATA[The date of the start of the fiscal week in the prior fiscal year, relative to the corresponding calendar date in the prior year.]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalMonthStartDate" type="date" jt="91" >
				<comment><![CDATA[The date of the start of the fiscal month in the prior fiscal year, relative to the corresponding calendar date in the prior year.]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalQuarterStartDate" type="date" jt="91" >
				<comment><![CDATA[The date of the start of the fiscal quarter in the prior fiscal year, relative to the corresponding calendar date in the prior year.]]></comment>
			</column>
			<column name="PriorFiscalYearFiscalYearStartDate" type="date" jt="91" >
				<comment><![CDATA[The date of the start of the prior fiscal year for this calendar date.]]></comment>
			</column>
			<column name="PriorYearCalendarDate" type="date" jt="91" >
				<comment><![CDATA[The calendar date of the prior year corresponding to the calendar date of the current record. Examples: 2012-07-04, 2011-07-03]]></comment>
			</column>
			<column name="CurrentFiscalYearEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the end of the current fiscal year, relative to today's date.  This flag is reset yearly, with only 1 record being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PreviousCalendarMonthDaysIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking the dates of the previous calendar month, relative to today's date.  This flag is reset monthly, with between 1-31 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="FiscalQuarterEndDateIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A flag (Y) indicating that this date is the end of a fiscal quarter.]]></comment>
			</column>
			<column name="CurrentFiscalYearPrevious8FiscalWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking calendar dates within the prior 8 fiscal weeks, relative to today's date.  This flag is reset weekly, with 56 records being marked, and all others remaining null.]]></comment>
			</column>
			<column name="PriorFiscalYearPrevious8FiscalWeekIndicator" type="bit" length="1" decimal="0" jt="-7" >
				<comment><![CDATA[A temporal flag (Y) marking calendar dates within the prior 8 fiscal weeks of the prior fiscal year, relative to the Prior Year Calendar Date for today's date.  This flag is reset weekly, with 56 records being marked, and all others remaining null.]]></comment>
			</column>
			<index name="UQ_StatDate_CalendarDate" unique="UNIQUE_KEY" >
				<column name="CalendarDate" options="ASC" />
			</index>
			<index name="PK_StatDate" unique="PRIMARY_KEY" >
				<column name="CalendarDate" />
			</index>
		</table>
		<table name="tbStatTime" >
			<column name="ReferenceTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[The Time represented in military format such as "05:35" for 5:35 AM  or "18:45"  for 6:45 PM]]></comment>
			</column>
			<column name="ClockTime" type="datetime" jt="92" >
				<comment><![CDATA[The Time represented as it would appear on a clock such as "5:35" for 5:35 AM  or "6:45"  for 6:45 PM]]></comment>
			</column>
			<column name="ClockTimeSuffixName" type="nvarchar" length="8" decimal="0" jt="12" >
				<comment><![CDATA[A suffix indicating the time relationship to the overall day as A.M., P.M., Noon or Midnight.]]></comment>
			</column>
			<column name="ClockTimeSuffixAbbreviationName" type="nvarchar" length="2" decimal="0" jt="12" >
				<comment><![CDATA[An abbreviation indicating the time relationship to the overall day.  The following are the four possible abbreviations and what they mean: AM (before noon; ante meridian), PM (after noon; post meridian), Nn (noon), Mn (midnight.)]]></comment>
			</column>
			<column name="CalendarDayMinuteCount" type="float" length="1" decimal="0" jt="8" >
				<comment><![CDATA[The number of minutes since midnight; a number from 0 to 1399.]]></comment>
			</column>
			<column name="FiscalClockOffsetNumber" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Indicates if time is within the fiscal day or belongs to the previous fiscal day.  A -1 indicates that the time belongs to the preceding fiscal day.  For example, if 1:01 AM belongs to the previous day, the fiscal clock offset would be -1 for that time.]]></comment>
			</column>
			<column name="Reference5MinuteSegmentStartTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest preceding or co-existing five minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference5MinuteSegmentEndTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest following or co-existing five minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference15MinuteSegmentStartTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest preceding or co-existing fifteen minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference15MinuteSegmentEndTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest following or co-existing fifteen minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference20MinuteSegmentStartTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest preceding or co-existing twenty minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference20MinuteSegmentEndTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest following or co-existing twenty minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference30MinuteSegmentStartTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest preceding or co-existing thirty minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference30MinuteSegmentEndTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest following or co-existing thirty minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference60MinuteSegmentStartTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest preceding or co-existing sixty minute segment to the indicated time.]]></comment>
			</column>
			<column name="Reference60MinuteSegmentEndTime" type="datetime" jt="92" >
				<comment><![CDATA[The closest following or co-existing sixty minute segment to the indicated time.]]></comment>
			</column>
			<index name="UQ_StateTime_ReferenceTime" unique="UNIQUE_KEY" >
				<column name="ReferenceTime" options="ASC" />
			</index>
			<index name="PK_StatTime" unique="PRIMARY_KEY" >
				<column name="ReferenceTime" />
			</index>
		</table>
		<table name="tbSurvey" >
			<column name="SurveyId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SurveyType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[230] Sale/Transaction]]></comment>
			</column>
			<column name="SurveyCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="SurveyName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="Frequency" type="smallint" length="1" decimal="0" jt="5" />
			<column name="Rules" type="nvarchar(max)" jt="12" />
			<column name="AttachToSale" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates to save metadata on order level (intead of transaction level) even when SurveyType is "transaction"]]></comment>
			</column>
			<index name="UQ_Survey_SurveyCode" unique="UNIQUE_KEY" >
				<column name="SurveyCode" options="ASC" />
			</index>
			<index name="PK_Survey" unique="PRIMARY_KEY" >
				<column name="SurveyId" />
			</index>
		</table>
		<table name="tbSurvey2Mask" >
			<column name="SurveyId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MaskId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_Survey2Mask_MaskId" unique="NORMAL" >
				<column name="MaskId" options="ASC" />
			</index>
			<index name="PK_Survey2Mask" unique="PRIMARY_KEY" >
				<column name="SurveyId" />
				<column name="MaskId" />
			</index>
			<fk name="FK_Survey2Mask_Mask" to_schema="SnApp.dbo" to_table="tbMask" >
				<fk_column name="MaskId" pk="MaskId" />
			</fk>
			<fk name="FK_Survey2Mask_Survey" to_schema="SnApp.dbo" to_table="tbSurvey" delete_action="cascade" >
				<fk_column name="SurveyId" pk="SurveyId" />
			</fk>
		</table>
		<table name="tbTag" >
			<column name="TagId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<column name="TagCode" type="varchar" length="15" jt="12" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="TagName" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Label of the tag]]></comment>
			</column>
			<index name="UQ_Tag_TagCode" unique="UNIQUE_KEY" options="where TagCode is not null" >
				<column name="EntityType" options="ASC" />
				<column name="TagCode" options="ASC" />
			</index>
			<index name="IX_Tag_EntityType" unique="NORMAL" >
				<column name="EntityType" options="ASC" />
				<column name="TagName" options="ASC" />
			</index>
			<index name="PK_Tag" unique="PRIMARY_KEY" >
				<column name="TagId" />
			</index>
		</table>
		<table name="tbTagLink" >
			<comment><![CDATA[N to N table for linking different entities to tags]]></comment>
			<column name="TagId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the tag]]></comment>
			</column>
			<column name="EntityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the entity]]></comment>
			</column>
			<column name="TagLinkType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[462]]]></comment>
			</column>
			<column name="EntityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[131]]]></comment>
			</column>
			<index name="PK_TagLink" unique="PRIMARY_KEY" >
				<column name="TagId" />
				<column name="EntityId" />
				<column name="TagLinkType" />
			</index>
			<index name="IX_TagLink_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
				<column name="TagLinkType" options="ASC" />
			</index>
			<fk name="FK_TagLink_Tag" to_schema="SnApp.dbo" to_table="tbTag" delete_action="cascade" >
				<fk_column name="TagId" pk="TagId" />
			</fk>
		</table>
		<table name="tbTask" >
			<comment><![CDATA[Stores configured scheduled tasks]]></comment>
			<column name="TaskId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="TaskName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the task]]></comment>
			</column>
			<column name="TaskType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[154]]]></comment>
			</column>
			<column name="NextTaskId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Task to be processed at the end of the execution of each job]]></comment>
			</column>
			<column name="TaskConfig" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[JSON representing specific task settings]]></comment>
			</column>
			<column name="TaskFrequency" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[155]]]></comment>
			</column>
			<column name="TimeFrom" type="datetime" jt="92" >
				<comment><![CDATA[Schedule starting time]]></comment>
			</column>
			<column name="TimeTo" type="datetime" jt="92" >
				<comment><![CDATA[Schedule ending time]]></comment>
			</column>
			<column name="TimeZone" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[238]]]></comment>
			</column>
			<column name="Interval" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[For "monthly" schedules, represent the day of the month.
For "recurrent" schedules, represente how many minutes are between each execution]]></comment>
			</column>
			<column name="ActiveMon" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the task should be executed on Mondays]]></comment>
			</column>
			<column name="ActiveTue" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the task should be executed on Tuesdays]]></comment>
			</column>
			<column name="ActiveWed" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the task should be executed on Wednesdays]]></comment>
			</column>
			<column name="ActiveThu" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the task should be executed on Thursdays]]></comment>
			</column>
			<column name="ActiveFri" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the task should be executed on Fridays]]></comment>
			</column>
			<column name="ActiveSat" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the task should be executed on Saturdays]]></comment>
			</column>
			<column name="ActiveSun" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the task should be executed on Sundays]]></comment>
			</column>
			<column name="LastFire" type="datetime" jt="92" >
				<comment><![CDATA[Indicates the date/time when the task should be executed NEXT time]]></comment>
			</column>
			<column name="LastReference" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Used for differential data exports]]></comment>
			</column>
			<column name="LastEntityChangeId" type="bigint" length="1" decimal="0" jt="-5" >
				<comment><![CDATA[Used for differential data exports]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" >
				<comment><![CDATA[Used for differential data exports]]></comment>
			</column>
			<column name="PurgeDays" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Job's persistance's number of days.
When null, default is taken from data-purge task]]></comment>
			</column>
			<column name="TaskStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[310] - Active, Disabled, Deleted]]></comment>
			</column>
			<column name="ClassAlias" type="varchar" length="30" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Class alias for the specific task]]></comment>
			</column>
			<column name="SendNotification" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Specify if task execution should send notifications]]></comment>
			</column>
			<column name="NotificationSubject" type="nvarchar" length="100" jt="12" >
				<comment><![CDATA[Notification subject if "SendNotification" is active]]></comment>
			</column>
			<column name="NotificationEmail" type="nvarchar" length="500" jt="12" >
				<comment><![CDATA[List of email addresses comma separated if "SendNotification" is active]]></comment>
			</column>
			<column name="NotifyOnJobFailure" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Send notification if job fails]]></comment>
			</column>
			<column name="NotifyOnSuccessCount" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Send notification in case of at least one successful record processed.
NotifyOnJob must be true.]]></comment>
			</column>
			<column name="NotifyOnWarnCount" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Send notification in case of at least one record processed with warn.
NotifyOnJob must be true.]]></comment>
			</column>
			<column name="NotifyOnFailCount" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Send notification in case of at least one record process has failed.
NotifyOnJob must be true.]]></comment>
			</column>
			<column name="ExtensionPackageId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the specific extension package containing the task]]></comment>
			</column>
			<column name="ExecPosition" type="int" jt="4" >
				<comment><![CDATA[For "maintenance" tasks only, indicates the overall execution position out of the total items to be processed]]></comment>
			</column>
			<column name="ExecTotal" type="int" jt="4" >
				<comment><![CDATA[For "maintenance" tasks only, indicates the overall total items to be processed]]></comment>
			</column>
			<column name="CreateDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time of task creation]]></comment>
			</column>
			<index name="IX_Task_ExtensionPackageId" unique="NORMAL" options="where ExtensionPackageId is not null" >
				<column name="ExtensionPackageId" options="ASC" />
			</index>
			<index name="PK_Task" unique="PRIMARY_KEY" >
				<column name="TaskId" />
			</index>
			<index name="IX_Task_NextTaskId" unique="NORMAL" options="where NextTaskId is not null" >
				<column name="NextTaskId" />
			</index>
			<fk name="FK_Task_NextTask" to_schema="SnApp.dbo" to_table="tbTask" >
				<fk_column name="NextTaskId" pk="TaskId" />
			</fk>
			<fk name="FK_Task_ExtensionPackage" to_schema="SnApp.dbo" to_table="tbExtensionPackage" delete_action="cascade" >
				<fk_column name="ExtensionPackageId" pk="ExtensionPackageId" />
			</fk>
		</table>
		<table name="tbTask2ServerProfile" prior="Tbl" >
			<comment><![CDATA[List of server profiles on which the task can be executed]]></comment>
			<column name="TaskId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to task internal ID]]></comment>
			</column>
			<column name="ServerProfileId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to server profile internal ID]]></comment>
			</column>
			<index name="PK_Task2ServerProfile" unique="PRIMARY_KEY" >
				<column name="TaskId" />
				<column name="ServerProfileId" />
			</index>
			<index name="IX_Task2ServerProfile_ServerProfileId" unique="NORMAL" >
				<column name="ServerProfileId" />
			</index>
			<fk name="FK_Task2ServerProfile_TaskId" to_schema="SnApp.dbo" to_table="tbTask" delete_action="cascade" >
				<fk_column name="TaskId" pk="TaskId" />
			</fk>
			<fk name="FK_Task2ServerProfile_ServerProfileId" to_schema="SnApp.dbo" to_table="tbServerProfile" >
				<fk_column name="ServerProfileId" pk="ServerProfileId" />
			</fk>
		</table>
		<table name="tbTaskDataExport" >
			<column name="TaskId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="DataExportOption" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[264]]]></comment>
			</column>
			<column name="RecipientRecap" type="nvarchar" length="100" jt="12" />
			<column name="LastEntityChangeId" type="bigint" length="1" decimal="0" jt="-5" />
			<column name="DataSourceId" type="uniqueidentifier" jt="1" />
			<index name="IX_TaskDataExport_DocTemplateId" unique="NORMAL" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="IX_TaskDataExport_DataSourceId" unique="NORMAL" options="where DataSourceId is not null" >
				<column name="DataSourceId" options="ASC" />
			</index>
			<index name="PK_TaskDataExport" unique="PRIMARY_KEY" >
				<column name="TaskId" />
			</index>
			<fk name="FK_TaskDataExport_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
			<fk name="FK_TaskDataExport_Task" to_schema="SnApp.dbo" to_table="tbTask" delete_action="cascade" >
				<fk_column name="TaskId" pk="TaskId" />
			</fk>
			<fk name="FK_TaskDataExport_DataSource" to_schema="SnApp.dbo" to_table="tbDataSource" >
				<fk_column name="DataSourceId" pk="DataSourceId" />
			</fk>
		</table>
		<table name="tbTaskTrigger" >
			<column name="TaskTriggerId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TaskId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TriggerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[156]]]></comment>
			</column>
			<column name="Enabled" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="TriggerConfig" type="nvarchar(max)" jt="12" />
			<index name="PK_TaskTrigger" unique="PRIMARY_KEY" >
				<column name="TaskTriggerId" />
			</index>
			<index name="IX_TaskTrigger_TaskId" unique="NORMAL" >
				<column name="TaskId" />
			</index>
			<fk name="FK_TaskTrigger_Task" to_schema="SnApp.dbo" to_table="tbTask" delete_action="cascade" >
				<fk_column name="TaskId" pk="TaskId" />
			</fk>
		</table>
		<table name="tbTax" >
			<comment><![CDATA[Hold taxes definition]]></comment>
			<column name="TaxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="TaxCode" type="varchar" length="10" jt="12" mandatory="y" >
				<comment><![CDATA[Tax user defined intelligible code]]></comment>
			</column>
			<column name="TaxName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Tax name]]></comment>
			</column>
			<column name="TaxType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[30] (percentage, absolute)]]></comment>
			</column>
			<column name="RoundingType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[73] Trunc, Algebraic]]></comment>
			</column>
			<column name="Remboursable" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if the tax could be refunded or not]]></comment>
			</column>
			<column name="Exemptible" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When false, tells that the tax must be charge even in tax exempt transactions]]></comment>
			</column>
			<column name="ExemptibleExplicit" prior="ExemptibleSpecific" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Tax is exemptible only if explicitly declared on the reservation's account]]></comment>
			</column>
			<column name="BearedTax" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When flagged, tax linked to the product can concur on increasing the clearing limit of the product]]></comment>
			</column>
			<column name="PosPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the tax plugin to be used from POS]]></comment>
			</column>
			<column name="WebPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the tax plugin to be used from WEB]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" />
			<index name="UQ_Tax_Code" unique="UNIQUE_KEY" >
				<column name="TaxCode" options="ASC" />
			</index>
			<index name="IX_Tax_PosPluginId" unique="NORMAL" options="where PosPluginId is not null" >
				<column name="PosPluginId" options="ASC" />
			</index>
			<index name="IX_Tax_WebPluginId" unique="NORMAL" options="where WebPluginId is not null" >
				<column name="WebPluginId" options="ASC" />
			</index>
			<index name="PK_Tax" unique="PRIMARY_KEY" >
				<column name="TaxId" />
			</index>
			<fk name="FK_Tax_PosPlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PosPluginId" pk="PluginId" />
			</fk>
			<fk name="FK_Tax_WebPlugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="WebPluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbTaxBracket" >
			<column name="TaxBracketId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="TaxableAmountFrom" type="money" length="0" jt="3" />
			<column name="TaxableAmountTo" type="money" length="0" jt="3" />
			<column name="TaxAmount" type="money" length="0" jt="3" mandatory="y" />
			<index name="PK_TaxBracket" unique="PRIMARY_KEY" >
				<column name="TaxBracketId" />
			</index>
			<fk name="FK_TaxBracket_Tax" to_schema="SnApp.dbo" to_table="tbTax" delete_action="cascade" >
				<fk_column name="TaxId" pk="TaxId" />
			</fk>
		</table>
		<table name="tbTaxLocation" >
			<column name="TaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_TaxLocation_LocationAccountId" unique="NORMAL" >
				<column name="LocationAccountId" options="ASC" />
			</index>
			<index name="PK_TaxLocation" unique="PRIMARY_KEY" >
				<column name="TaxId" />
				<column name="LocationAccountId" />
			</index>
			<fk name="FK_TaxLocation_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_TaxLocation_Tax" to_schema="SnApp.dbo" to_table="tbTax" delete_action="cascade" >
				<fk_column name="TaxId" pk="TaxId" />
			</fk>
		</table>
		<table name="tbTaxProfile" >
			<column name="TaxProfileId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TaxProfileCode" type="varchar" length="10" jt="12" mandatory="y" />
			<column name="TaxProfileName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="LastUpdate" type="datetime" jt="92" />
			<index name="PK_TaxProfile" unique="PRIMARY_KEY" >
				<column name="TaxProfileId" />
			</index>
		</table>
		<table name="tbTaxProfile2Tax" >
			<comment><![CDATA[Contains list of taxes belonging to each tax profile]]></comment>
			<column name="TaxProfileId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tax profile]]></comment>
			</column>
			<column name="TaxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tax]]></comment>
			</column>
			<column name="TaxablePerc" type="money" length="0" jt="3" >
				<comment><![CDATA[Percentage of the product price subjected to this tax]]></comment>
			</column>
			<index name="IX_TaxProfile2Tax_TaxId" unique="NORMAL" >
				<column name="TaxId" options="ASC" />
			</index>
			<index name="PK_TaxProfile2Tax" unique="PRIMARY_KEY" >
				<column name="TaxProfileId" />
				<column name="TaxId" />
			</index>
			<fk name="FK_TaxProfile2Tax_Tax" to_schema="SnApp.dbo" to_table="tbTax" >
				<fk_column name="TaxId" pk="TaxId" />
			</fk>
			<fk name="FK_TaxProfile2Tax_TaxProfile" to_schema="SnApp.dbo" to_table="tbTaxProfile" delete_action="cascade" >
				<fk_column name="TaxProfileId" pk="TaxProfileId" />
			</fk>
		</table>
		<table name="tbTaxRate" >
			<column name="TaxId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ValidDateFrom" type="date" jt="91" mandatory="y" />
			<column name="ValidDateTo" type="date" jt="91" />
			<column name="TaxType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[29] (rate, amount, bracket)]]></comment>
			</column>
			<column name="TaxValue" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Tax percentage or fixed amount (depending on TaxType)]]></comment>
			</column>
			<index name="PK_TaxRate" unique="PRIMARY_KEY" >
				<column name="TaxId" />
				<column name="ValidDateFrom" />
			</index>
			<fk name="FK_TaxRate_Tax" to_schema="SnApp.dbo" to_table="tbTax" delete_action="cascade" >
				<fk_column name="TaxId" pk="TaxId" />
			</fk>
		</table>
		<table name="tbTicket" >
			<comment><![CDATA[Holds encoded products]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LicenseId" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Licensee owning this product]]></comment>
			</column>
			<column name="TicketMediaMatchId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to portfolio]]></comment>
			</column>
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the sale item detail which sold this product]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to product type]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the transaction which created this record]]></comment>
			</column>
			<column name="SeatHoldId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[For limited capacity events, reference to the seat locking info]]></comment>
			</column>
			<column name="PerformanceSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to performance set]]></comment>
			</column>
			<column name="TicketStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[5]]]></comment>
			</column>
			<column name="StationSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Serial of the workstation which encoded thi product]]></comment>
			</column>
			<column name="TicketSerial" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Serial of the product]]></comment>
			</column>
			<column name="EncodeDateTime" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Encoding date/time]]></comment>
			</column>
			<column name="EncodeFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Encoding fiscal/date]]></comment>
			</column>
			<column name="ValidateDateTime" type="smalldatetime" jt="93" >
				<comment><![CDATA[Validation date/time.
Nulll = not validated]]></comment>
			</column>
			<column name="ValidateFiscalDate" type="date" jt="91" />
			<column name="FirstUsageDateTime" type="smalldatetime" jt="93" >
				<comment><![CDATA[First usage date/time.
Null = not used]]></comment>
			</column>
			<column name="FirstUsageFiscalDate" type="date" jt="91" />
			<column name="EntitlementData" type="varchar(max)" length="0" decimal="0" jt="12" >
				<comment><![CDATA[Product's entitlement's JSON]]></comment>
			</column>
			<column name="EntitlementVersion" type="int" jt="4" >
				<comment><![CDATA[Product's entitlements version]]></comment>
			</column>
			<column name="GroupQuantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[1 for non group ticket, otherwise is the quantity purchaised]]></comment>
			</column>
			<column name="GroupTicketOption" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[153]]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA[Ticket validity start date]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA[Ticket expiration date. This field value changes during the lifetime of a product everytime it gets used]]></comment>
			</column>
			<column name="PurgeLevel" type="tinyint" jt="-6" >
				<comment><![CDATA[LK[226]]]></comment>
			</column>
			<column name="Printed" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Tells if the ticket has been printed or not]]></comment>
			</column>
			<column name="Settled" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Used for thos products which are not paid at sale time, but when the guest exits the location settling both ticket value and anything else purchaised with it]]></comment>
			</column>
			<column name="ManualStartValidity" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Set to true when the start validity date was manually changed]]></comment>
			</column>
			<column name="ManualExpiration" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Set to true when expiration date was manually changed from BKO]]></comment>
			</column>
			<column name="BonusEntry" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="OfflineVirtual" type="bit" length="1" jt="-7" >
				<comment><![CDATA[true if the record was created upon a redemption of a media issued offline which is not present at DB]]></comment>
			</column>
			<column name="UnitAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amount paid for the ticket (including taxes)]]></comment>
			</column>
			<column name="UnitTax" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Tax portion for the amount paid for the ticket]]></comment>
			</column>
			<column name="ClearingLimit" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Total amount that can be moved to revenue (usually the ticket net price)]]></comment>
			</column>
			<column name="ClearingUsed" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Clearing portion already moved to revenue]]></comment>
			</column>
			<column name="ClearingInitialAllocation" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[This field is populated by the Import API and gets the same value as Clearing Used at the time of the import]]></comment>
			</column>
			<column name="PriorityOrder" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Redemption priority on the same portfolio]]></comment>
			</column>
			<column name="BreakageDate" type="date" jt="91" >
				<comment><![CDATA[Date of when the breakage of ticket value should happen if ticket never used.]]></comment>
			</column>
			<column name="BiometricTicketOverride" type="tinyint" length="1" decimal="0" jt="-6" >
				<comment><![CDATA[LK[379]]]></comment>
			</column>
			<column name="TriggerBreakage" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When true, ledger trigger on breakage has been triggered]]></comment>
			</column>
			<column name="TriggerExpiration" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When true, ledger trigger on expiration has been triggered]]></comment>
			</column>
			<column name="TriggerClearing" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[When true, ledger trigger on clearing has been triggered]]></comment>
			</column>
			<column name="AccrualEndDate" type="date" jt="91" >
				<comment><![CDATA[Stores fiscal date of when the revenue of the ticket has been acccrued to the point that can never change again. (Ex. after expiration, after upgrade, after clearing allocated is equal to clearing limit etc.)]]></comment>
			</column>
			<column name="TicketVersion" type="bigint" jt="-5" >
				<comment><![CDATA[Autoinc field updated everytime the ticket (in this specific record or any dependant) is modified. To be used for differential reports]]></comment>
			</column>
			<column name="TicketSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number starting from 1]]></comment>
			</column>
			<column name="TicketSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with TicketSequence to create encrypted barcodes]]></comment>
			</column>
			<column name="ExtSystemType" type="tinyint" jt="-6" spec="computed" >
				<comment><![CDATA[LK[258]]]></comment>
			</column>
			<column name="IgnoreCrossoverTimeUntilDate" type="date" jt="91" >
				<comment><![CDATA[When not null, will suspend any "crossover time constraint" set on ticket's entitlements until the specified date]]></comment>
			</column>
			<column name="ProductSuspendSerial" type="int" jt="4" >
				<comment><![CDATA[Reference to the last suspension period(s) for which the expiration of the ticket has been recalculated]]></comment>
			</column>
			<column name="PackageTicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the main package ticket which originated the others]]></comment>
			</column>
			<column name="PackageGroupItem" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[True when product is part of a "Package itemized" package and flag to redeem is "Package only"]]></comment>
			</column>
			<column name="BindWalletRewardToProduct" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Inherited from product configuration. Tells whether to bind or not wallet/reward points to the product.]]></comment>
			</column>
			<column name="ArchivedTickets" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Indicates that this ticket has "related" (ie tickets in the upgrade chain) tickets which have been archived]]></comment>
			</column>
			<column name="Archivable" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[Indicates if the ticket is eligible for archiving]]></comment>
			</column>
			<column name="ArchivableDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/Time of where field "Archivable" was set to 1. Should be NULL when "Archivable"=0]]></comment>
			</column>
			<index name="UQ_Ticket_TDSSN" unique="UNIQUE_KEY" >
				<column name="EncodeFiscalDate" options="ASC" />
				<column name="LicenseId" options="ASC" />
				<column name="StationSerial" options="ASC" />
				<column name="TicketSerial" options="ASC" />
			</index>
			<index name="UQ_Ticket_SaleItemDetailId" unique="UNIQUE_KEY" >
				<column name="SaleItemDetailId" options="ASC" />
			</index>
			<index name="IX_Ticket_PortfolioId" unique="NORMAL" >
				<column name="TicketMediaMatchId" options="ASC" />
				<column name="PriorityOrder" options="ASC" />
			</index>
			<index name="IX_Ticket_SeatHoldId" unique="NORMAL" options="where SeatHoldId is not null" >
				<column name="SeatHoldId" options="ASC" />
			</index>
			<index name="IX_Ticket_ProductId" unique="NORMAL" options="INCLUDE(TicketStatus, FirstUsageDateTime)" >
				<column name="ProductId" options="ASC" />
				<column name="EncodeFiscalDate" options="ASC" />
				<column name="EncodeDateTime" options="ASC" />
			</index>
			<index name="IX_Ticket_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="IX_Ticket_EncodeFiscalDate" unique="NORMAL" >
				<column name="EncodeFiscalDate" options="DESC" />
				<column name="EncodeDateTime" options="DESC" />
				<column name="TicketSerial" options="DESC" />
			</index>
			<index name="IX_Ticket_PerformanceSetId" unique="NORMAL" options="where PerformanceSetId is not null" >
				<column name="PerformanceSetId" options="ASC" />
				<column name="FirstUsageDateTime" options="ASC" />
			</index>
			<index name="IX_Ticket_ValidDateTo" unique="NORMAL" options="where ValidDateTo is not null" >
				<column name="ValidDateTo" options="ASC" />
			</index>
			<index name="IX_Ticket_TriggerBreakage" unique="NORMAL" options="where (BreakageDate is not null) and TriggerBreakage=0" >
				<column name="BreakageDate" options="ASC" />
				<column name="TriggerBreakage" options="ASC" />
			</index>
			<index name="IX_Ticket_TriggerClearing" unique="NORMAL" options="where (ValidDateTo is not null) and TriggerClearing=0" >
				<column name="ValidDateTo" options="ASC" />
				<column name="TriggerClearing" options="ASC" />
			</index>
			<index name="PK_Ticket" unique="PRIMARY_KEY" >
				<column name="TicketId" />
			</index>
			<index name="IX_Ticket_AccrualEndDate" unique="NORMAL" >
				<column name="AccrualEndDate" options=" DESC " />
				<column name="EncodeFiscalDate" options=" DESC " />
			</index>
			<index name="IX_Ticket_ValidDateFrom" unique="NORMAL" >
				<column name="ValidDateFrom" options=" ASC " />
				<column name="ValidDateTo" options="ASC" />
			</index>
			<index name="UQ_Ticket_TicketSequence" unique="UNIQUE_INDEX" options="WHERE TicketSequence is not null INCLUDE (TicketSeed, EncodeFiscalDate)" >
				<column name="TicketSequence" />
			</index>
			<index name="UQ_Ticket_TicketVersion" unique="UNIQUE_INDEX" options="INCLUDE (EncodeFiscalDate, EncodeDateTime)  WHERE TicketVersion is not null" >
				<column name="TicketVersion" />
			</index>
			<index name="IX_Ticket_Archivable" unique="NORMAL" options="INCLUDE (ProductId,ArchivableDateTime)" >
				<column name="Archivable" />
				<column name="ValidDateTo" />
			</index>
			<index name="IX_Ticket_PackageTicketId" unique="NORMAL" options="where PackageTicketId is not null" >
				<column name="PackageTicketId" />
			</index>
			<index name="IX_Ticket_TriggerExpiration" unique="NORMAL" options="INCLUDE ([TicketMediaMatchId],[ProductId],[BindWalletRewardToProduct]) WHERE ([ValidDateTo] IS NOT NULL AND [TriggerExpiration]=(0))" >
				<column name="ValidDateTo" options="ASC" />
				<column name="TriggerExpiration" options="ASC" />
				<column name="TicketStatus" />
			</index>
			<fk name="FK_Ticket_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_Ticket_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_Ticket_Portfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="TicketMediaMatchId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_Ticket_License" to_schema="SnApp.dbo" to_table="tbLicense" >
				<fk_column name="LicenseId" pk="LicenseId" />
			</fk>
			<fk name="FK_Ticket_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
			<fk name="FK_Ticket_SeatHold" to_schema="SnApp.dbo" to_table="tbSeatHold" >
				<fk_column name="SeatHoldId" pk="SeatHoldId" />
			</fk>
			<fk name="FK_Ticket_PerformanceSet" to_schema="SnApp.dbo" to_table="tbPerformanceSet" >
				<fk_column name="PerformanceSetId" pk="PerformanceSetId" />
			</fk>
			<fk name="FK_Ticket_PackageTicket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="PackageTicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicket2Event" prior="Tbl" >
			<comment><![CDATA[Support table for whitelists. Stores infromation about valid events for a specific ticket.]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Unique identifier of the ticket]]></comment>
			</column>
			<column name="EventId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Unique identifier of the event]]></comment>
			</column>
			<column name="ValidDateFrom" type="date" jt="91" >
				<comment><![CDATA["Valid date from" of the ticket]]></comment>
			</column>
			<column name="ValidDateTo" type="date" jt="91" >
				<comment><![CDATA["Valid date to" of the ticket]]></comment>
			</column>
			<index name="PK_Ticket2Event" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="EventId" />
			</index>
			<index name="IX_Ticket2Event_EventId" unique="NORMAL" >
				<column name="EventId" />
				<column name="ValidDateTo" />
				<column name="ValidDateFrom" />
			</index>
			<fk name="FK_Ticket2Event_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_Ticket2Event_Event" to_schema="SnApp.dbo" to_table="tbEvent" >
				<fk_column name="EventId" pk="EventId" />
			</fk>
		</table>
		<table name="tbTicketAmortization" >
			<comment><![CDATA[Keeps the amortization plan for each ticket depending on product type configuration]]></comment>
			<column name="TicketAmortizationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Primary Key]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ticket]]></comment>
			</column>
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to gate category]]></comment>
			</column>
			<column name="AmortizationDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Planned amortization date]]></comment>
			</column>
			<column name="AmortizationAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Amortization amount]]></comment>
			</column>
			<column name="LedgerDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Ledger registration date time. If null, no ledger was triggered for this event]]></comment>
			</column>
			<column name="TicketAmortizationStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[339] Scheduled, Applied, Blocked, Voided]]></comment>
			</column>
			<index name="UQ_TicketAmortization_TicketId" unique="UNIQUE_KEY" >
				<column name="TicketId" options="ASC" />
				<column name="GateCategoryId" options="ASC" />
				<column name="AmortizationDate" options="ASC" />
			</index>
			<index name="UQ_TicketAmortization_GateCategoryId" unique="UNIQUE_KEY" >
				<column name="GateCategoryId" options="ASC" />
				<column name="TicketId" options="ASC" />
				<column name="AmortizationDate" options="ASC" />
			</index>
			<index name="IX_TicketAmortization_Date" unique="NORMAL" >
				<column name="AmortizationDate" options="ASC" />
				<column name="LedgerDateTime" options="ASC" />
			</index>
			<index name="PK_TicketAmortization" unique="PRIMARY_KEY" >
				<column name="TicketAmortizationId" />
			</index>
			<fk name="FK_TicketAmortization_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketAmortization_GateCategory" to_schema="SnApp.dbo" to_table="tbGateCategory" >
				<fk_column name="GateCategoryId" pk="GateCategoryId" />
			</fk>
		</table>
		<table name="tbTicketDescription" >
			<comment><![CDATA[Extension table for tbTicket.
Used for "variable description" products, holds the description entered by the operator on sale time]]></comment>
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item detail]]></comment>
			</column>
			<column name="TicketDescription" type="nvarchar" length="100" jt="12" mandatory="y" >
				<comment><![CDATA[Operator input description]]></comment>
			</column>
			<index name="PK_TicketDescription" unique="PRIMARY_KEY" >
				<column name="SaleItemDetailId" />
			</index>
			<fk name="FK_TicketDescription_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
		</table>
		<table name="tbTicketElectronic" prior="Tbl" >
			<comment><![CDATA[tbTicketElectronic store ETicket from Apple or Google]]></comment>
			<column name="TicketElectronicId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="TicketElectronicStatus" type="smallint" length="1" jt="5" mandatory="y" >
				<comment><![CDATA[LK[471]]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbTicket table]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbPlugin table]]></comment>
			</column>
			<column name="CreateDateTime" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[ETicket creation datetime]]></comment>
			</column>
			<column name="ExternalTicketCode" type="nvarchar" length="255" jt="12" >
				<comment><![CDATA[External ETIcket code]]></comment>
			</column>
			<index name="PK_TicketElectronic" unique="PRIMARY_KEY" >
				<column name="TicketElectronicId" />
			</index>
			<index name="IX_TicketElectronic_ExternalTicketCode" unique="NORMAL" >
				<comment><![CDATA[ExternalTicketCode index]]></comment>
				<column name="ExternalTicketCode" />
			</index>
			<index name="IX_TicketElectronic_TicketId_CreateDateTime" unique="NORMAL" >
				<comment><![CDATA[TicketId, CreationDateTime index]]></comment>
				<column name="TicketId" />
				<column name="CreateDateTime" />
			</index>
			<index name="IX_TicketElectronic_PluginId_CreateDateTime" unique="NORMAL" >
				<comment><![CDATA[PluginId, CreationDateTime index]]></comment>
				<column name="PluginId" />
				<column name="CreateDateTime" />
			</index>
			<fk name="FK_TicketElectronic_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketElectronic_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbTicketElectronicData" prior="Tbl" >
			<comment><![CDATA[ETicket auxiliarydata table]]></comment>
			<column name="TicketElectronicId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the electronic ticket]]></comment>
			</column>
			<column name="ParamName" type="varchar" length="30" jt="12" mandatory="y" >
				<comment><![CDATA[Parameter name]]></comment>
			</column>
			<column name="ParamValue" type="nvarchar(max)" jt="12" mandatory="y" >
				<comment><![CDATA[Parameter value]]></comment>
			</column>
			<index name="PK_TicketElectronicData" unique="PRIMARY_KEY" >
				<column name="TicketElectronicId" />
				<column name="ParamName" />
			</index>
			<fk name="FK_TicketElectronicData_TicketElectronic" to_schema="SnApp.dbo" to_table="tbTicketElectronic" delete_action="cascade" >
				<fk_column name="TicketElectronicId" pk="TicketElectronicId" />
			</fk>
		</table>
		<table name="tbTicketFacePrice" >
			<comment><![CDATA[When ticket is sold at a price different than face price, he is store what was the face price at sale time.
Used as starting price for upgrades/downgrades]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product]]></comment>
			</column>
			<column name="UnitAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="UnitTax" type="money" length="0" jt="3" mandatory="y" />
			<index name="PK_TicketFacePrice" unique="PRIMARY_KEY" >
				<column name="TicketId" />
			</index>
			<fk name="FK_TicketFacePrice_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketGuest" >
			<comment><![CDATA[For product which include configured "guest tickets", this table keep count of "max available" / "already printed"]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product]]></comment>
			</column>
			<column name="GuestProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to guest product type]]></comment>
			</column>
			<column name="QtyTotal" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity configured at time of sale]]></comment>
			</column>
			<column name="QtyEncoded" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity already used]]></comment>
			</column>
			<index name="IX_TicketGuest_GuestProductId" unique="NORMAL" >
				<column name="GuestProductId" options="ASC" />
			</index>
			<index name="PK_TicketGuest" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="GuestProductId" />
			</index>
			<fk name="FK_TicketGuest_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="GuestProductId" pk="ProductId" />
			</fk>
			<fk name="FK_TicketGuest_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketGuestLink" prior="Tbl" >
			<comment><![CDATA[List of guest tickets of host ticket]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Host ticket reference]]></comment>
			</column>
			<column name="GuestTicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Guest ticket reference]]></comment>
			</column>
			<index name="PK_TicketGuestLink" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="GuestTicketId" />
			</index>
			<index name="IX_TicketGuestLink_GuestTicketId" unique="NORMAL" >
				<column name="GuestTicketId" />
			</index>
			<fk name="FK_TicketGuestLink_HostTicket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketGuestLink_GuestTicket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="GuestTicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketIncProd" >
			<comment><![CDATA[For tickets which embed the possibility to redeem products (example: 1day admission ticket which allow you to redeem for a meal in restaurants), here is stored available/used quantities]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product (admission ticket)]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to redeemable product type (ie: meal)]]></comment>
			</column>
			<column name="QuantityTotal" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Total quantity included at sale time]]></comment>
			</column>
			<column name="QuantityUsed" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Quantity already redeemed]]></comment>
			</column>
			<index name="IX_TicketIncProduct_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="PK_TicketIncProd" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="ProductId" />
			</index>
			<fk name="FK_TicketIncProd_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_TicketIncProd_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketLedgerTrigger" >
			<column name="TicketLedgerTriggerId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Unique identifier]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to ticket record]]></comment>
			</column>
			<column name="TriggerLedgerType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[183] Expiration, Breakage]]></comment>
			</column>
			<column name="TriggerDateTime" type="datetime" length="0" decimal="0" jt="92" mandatory="y" >
				<comment><![CDATA[Trigger date/time]]></comment>
			</column>
			<column name="LedgerRegRule" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[299]]]></comment>
			</column>
			<column name="Invalidated" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[True when record has been "voided" for example when reverting a usage of a product already expired]]></comment>
			</column>
			<column name="TicketLedgerTriggerSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number starting from 1]]></comment>
			</column>
			<index name="PK_TicketLedgerTrigger" unique="PRIMARY_KEY" >
				<column name="TicketLedgerTriggerId" />
			</index>
			<index name="IX_TicketLedgerTrigger_TicketId" unique="NORMAL" >
				<column name="TicketId" />
				<column name="TriggerLedgerType" />
				<column name="Invalidated" />
			</index>
			<index name="UQ_TicketLedgerTrigger_Sequence" unique="UNIQUE_INDEX" options="INCLUDE (TriggerDateTime) WHERE TicketLedgerTriggerSequence is not null" >
				<column name="TicketLedgerTriggerSequence" />
			</index>
			<index name="IX_TicketLedgerTrigger_TriggerDateTime" unique="NORMAL" >
				<column name="TriggerDateTime" />
			</index>
			<fk name="FK_TicketLedgerTrigger_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketLocker" >
			<comment><![CDATA[not yet used.
Its designed to hold information about product-locker association]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product]]></comment>
			</column>
			<column name="LockerCode" type="varchar" length="20" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[3rd party locker identifier]]></comment>
			</column>
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LockerStatus" type="smallint" jt="5" mandatory="y" />
			<column name="ExpirationDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<index name="IX_TicketLocker_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_TicketLocker_Status" unique="NORMAL" >
				<column name="LockerStatus" options="ASC" />
				<column name="ExpirationDateTime" options="ASC" />
			</index>
			<index name="PK_TicketLocker" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="LockerCode" />
			</index>
			<fk name="FK_TicketLocker_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_TicketLocker_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketMediaMatch" >
			<comment><![CDATA[Portfolio.
1 account = 0 or N portfolios
1 portfolio = 0 or N medias
1 portfolio = 0 or N products]]></comment>
			<column name="TicketMediaMatchId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the account associated/owning the portfolio.
Can be null because a portfolio can be anonymous]]></comment>
			</column>
			<column name="PortfolioGroupId" type="uniqueidentifier" length="1" decimal="0" jt="1" >
				<comment><![CDATA[Used to group different portfolio togheter, by default all portfolio generated in the same transaction get grouped togheter.
Used to easely find "family related" tickets given a media]]></comment>
			</column>
			<column name="MainPortfolio" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if this is the main/default portfolio of the account.
For every AccountId the must exist only one record flagged as "main"]]></comment>
			</column>
			<column name="Settled" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[For those configuration where tickets are not paid on sale, but at park's exit, this flag indicates if the portfolio have been settled/paid or not]]></comment>
			</column>
			<column name="ArchivedTickets" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[One or more tickets belonging to this portfolio have been archived and purged from production DB]]></comment>
			</column>
			<column name="ArchivedMedias" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[One or more media belonging to this portfolio have been archived and purged from production DB]]></comment>
			</column>
			<index name="IX_Portfolio_AccountId" unique="NORMAL" options="where AccountId is not null" >
				<column name="AccountId" options="ASC" />
				<column name="MainPortfolio" options="ASC" />
			</index>
			<index name="IX_Portfolio_PortfolioGroupId" unique="NORMAL" options="where PortfolioGroupId is not null" >
				<column name="PortfolioGroupId" options="ASC" />
			</index>
			<index name="PK_TicketMediaMatch" unique="PRIMARY_KEY" >
				<column name="TicketMediaMatchId" />
			</index>
			<fk name="FK_Portfolio_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbTicketMemebershipPoint" >
			<comment><![CDATA[If the ticket was purchased (exchanged) with reward points, it will have price=0 and here it will be stored how many reward points were used]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MembershipPointId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriceValue" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_TicketMembershipPoint_MembershipPointId" unique="NORMAL" >
				<column name="MembershipPointId" options="ASC" />
			</index>
			<index name="PK_TicketMembershipPoint" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="MembershipPointId" />
			</index>
			<fk name="FK_TicketMembershipPoint_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketMembershipPoint_MembershipPoint" to_schema="SnApp.dbo" to_table="tbMembershipPoint" >
				<fk_column name="MembershipPointId" pk="MembershipPointId" />
			</fk>
		</table>
		<table name="tbTicketPerformanceException" prior="Tbl" >
			<comment><![CDATA[Contains exceptions (such "time start validity") of a ticket for a specific performance.
If a performance is not referenced, it means that there are no exceptions, but the performance could be still be associated to the ticket (through tbTicket.PerformanceSetId)]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the ticket]]></comment>
			</column>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the performance]]></comment>
			</column>
			<column name="TimeFrom" type="time" jt="92" >
				<comment><![CDATA[Start validity time. When not null, the ticket can be used for the performance only after the indicated time]]></comment>
			</column>
			<index name="PK_TicketPerformanceException" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="PerformanceId" />
			</index>
			<index name="IX_TicketPerformanceException_PerformanceId" unique="NORMAL" >
				<column name="PerformanceId" />
			</index>
			<fk name="FK_TicketPerformanceException_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
		</table>
		<table name="tbTicketRenew" >
			<comment><![CDATA[Extension table for tbTicket.
Holds information for products which are the renewal of another product]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to destination product]]></comment>
			</column>
			<column name="SourceTicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to source product]]></comment>
			</column>
			<column name="RenewStartDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[The day after the end validity of the source ticket]]></comment>
			</column>
			<column name="SourceArchivedTicketId" prior="SourceTicketArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the renewal source ticket in case it has been archived]]></comment>
			</column>
			<column name="SourceArchivedTicketCode" prior="SourceTicketArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Archived source ticket code]]></comment>
			</column>
			<index name="IX_TicketRenew_SourceTicketId" unique="NORMAL" >
				<column name="SourceTicketId" options="ASC" />
			</index>
			<index name="PK_TicketRenew" unique="PRIMARY_KEY" >
				<column name="TicketId" />
			</index>
			<index name="IX_TicketRenew_RenewStartDate" unique="NORMAL" >
				<column name="RenewStartDate" />
			</index>
			<index name="IX_TicketRenew_SourceArchivedTicketId" unique="NORMAL" options="WHERE SourceArchivedTicketId IS NOT NULL" >
				<column name="SourceArchivedTicketId" />
			</index>
			<fk name="FK_TicketRenew_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketRenew_SourceTicket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="SourceTicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketRevenue" >
			<comment><![CDATA[Consolidates VPTs per ticket. Calculated at first redemption]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ticket]]></comment>
			</column>
			<column name="GateCategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to gate category]]></comment>
			</column>
			<column name="ClearingLimit" type="money" length="0" jt="3" mandatory="y" />
			<column name="ClearingAllocated" type="money" length="0" jt="3" mandatory="y" />
			<column name="ClearingInitialAllocation" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[This field is populated by the Import API and gets the same value as Clearing Used at the time of the import]]></comment>
			</column>
			<column name="ProductVPT" type="money" length="0" jt="3" >
				<comment><![CDATA[VPT calculated on first redemption]]></comment>
			</column>
			<column name="ProductAmountVPT" type="money" length="0" jt="3" >
				<comment><![CDATA[VPT amount for each click]]></comment>
			</column>
			<column name="ProductAmortizationTriggerType" type="smallint" jt="5" >
				<comment><![CDATA[LK[317] Start validity, First usage, Payment]]></comment>
			</column>
			<column name="ProductAmortizationPeriods" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Amortization periods calculated at the time of sale]]></comment>
			</column>
			<column name="ProductAmortizationPeriodType" type="smallint" jt="5" >
				<comment><![CDATA[LK[316] Day, Week, Month, Calendar]]></comment>
			</column>
			<column name="ProductAmortizationCalendarId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to calendar ID configured at time of sale]]></comment>
			</column>
			<column name="ProductAmortizationWithinExpiration" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[When checked, amortization period generation will never generate periods after product expiration]]></comment>
			</column>
			<column name="ProductAmortizationScheduledDate" type="date" jt="91" >
				<comment><![CDATA[Scheduled date of when the amortization periods should start]]></comment>
			</column>
			<column name="ProductAmortizationCreateDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/time of scheduled periods creation]]></comment>
			</column>
			<index name="IX_TicketRevenue_GateCategory" unique="NORMAL" >
				<column name="GateCategoryId" options="ASC" />
			</index>
			<index name="IX_TicketRevenue_ProductAmortizationCalendarId" unique="NORMAL" options="where ProductAmortizationCalendarId is not null" >
				<column name="ProductAmortizationCalendarId" options="ASC" />
			</index>
			<index name="PK_TicketRevenue" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="GateCategoryId" />
			</index>
			<index name="IX_TicketRevenue_ProductAmortizationScheduledDate" unique="NORMAL" options="WHERE ProductAmortizationScheduledDate is not null" >
				<column name="ProductAmortizationScheduledDate" />
				<column name="ProductAmortizationCreateDateTime" />
			</index>
			<fk name="FK_TicketRevenue_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketRevenue_Calendar" to_schema="SnApp.dbo" to_table="tbCalendar" >
				<fk_column name="ProductAmortizationCalendarId" pk="CalendarId" />
			</fk>
			<fk name="FK_TicketRevenue_GateCategory" to_schema="SnApp.dbo" to_table="tbGateCategory" >
				<fk_column name="GateCategoryId" pk="GateCategoryId" />
			</fk>
		</table>
		<table name="tbTicketSecondary" >
			<comment><![CDATA[Store primary/secondary ticket links]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to primary ticket]]></comment>
			</column>
			<column name="SecondaryTicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Link to secondary ticket]]></comment>
			</column>
			<index name="IX_TicketSecondary_SecondaryTicketId" unique="NORMAL" >
				<column name="SecondaryTicketId" options="ASC" />
			</index>
			<index name="PK_TicketSecondary" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="SecondaryTicketId" />
			</index>
			<fk name="FK_TicketSecondary_PrimaryTicket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketSecondary_SecondaryTicket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="SecondaryTicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketTransaction" >
			<comment><![CDATA[Holds information for different transactions that touched the product.
For now used to store the transaction which sold the ticket (only if different from tbTicket.TransactionId which is the one that fulfilled it, not sold)]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product]]></comment>
			</column>
			<column name="TicketTransactionType" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[281]]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction]]></comment>
			</column>
			<index name="IX_TicketTransaction_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="PK_TicketTransaction" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="TicketTransactionType" />
			</index>
			<fk name="FK_TicketTransaction_Ticket" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TicketTransaction_Transaction" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketUpgrade" >
			<comment><![CDATA[Extension table for tbTicket.
Holds information about upgraded (destination) product.
When you upgrade ticket A, ticket B will be created and in this table you'll find the link between A and B. If ticket B gets upgraded as well, ticket C will be created and in this table you'll find the link between B and C.]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to destination product]]></comment>
			</column>
			<column name="SourceTicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[It's the product we are upgrading from]]></comment>
			</column>
			<column name="SourceArchivedTicketId" prior="SourceTicketArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the upgrade source ticket in case it has been archived]]></comment>
			</column>
			<column name="SourceArchivedTicketCode" prior="SourceTicketArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Archived source ticket code]]></comment>
			</column>
			<column name="RootTicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[In case this is an upgrade of an already upgraded ticket, this field contains the overall starting ticket]]></comment>
			</column>
			<column name="RootArchivedTicketId" prior="RootTicketArcId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the upgrade root ticket in case it has been archived]]></comment>
			</column>
			<column name="RootArchivedTicketCode" prior="RootTicketArcCode" type="varchar" length="50" jt="12" >
				<comment><![CDATA[Archived root ticket code]]></comment>
			</column>
			<column name="Sequence" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Indicates the position of this upgrade in the upgrade history of this ticket]]></comment>
			</column>
			<column name="FlatUpgrade" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="UQ_TicketUpgrade_SourceTicketId" unique="UNIQUE_KEY" >
				<column name="SourceTicketId" options="ASC" />
			</index>
			<index name="PK_TicketUpgrade" unique="PRIMARY_KEY" >
				<column name="TicketId" />
			</index>
			<index name="IX_TicketUpgrade_RootTicketId" unique="NORMAL" options="INCLUDE (SourceTicketId)" >
				<column name="RootTicketId" options="ASC" />
				<column name="Sequence" options="ASC" />
			</index>
			<index name="IX_TicketUpgrade_RootArchivedTicketId" unique="NORMAL" options="WHERE RootArchivedTicketId IS NOT NULL" >
				<column name="RootArchivedTicketId" />
			</index>
			<index name="IX_TicketUpgrade_SourceArchivedTicketId" unique="NORMAL" options="WHERE SourceArchivedTicketId IS NOT NULL" >
				<column name="SourceArchivedTicketId" />
			</index>
			<fk name="FK_TicketUpgrade_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketUpgrade_SourceTicket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="SourceTicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketUpgrade_RootTicket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="RootTicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTicketUpgradeTax" >
			<comment><![CDATA[In case the ticket comes from an upgrade/downgrade, this table is filled in with the taxes of the original ticket. The overall taxes of this ticket, are the sum between this table and tbSaleItemTax (which contains taxes only for the difference paid)]]></comment>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to product]]></comment>
			</column>
			<column name="TaxId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to configured tax type]]></comment>
			</column>
			<column name="TaxAmount" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_TicketUpgradeTax_TaxId" unique="NORMAL" >
				<column name="TaxId" options="ASC" />
			</index>
			<index name="PK_TicketUpgradeTax" unique="PRIMARY_KEY" >
				<column name="TicketId" />
				<column name="TaxId" />
			</index>
			<fk name="FK_TicketUpgradeTax_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketUpgradeTax_Tax" to_schema="SnApp.dbo" to_table="tbTax" >
				<fk_column name="TaxId" pk="TaxId" />
			</fk>
		</table>
		<table name="tbTicketUsage" >
			<comment><![CDATA[Log of all ticket scans/redemption both valid/invalid. Include also "included prooduct redemptions" (see tbTicketIncProd)]]></comment>
			<column name="TicketUsageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="UsageDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Server date/time]]></comment>
			</column>
			<column name="UsageFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Relative to the redemption location]]></comment>
			</column>
			<column name="UsageType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[69]]]></comment>
			</column>
			<column name="ValidateResult" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[70]]]></comment>
			</column>
			<column name="MediaId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to media]]></comment>
			</column>
			<column name="AptWorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to access point]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to product]]></comment>
			</column>
			<column name="AccessAreaAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to access area]]></comment>
			</column>
			<column name="PerformanceId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to performance]]></comment>
			</column>
			<column name="IncProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to redeemed product (see tbTicketIncProd)]]></comment>
			</column>
			<column name="IncProductValue" type="money" jt="3" >
				<comment><![CDATA[Value of the redeemed product to be used for ledger pourposes]]></comment>
			</column>
			<column name="ValidateDateTime" type="smalldatetime" jt="93" >
				<comment><![CDATA[If null, the validate was online, otherwise this is the date/time when the usage was processed by the back-end]]></comment>
			</column>
			<column name="GroupQuantity" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Number of entries for group tickets. If null we must use the GroupQuantity on the tbTicket]]></comment>
			</column>
			<column name="UsageLocalDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Client date/time]]></comment>
			</column>
			<column name="InvalidOfflineValidateResult" type="smallint" jt="5" >
				<comment><![CDATA[Original validate result for invalid offline usages]]></comment>
			</column>
			<column name="TicketStatus" type="smallint" jt="5" >
				<comment><![CDATA[LK[5] Status of the ticket when the scan happened]]></comment>
			</column>
			<column name="BiometricType" type="smallint" jt="5" >
				<comment><![CDATA[LK[229]]]></comment>
			</column>
			<column name="BiometricScore" type="int" length="1" decimal="0" jt="4" >
				<comment><![CDATA[Biometric check result value]]></comment>
			</column>
			<column name="BioEnrollmentType" type="tinyint" jt="-6" >
				<comment><![CDATA[LK[440] - None, Enrollment, ReEnrollment]]></comment>
			</column>
			<column name="Imported" type="bit" length="1" jt="-7" >
				<comment><![CDATA[Indicates if the usage has been imported: the scan/redemption was non handled by SnApp]]></comment>
			</column>
			<column name="ForcedGate" type="bit" length="1" jt="-7" >
				<comment><![CDATA[Indicates if the access point configuration was overridden in the API call, requesting to use a specific gate (op.area)]]></comment>
			</column>
			<column name="Invalidated" type="bit" length="1" jt="-7" >
				<comment><![CDATA[Record should be ignored (ie: it was voided)]]></comment>
			</column>
			<column name="SimulatedRedemption" type="bit" length="1" jt="-7" >
				<comment><![CDATA[If true indicates a simulated redemption and should not be taken into account for any in-park statistics]]></comment>
			</column>
			<column name="UsageMethodType" type="tinyint" jt="-6" >
				<comment><![CDATA[LK[439] - Identifies what has been used to trigger the usage (Media, Ticket, Account, Document...)]]></comment>
			</column>
			<column name="BiometricGroup" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Usage authorized using a biometric template taken from a different ticket within the biometric group]]></comment>
			</column>
			<column name="BiometricGroupTicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the ticket used to authorize the biometric template]]></comment>
			</column>
			<column name="FlashAtTurnstile" type="bit" jt="-7" >
				<comment><![CDATA[Flash at turnstile has been triggered]]></comment>
			</column>
			<column name="PeopleOfDetermination" type="bit" jt="-7" >
				<comment><![CDATA[Status of the flag "People of determination" on the rlated product type]]></comment>
			</column>
			<column name="RotationsAllowed" type="smallint" jt="5" >
				<comment><![CDATA[Number of rotations allowed]]></comment>
			</column>
			<column name="ExtraEntry" type="bit" jt="-7" >
				<comment><![CDATA[If true extra entries can be performed]]></comment>
			</column>
			<column name="TicketUsageSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number starting from 1]]></comment>
			</column>
			<column name="TicketUsageSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with TicketSequence to create encrypted barcodes]]></comment>
			</column>
			<column name="VoidTicketUsageId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the voided ticket usage (if any)]]></comment>
			</column>
			<column name="DynamicEntitlementId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the dynamic entitlement (set on product type) used at time of the redemption]]></comment>
			</column>
			<column name="MasterTicketUsageId" prior="MarsterTicketUsageId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the master ticket usage that originated the usage.
Filled, for example, in case of usages involved in a PPU transaction when master ticket usage has partial payment approved (wallet/points) and other tickets need to be decremented in money/points as well.]]></comment>
			</column>
			<index name="IX_TicketUsage_AptWorkstationId" unique="NORMAL" >
				<column name="AptWorkstationId" options="ASC" />
			</index>
			<index name="IX_TicketUsage_MediaId" unique="NORMAL" >
				<column name="MediaId" options="ASC" />
			</index>
			<index name="IX_TicketUsage_UsageDateTime" unique="NORMAL" >
				<column name="UsageDateTime" options="DESC" />
			</index>
			<index name="IX_TicketUsage_PerformanceId" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_TicketUsage_AccessAreaId" unique="NORMAL" >
				<column name="AccessAreaAccountId" options="ASC" />
			</index>
			<index name="IX_TicketUsage_IncProductId" unique="NORMAL" options="where IncProductId is not null" >
				<column name="IncProductId" options="ASC" />
			</index>
			<index name="PK_TicketUsage" unique="PRIMARY_KEY" >
				<column name="TicketUsageId" />
			</index>
			<index name="IX_TicketUsage_UsageFiscalDate_V2" unique="NORMAL" options="include (UsageType, ValidateResult, SimulatedRedemption, Invalidated)" >
				<column name="UsageFiscalDate" />
				<column name="UsageDateTime" />
			</index>
			<index name="UQ_TicketUsage_TicketUsageSequence" unique="UNIQUE_INDEX" options="WHERE TicketUsageSequence&lt;&gt;0 INCLUDE (TicketUsageSeed, UsageFiscalDate)" >
				<column name="TicketUsageSequence" />
			</index>
			<index name="IX_TicketUsage_BiometricGroupTicketId" unique="NORMAL" options="where BiometricGroupTicketId is not null" >
				<column name="BiometricGroupTicketId" options="" />
			</index>
			<index name="IX_TicketUsage_TicketId_V3" unique="NORMAL" options="include (UsageType, ValidateResult, SimulatedRedemption, Invalidated)" >
				<column name="TicketId" />
				<column name="UsageFiscalDate" />
				<column name="UsageDateTime" />
			</index>
			<index name="UQ_TicketUsage_VoidTicketUsageId" unique="UNIQUE_INDEX" options="where VoidTicketUsageId is not null" >
				<column name="VoidTicketUsageId" />
			</index>
			<index name="IX_TicketUsage_DynamicEntitlementId" unique="NORMAL" options="WHERE DynamicEntitlementId IS NOT NULL" >
				<column name="DynamicEntitlementId" />
			</index>
			<index name="IX_TicketUsage_MasterTicketUsageId" unique="NORMAL" options="where MasterTicketUsageId is not null" >
				<column name="MasterTicketUsageId" />
			</index>
			<fk name="FK_TicketUsage_AcAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccessAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_TicketUsage_AptWorkstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="AptWorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_TicketUsage_IncProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="IncProductId" pk="ProductId" />
			</fk>
			<fk name="FK_TicketUsage_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_TicketUsage_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketUsage_MediaId" to_schema="SnApp.dbo" to_table="tbMedia" >
				<fk_column name="MediaId" pk="MediaId" />
			</fk>
			<fk name="FK_TicketUsage_BiometricGroupTicket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="BiometricGroupTicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TicketUsage_VoidTicketUsage" to_schema="SnApp.dbo" to_table="tbTicketUsage" >
				<fk_column name="VoidTicketUsageId" pk="TicketUsageId" />
			</fk>
			<fk name="FK_TicketUsage_DynamicEntitlement" to_schema="SnApp.dbo" to_table="tbEntitlement" >
				<fk_column name="DynamicEntitlementId" pk="EntitlementId" />
			</fk>
			<fk name="FK_TicketUsage_MasterTicketUsage" to_schema="SnApp.dbo" to_table="tbTicketUsage" >
				<fk_column name="MasterTicketUsageId" pk="TicketUsageId" />
			</fk>
		</table>
		<table name="tbTicketUsageAccount" >
			<comment><![CDATA[*** PLACEHOLDER - NOT CREATED IN DB YET ***
Extension table for tbTicketUsage.
Holds information about the account ID used for validation (used instead of media code) ONLY if no products can be found in any of the portfolios of the account.]]></comment>
			<column name="TicketUsageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbTicketUsage ID]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Account ID used vor validation with no products found]]></comment>
			</column>
			<index name="IX_TicketUsageAccount_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="PK_TicketUsageAccount" unique="PRIMARY_KEY" >
				<column name="TicketUsageId" />
			</index>
			<fk name="FK_TicketUsageAccount_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_TicketUsageAccount_TicketUsage" to_schema="SnApp.dbo" to_table="tbTicketUsage" >
				<fk_column name="TicketUsageId" pk="TicketUsageId" />
			</fk>
		</table>
		<table name="tbTicketUsageEntitlementDiff" >
			<comment><![CDATA[Stores a snapshot of ticket's EntitlementData before applying the usage]]></comment>
			<column name="TicketUsageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ticket usage internal ID]]></comment>
			</column>
			<column name="UsageFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Redund tbTicketUsage.UsageFiscalDate]]></comment>
			</column>
			<column name="UsageDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Redund tbTicketUsage.UsageDateTime]]></comment>
			</column>
			<column name="EntitlementDiff" type="varchar(max)" length="0" decimal="0" jt="12" >
				<comment><![CDATA[Stores a json representing the changes of ticket's EntitlementData when the usage was appied]]></comment>
			</column>
			<index name="IX_TicketUsageEntitlementDiff_FiscalDate" unique="NORMAL" >
				<column name="UsageFiscalDate" options="ASC" />
				<column name="UsageDateTime" options="ASC" />
			</index>
			<index name="PK_TicketUsageEntitlementDiff" unique="PRIMARY_KEY" >
				<column name="TicketUsageId" />
			</index>
			<fk name="FK_TicketUsageEntitlementDiff_TicketUsage" to_schema="SnApp.dbo" to_table="tbTicketUsage" delete_action="cascade" >
				<fk_column name="TicketUsageId" pk="TicketUsageId" />
			</fk>
		</table>
		<table name="tbTicketUsageExternalRedeem" prior="Tbl" >
			<comment><![CDATA[Storing usages redeemed with an external validator]]></comment>
			<column name="TicketUsageId" prior="TicketIsageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbTicketUsage ID]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" spec="computed" mandatory="y" >
				<comment><![CDATA[Reference to redeeemer plugin]]></comment>
			</column>
			<column name="DocData" type="nvarchar(max)" jt="12" />
			<index name="PK_tbTicketUsageExternalRedeem" unique="PRIMARY_KEY" >
				<column name="TicketUsageId" />
			</index>
			<index name="IX_TicketUsageExternalRedeem_PluginId" unique="NORMAL" >
				<column name="PluginId" />
			</index>
			<fk name="FK_tbTicketUsageExternalRedeem_TicketUsage" to_schema="SnApp.dbo" to_table="tbTicketUsage" delete_action="cascade" >
				<fk_column name="TicketUsageId" pk="TicketUsageId" />
			</fk>
			<fk name="FK_tbTicketUsageExternalRedeem_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbTicketUsageMediaCode" >
			<comment><![CDATA[Storing media codes for failed redemption (media not found)]]></comment>
			<column name="TicketUsageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to tbTicketUsage ID]]></comment>
			</column>
			<column name="MediaCode" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[MediaCode which was not found on DB]]></comment>
			</column>
			<column name="UnknownMediaCode" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[337]]]></comment>
			</column>
			<index name="IX_TicketUsageMediaCode_MediaCode" unique="NORMAL" >
				<column name="MediaCode" options="ASC" />
			</index>
			<index name="PK_TicketUsageMediaCode" unique="PRIMARY_KEY" >
				<column name="TicketUsageId" />
			</index>
			<fk name="FK_TicketUsageMediaCode_TicketUsage" to_schema="SnApp.dbo" to_table="tbTicketUsage" delete_action="cascade" >
				<fk_column name="TicketUsageId" pk="TicketUsageId" />
			</fk>
		</table>
		<table name="tbTicketUsageUser" >
			<comment><![CDATA[Extension table for tbTicketUsage.
Contains information about the user logged at turnsytle at ticket redemption time]]></comment>
			<column name="TicketUsageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ticket usage internal ID]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to user]]></comment>
			</column>
			<column name="SupAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to supervisor user]]></comment>
			</column>
			<column name="MediaId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to media used]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the product]]></comment>
			</column>
			<column name="TicketUsageUserType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[207]]]></comment>
			</column>
			<column name="OperationDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time of when the action happened (it might differs from tbTicketUsage.UsageDateTime, ie in case of void)]]></comment>
			</column>
			<index name="IX_TicketUsageUser_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
				<column name="OperationDateTime" options="ASC" />
			</index>
			<index name="IX_TicketUsageUser_SupAccountId" unique="NORMAL" options="where SupAccountId is not null" >
				<column name="SupAccountId" options="ASC" />
			</index>
			<index name="PK_TicketUsageUser" unique="PRIMARY_KEY" >
				<column name="TicketUsageId" />
			</index>
			<index name="IX_TicketUsageUser_MediaId" unique="NORMAL" options="where MediaId is not null" >
				<column name="MediaId" />
			</index>
			<index name="IX_TicketUsageUser_TicketId" unique="NORMAL" options="where TicketId is not null" >
				<column name="TicketId" />
			</index>
			<fk name="FK_TicketUsageUser_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_TicketUsageUser_SupAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="SupAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_TicketUsageUser_TicketUsage" to_schema="SnApp.dbo" to_table="tbTicketUsage" delete_action="cascade" >
				<fk_column name="TicketUsageId" pk="TicketUsageId" />
			</fk>
			<fk name="FK_TicketUsageUser_MediaId" to_schema="SnApp.dbo" to_table="tbMedia" >
				<fk_column name="MediaId" pk="MediaId" />
			</fk>
			<fk name="FK_TicketUsageUser_TicketId" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTimedTicketRule" >
			<column name="TimedTicketRuleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="RuleName" type="nvarchar" length="30" jt="12" mandatory="y" />
			<column name="RuleCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="ValidFromDate" type="date" jt="91" />
			<column name="ValidToDate" type="date" jt="91" />
			<index name="UQ_TimedTicketRule_RuleCode" unique="UNIQUE_KEY" >
				<column name="RuleCode" options="ASC" />
			</index>
			<index name="PK_TimedTicketRule" unique="PRIMARY_KEY" >
				<column name="TimedTicketRuleId" />
			</index>
		</table>
		<table name="tbTimedTicketRuleItem" >
			<column name="TimedTicketRuleItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TimedTicketRuleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ItemName" type="nvarchar" length="30" jt="12" />
			<column name="ApplyFromMinute" type="smallint" length="1" decimal="0" jt="5" />
			<column name="ApplyToMinute" type="smallint" length="1" decimal="0" jt="5" />
			<column name="Optional" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="StepType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[195]]]></comment>
			</column>
			<column name="StepValue" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="StepAmount" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_TimedTicketRuleItem_TimedTicketRuleId" unique="NORMAL" >
				<column name="TimedTicketRuleId" options="ASC" />
			</index>
			<index name="PK_TimedTicketRuleItem" unique="PRIMARY_KEY" >
				<column name="TimedTicketRuleItemId" />
			</index>
			<fk name="FK_TimedTicketRuleItem_TimedTicketRule" to_schema="SnApp.dbo" to_table="tbTimedTicketRule" delete_action="cascade" >
				<fk_column name="TimedTicketRuleId" pk="TimedTicketRuleId" />
			</fk>
		</table>
		<table name="tbTimedTicketStatement" >
			<column name="TimedTicketStatementId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="StatementStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[196]]]></comment>
			</column>
			<column name="TimedTicketRuleId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MediaId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketMediaMatchId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PerformanceId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketUsageEntryId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketUsageExitId" type="uniqueidentifier" jt="1" />
			<column name="SettleTransactionId" type="uniqueidentifier" jt="1" />
			<column name="SettleAmount" type="money" length="0" jt="3" />
			<index name="IX_TimedTicketStatement_TimedTicketRuleId" unique="NORMAL" >
				<column name="TimedTicketRuleId" options="ASC" />
			</index>
			<index name="IX_TimedTicketStatement_TicketMediaMatch" unique="NORMAL" >
				<column name="TicketMediaMatchId" options="ASC" />
			</index>
			<index name="IX_TimedTicketStatement_PerformanceId" unique="NORMAL" >
				<column name="PerformanceId" options="ASC" />
			</index>
			<index name="IX_TimedTicketStatement_TicketUsageEntryId" unique="NORMAL" >
				<column name="TicketUsageEntryId" options="ASC" />
			</index>
			<index name="IX_TimedTicketStatement_TicketUsageExitId" unique="NORMAL" options="where TicketUsageExitId is not null" >
				<column name="TicketUsageExitId" options="ASC" />
			</index>
			<index name="IX_TimedTicketStatement_SettleTransactionId" unique="NORMAL" options="where SettleTransactionId is not null" >
				<column name="SettleTransactionId" options="ASC" />
			</index>
			<index name="IX_TimedTicketStatement_TicketId" unique="NORMAL" >
				<column name="TicketId" options="ASC" />
			</index>
			<index name="IX_TimedTicketStatement_MediaId" unique="NORMAL" >
				<column name="MediaId" options="ASC" />
			</index>
			<index name="PK_TimedTicketStatement" unique="PRIMARY_KEY" >
				<column name="TimedTicketStatementId" />
			</index>
			<fk name="FK_TimedTicketStatement_Performance" to_schema="SnApp.dbo" to_table="tbPerformance" >
				<fk_column name="PerformanceId" pk="PerformanceId" />
			</fk>
			<fk name="FK_TimedTicketStatement_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="SettleTransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TimedTicketStatement_TicketMediaMatch" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="TicketMediaMatchId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_TimedTicketStatement_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TimedTicketStatement_Media" to_schema="SnApp.dbo" to_table="tbMedia" delete_action="cascade" >
				<fk_column name="MediaId" pk="MediaId" />
			</fk>
			<fk name="FK_TimedTicketStatement_TicketUsage_Entry" to_schema="SnApp.dbo" to_table="tbTicketUsage" >
				<fk_column name="TicketUsageEntryId" pk="TicketUsageId" />
			</fk>
			<fk name="FK_TimedTicketStatement_TicketUsage_Exit" to_schema="SnApp.dbo" to_table="tbTicketUsage" >
				<fk_column name="TicketUsageExitId" pk="TicketUsageId" />
			</fk>
			<fk name="FK_TimedTicketStatement_TimedTicketRule" to_schema="SnApp.dbo" to_table="tbTimedTicketRule" >
				<fk_column name="TimedTicketRuleId" pk="TimedTicketRuleId" />
			</fk>
		</table>
		<table name="tbTransaction" >
			<comment><![CDATA[Holds information about workstation transactions.
1 order = 1 or N transactions]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LicenseId" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Licensee this transaction belongs to]]></comment>
			</column>
			<column name="SaleId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the order]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Workstation which performed the transaction]]></comment>
			</column>
			<column name="OpAreaId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Operating area under which the workstation that performed transaction is configured]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[User which performed the transaction]]></comment>
			</column>
			<column name="BoxId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Box assigned to this transaction for operator cash out operations]]></comment>
			</column>
			<column name="SupAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[It's the supervisor accountId]]></comment>
			</column>
			<column name="TransactionType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[3]]]></comment>
			</column>
			<column name="TransactionDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Based on server processing date/time]]></comment>
			</column>
			<column name="TransactionFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Based on server processing date/time]]></comment>
			</column>
			<column name="SerialDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Based on client transaction date/time (server timezone)]]></comment>
			</column>
			<column name="SerialLocalDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Based on client transaction date/time (client timezone)]]></comment>
			</column>
			<column name="SerialFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Based on client transaction date/time]]></comment>
			</column>
			<column name="TransactionSerial" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Serial of the transaction]]></comment>
			</column>
			<column name="StationSerial" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Serial of the station]]></comment>
			</column>
			<column name="ItemCount" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Total items in the transaction]]></comment>
			</column>
			<column name="PrintedCount" type="int" length="18" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[not used]]></comment>
			</column>
			<column name="TotalAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Algebraic sum of tbSaleItem.UnitAmount * tbTransactionItem.Quantity]]></comment>
			</column>
			<column name="TotalTax" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Algebraic sum of tbSaleItem.UnitTax * tbTransactionItem.Quantity]]></comment>
			</column>
			<column name="PaidAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Total amount paid with the transaction]]></comment>
			</column>
			<column name="PaidTax" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Total taxes paid with the transaction]]></comment>
			</column>
			<column name="Approved" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if it is an Approval transaction]]></comment>
			</column>
			<column name="Consignment" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Products will be paid when products are redeemed]]></comment>
			</column>
			<column name="Paid" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if the transaction contains any payment]]></comment>
			</column>
			<column name="Encoded" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if it is an ticket encoding transaction]]></comment>
			</column>
			<column name="Printed" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if it is an ticket printing transaction]]></comment>
			</column>
			<column name="Validated" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Indicates if it is an validation transaction]]></comment>
			</column>
			<column name="DurationSelection" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Duration from first item put in shopcart to checkout button press (tenth of seconds)]]></comment>
			</column>
			<column name="DurationPayment" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Duration from first item put in shopcart to begin of ticket print (tenth of seconds)]]></comment>
			</column>
			<column name="DurationPrint" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Duration from first item put in shopcart to end of ticket print (tenth of seconds)]]></comment>
			</column>
			<column name="CommitDateTime" type="datetime" jt="92" >
				<comment><![CDATA[Date/time prior to SQL commit]]></comment>
			</column>
			<column name="TransactionSequence" type="bigint" jt="-5" >
				<comment><![CDATA[Sequential unique (for this table) number starting from 1]]></comment>
			</column>
			<column name="TransactionSeed" type="smallint" jt="5" >
				<comment><![CDATA[Information used along with TicketSequence to create encrypted barcodes]]></comment>
			</column>
			<column name="LedgerRegRule" type="tinyint" jt="-6" >
				<comment><![CDATA[LK[299] ScheduledDateTime, PreviousFiscalDate, ExecutionDateTime
Fulfilled during "Wallet/Reward points clearing" created by task Finance reconciliation with the parameter of the task itself. 
Used to save ledger movements at the proper date.]]></comment>
			</column>
			<column name="ToBeFinalized" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[True when "FinalizeTransaction" method has not been executed yet. Use for example by Finance Reconcile task for Wallet/Reward point clearing transactions.]]></comment>
			</column>
			<column name="ArchivedTickets" prior="ArchiveTickets" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[One or more tickets linked to this transaction have been archived and purged from production DB]]></comment>
			</column>
			<column name="ArchivedMedias" type="bit" jt="-7" mandatory="y" >
				<defo><![CDATA[0]]></defo>
				<comment><![CDATA[One or more tickets linked to this transaction have been archived and purged from production DB]]></comment>
			</column>
			<index name="UQ_Transaction_TDSSN" unique="UNIQUE_KEY" >
				<column name="SerialFiscalDate" options="ASC" />
				<column name="LicenseId" options="ASC" />
				<column name="StationSerial" options="ASC" />
				<column name="TransactionSerial" options="ASC" />
			</index>
			<index name="IX_Transaction_FiscalDate" unique="NORMAL" >
				<column name="TransactionFiscalDate" options="DESC" />
				<column name="TransactionDateTime" options="DESC" />
				<column name="TransactionSerial" options="DESC" />
			</index>
			<index name="IX_Transaction_SerialFiscalDate" unique="NORMAL" >
				<column name="SerialFiscalDate" options="ASC" />
				<column name="SerialDateTime" options="ASC" />
				<column name="TransactionSerial" options="ASC" />
			</index>
			<index name="PK_Transaction" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
			</index>
			<index name="IX_Transaction_SaleId" unique="NORMAL" >
				<column name="SaleId" options="ASC" />
				<column name="TransactionFiscalDate" options="ASC" />
				<column name="TransactionDateTime" options="ASC" />
			</index>
			<index name="IX_Transaction_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="TransactionFiscalDate" options="ASC" />
				<column name="TransactionDateTime" options="ASC" />
			</index>
			<index name="IX_Transaction_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
				<column name="TransactionFiscalDate" options="ASC" />
				<column name="TransactionDateTime" options="ASC" />
			</index>
			<index name="IX_Transaction_SupAccountId" unique="NORMAL" options="where SupAccountId is not null" >
				<column name="SupAccountId" options="ASC" />
				<column name="TransactionFiscalDate" options="ASC" />
				<column name="TransactionDateTime" options="ASC" />
			</index>
			<index name="IX_Transaction_BoxId" unique="NORMAL" options="where BoxId is not null" >
				<column name="BoxId" options="ASC" />
				<column name="TransactionFiscalDate" options="ASC" />
				<column name="TransactionDateTime" options="ASC" />
			</index>
			<index name="IX_Transaction_OpAreaId" unique="NORMAL" >
				<column name="OpAreaId" />
				<column name="TransactionFiscalDate" />
				<column name="TransactionDateTime" />
			</index>
			<index name="UQ_Transaction_TransactionSequence" unique="UNIQUE_INDEX" options="WHERE TransactionSequence&lt;&gt;0 INCLUDE (TransactionSeed, TransactionFiscalDate)" >
				<column name="TransactionSequence" />
			</index>
			<index name="IX_Transaction_ToBeFinalized" unique="NORMAL" options="where ToBeFinalized=1" >
				<column name="ToBeFinalized" />
				<column name="TransactionDateTime" />
			</index>
			<fk name="FK_Transaction_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Transaction_SupAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="SupAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Transaction_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Transaction_Sale" to_schema="SnApp.dbo" to_table="tbSale" delete_action="cascade" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
			<fk name="FK_Transaction_License" to_schema="SnApp.dbo" to_table="tbLicense" >
				<fk_column name="LicenseId" pk="LicenseId" />
			</fk>
			<fk name="FK_Transaction_Box" to_schema="SnApp.dbo" to_table="tbBox" >
				<fk_column name="BoxId" pk="BoxId" />
			</fk>
			<fk name="FK_Transaction_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbTransaction2DocketDevice" >
			<comment><![CDATA[Enlist transactions which match docket device configuration]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction]]></comment>
			</column>
			<column name="DocketDeviceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to docket device]]></comment>
			</column>
			<column name="SerialDateTime" type="smalldatetime" jt="93" mandatory="y" >
				<comment><![CDATA[Redound tbTransaction.SerialDateTime]]></comment>
			</column>
			<column name="SerialFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Redound tbTransaction.SerialFiscalDate]]></comment>
			</column>
			<column name="ReceiptSpoolStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[265] - ToBePrinted, WaitingConfirm, Printed]]></comment>
			</column>
			<column name="PrintDateTime" type="smalldatetime" jt="93" >
				<comment><![CDATA[Date/time about when the receipt was printed]]></comment>
			</column>
			<index name="IX_Transaction2DocketDevice_FiscalDate" unique="NORMAL" >
				<column name="SerialFiscalDate" options="ASC" />
				<column name="SerialDateTime" options="ASC" />
			</index>
			<index name="IX_Transaction2DocketDevice_DocketDeviceId" unique="NORMAL" >
				<column name="DocketDeviceId" options="ASC" />
				<column name="SerialFiscalDate" options="ASC" />
				<column name="SerialDateTime" options="ASC" />
			</index>
			<index name="PK_Transaction2DocketDevice" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="DocketDeviceId" />
			</index>
			<fk name="FK_Transaction2DocketDevice_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_Transaction2DocketDevice_DocketDevice" to_schema="SnApp.dbo" to_table="tbDocketDevice" >
				<fk_column name="DocketDeviceId" pk="DocketDeviceId" />
			</fk>
		</table>
		<table name="tbTransaction2ExtSystemVoid" prior="tbTransaction2Ext" >
			<comment><![CDATA[Store reference to tickets which are voided by a transaction on an external system]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction internal ID]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ticket internal ID]]></comment>
			</column>
			<column name="ExtCode" type="varchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Identifier of the void product on the external system]]></comment>
			</column>
			<column name="ExtSystemType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[258]]]></comment>
			</column>
			<column name="PluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the plugin for the external system]]></comment>
			</column>
			<index name="PK_Transaction2ExtSystemVoid" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="TicketId" />
			</index>
			<index name="IX_Transaction2ExtSystemVoid_PluginId" unique="NORMAL" options="where PluginId is not null include (ExtSystemType)" >
				<column name="PluginId" />
			</index>
			<index name="IX_Transaction2ExtSystemVoid_ExtCode" unique="NORMAL" options="include (ExtSystemType)" >
				<column name="ExtCode" />
			</index>
			<fk name="FK_Transaction2ExtSystemVoid_TransactionId" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_Transaction2ExtSystemVoid_TicketId" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_Transaction2ExtSystemVoid_PluginId" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbTransaction2TicketUsage" >
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction]]></comment>
			</column>
			<column name="TicketUsageId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ticket usage]]></comment>
			</column>
			<index name="PK_Transaction2TicketUsage" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="TicketUsageId" />
			</index>
			<index name="IX_Transaction2TicketUsage_TicketUsageId" unique="NORMAL" >
				<column name="TicketUsageId" />
			</index>
			<fk name="FK_Transaction2TicketUsage_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_Transaction2TicketUsage_TicketUsage" to_schema="SnApp.dbo" to_table="tbTicketUsage" >
				<fk_column name="TicketUsageId" pk="TicketUsageId" />
			</fk>
		</table>
		<table name="tbTransactionAccountInventory" >
			<comment><![CDATA[Holds information about the movements of products from account inventory]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the transaction]]></comment>
			</column>
			<column name="AccountInventoryBalanceId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the account inventory]]></comment>
			</column>
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity (positive or negative) moved from/to the account inventory]]></comment>
			</column>
			<column name="UnitAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Unit amount of the product selected]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date of the transaction]]></comment>
			</column>
			<index name="IX_TransactionAccountInventory_AccountInventoryBalanceId" unique="NORMAL" >
				<column name="AccountInventoryBalanceId" options="ASC" />
			</index>
			<index name="PK_TransactionAccountInventory" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="AccountInventoryBalanceId" />
			</index>
			<fk name="FK_TransactionAccountInventory_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionAccountInventory_AccountInventoryBalance" to_schema="SnApp.dbo" to_table="tbAccountInventoryBalance" >
				<fk_column name="AccountInventoryBalanceId" pk="AccountInventoryBalanceId" />
			</fk>
		</table>
		<table name="tbTransactionAccountMerge" prior="Tbl" >
			<comment><![CDATA[When an account merge is performed a transaction merge is created.
This table is the link between the transaction, the final account and the source account(s)]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[The transaction generated by the account merge]]></comment>
			</column>
			<column name="FinalAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[This is the result account of the merge function. The source accont have been merged into this one]]></comment>
			</column>
			<column name="SourceAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[A source account merged into the final one]]></comment>
			</column>
			<index name="PK_TransactionAccountMerge" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="FinalAccountId" />
				<column name="SourceAccountId" />
			</index>
			<index name="IX_TransactionAccountMerge_FinalAccountId" unique="NORMAL" >
				<column name="FinalAccountId" options="ASC" />
			</index>
			<index name="IX_TransactionAccountMerge_SourceAccountId" unique="NORMAL" >
				<column name="SourceAccountId" options="ASC" />
			</index>
			<fk name="FK_TransactionAccountMerge_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionAccountMerge_FinalAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="FinalAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_TransactionAccountMerge_SourceAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="SourceAccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbTransactionActivationGroup" >
			<comment><![CDATA[Keeps track of the operations performed on the activation groups]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the transaction]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the primary ticket]]></comment>
			</column>
			<column name="SecondaryTicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the secondary ticket]]></comment>
			</column>
			<column name="AddLink" type="bit" length="1" jt="-7" mandatory="y" />
			<index name="IX_TransactionActivationGroup_TicketId" unique="NORMAL" >
				<column name="TicketId" options="ASC" />
			</index>
			<index name="IX_TransactionActivationGroup_SecondaryTicketId" unique="NORMAL" >
				<column name="SecondaryTicketId" options="ASC" />
			</index>
			<index name="PK_TransactionActivationGroup" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="TicketId" />
				<column name="SecondaryTicketId" />
			</index>
			<fk name="FK_TransactionActivationGroup_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionActivationGroup_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TransactionActivationGroup_SecondaryTicket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="SecondaryTicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTransactionCommission" >
			<comment><![CDATA[Stores commissions applied with this transaction]]></comment>
			<column name="TransactionCommissionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction]]></comment>
			</column>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the account who benefits the commission]]></comment>
			</column>
			<column name="CommissionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the commission type]]></comment>
			</column>
			<column name="FinanceGroupTagId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Finance grouping]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to ticket (used only in case of ticket voids)]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date]]></comment>
			</column>
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="CommissionAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[NET amount of the commission]]></comment>
			</column>
			<column name="CommissionTax" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Tax of the commission]]></comment>
			</column>
			<column name="ExternalPricing" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[Identifies if the commission amount was supplied by and external pricing plugin]]></comment>
			</column>
			<index name="IX_TransactionCommission_SaleItemId" unique="NORMAL" >
				<column name="SaleItemId" options="ASC" />
			</index>
			<index name="IX_TransactionCommission_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="IX_TransactionCommission_FiscalDate" unique="NORMAL" >
				<column name="FiscalDate" options="ASC" />
			</index>
			<index name="PK_TransactionCommission" unique="PRIMARY_KEY" >
				<column name="TransactionCommissionId" />
			</index>
			<index name="IX_TransactionCommission_TicketId" unique="NORMAL" options="where TicketId is not null" >
				<column name="TicketId" />
			</index>
			<index name="UQ_TransactionCommission" unique="UNIQUE_INDEX" >
				<column name="TransactionId" />
				<column name="AccountId" />
				<column name="CommissionId" />
				<column name="SaleItemId" />
				<column name="TicketId" />
			</index>
			<index name="IX_TransactionCommission_CommisionId" unique="NORMAL" options="where CommissionId is not null" >
				<column name="CommissionId" options="ASC" />
			</index>
			<index name="IX_TransactionCommission_FinanceGroupTagId" unique="NORMAL" options="where FinanceGroupTagId is not null" >
				<column name="FinanceGroupTagId" options="ASC" />
			</index>
			<fk name="FK_TransactionCommission_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_TransactionCommission_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionCommission_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_TransactionCommission_Tag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="FinanceGroupTagId" pk="TagId" />
			</fk>
			<fk name="FK_TransactionCommission_Commission" to_schema="SnApp.dbo" to_table="tbCommission" >
				<fk_column name="CommissionId" pk="CommissionId" />
			</fk>
		</table>
		<table name="tbTransactionCrossPlatform" >
			<column name="TransactionCrossPlatformId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CrossPlatformId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Status" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[289]]]></comment>
			</column>
			<column name="AttemptCount" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="NextAttemptDateTime" type="smalldatetime" jt="93" />
			<column name="LastAttemptDateTime" type="smalldatetime" jt="93" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" />
			<column name="Message" type="nvarchar(max)" jt="12" />
			<column name="ErrorCode" type="smallint" length="1" decimal="0" jt="5" />
			<column name="ErrorMsg" type="nvarchar(max)" jt="12" />
			<column name="CrossTransactionRef" type="varchar" length="36" decimal="0" jt="12" >
				<comment><![CDATA[Transaction Id of the cross platform]]></comment>
			</column>
			<column name="CrossSaleRef" type="varchar" length="36" decimal="0" jt="12" >
				<comment><![CDATA[Sale Id of the cross platform]]></comment>
			</column>
			<index name="IX_TransactionCrossPlatform_TransactionId" unique="NORMAL" >
				<column name="TransactionId" options="ASC" />
				<column name="CrossPlatformId" options="ASC" />
			</index>
			<index name="IX_TransactionCrossPlatform_CrossPlatformId" unique="NORMAL" >
				<column name="CrossPlatformId" options="ASC" />
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="IX_TransactionCrossPlatform_ServerId" unique="NORMAL" options="where ServerId is not null" >
				<column name="ServerId" options="ASC" />
				<column name="Status" options="ASC" />
				<column name="NextAttemptDateTime" options="ASC" />
			</index>
			<index name="IX_TransactionCrossPlatform_NextAttemptDateTime" unique="NORMAL" options="where NextAttemptDateTime is not null" >
				<column name="NextAttemptDateTime" options="ASC" />
			</index>
			<index name="IX_TransactionCrossPlatform_CrossTransactionRef" unique="NORMAL" >
				<column name="CrossPlatformId" options="ASC" />
				<column name="CrossTransactionRef" options="ASC" />
			</index>
			<index name="IX_TransactionCrossPlatform_CrossSaleRef" unique="NORMAL" >
				<column name="CrossPlatformId" options="ASC" />
				<column name="CrossSaleRef" options="ASC" />
			</index>
			<index name="PK_TransactionCrossPlatform" unique="PRIMARY_KEY" >
				<column name="TransactionCrossPlatformId" />
			</index>
			<fk name="FK_TransactionCrossPlatform_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbTransactionCrossPlatformItem" >
			<column name="TransactionCrossPlatformId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="UnitPrice" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<index name="IX_TransactionCrossPlatformItem_SaleItemId" unique="NORMAL" >
				<column name="SaleItemId" options="ASC" />
			</index>
			<index name="PK_TransactionCrossPlatformItem" unique="PRIMARY_KEY" >
				<column name="TransactionCrossPlatformId" />
				<column name="SaleItemId" />
			</index>
			<fk name="FK_TransactionCrossPlatformItem_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
			<fk name="FK_TransactionCrossPlatformItem_TransactionCrossPlatform" to_schema="SnApp.dbo" to_table="tbTransactionCrossPlatform" >
				<fk_column name="TransactionCrossPlatformId" pk="TransactionCrossPlatformId" />
			</fk>
		</table>
		<table name="tbTransactionDocket" >
			<comment><![CDATA[Extension table for tbTransaction which includes information about docket status (to be prepared, ready, etc)]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction]]></comment>
			</column>
			<column name="DocketStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[313] Waiting, InPreparation, Ready, etc]]></comment>
			</column>
			<column name="OrderPaid" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[Set to 1 if the transaction Paid the order]]></comment>
			</column>
			<index name="PK_TransactionDocket" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
			</index>
			<fk name="FK_TransactionDocket_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbTransactionItem" >
			<comment><![CDATA[Stores variation done on tbSaleItem per transaction]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction]]></comment>
			</column>
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to sale item]]></comment>
			</column>
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Delta quantity applied to the sale item.
Give a sale item, its quantity is the algebraic sum of all its transaction item quantity]]></comment>
			</column>
			<column name="QtyPaid" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity paid with this transaction. For financial/statistical report based on transactions, this is the quantity to be used]]></comment>
			</column>
			<index name="IX_TransactionItem_SaleItemId" unique="NORMAL" >
				<column name="SaleItemId" options="ASC" />
			</index>
			<index name="PK_TransactionItem" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="SaleItemId" />
			</index>
			<fk name="FK_TransactionItem_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionItem_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbTransactionJob" prior="Tbl" >
			<comment><![CDATA[Link between a job and a transaction]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Transaction identifier]]></comment>
			</column>
			<column name="JobId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Job identifier]]></comment>
			</column>
			<index name="PK_TransactionJob" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
			</index>
			<index name="IX_TransactionJob_JobId" unique="NORMAL" >
				<column name="JobId" />
			</index>
			<fk name="FK_TransactionJob_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionJob_Job" to_schema="SnApp.dbo" to_table="tbJob" delete_action="cascade" >
				<fk_column name="JobId" pk="JobId" />
			</fk>
		</table>
		<table name="tbTransactionLedgerBalance" prior="tbTransactionLedger" >
			<comment><![CDATA[Track changes made by transaction type "recalc ledger balance"]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction internal ID]]></comment>
			</column>
			<column name="LedgerFiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Ledger balance date]]></comment>
			</column>
			<column name="LedgerAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ledger account id]]></comment>
			</column>
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to account internal ID]]></comment>
			</column>
			<column name="BalanceDelta" type="money" jt="3" mandatory="y" >
				<comment><![CDATA[Delta amount applied to tbLedgerDateTotal]]></comment>
			</column>
			<index name="PK_TransactionLedgerBalance" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="LedgerFiscalDate" />
				<column name="LedgerAccountId" />
				<column name="AccountId" />
			</index>
			<index name="IX_TransactionLedgerBalance_LedgerAccountId" unique="NORMAL" >
				<column name="LedgerAccountId" />
				<column name="LedgerFiscalDate" />
			</index>
			<index name="IX_TransactionLedgerBalance_AccountId" unique="NORMAL" >
				<column name="AccountId" />
				<column name="LedgerFiscalDate" />
			</index>
			<fk name="FK_TransactionLedgerBalance_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionLedgerBalance_LedgerAccountId" to_schema="SnApp.dbo" to_table="tbLedgerAccount" >
				<fk_column name="LedgerAccountId" pk="LedgerAccountId" />
			</fk>
			<fk name="FK_TransactionLedgerBalance_AccountId" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbTransactionMediaTransfer" >
			<comment><![CDATA[Holds reference for transferred medias]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction on which the transfer happened]]></comment>
			</column>
			<column name="MediaId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the media transferred]]></comment>
			</column>
			<column name="SourcePortfolioId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the portfolio on which the media has been removed]]></comment>
			</column>
			<column name="TargetPortfolioId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the portfolio on which the media has been added]]></comment>
			</column>
			<index name="IX_TransactionMediaTransfer_MediaId" unique="NORMAL" >
				<column name="MediaId" options="ASC" />
			</index>
			<index name="IX_TransactionMediaTransfer_SourcePortfolioId" unique="NORMAL" >
				<column name="SourcePortfolioId" options="ASC" />
				<column name="MediaId" options="ASC" />
			</index>
			<index name="IX_TransactionMediaTransfer_TargetPortfolioId" unique="NORMAL" >
				<column name="TargetPortfolioId" options="ASC" />
				<column name="MediaId" options="ASC" />
			</index>
			<index name="PK_TransactionMediaTransfer" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="MediaId" />
			</index>
			<fk name="FK_TransactionMediaTransfer_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionMediaTransfer_SourcePortfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="SourcePortfolioId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_TransactionMediaTransfer_TargetPortfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="TargetPortfolioId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_TransactionMediaTransfer_Media" to_schema="SnApp.dbo" to_table="tbMedia" >
				<fk_column name="MediaId" pk="MediaId" />
			</fk>
		</table>
		<table name="tbTransactionStock" >
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WarehouseId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MeasureId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="FaceMeasureId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Quantity" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<column name="FaceQuantity" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<column name="TransactionDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<index name="IX_TransactionStock_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
				<column name="TransactionDateTime" options="ASC" />
			</index>
			<index name="IX_TransactionStock_WarehouseId" unique="NORMAL" >
				<column name="WarehouseId" options="ASC" />
				<column name="TransactionDateTime" options="ASC" />
			</index>
			<index name="IX_TransactionStock_ProductWarehouse" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
				<column name="WarehouseId" options="ASC" />
				<column name="TransactionDateTime" options="ASC" />
			</index>
			<index name="IX_TransactionStock_MeasureId" unique="NORMAL" >
				<column name="MeasureId" options="ASC" />
			</index>
			<index name="IX_TransactionStock_FaceMeasureId" unique="NORMAL" >
				<column name="FaceMeasureId" options="ASC" />
			</index>
			<index name="PK_TransactionStock" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="ProductId" />
				<column name="WarehouseId" />
				<column name="MeasureId" />
				<column name="FaceMeasureId" />
			</index>
			<fk name="FK_TransactionStock_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_TransactionStock_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionStock_Warehouse" to_schema="SnApp.dbo" to_table="tbWarehouse" >
				<fk_column name="WarehouseId" pk="WarehouseId" />
			</fk>
			<fk name="FK_TransactionStock_FaceMeasure" to_schema="SnApp.dbo" to_table="tbMeasure" >
				<fk_column name="FaceMeasureId" pk="MeasureId" />
			</fk>
			<fk name="FK_TransactionStock_Measure" to_schema="SnApp.dbo" to_table="tbMeasure" >
				<fk_column name="MeasureId" pk="MeasureId" />
			</fk>
		</table>
		<table name="tbTransactionTicketPerformance" >
			<comment><![CDATA[Used to store details about the "change ticket performance" transactions]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the transaction]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the ticket]]></comment>
			</column>
			<column name="SourcePerformanceSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Performance set we are changing from]]></comment>
			</column>
			<column name="TargetPerformanceSetId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Performance set we are changing to]]></comment>
			</column>
			<index name="PK_TransactionTicketPerformance" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="TicketId" />
			</index>
			<index name="IX_TransactionTicketPerformance_TicketId" unique="NORMAL" >
				<column name="TicketId" />
			</index>
			<index name="IX_TransactionTicketPerformance_SourcePerformanceSetId" unique="NORMAL" options="WHERE SourcePerformanceSetId is not null" >
				<column name="SourcePerformanceSetId" />
			</index>
			<index name="IX_TransactionTicketPerformance_TargetPerformanceSetId" unique="NORMAL" options="WHERE TargetPerformanceSetId is not null" >
				<column name="TargetPerformanceSetId" />
			</index>
			<fk name="FK_TransactionTicketPerformance_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionTicketPerformance_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" delete_action="cascade" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
			<fk name="FK_TransactionTicketPerformance_SourcePerformanceSet" to_schema="SnApp.dbo" to_table="tbPerformanceSet" >
				<fk_column name="SourcePerformanceSetId" pk="PerformanceSetId" />
			</fk>
			<fk name="FK_TransactionTicketPerformance_TargetPerformanceSet" to_schema="SnApp.dbo" to_table="tbPerformanceSet" >
				<fk_column name="TargetPerformanceSetId" pk="PerformanceSetId" />
			</fk>
		</table>
		<table name="tbTransactionTicketPriority" >
			<comment><![CDATA[Contains details for "change ticket priority" transactions]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to transaction internal ID]]></comment>
			</column>
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to ticket internal ID]]></comment>
			</column>
			<column name="OldPriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Previous PriorityOrder value]]></comment>
			</column>
			<column name="NewPriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Updated PriorityOrder value]]></comment>
			</column>
			<index name="IX_TransactionTicketPriority_TicketId" unique="NORMAL" >
				<column name="TicketId" options="ASC" />
			</index>
			<index name="PK_TransactionTicketPriority" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="TicketId" />
			</index>
			<fk name="FK_TransactionTicketPriority_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionTicketPriority_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTransactionTicketTransfer" >
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TicketId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SourcePortfolioId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TargetPortfolioId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="IX_TransactionTicketTransfer_TicketId" unique="NORMAL" >
				<column name="TicketId" options="ASC" />
			</index>
			<index name="IX_TransactionTicketTransfer_SourcePortfolioId" unique="NORMAL" >
				<column name="SourcePortfolioId" options="ASC" />
			</index>
			<index name="PK_TransactionTicketTransfer" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="TicketId" />
			</index>
			<fk name="FK_TransactionTicketTransfer_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionTicketTransfer_SourcePortfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="SourcePortfolioId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_TransactionTicketTransfer_TargetPortfolio" to_schema="SnApp.dbo" to_table="tbTicketMediaMatch" >
				<fk_column name="TargetPortfolioId" pk="TicketMediaMatchId" />
			</fk>
			<fk name="FK_TransactionTicketTransfer_Ticket" to_schema="SnApp.dbo" to_table="tbTicket" >
				<fk_column name="TicketId" pk="TicketId" />
			</fk>
		</table>
		<table name="tbTransactionUpsell" prior="Tbl" >
			<comment><![CDATA[Keep track of upsell&swap behavior]]></comment>
			<column name="TransactionUpsellId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the transaction which leveraged on upsell]]></comment>
			</column>
			<column name="SourceProductId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the upsell/swap triggering/source product type]]></comment>
			</column>
			<column name="TargetProductId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the upsell/swap target product type]]></comment>
			</column>
			<column name="UpsellType" prior="UpsellyType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[488] Swap/Upsell]]></comment>
			</column>
			<column name="Quantity" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity]]></comment>
			</column>
			<index name="PK_TransactionUpsell" unique="PRIMARY_KEY" >
				<column name="TransactionUpsellId" />
			</index>
			<index name="IX_TransactionUpsell_TransactionId" unique="NORMAL" >
				<column name="TransactionId" />
			</index>
			<index name="IX_TransactionUpsell_TargetProductId" unique="NORMAL" >
				<column name="TargetProductId" />
			</index>
			<index name="IX_TransactionUpsell_SourceProductId" unique="NORMAL" options="WHERE SourceProductId IS NOT NULL" >
				<column name="SourceProductId" />
			</index>
			<fk name="FK_TransactionUpsell_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionUpsell_SourceProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="SourceProductId" pk="ProductId" />
			</fk>
			<fk name="FK_TransactionUpsell_TargetProduct" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="TargetProductId" pk="ProductId" />
			</fk>
		</table>
		<table name="tbTransactionVoucher" >
			<comment><![CDATA[This table contains the committed amount of a transaction and it is used to calculate the exposure of an organization for "Issued" and "Partially redeemed" vouchers.]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="VoucherId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CommittedAmount" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_TransactionVoucher_VoucherId" unique="NORMAL" >
				<column name="VoucherId" options="ASC" />
			</index>
			<index name="IX_TransactionVoucher_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
			</index>
			<index name="PK_TransactionVoucher" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="VoucherId" />
			</index>
			<fk name="FK_TransactionVoucher_AccountFinance" to_schema="SnApp.dbo" to_table="tbAccountFinance" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_TransactionVoucher_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionVoucher_Voucher" to_schema="SnApp.dbo" to_table="tbVoucher" >
				<fk_column name="VoucherId" pk="VoucherId" />
			</fk>
		</table>
		<table name="tbTransactionWallet" >
			<comment><![CDATA[Write a record for every TransactionItem changing tbSaleItemDetail.WalletDeposit]]></comment>
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="SaleItemDetailId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WalletDeposit" type="money" length="0" jt="3" mandatory="y" />
			<index name="IX_TransactionWallet_SaleItemDetailId" unique="NORMAL" >
				<column name="SaleItemDetailId" options="ASC" />
			</index>
			<index name="PK_TransactionWallet" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="SaleItemDetailId" />
			</index>
			<fk name="FK_TransactionWallet_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_TransactionWallet_SaleItemDetail" to_schema="SnApp.dbo" to_table="tbSaleItemDetail" >
				<fk_column name="SaleItemDetailId" pk="SaleItemDetailId" />
			</fk>
		</table>
		<table name="tbTransactionWarn" >
			<column name="TransactionId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TransactionWarn" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[243]]]></comment>
			</column>
			<index name="IX_TransactionWarn_TransactionWarn" unique="NORMAL" >
				<column name="TransactionWarn" options="ASC" />
			</index>
			<index name="PK_TransactionWarn" unique="PRIMARY_KEY" >
				<column name="TransactionId" />
				<column name="TransactionWarn" />
			</index>
			<fk name="FK_TransactionWarn_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" delete_action="cascade" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbTranslate" >
			<comment><![CDATA[Translate system strings]]></comment>
			<column name="LangISO" type="varchar" length="3" decimal="0" jt="12" mandatory="y" />
			<column name="LabelKey" type="varchar" length="50" decimal="0" jt="12" mandatory="y" />
			<column name="LabelValue" type="nvarchar" length="4000" decimal="0" jt="12" mandatory="y" />
			<index name="PK_Translate" unique="PRIMARY_KEY" >
				<column name="LangISO" />
				<column name="LabelKey" />
			</index>
		</table>
		<table name="tbUpload" >
			<column name="UploadId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UploadStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[137] (Waiting, Working, Success, Error)]]></comment>
			</column>
			<column name="UploadType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[148]]]></comment>
			</column>
			<column name="QueuePriority" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[171]]]></comment>
			</column>
			<column name="RequestDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="StartDateTime" type="datetime" jt="92" />
			<column name="EndDateTime" type="datetime" jt="92" />
			<column name="MsgRequest" type="nvarchar(max)" jt="12" mandatory="y" />
			<column name="MsgAnswer" type="nvarchar(max)" jt="12" />
			<column name="EntityType" type="smallint" jt="5" />
			<column name="EntityId" type="uniqueidentifier" jt="1" />
			<column name="ServerId" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Tomcat instance]]></comment>
			</column>
			<column name="ErrorCode" type="int" jt="4" >
				<comment><![CDATA[LK[139]]]></comment>
			</column>
			<index name="IX_Upload_EntityId" unique="NORMAL" >
				<column name="EntityId" options="ASC" />
			</index>
			<index name="IX_Upload_RequestDateTime" unique="NORMAL" >
				<column name="RequestDateTime" options="ASC" />
			</index>
			<index name="IX_Upload_TypeAndDateTime" unique="NORMAL" >
				<column name="UploadType" options="ASC" />
				<column name="RequestDateTime" options="ASC" />
			</index>
			<index name="IX_Upload_StatusAndDateTime" unique="NORMAL" >
				<column name="UploadStatus" options="ASC" />
				<column name="RequestDateTime" options="ASC" />
			</index>
			<index name="PK_Upload" unique="PRIMARY_KEY" >
				<column name="UploadId" />
			</index>
			<index name="IX_Upload_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" />
			</index>
			<index name="IX_Upload_StatusPriorityType_V2" unique="NORMAL" >
				<column name="ServerId" options="ASC" />
				<column name="UploadStatus" options="ASC" />
				<column name="UploadType" options="ASC" />
				<column name="QueuePriority" options="ASC" />
				<column name="RequestDateTime" options="ASC" />
			</index>
			<fk name="FK_Upload_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
		</table>
		<table name="tbUserActivity" >
			<column name="FiscalDate" type="date" jt="91" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserActivitySerial" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="LoginDateTime" type="datetime" jt="92" mandatory="y" />
			<column name="LogoutDateTime" type="datetime" jt="92" />
			<column name="ProductCount" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="TransactionCount" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<column name="TotalSelectionTime" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Expressed in tens of seconds]]></comment>
			</column>
			<column name="TotalPaymentTime" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Expressed in tens of seconds]]></comment>
			</column>
			<column name="TotalPrintTime" type="int" length="1" decimal="0" jt="4" mandatory="y" >
				<comment><![CDATA[Expressed in tens of seconds]]></comment>
			</column>
			<column name="ExtLoginName" type="nvarchar" length="50" jt="12" >
				<comment><![CDATA[Login user nome from external plugin]]></comment>
			</column>
			<column name="ExtSessionReference" type="varchar" length="100" decimal="0" jt="12" >
				<comment><![CDATA[Session reference data from external plugin]]></comment>
			</column>
			<column name="ExtPluginId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Id of the plugin used to login]]></comment>
			</column>
			<index name="IX_UserActivity_AccountId" unique="NORMAL" >
				<column name="UserAccountId" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="UserActivitySerial" options="ASC" />
			</index>
			<index name="IX_UserActivity_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
				<column name="FiscalDate" options="ASC" />
				<column name="LoginDateTime" options="ASC" />
			</index>
			<index name="IX_UserActivity_PluginId" unique="NORMAL" options="where ExtPluginId is not null" >
				<column name="ExtPluginId" options="ASC" />
				<column name="LoginDateTime" options="ASC" />
			</index>
			<index name="PK_UserActivity" unique="PRIMARY_KEY" >
				<column name="FiscalDate" />
				<column name="UserAccountId" />
				<column name="UserActivitySerial" />
			</index>
			<fk name="FK_UserActivity_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_UserActivity_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_UserActivity_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="ExtPluginId" pk="PluginId" />
			</fk>
		</table>
		<table name="tbUserFilter" >
			<comment><![CDATA[Stores last search criteria used by user, for example in admission statistics, in order to use it as default next time he jumps into the page]]></comment>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserFilterType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[279]]]></comment>
			</column>
			<column name="FilterData" type="nvarchar(max)" jt="12" mandatory="y" />
			<column name="LastUpdate" type="datetime" jt="92" mandatory="y" />
			<index name="IX_UserFilter_LastUpdate" unique="NORMAL" >
				<column name="LastUpdate" options="ASC" />
			</index>
			<index name="PK_UserFilter" unique="PRIMARY_KEY" >
				<column name="UserAccountId" />
				<column name="UserFilterType" />
			</index>
			<fk name="FK_UserFilter_Account" to_schema="SnApp.dbo" to_table="tbAccount" delete_action="cascade" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbVoucher" >
			<column name="VoucherId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="TemplateVoucherId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Mandatory for "individual vouchers", refers to the "voucher template"]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" />
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" />
			<column name="VoucherType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[82] (Template / Individual)]]></comment>
			</column>
			<column name="VoucherStatus" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[79]]]></comment>
			</column>
			<column name="VoucherCode" type="varchar" length="25" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Size increased from 10 to 25 on 30/05/2017 - Issue 3341]]></comment>
			</column>
			<column name="VoucherName" type="nvarchar" length="50" jt="12" />
			<column name="CreateDate" type="date" jt="91" mandatory="y" />
			<column name="CreateDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="ValidDateFrom" type="date" jt="91" />
			<column name="ValidDateTo" type="date" jt="91" />
			<column name="QuantityMax" type="smallint" length="1" decimal="0" jt="5" />
			<column name="AmountMax" type="money" length="0" jt="3" />
			<column name="Printed" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="VoucherDescription" type="nvarchar" length="100" jt="12" />
			<column name="Active" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="TotalAmount" type="money" length="0" jt="3" mandatory="y" >
				<comment><![CDATA[Contains the total paid value for the voucher.
1) If the voucher is paid at issue will contain the amount of its  voucher items
2) if the voucher is not paid at issue will contain 0, the value will be updated upon redeem with the value of the voucher items selected]]></comment>
			</column>
			<column name="PartiallyRedeemable" type="bit" length="1" jt="-7" mandatory="y" >
				<comment><![CDATA[If voucher is not paid and the flag is active POS can redeem voucher untill MaxQty of every item is reached.]]></comment>
			</column>
			<index name="IX_Voucher_TemplateVoucherId" unique="NORMAL" options="where TemplateVoucherId is not null" >
				<column name="TemplateVoucherId" options="ASC" />
			</index>
			<index name="IX_Voucher_AccountId" unique="NORMAL" >
				<column name="AccountId" options="ASC" />
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="UQ_Voucher_VoucherCode" unique="UNIQUE_KEY" >
				<column name="VoucherCode" options="ASC" />
				<column name="AccountId" options="ASC" />
			</index>
			<index name="IX_Voucher_TransactionId" unique="NORMAL" options="where TransactionId is not null" >
				<column name="TransactionId" options="ASC" />
			</index>
			<index name="IX_Voucher_DocTemplateId" unique="NORMAL" options="where DocTemplateId is not null" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="IX_Voucher_Exposure" unique="NORMAL" options="INCLUDE(TotalAmount) where VoucherStatus in (101, 302) and AmountMax is not null" >
				<column name="AccountId" options="ASC" />
				<column name="VoucherStatus" options="ASC" />
				<column name="AmountMax" options="ASC" />
			</index>
			<index name="PK_Voucher" unique="PRIMARY_KEY" >
				<column name="VoucherId" />
			</index>
			<fk name="FK_Voucher_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="AccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Voucher_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
			<fk name="FK_Voucher_Voucher" to_schema="SnApp.dbo" to_table="tbVoucher" >
				<fk_column name="TemplateVoucherId" pk="VoucherId" />
			</fk>
			<fk name="FK_Voucher_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
		</table>
		<table name="tbVoucherItem" >
			<column name="VoucherItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="VoucherId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="QuantityMin" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="QuantityMax" type="smallint" length="1" decimal="0" jt="5" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UnitPrice" type="money" length="0" jt="3" mandatory="y" />
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" >
				<comment><![CDATA[Quantity of paid items.
1) If voucher is paid at issue Quantity will be equals to QuantityMin
2) If voucher is not paid at issue Quantity will be 0 and will be updated upon redeem with the proper info selected at POS]]></comment>
			</column>
			<index name="PK_VoucherItem" unique="PRIMARY_KEY" >
				<column name="VoucherItemId" />
			</index>
			<index name="IX_VoucherItem_ProductId" unique="NORMAL" >
				<column name="ProductId" />
			</index>
			<index name="IX_VoucherItem_VoucherId" unique="NORMAL" >
				<column name="VoucherId" />
			</index>
			<fk name="FK_VoucherItem_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_VoucherItem_Voucher" to_schema="SnApp.dbo" to_table="tbVoucher" delete_action="cascade" >
				<fk_column name="VoucherId" pk="VoucherId" />
			</fk>
		</table>
		<table name="tbWalletLog2SaleItem" >
			<comment><![CDATA[Track what sale items have been paid through wallet payment.
ForeignKey to tbPortfolioSlotLog not present because we skipped MembershipPoint fields]]></comment>
			<column name="PortfolioId" type="uniqueidentifier" length="1" decimal="0" jt="1" mandatory="y" />
			<column name="LogFiscalDate" type="date" jt="91" mandatory="y" />
			<column name="LogSerial" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<column name="SaleItemId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Quantity" type="smallint" length="1" decimal="0" jt="5" mandatory="y" />
			<index name="IX_WalletLog2SaleItem" unique="NORMAL" >
				<column name="SaleItemId" options="ASC" />
			</index>
			<index name="PK_WalletLog2SaleItem" unique="PRIMARY_KEY" >
				<column name="PortfolioId" />
				<column name="LogFiscalDate" />
				<column name="LogSerial" />
				<column name="SaleItemId" />
			</index>
			<fk name="FK_WalletLog2SaleItem_SaleItem" to_schema="SnApp.dbo" to_table="tbSaleItem" >
				<fk_column name="SaleItemId" pk="SaleItemId" />
			</fk>
		</table>
		<table name="tbWarehouse" >
			<column name="WarehouseId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WarehouseCode" type="varchar" length="15" jt="12" mandatory="y" />
			<column name="WarehouseName" type="nvarchar" length="50" jt="12" mandatory="y" />
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" />
			<index name="UQ_Warehouse_Code" unique="UNIQUE_KEY" >
				<column name="WarehouseCode" options="ASC" />
			</index>
			<index name="IX_Warehouse_LocationAccountId" unique="NORMAL" >
				<column name="LocationAccountId" options="ASC" />
				<column name="WarehouseName" options="ASC" />
			</index>
			<index name="PK_Warehouse" unique="PRIMARY_KEY" >
				<column name="WarehouseId" />
			</index>
			<fk name="FK_Warehouse_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
		</table>
		<table name="tbWarehouseStock" >
			<column name="WarehouseId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ProductId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="MeasureId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="Quantity" type="money" length="1" decimal="0" jt="3" mandatory="y" />
			<index name="IX_WarehouseStock_ProductId" unique="NORMAL" >
				<column name="ProductId" options="ASC" />
			</index>
			<index name="IX_WarehouseStock_MeasureId" unique="NORMAL" >
				<column name="MeasureId" options="ASC" />
			</index>
			<index name="PK_WarehouseStock" unique="PRIMARY_KEY" >
				<column name="WarehouseId" />
				<column name="ProductId" />
				<column name="MeasureId" />
			</index>
			<fk name="FK_WarehouseStock_Product" to_schema="SnApp.dbo" to_table="tbProduct" >
				<fk_column name="ProductId" pk="ProductId" />
			</fk>
			<fk name="FK_WarehouseStock_Warehouse" to_schema="SnApp.dbo" to_table="tbWarehouse" delete_action="cascade" >
				<fk_column name="WarehouseId" pk="WarehouseId" />
			</fk>
			<fk name="FK_WarehouseStock_Measure" to_schema="SnApp.dbo" to_table="tbMeasure" >
				<fk_column name="MeasureId" pk="MeasureId" />
			</fk>
		</table>
		<table name="tbWebAuth" >
			<column name="WebAuthId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="WebAuthRef" type="varchar" length="50" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Identifier sent to the bank]]></comment>
			</column>
			<column name="WebAuthStatus" type="tinyint" jt="-6" mandatory="y" >
				<comment><![CDATA[LK[54]]]></comment>
			</column>
			<column name="WebAuthAmount" type="money" length="0" jt="3" mandatory="y" />
			<column name="CreateDateTime" type="smalldatetime" jt="93" mandatory="y" />
			<column name="CloseDateTime" type="smalldatetime" jt="93" />
			<column name="SaleId" type="uniqueidentifier" jt="1" />
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="UserAccountId" type="uniqueidentifier" jt="1" />
			<column name="PluginId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PaymentMethodId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="CreateOrderConfirmation" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="SendOrderConfirmation" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="IncludeTickets" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="PreparePahDownload" type="bit" length="1" jt="-7" mandatory="y" />
			<column name="DocTemplateId" type="uniqueidentifier" jt="1" />
			<column name="AuthorizationCode" type="varchar" length="50" jt="12" />
			<column name="PaymentId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the payment]]></comment>
			</column>
			<column name="TransactionId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Link to the transaction]]></comment>
			</column>
			<index name="UQ_WebAuth_WebAuthRef" unique="UNIQUE_KEY" >
				<column name="WebAuthRef" options="ASC" />
			</index>
			<index name="IX_WebAuth_CreateDateTime" unique="NORMAL" >
				<column name="CreateDateTime" options="ASC" />
			</index>
			<index name="IX_WebAuth_SaleId" unique="NORMAL" >
				<column name="SaleId" options="ASC" />
			</index>
			<index name="IX_WebAuth_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" options="ASC" />
			</index>
			<index name="IX_WebAuth_PluginId" unique="NORMAL" >
				<column name="PluginId" options="ASC" />
			</index>
			<index name="IX_WebAuth_AuthorizationCode" unique="NORMAL" >
				<column name="AuthorizationCode" options="ASC" />
			</index>
			<index name="IX_WebAuth_PaymentMethodId" unique="NORMAL" >
				<column name="PaymentMethodId" options="ASC" />
			</index>
			<index name="IX_WebAuth_DocTemplateId" unique="NORMAL" options="where DocTemplateId is not null" >
				<column name="DocTemplateId" options="ASC" />
			</index>
			<index name="IX_WebAuth_UserAccountId" unique="NORMAL" options="where UserAccountId is not null" >
				<column name="UserAccountId" options="ASC" />
			</index>
			<index name="PK_WebAuth" unique="PRIMARY_KEY" >
				<column name="WebAuthId" />
			</index>
			<index name="IX_WebAuth_paymentId" unique="NORMAL" options="where PaymentId is not null" >
				<column name="PaymentId" />
			</index>
			<index name="IX_WebAuth_TransactionId" unique="NORMAL" options="where TransactionId is not null" >
				<column name="TransactionId" />
			</index>
			<index name="IX_WebAuth_WebAuthStatus" unique="NORMAL" >
				<column name="WebAuthStatus" />
				<column name="CreateDateTime" />
			</index>
			<fk name="FK_WebAuth_Account" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_WebAuth_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_WebAuth_Sale" to_schema="SnApp.dbo" to_table="tbSale" >
				<fk_column name="SaleId" pk="SaleId" />
			</fk>
			<fk name="FK_WebAuth_Plugin" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PluginId" pk="PluginId" />
			</fk>
			<fk name="FK_WebAuth_PaymentMethod" to_schema="SnApp.dbo" to_table="tbPlugin" >
				<fk_column name="PaymentMethodId" pk="PluginId" />
			</fk>
			<fk name="FK_WebAuth_DocTemplate" to_schema="SnApp.dbo" to_table="tbDocTemplate" >
				<fk_column name="DocTemplateId" pk="DocTemplateId" />
			</fk>
			<fk name="FK_WebAuth_Payment" to_schema="SnApp.dbo" to_table="tbPayment" delete_action="cascade" >
				<fk_column name="PaymentId" pk="PaymentId" />
			</fk>
			<fk name="FK_WebAuth_Transaction" to_schema="SnApp.dbo" to_table="tbTransaction" >
				<fk_column name="TransactionId" pk="TransactionId" />
			</fk>
		</table>
		<table name="tbWebAuthData" prior="tbPaymentData_0" >
			<comment><![CDATA[Table designed to store additional custom data for web payment gateways.]]></comment>
			<column name="WebAuthId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="ParamName" type="varchar" length="30" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Name of the parameter]]></comment>
			</column>
			<column name="ParamValue" type="nvarchar" length="100" decimal="0" jt="12" mandatory="y" >
				<comment><![CDATA[Value of the parameter]]></comment>
			</column>
			<column name="ParamValueLong" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Value of the parameter if longer then 100 chars]]></comment>
			</column>
			<index name="PK_WebAuthData" unique="PRIMARY_KEY" >
				<column name="WebAuthId" />
				<column name="ParamName" />
			</index>
			<fk name="FK_WebAuthData_WebAuth" to_schema="SnApp.dbo" to_table="tbWebAuth" delete_action="cascade" >
				<fk_column name="WebAuthId" pk="WebAuthId" />
			</fk>
		</table>
		<table name="tbWorkstation" >
			<comment><![CDATA[Holds information about system workstation. 
Be aware that Access Points (tbAccessPoint) are an extension to this table]]></comment>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="LicenseId" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[Licensee this workstation belongs to]]></comment>
			</column>
			<column name="CategoryId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Category of the workstation (determins applicable data masks)]]></comment>
			</column>
			<column name="LocationAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Location under which the workstation is configured (cannot be changed)]]></comment>
			</column>
			<column name="OpAreaAccountId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Location under which the workstation is configured (can be changed)]]></comment>
			</column>
			<column name="WorkstationType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[19]]]></comment>
			</column>
			<column name="WorkstationCode" type="varchar" length="15" jt="12" mandatory="y" >
				<comment><![CDATA[Intelligible alphanumeric user defined code]]></comment>
			</column>
			<column name="WorkstationName" type="nvarchar" length="50" jt="12" mandatory="y" >
				<comment><![CDATA[Workstation name]]></comment>
			</column>
			<column name="WorkstationURI" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[For CLC workstation, is the URL piece used to identify the workstation http://domain/cc/WorkstationURI]]></comment>
			</column>
			<column name="ActivationKey" type="varchar" length="25" decimal="0" jt="12" >
				<comment><![CDATA[ActivationKey that this workstation is consuming]]></comment>
			</column>
			<column name="StationSerial" type="smallint" length="1" decimal="0" jt="5" >
				<comment><![CDATA[Station serial]]></comment>
			</column>
			<column name="LicenseParams" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Encrypted license information associated to this workstation through activation key]]></comment>
			</column>
			<column name="SaleChannelId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[SaleChannel to be used when selling from this workstation (determines product prices)]]></comment>
			</column>
			<column name="LastUserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Last user logged into the workstation]]></comment>
			</column>
			<column name="LastClientActivity" type="datetime" jt="92" >
				<comment><![CDATA[For POSs, last time the POS talked (even through a watch dog) to the backend. Used to understand if the workstation is online or offlline/crashed]]></comment>
			</column>
			<column name="LastClientVersion" type="varchar" length="15" decimal="0" jt="12" >
				<comment><![CDATA[For POSs, software version on the last POS connections]]></comment>
			</column>
			<column name="LastClientIPAddress" type="varchar" length="30" decimal="0" jt="12" >
				<comment><![CDATA[IP address of the workstation registered on last communication with client]]></comment>
			</column>
			<column name="LastLoginRights" type="nvarchar(max)" jt="12" >
				<comment><![CDATA[Consolidated workstation rights]]></comment>
			</column>
			<column name="LoggedUserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[User currently logged into the workstation (field gets cleared on user logout)]]></comment>
			</column>
			<column name="DeviceCode" type="varchar" length="50" decimal="0" jt="12" >
				<comment><![CDATA[Used for mobile workstations, it is the mobile device identificator]]></comment>
			</column>
			<column name="ApiSecurityType" type="smallint" jt="5" >
				<comment><![CDATA[LK[356] Indicates which level/methodology of API security is implemented]]></comment>
			</column>
			<column name="ApiEncryptionKey" type="varchar(max)" length="0" decimal="0" jt="12" >
				<comment><![CDATA[API client private encryption key]]></comment>
			</column>
			<column name="ApiRotationKey" type="varchar(max)" length="0" decimal="0" jt="12" >
				<comment><![CDATA[API client rotation key]]></comment>
			</column>
			<column name="ApiLastKeyRotation" type="datetime" jt="92" >
				<comment><![CDATA[Date/time when API keys were last rotated]]></comment>
			</column>
			<column name="ApiDebugMode" type="bit" length="1" jt="-7" >
				<comment><![CDATA[If active, the backend will send detailed error stack traces to the client]]></comment>
			</column>
			<column name="ChannelGroupTagId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Statistical grouping]]></comment>
			</column>
			<column name="LastUpdate" type="datetime" jt="92" />
			<index name="UQ_Workstation_Code" unique="UNIQUE_KEY" >
				<column name="LicenseId" options="ASC" />
				<column name="WorkstationCode" options="ASC" />
			</index>
			<index name="UQ_Workstation_StationSerial" unique="UNIQUE_KEY" options="where StationSerial is not null and StationSerial &lt;&gt; 0" >
				<column name="LicenseId" options="ASC" />
				<column name="StationSerial" options="ASC" />
			</index>
			<index name="UQ_Workstation_ActivationKey" unique="UNIQUE_KEY" options="where ActivationKey is not null" >
				<column name="ActivationKey" options="ASC" />
			</index>
			<index name="UQ_Worstation_WorkstationURI" unique="UNIQUE_KEY" options="where WorkstationURI is not null" >
				<column name="WorkstationURI" options="ASC" />
			</index>
			<index name="IX_Workstation_CategoryId" unique="NORMAL" >
				<column name="CategoryId" options="ASC" />
			</index>
			<index name="IX_Workstation_LocationId" unique="NORMAL" >
				<column name="LocationAccountId" options="ASC" />
			</index>
			<index name="IX_Workstation_OpAreaId" unique="NORMAL" >
				<column name="OpAreaAccountId" options="ASC" />
			</index>
			<index name="IX_Workstation_LoggedUserAccountId" unique="NORMAL" >
				<column name="LoggedUserAccountId" options="ASC" />
			</index>
			<index name="IX_Workstation_LastUserAccountId" unique="NORMAL" >
				<column name="LastUserAccountId" options="ASC" />
			</index>
			<index name="IX_Workstation_DeviceCode" unique="NORMAL" >
				<column name="DeviceCode" options="ASC" />
			</index>
			<index name="PK_Workstation" unique="PRIMARY_KEY" >
				<column name="WorkstationId" />
			</index>
			<index name="IX_Workstation_ChannelGroupTagId" unique="NORMAL" options="where ChannelGroupTagId is not null" >
				<column name="ChannelGroupTagId" />
			</index>
			<index name="IX_Workstation_SaleChannelId" unique="NORMAL" options="where SaleChannelId is not null" >
				<column name="SaleChannelId" />
			</index>
			<fk name="FK_Workstation_LocationAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LocationAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Workstation_OpAreaAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="OpAreaAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Workstation_LastUserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LastUserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Workstation_LoggedUserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="LoggedUserAccountId" pk="AccountId" />
			</fk>
			<fk name="FK_Workstation_SaleChannel" to_schema="SnApp.dbo" to_table="tbSaleChannel" >
				<fk_column name="SaleChannelId" pk="SaleChannelId" />
			</fk>
			<fk name="FK_Workstation_Category" to_schema="SnApp.dbo" to_table="tbCategory" >
				<fk_column name="CategoryId" pk="CategoryId" />
			</fk>
			<fk name="FK_Workstation_License" to_schema="SnApp.dbo" to_table="tbLicense" >
				<fk_column name="LicenseId" pk="LicenseId" />
			</fk>
			<fk name="FK_Workstation_Tag" to_schema="SnApp.dbo" to_table="tbTag" >
				<fk_column name="ChannelGroupTagId" pk="TagId" />
			</fk>
		</table>
		<table name="tbWorkstation2AccessPoint" >
			<comment><![CDATA[List all access points "monitored" by a workstation]]></comment>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="AptWorkstationId" type="uniqueidentifier" jt="1" mandatory="y" />
			<column name="PriorityOrder" type="int" length="1" decimal="0" jt="4" mandatory="y" />
			<index name="IX_Workstation2AccessPoint_AptWorkstationId" unique="NORMAL" >
				<column name="AptWorkstationId" options="ASC" />
			</index>
			<index name="PK_Workstation2AccessPoint" unique="PRIMARY_KEY" >
				<column name="WorkstationId" />
				<column name="AptWorkstationId" />
			</index>
			<fk name="FK_Workstation2AccessPoint_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_Workstation2AccessPoint_AccessPoint" to_schema="SnApp.dbo" to_table="tbAccessPoint" >
				<fk_column name="AptWorkstationId" pk="AptWorkstationId" />
			</fk>
		</table>
		<table name="tbWorkstationActivity" prior="Tbl" >
			<comment><![CDATA[Keeps track of workstation's login/logout and online/offline]]></comment>
			<column name="WorkstationActivityId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Internal ID]]></comment>
			</column>
			<column name="WorkstationId" type="uniqueidentifier" jt="1" mandatory="y" >
				<comment><![CDATA[Reference to the workstation when the operation/activity occurred]]></comment>
			</column>
			<column name="FiscalDate" type="date" jt="91" mandatory="y" >
				<comment><![CDATA[Fiscal date (relative to the workstation) the the operation/activity happened]]></comment>
			</column>
			<column name="ActivityDateTime" type="datetime" jt="92" mandatory="y" >
				<comment><![CDATA[Date/Time (at server timezone) when the operation/activity happened]]></comment>
			</column>
			<column name="ActivityType" type="smallint" jt="5" mandatory="y" >
				<comment><![CDATA[LK[436]]]></comment>
			</column>
			<column name="Online" type="bit" jt="-7" mandatory="y" >
				<comment><![CDATA[1=Online, 0=Offline
In case of ActivityType=ConnectionStatusChange, "1=Online" means we went from "offline" to "online"]]></comment>
			</column>
			<column name="UserAccountId" type="uniqueidentifier" jt="1" >
				<comment><![CDATA[Reference to the user logged-in at the time of the operation/activity]]></comment>
			</column>
			<index name="PK_WorkstationActivity" unique="PRIMARY_KEY" >
				<column name="WorkstationActivityId" />
			</index>
			<index name="IX_WorkstationActivity_WorkstationId" unique="NORMAL" >
				<column name="WorkstationId" />
				<column name="ActivityDateTime" />
			</index>
			<index name="IX_WorkstationActivity_FiscalDate" unique="NORMAL" >
				<column name="FiscalDate" />
				<column name="WorkstationId" />
				<column name="ActivityDateTime" />
			</index>
			<index name="IX_WorkstationActivity_UserAccountId" unique="NORMAL" options="WHERE UserAccountId is not null" >
				<column name="UserAccountId" />
				<column name="ActivityDateTime" />
			</index>
			<fk name="FK_WorkstationActivity_Workstation" to_schema="SnApp.dbo" to_table="tbWorkstation" delete_action="cascade" >
				<fk_column name="WorkstationId" pk="WorkstationId" />
			</fk>
			<fk name="FK_WorkstationActivity_UserAccount" to_schema="SnApp.dbo" to_table="tbAccount" >
				<fk_column name="UserAccountId" pk="AccountId" />
			</fk>
		</table>
	</schema>
	<layout name="SnApp 3.598" id="DefaultLayout_001" show_relation="columns" >
		<entity schema="SnApp.dbo" name="tbAccessPoint" color="B9FFFF" x="9408" y="5056" />
		<entity schema="SnApp.dbo" name="tbAccessPoint2Area" color="B9FFFF" x="8592" y="5216" />
		<entity schema="SnApp.dbo" name="tbAccessPointDescription" color="B9FFFF" x="9696" y="5056" />
		<entity schema="SnApp.dbo" name="tbAccount" color="80FF80" x="4672" y="4544" />
		<entity schema="SnApp.dbo" name="tbAccount2Plugin" color="C1FFC1" x="5536" y="4928" />
		<entity schema="SnApp.dbo" name="tbAccount2Role" color="C1FFC1" x="4176" y="4928" />
		<entity schema="SnApp.dbo" name="tbAccountAccessArea" color="80FF80" x="4000" y="4448" />
		<entity schema="SnApp.dbo" name="tbAccountAssociation" color="C1FFC1" x="5696" y="5424" />
		<entity schema="SnApp.dbo" name="tbAccountContext" color="EAEAEA" x="5760" y="752" />
		<entity schema="SnApp.dbo" name="tbAccountCrossPlatform" color="C1FFC1" x="5248" y="5440" />
		<entity schema="SnApp.dbo" name="tbAccountCrossPlatformParam" color="C1FFC1" x="5264" y="5664" />
		<entity schema="SnApp.dbo" name="tbAccountDepositLog" color="FFFF80" x="3792" y="3840" />
		<entity schema="SnApp.dbo" name="tbAccountDetail" color="C1FFC1" x="4224" y="3728" />
		<entity schema="SnApp.dbo" name="tbAccountExposureLog" color="FFFF80" x="3792" y="4080" />
		<entity schema="SnApp.dbo" name="tbAccountFinance" color="C1FFC1" x="4656" y="5168" />
		<entity schema="SnApp.dbo" name="tbAccountFlag" color="C1FFC1" x="4608" y="5888" />
		<entity schema="SnApp.dbo" name="tbAccountInventoryBalance" color="C1FFC1" x="5360" y="3472" />
		<entity schema="SnApp.dbo" name="tbAccountOpArea" color="80FF80" x="4400" y="4368" />
		<entity schema="SnApp.dbo" name="tbAccountOpenOrderLog" color="FFFF80" x="3760" y="4272" />
		<entity schema="SnApp.dbo" name="tbAccountRelation" color="C1FFC1" x="3760" y="5728" />
		<entity schema="SnApp.dbo" name="tbAccountResource" color="C1FFC1" x="10304" y="10128" />
		<entity schema="SnApp.dbo" name="tbAccountTaxExempt" color="C1FFC1" x="5040" y="5216" />
		<entity schema="SnApp.dbo" name="tbAccountTaxExempt2Tax" color="80FF80" x="5024" y="5376" />
		<entity schema="SnApp.dbo" name="tbAccountTemp" color="80FF80" x="5120" y="4768" />
		<entity schema="SnApp.dbo" name="tbAccountUserLimit" color="C1FFC1" x="4224" y="5120" />
		<entity schema="SnApp.dbo" name="tbAction" color="C1FFC1" x="5248" y="3856" />
		<entity schema="SnApp.dbo" name="tbActionLink" color="C1FFC1" x="5440" y="4176" />
		<entity schema="SnApp.dbo" name="tbActivityLog" color="EAEAEA" x="10624" y="3760" />
		<entity schema="SnApp.dbo" name="tbApiFirewall" color="EAEAEA" x="224" y="10496" />
		<entity schema="SnApp.dbo" name="tbApiFirewallAddress" color="EAEAEA" x="464" y="10848" />
		<entity schema="SnApp.dbo" name="tbApiFirewallService" color="EAEAEA" x="832" y="10528" />
		<entity schema="SnApp.dbo" name="tbApiLog" color="EAEAEA" x="224" y="4352" />
		<entity schema="SnApp.dbo" name="tbApiLogLink" color="EAEAEA" x="704" y="4400" />
		<entity schema="SnApp.dbo" name="tbAssociation2Mask" color="C1FFC1" x="6256" y="5664" />
		<entity schema="SnApp.dbo" name="tbAssociation2Product" color="C1FFC1" x="5824" y="5824" />
		<entity schema="SnApp.dbo" name="tbAsyncFinalize" color="EAEAEA" x="384" y="9872" />
		<entity schema="SnApp.dbo" name="tbAsyncFinalizeConsQueue" color="EAEAEA" x="432" y="10160" />
		<entity schema="SnApp.dbo" name="tbAsyncFinalizeStat" color="EAEAEA" x="192" y="10160" />
		<entity schema="SnApp.dbo" name="tbAsyncProcess" color="EAEAEA" x="2080" y="8096" />
		<entity schema="SnApp.dbo" name="tbAsyncProcessItem" color="EAEAEA" x="1680" y="8368" />
		<entity schema="SnApp.dbo" name="tbAsyncProcessLog" color="EAEAEA" x="1568" y="8160" />
		<entity schema="SnApp.dbo" name="tbAttribute" color="FFCAFF" x="5824" y="9184" />
		<entity schema="SnApp.dbo" name="tbAttributeItem" color="FFCAFF" x="5584" y="8720" />
		<entity schema="SnApp.dbo" name="tbAuth" color="FFFF80" x="3104" y="144" />
		<entity schema="SnApp.dbo" name="tbBiometric" color="EAEAEA" x="1376" y="10688" />
		<entity schema="SnApp.dbo" name="tbBiometricExternalPurge" color="CBBBB4" x="1744" y="10608" />
		<entity schema="SnApp.dbo" name="tbBox" color="FFFF80" x="2352" y="2864" />
		<entity schema="SnApp.dbo" name="tbBoxContent" color="FFFF80" x="2448" y="3264" />
		<entity schema="SnApp.dbo" name="tbBoxDeposit" color="FFFF80" x="2080" y="3392" />
		<entity schema="SnApp.dbo" name="tbBoxDepositBreakdown" color="FFFF80" x="2304" y="3824" />
		<entity schema="SnApp.dbo" name="tbBoxDepositDetail" color="FFFF80" x="2480" y="3536" />
		<entity schema="SnApp.dbo" name="tbBoxDepositIntercompany" color="FFFF00" x="2656" y="3824" />
		<entity schema="SnApp.dbo" name="tbBoxWarn" color="C1D8EE" x="2752" y="2864" />
		<entity schema="SnApp.dbo" name="tbBroadcast" color="EAEAEA" x="2736" y="11168" />
		<entity schema="SnApp.dbo" name="tbCalendar" color="EAEAEA" x="2016" y="4752" />
		<entity schema="SnApp.dbo" name="tbCalendarDetail" color="EAEAEA" x="2304" y="5056" />
		<entity schema="SnApp.dbo" name="tbCaptcha" color="EAEAEA" x="896" y="10928" />
		<entity schema="SnApp.dbo" name="tbCardType" color="FFCAFF" x="2352" y="7456" />
		<entity schema="SnApp.dbo" name="tbCardTypeRange" color="FFCAFF" x="2352" y="7712" />
		<entity schema="SnApp.dbo" name="tbCatalog" color="FFCAFF" x="3808" y="11360" />
		<entity schema="SnApp.dbo" name="tbCatalogCache" color="FFCAFF" x="3328" y="11664" />
		<entity schema="SnApp.dbo" name="tbCatalogRule" color="FFCAFF" x="3408" y="11360" />
		<entity schema="SnApp.dbo" name="tbCategory" color="EAEAEA" x="5072" y="528" />
		<entity schema="SnApp.dbo" name="tbCategory2Entity" color="EAEAEA" x="5760" y="528" />
		<entity schema="SnApp.dbo" name="tbCategory2Location" color="EAEAEA" x="1888" y="4016" />
		<entity schema="SnApp.dbo" name="tbCategory2Mask" color="EAEAEA" x="1232" y="4032" />
		<entity schema="SnApp.dbo" name="tbCodeAlias" color="EAEAEA" x="2176" y="9584" />
		<entity schema="SnApp.dbo" name="tbCodeAliasType" color="EAEAEA" x="1600" y="9344" />
		<entity schema="SnApp.dbo" name="tbCommission" color="FFCAFF" x="6176" y="9424" />
		<entity schema="SnApp.dbo" name="tbCommissionDetail" color="FFCAFF" x="5840" y="10736" />
		<entity schema="SnApp.dbo" name="tbConfigLang" color="EAEAEA" x="752" y="11920" />
		<entity schema="SnApp.dbo" name="tbConsAPI" color="F9F9E6" x="8096" y="11536" />
		<entity schema="SnApp.dbo" name="tbConsAccess" color="F9F9E6" x="6784" y="10944" />
		<entity schema="SnApp.dbo" name="tbConsAccountSale" color="F9F9E6" x="8400" y="11088" />
		<entity schema="SnApp.dbo" name="tbConsExtProductType" color="F9F9E6" x="7056" y="12208" />
		<entity schema="SnApp.dbo" name="tbConsPayment" color="F9F9E6" x="7712" y="11040" />
		<entity schema="SnApp.dbo" name="tbConsRotation" color="F9F9E6" x="7504" y="11808" />
		<entity schema="SnApp.dbo" name="tbConsRotationQueue" color="FFFF80" x="7552" y="11472" />
		<entity schema="SnApp.dbo" name="tbConsRotationQueueConsQueue" color="FFFF80" x="6912" y="11536" />
		<entity schema="SnApp.dbo" name="tbConsSale" color="F9F9E6" x="7312" y="11056" />
		<entity schema="SnApp.dbo" name="tbConsServer" color="F9F9E6" x="8624" y="11600" />
		<entity schema="SnApp.dbo" name="tbConsUpsell" color="FFFF80" x="1008" y="1696" />
		<entity schema="SnApp.dbo" name="tbCorrelation" color="EAEAEA" x="352" y="5056" />
		<entity schema="SnApp.dbo" name="tbCryptoKey" color="EAEAEA" x="256" y="6096" />
		<entity schema="SnApp.dbo" name="tbCurrency" color="EAEAEA" x="832" y="7792" />
		<entity schema="SnApp.dbo" name="tbCurrencyDetail" color="EAEAEA" x="320" y="7808" />
		<entity schema="SnApp.dbo" name="tbDBInfo" color="EAEAEA" x="576" y="12992" />
		<entity schema="SnApp.dbo" name="tbDataSource" color="EAEAEA" x="960" y="8608" />
		<entity schema="SnApp.dbo" name="tbDatabaseUpdate" color="EAEAEA" x="192" y="11840" />
		<entity schema="SnApp.dbo" name="tbDocContext" color="FF8040" x="9088" y="9744" />
		<entity schema="SnApp.dbo" name="tbDocParam" color="FF8040" x="9072" y="9392" />
		<entity schema="SnApp.dbo" name="tbDocTemplate" color="FF8040" x="8704" y="9296" />
		<entity schema="SnApp.dbo" name="tbDocTemplate2DocTemplate" color="CBBBB4" x="8704" y="9952" />
		<entity schema="SnApp.dbo" name="tbDocTemplate2Driver" color="FF8040" x="8432" y="9408" />
		<entity schema="SnApp.dbo" name="tbDocketDevice" color="B9FFFF" x="9872" y="4272" />
		<entity schema="SnApp.dbo" name="tbDocketDevice2OpArea" color="B9FFFF" x="9712" y="4672" />
		<entity schema="SnApp.dbo" name="tbDriver" color="B9FFFF" x="7824" y="4944" />
		<entity schema="SnApp.dbo" name="tbDriverFramework" color="B9FFFF" x="7680" y="5456" />
		<entity schema="SnApp.dbo" name="tbEntitlement" color="FFCAFF" x="3968" y="6288" />
		<entity schema="SnApp.dbo" name="tbEntitlement2Event" color="FFCAFF" x="4320" y="6768" />
		<entity schema="SnApp.dbo" name="tbEntitlementVersion" color="FFCAFF" x="3648" y="6464" />
		<entity schema="SnApp.dbo" name="tbEntityChange" color="EAEAEA" x="1040" y="12512" />
		<entity schema="SnApp.dbo" name="tbEntityLink" color="EAEAEA" x="288" y="13120" />
		<entity schema="SnApp.dbo" name="tbEntityRight" color="EAEAEA" x="704" y="11520" />
		<entity schema="SnApp.dbo" name="tbEntityTab" color="EAEAEA" x="1040" y="12688" />
		<entity schema="SnApp.dbo" name="tbEvent" color="FFCAFF" x="4640" y="6768" />
		<entity schema="SnApp.dbo" name="tbEvent2ResourceType" color="FFCAFF" x="5248" y="6912" />
		<entity schema="SnApp.dbo" name="tbEventCapacityThreshold" color="FFCAFF" x="4144" y="6912" />
		<entity schema="SnApp.dbo" name="tbEventCapacityThresholdDetail" color="FFCAFF" x="4144" y="7120" />
		<entity schema="SnApp.dbo" name="tbEventCategory" color="FFCAFF" x="5232" y="10096" />
		<entity schema="SnApp.dbo" name="tbEventCategoryLink" color="FFCAFF" x="5216" y="10400" />
		<entity schema="SnApp.dbo" name="tbEventDynRateCode" color="FFCAFF" x="4784" y="8048" />
		<entity schema="SnApp.dbo" name="tbEventDynSaleChannel" color="FFCAFF" x="4448" y="7920" />
		<entity schema="SnApp.dbo" name="tbEventFlag" color="FFCAFF" x="4480" y="6400" />
		<entity schema="SnApp.dbo" name="tbEventItinerary" color="FFCAFF" x="5360" y="8416" />
		<entity schema="SnApp.dbo" name="tbExtMediaBatch" color="FFB3B3" x="8224" y="1616" />
		<entity schema="SnApp.dbo" name="tbExtMediaBatchDetail" color="FFB3B3" x="7968" y="2096" />
		<entity schema="SnApp.dbo" name="tbExtMediaCode" color="FFB3B3" x="9296" y="1872" />
		<entity schema="SnApp.dbo" name="tbExtMediaGroup" color="FFB3B3" x="8736" y="1696" />
		<entity schema="SnApp.dbo" name="tbExtProductType" color="FFB3B3" x="8560" y="2112" />
		<entity schema="SnApp.dbo" name="tbExtProductTypeLog" color="FFB3B3" x="8256" y="2448" />
		<entity schema="SnApp.dbo" name="tbExtProductTypeLogConsQueue" color="3986C1" x="7984" y="2512" />
		<entity schema="SnApp.dbo" name="tbExtensionPackage" color="B9FFFF" x="8672" y="5456" />
		<entity schema="SnApp.dbo" name="tbExtensionPackageStatus" color="B9FFFF" x="8176" y="5584" />
		<entity schema="SnApp.dbo" name="tbFont" color="EAEAEA" x="288" y="6912" />
		<entity schema="SnApp.dbo" name="tbFullText" color="EAEAEA" x="688" y="12176" />
		<entity schema="SnApp.dbo" name="tbGateCategory" color="FFCAFF" x="5904" y="11472" />
		<entity schema="SnApp.dbo" name="tbGateCategory2Entity" color="FFCAFF" x="5488" y="11312" />
		<entity schema="SnApp.dbo" name="tbGrid" color="EAEAEA" x="2032" y="4400" />
		<entity schema="SnApp.dbo" name="tbHistoryDetail" color="EAEAEA" x="1776" y="7440" />
		<entity schema="SnApp.dbo" name="tbHistoryLog" color="EAEAEA" x="1744" y="6784" />
		<entity schema="SnApp.dbo" name="tbIndividualCoupon" color="FFB3B3" x="11376" y="688" />
		<entity schema="SnApp.dbo" name="tbInstallmentContract" color="FFFF80" x="2576" y="1648" />
		<entity schema="SnApp.dbo" name="tbInstallmentContract2Ticket" color="FFFF80" x="2960" y="1360" />
		<entity schema="SnApp.dbo" name="tbInstallmentContractDetail" color="FFFF80" x="3184" y="1504" />
		<entity schema="SnApp.dbo" name="tbInstallmentContractItem" color="FFFF80" x="3248" y="1936" />
		<entity schema="SnApp.dbo" name="tbInstallmentContractItemDetail" color="FFFF80" x="3792" y="1872" />
		<entity schema="SnApp.dbo" name="tbInstallmentContractTrigger" color="FFFF80" x="2896" y="2000" />
		<entity schema="SnApp.dbo" name="tbInstallmentPlan" color="FFCAFF" x="6800" y="7824" />
		<entity schema="SnApp.dbo" name="tbInstallmentPlanComm" color="FFCAFF" x="7392" y="8096" />
		<entity schema="SnApp.dbo" name="tbIntercompanyCostCenter" color="B9FFFF" x="7344" y="5680" />
		<entity schema="SnApp.dbo" name="tbInvoice" color="FFFF80" x="1568" y="3664" />
		<entity schema="SnApp.dbo" name="tbInvoiceItem" color="FFFF80" x="1296" y="3792" />
		<entity schema="SnApp.dbo" name="tbInvoicePayment" color="FFFF80" x="1072" y="3696" />
		<entity schema="SnApp.dbo" name="tbJob" color="EAEAEA" x="320" y="9264" />
		<entity schema="SnApp.dbo" name="tbLedger" color="FFFF80" x="3696" y="2192" />
		<entity schema="SnApp.dbo" name="tbLedgerAccount" color="EAEAEA" x="4688" y="1504" />
		<entity schema="SnApp.dbo" name="tbLedgerClearing" color="FFFF80" x="5344" y="1872" />
		<entity schema="SnApp.dbo" name="tbLedgerDateTotal" color="FFFF80" x="4848" y="1984" />
		<entity schema="SnApp.dbo" name="tbLedgerManual" color="FFFF80" x="3600" y="2752" />
		<entity schema="SnApp.dbo" name="tbLedgerManualItem" color="FFFF80" x="3712" y="2448" />
		<entity schema="SnApp.dbo" name="tbLedgerRef" color="FFFF80" x="4256" y="2352" />
		<entity schema="SnApp.dbo" name="tbLedgerRule" color="EAEAEA" x="3744" y="784" />
		<entity schema="SnApp.dbo" name="tbLedgerRuleDetail" color="EAEAEA" x="4432" y="560" />
		<entity schema="SnApp.dbo" name="tbLedgerRuleFilter" color="EAEAEA" x="3968" y="1328" />
		<entity schema="SnApp.dbo" name="tbLedgerRuleFlag" color="EAEAEA" x="4304" y="1584" />
		<entity schema="SnApp.dbo" name="tbLedgerRuleTemplate" color="EAEAEA" x="4480" y="1136" />
		<entity schema="SnApp.dbo" name="tbLedgerRuleTemplate2Entity" color="EAEAEA" x="4976" y="1168" />
		<entity schema="SnApp.dbo" name="tbLedgerRuleTemplateDate" color="EAEAEA" x="4464" y="1328" />
		<entity schema="SnApp.dbo" name="tbLicense" color="00FFFF" x="8688" y="4656" />
		<entity schema="SnApp.dbo" name="tbLock" color="EAEAEA" x="9600" y="2928" />
		<entity schema="SnApp.dbo" name="tbLog" color="EAEAEA" x="10160" y="3808" />
		<entity schema="SnApp.dbo" name="tbLogin" color="C1FFC1" x="3840" y="4688" />
		<entity schema="SnApp.dbo" name="tbLoginAlias" color="C1FFC1" x="3632" y="4880" />
		<entity schema="SnApp.dbo" name="tbLoginStats" color="F9F9E6" x="6512" y="11776" />
		<entity schema="SnApp.dbo" name="tbLookupItem" color="EAEAEA" x="608" y="12768" />
		<entity schema="SnApp.dbo" name="tbLookupTable" color="EAEAEA" x="224" y="12688" />
		<entity schema="SnApp.dbo" name="tbMask" color="EAEAEA" x="1136" y="5456" />
		<entity schema="SnApp.dbo" name="tbMask2Entity" color="EAEAEA" x="1424" y="5696" />
		<entity schema="SnApp.dbo" name="tbMaskItem" color="EAEAEA" x="1088" y="5840" />
		<entity schema="SnApp.dbo" name="tbMaskItemCondition" color="EAEAEA" x="1376" y="6000" />
		<entity schema="SnApp.dbo" name="tbMeasure" color="FFCAFF" x="5040" y="11744" />
		<entity schema="SnApp.dbo" name="tbMeasureConversion" color="FFCAFF" x="4512" y="11952" />
		<entity schema="SnApp.dbo" name="tbMeasureProfile" color="FFCAFF" x="4528" y="11504" />
		<entity schema="SnApp.dbo" name="tbMedia" color="FFB3B3" x="11008" y="1488" />
		<entity schema="SnApp.dbo" name="tbMediaCode" color="FFB3B3" x="11536" y="1696" />
		<entity schema="SnApp.dbo" name="tbMembershipPoint" color="EAEAEA" x="6640" y="5584" />
		<entity schema="SnApp.dbo" name="tbMembershipPointAccrualRule" color="FF80FF" x="6272" y="6048" />
		<entity schema="SnApp.dbo" name="tbMembershipPointAccrualRule2PaymentMethod" color="FF80FF" x="6864" y="6256" />
		<entity schema="SnApp.dbo" name="tbMembershipPointExchangeRate" color="EAEAEA" x="6640" y="6048" />
		<entity schema="SnApp.dbo" name="tbMerchant" color="EAEAEA" x="1696" y="5584" />
		<entity schema="SnApp.dbo" name="tbMessage" color="EAEAEA" x="2208" y="10864" />
		<entity schema="SnApp.dbo" name="tbMessageRead" color="EAEAEA" x="1376" y="11232" />
		<entity schema="SnApp.dbo" name="tbMetaData" color="EAEAEA" x="432" y="5696" />
		<entity schema="SnApp.dbo" name="tbMetaField" color="EAEAEA" x="832" y="5440" />
		<entity schema="SnApp.dbo" name="tbMetaFieldFlag" color="EAEAEA" x="960" y="5184" />
		<entity schema="SnApp.dbo" name="tbMetaFieldGroup" color="FF8080" x="352" y="5392" />
		<entity schema="SnApp.dbo" name="tbMetaFieldItem" color="EAEAEA" x="752" y="6064" />
		<entity schema="SnApp.dbo" name="tbNote" color="EAEAEA" x="1568" y="5088" />
		<entity schema="SnApp.dbo" name="tbNotifyLog" color="EAEAEA" x="960" y="14000" />
		<entity schema="SnApp.dbo" name="tbNotifyLogRef" color="EAEAEA" x="1184" y="14000" />
		<entity schema="SnApp.dbo" name="tbNotifyRule" color="EAEAEA" x="960" y="13632" />
		<entity schema="SnApp.dbo" name="tbNotifyRule2Category" color="EAEAEA" x="896" y="13440" />
		<entity schema="SnApp.dbo" name="tbNotifyRule2Event" color="EAEAEA" x="672" y="13440" />
		<entity schema="SnApp.dbo" name="tbNotifyRule2Location" color="EAEAEA" x="1120" y="13440" />
		<entity schema="SnApp.dbo" name="tbNotifyRuleEntityChange" color="EAEAEA" x="1360" y="13520" />
		<entity schema="SnApp.dbo" name="tbNotifyRuleFlag" color="EAEAEA" x="752" y="14000" />
		<entity schema="SnApp.dbo" name="tbNotifyRuleOrder" color="EAEAEA" x="528" y="13552" />
		<entity schema="SnApp.dbo" name="tbNotifyRuleOrder2Sale" color="EAEAEA" x="528" y="13808" />
		<entity schema="SnApp.dbo" name="tbNotifyRuleRedemption2Type" color="EAEAEA" x="1360" y="13632" />
		<entity schema="SnApp.dbo" name="tbNotifyRuleSale" color="EAEAEA" x="1360" y="13744" />
		<entity schema="SnApp.dbo" name="tbNotifyRuleUser" color="EAEAEA" x="1376" y="13904" />
		<entity schema="SnApp.dbo" name="tbOpArea2AccessArea" color="B9FFFF" x="7216" y="5024" />
		<entity schema="SnApp.dbo" name="tbOpArea2Role" color="C1FFC1" x="5728" y="5280" />
		<entity schema="SnApp.dbo" name="tbOptionSet" color="FFCAFF" x="5856" y="8336" />
		<entity schema="SnApp.dbo" name="tbOptionSetDetail" color="FFCAFF" x="6128" y="8560" />
		<entity schema="SnApp.dbo" name="tbOutboundMessage" color="EAEAEA" x="7664" y="7168" />
		<entity schema="SnApp.dbo" name="tbOutboundOffline" color="EAEAEA" x="9088" y="7456" />
		<entity schema="SnApp.dbo" name="tbOutboundQueue" color="EAEAEA" x="8224" y="7728" />
		<entity schema="SnApp.dbo" name="tbOutboundQueueHistory" color="EAEAEA" x="8608" y="6960" />
		<entity schema="SnApp.dbo" name="tbOutboundQueueHistoryConsQueue" color="EAEAEA" x="8320" y="7312" />
		<entity schema="SnApp.dbo" name="tbOutboundQueueItem" color="EAEAEA" x="9088" y="8048" />
		<entity schema="SnApp.dbo" name="tbOutboundTrigger" color="EAEAEA" x="9776" y="7712" />
		<entity schema="SnApp.dbo" name="tbPPURule" color="FFCAFF" x="2656" y="12304" />
		<entity schema="SnApp.dbo" name="tbPPURuleLink" color="FFCAFF" x="2704" y="12848" />
		<entity schema="SnApp.dbo" name="tbPasswordHistory" color="C1FFC1" x="3424" y="4400" />
		<entity schema="SnApp.dbo" name="tbPayment" color="FFFF80" x="1872" y="528" />
		<entity schema="SnApp.dbo" name="tbPaymentCard" color="FFFF80" x="2656" y="48" />
		<entity schema="SnApp.dbo" name="tbPaymentCredit" color="FFFF80" x="2512" y="912" />
		<entity schema="SnApp.dbo" name="tbPaymentCurrency" color="FFFF80" x="2480" y="704" />
		<entity schema="SnApp.dbo" name="tbPaymentData" color="FFFF80" x="2096" y="192" />
		<entity schema="SnApp.dbo" name="tbPaymentDoc" color="FFFF80" x="3024" y="960" />
		<entity schema="SnApp.dbo" name="tbPaymentInstallment" color="FFFF80" x="1824" y="1136" />
		<entity schema="SnApp.dbo" name="tbPaymentIntercompany" color="FFFF80" x="2256" y="1232" />
		<entity schema="SnApp.dbo" name="tbPaymentMembership" color="FFFF80" x="2128" y="608" />
		<entity schema="SnApp.dbo" name="tbPaymentProfile" color="FFCAFF" x="2912" y="6832" />
		<entity schema="SnApp.dbo" name="tbPaymentProfile2InstallmentPlan" color="FFCAFF" x="3248" y="7168" />
		<entity schema="SnApp.dbo" name="tbPaymentProfileMembershipPoint" color="FFCAFF" x="2752" y="7200" />
		<entity schema="SnApp.dbo" name="tbPaymentProfileMethod" color="FFCAFF" x="2432" y="7072" />
		<entity schema="SnApp.dbo" name="tbPaymentToken" color="C1FFC1" x="4832" y="3440" />
		<entity schema="SnApp.dbo" name="tbPaymentTokenData" color="80FF80" x="4832" y="3216" />
		<entity schema="SnApp.dbo" name="tbPaymentWallet" color="FFFF80" x="2448" y="384" />
		<entity schema="SnApp.dbo" name="tbPerformance" color="FFCAFF" x="5696" y="7040" />
		<entity schema="SnApp.dbo" name="tbPerformanceDetail" color="FFCAFF" x="6304" y="7360" />
		<entity schema="SnApp.dbo" name="tbPerformanceSet" color="FFCAFF" x="6400" y="6992" />
		<entity schema="SnApp.dbo" name="tbPerformanceSetDetail" color="FFCAFF" x="7040" y="7104" />
		<entity schema="SnApp.dbo" name="tbPerformanceType" color="FFCAFF" x="5184" y="7216" />
		<entity schema="SnApp.dbo" name="tbPlugin" color="B9FFFF" x="8176" y="4448" />
		<entity schema="SnApp.dbo" name="tbPlugin2PaymentMethod" color="B9FFFF" x="8464" y="4304" />
		<entity schema="SnApp.dbo" name="tbPluginPayment2IntercompanyCostCenter" color="B9FFFF" x="6336" y="3104" />
		<entity schema="SnApp.dbo" name="tbPluginPaymentMethod" color="B9FFFF" x="7376" y="3792" />
		<entity schema="SnApp.dbo" name="tbPortfolioInPerformance" color="FFB3B3" x="9792" y="2432" />
		<entity schema="SnApp.dbo" name="tbPortfolioShare" color="FFB3B3" x="11968" y="480" />
		<entity schema="SnApp.dbo" name="tbPortfolioSlot" color="FFB3B3" x="11632" y="1136" />
		<entity schema="SnApp.dbo" name="tbPortfolioSlotBalance" color="FFB3B3" x="11952" y="960" />
		<entity schema="SnApp.dbo" name="tbPortfolioSlotHold" color="EAEAEA" x="8816" y="2432" />
		<entity schema="SnApp.dbo" name="tbPortfolioSlotLog" color="FFFF80" x="12272" y="880" />
		<entity schema="SnApp.dbo" name="tbProduct" color="FF80FF" x="4000" y="7616" />
		<entity schema="SnApp.dbo" name="tbProduct2AttributeItem" color="FFCAFF" x="4912" y="8832" />
		<entity schema="SnApp.dbo" name="tbProduct2CardType" color="FFCAFF" x="2384" y="7280" />
		<entity schema="SnApp.dbo" name="tbProduct2DocTemplate" color="FFCAFF" x="6880" y="9504" />
		<entity schema="SnApp.dbo" name="tbProduct2Plugin" color="FFCAFF" x="5952" y="8016" />
		<entity schema="SnApp.dbo" name="tbProductAccountRule" color="FFCAFF" x="3456" y="10656" />
		<entity schema="SnApp.dbo" name="tbProductBOM" color="FFCAFF" x="5440" y="11696" />
		<entity schema="SnApp.dbo" name="tbProductCrossSell" color="FFCAFF" x="5552" y="6608" />
		<entity schema="SnApp.dbo" name="tbProductFamily" color="FFCAFF" x="3408" y="9776" />
		<entity schema="SnApp.dbo" name="tbProductFlag" color="FFCAFF" x="3872" y="6896" />
		<entity schema="SnApp.dbo" name="tbProductGuest" color="FFCAFF" x="3520" y="8416" />
		<entity schema="SnApp.dbo" name="tbProductMediaConstraint" color="FFCAFF" x="6544" y="9712" />
		<entity schema="SnApp.dbo" name="tbProductPackage" color="FFCAFF" x="4512" y="10112" />
		<entity schema="SnApp.dbo" name="tbProductPrice" color="FFCAFF" x="4720" y="9552" />
		<entity schema="SnApp.dbo" name="tbProductPriceAdvance" color="FFCAFF" x="5088" y="9552" />
		<entity schema="SnApp.dbo" name="tbProductPriceDate" color="FFCAFF" x="4880" y="9120" />
		<entity schema="SnApp.dbo" name="tbProductPriceMembershipPoint" color="FFCAFF" x="5440" y="9552" />
		<entity schema="SnApp.dbo" name="tbProductPriceVariable" color="FFCAFF" x="4608" y="9136" />
		<entity schema="SnApp.dbo" name="tbProductRefund" color="FFCAFF" x="5008" y="8528" />
		<entity schema="SnApp.dbo" name="tbProductRenewFromProduct" color="FFCAFF" x="3392" y="7904" />
		<entity schema="SnApp.dbo" name="tbProductRevenueDate" color="FFCAFF" x="4224" y="12384" />
		<entity schema="SnApp.dbo" name="tbProductRevenueDateWeight" color="FFCAFF" x="4544" y="12688" />
		<entity schema="SnApp.dbo" name="tbProductRevenueGateCategory" color="FFCAFF" x="4880" y="12384" />
		<entity schema="SnApp.dbo" name="tbProductShare" color="FFCAFF" x="5136" y="6544" />
		<entity schema="SnApp.dbo" name="tbProductSuspend" color="FFCAFF" x="3632" y="8784" />
		<entity schema="SnApp.dbo" name="tbProductUpgrade" color="FFCAFF" x="2592" y="7952" />
		<entity schema="SnApp.dbo" name="tbProductUpgrade2Location" color="FFCAFF" x="2960" y="7552" />
		<entity schema="SnApp.dbo" name="tbProductUpgrade2Product" color="FFCAFF" x="3408" y="8160" />
		<entity schema="SnApp.dbo" name="tbProductUpsell" color="FF80FF" x="4608" y="8512" />
		<entity schema="SnApp.dbo" name="tbProductVPT" color="FFCAFF" x="5488" y="12368" />
		<entity schema="SnApp.dbo" name="tbPromoAction" color="FFCAFF" x="3424" y="10928" />
		<entity schema="SnApp.dbo" name="tbPromoActionMembershipPoint" color="FFCAFF" x="4816" y="10496" />
		<entity schema="SnApp.dbo" name="tbPromoRule" color="FFCAFF" x="5024" y="13424" />
		<entity schema="SnApp.dbo" name="tbPromoTrigger" color="FFCAFF" x="4512" y="10624" />
		<entity schema="SnApp.dbo" name="tbQueueStat" color="F9F9E6" x="8048" y="12080" />
		<entity schema="SnApp.dbo" name="tbQueueWait" color="C1D8EE" x="8336" y="12080" />
		<entity schema="SnApp.dbo" name="tbRateCode" color="FFCAFF" x="5248" y="7808" />
		<entity schema="SnApp.dbo" name="tbReceiptSpool" color="FFFF80" x="1568" y="1872" />
		<entity schema="SnApp.dbo" name="tbRedemptionCommissionRule" color="FFCAFF" x="3312" y="12240" />
		<entity schema="SnApp.dbo" name="tbRedemptionCommissionRuleLink" color="FFCAFF" x="3264" y="12864" />
		<entity schema="SnApp.dbo" name="tbRelation" color="C1FFC1" x="3536" y="5968" />
		<entity schema="SnApp.dbo" name="tbRepository" color="EAEAEA" x="1024" y="7056" />
		<entity schema="SnApp.dbo" name="tbRepositoryIndex" color="EAEAEA" x="288" y="7488" />
		<entity schema="SnApp.dbo" name="tbResourceConfig" color="B9DFFF" x="11056" y="10016" />
		<entity schema="SnApp.dbo" name="tbResourceHold" color="C1D8EE" x="10416" y="9376" />
		<entity schema="SnApp.dbo" name="tbResourceSchedule" color="B9DFFF" x="10864" y="9136" />
		<entity schema="SnApp.dbo" name="tbResourceSerial" color="B9DFFF" x="11472" y="9392" />
		<entity schema="SnApp.dbo" name="tbResourceSkill" color="B9DFFF" x="11424" y="9984" />
		<entity schema="SnApp.dbo" name="tbResourceSkillLink" color="B9DFFF" x="11696" y="9888" />
		<entity schema="SnApp.dbo" name="tbResourceType" color="B9DFFF" x="10752" y="9712" />
		<entity schema="SnApp.dbo" name="tbRichDesc" color="EAEAEA" x="1216" y="12160" />
		<entity schema="SnApp.dbo" name="tbRight" color="EAEAEA" x="272" y="11456" />
		<entity schema="SnApp.dbo" name="tbRole" color="C1FFC1" x="3920" y="5088" />
		<entity schema="SnApp.dbo" name="tbSale" color="FFFF00" x="288" y="1024" />
		<entity schema="SnApp.dbo" name="tbSale2Account" color="FFFF80" x="496" y="1648" />
		<entity schema="SnApp.dbo" name="tbSale2Performance" color="FFFF80" x="352" y="2832" />
		<entity schema="SnApp.dbo" name="tbSale2SaleTab" color="FFFF80" x="144" y="816" />
		<entity schema="SnApp.dbo" name="tbSaleApprove" color="FFFF80" x="144" y="2128" />
		<entity schema="SnApp.dbo" name="tbSaleCapacity" color="FFCAFF" x="3008" y="10208" />
		<entity schema="SnApp.dbo" name="tbSaleCapacityAccount" color="FF80FF" x="3440" y="10096" />
		<entity schema="SnApp.dbo" name="tbSaleCapacityAccountDetail" color="FF80FF" x="3520" y="10288" />
		<entity schema="SnApp.dbo" name="tbSaleCapacityHold" color="FFCAFF" x="2656" y="10608" />
		<entity schema="SnApp.dbo" name="tbSaleCapacityLog" color="FFCAFF" x="2256" y="10448" />
		<entity schema="SnApp.dbo" name="tbSaleCapacitySlot" color="FFCAFF" x="2640" y="10144" />
		<entity schema="SnApp.dbo" name="tbSaleChannel" color="FFCAFF" x="3920" y="10112" />
		<entity schema="SnApp.dbo" name="tbSaleChannelPriceGroup" color="FFCAFF" x="3920" y="10496" />
		<entity schema="SnApp.dbo" name="tbSaleFlag" color="C1D8EE" x="608" y="1280" />
		<entity schema="SnApp.dbo" name="tbSaleItem" color="FFFF80" x="928" y="2480" />
		<entity schema="SnApp.dbo" name="tbSaleItem2AttributeItem" color="FFFF80" x="1600" y="3024" />
		<entity schema="SnApp.dbo" name="tbSaleItem2TimedTicketStatement" color="FFFF80" x="1504" y="3232" />
		<entity schema="SnApp.dbo" name="tbSaleItemAccrual" color="FFFF80" x="1264" y="3056" />
		<entity schema="SnApp.dbo" name="tbSaleItemData" color="FFFF80" x="1264" y="2656" />
		<entity schema="SnApp.dbo" name="tbSaleItemDepositAccount" color="FFFF80" x="1600" y="2240" />
		<entity schema="SnApp.dbo" name="tbSaleItemDetail" color="FFFF80" x="1968" y="1728" />
		<entity schema="SnApp.dbo" name="tbSaleItemDetailMaterial" color="FFFF80" x="2384" y="2320" />
		<entity schema="SnApp.dbo" name="tbSaleItemDetailRevalidate" color="FFFF80" x="2576" y="1360" />
		<entity schema="SnApp.dbo" name="tbSaleItemDetailRevenue" color="FFFF80" x="2000" y="2288" />
		<entity schema="SnApp.dbo" name="tbSaleItemDiscount" color="FFFF80" x="1600" y="2784" />
		<entity schema="SnApp.dbo" name="tbSaleItemDiscountPoint" color="FFFF80" x="2032" y="2656" />
		<entity schema="SnApp.dbo" name="tbSaleItemGiftCard" color="FFFF80" x="1296" y="3456" />
		<entity schema="SnApp.dbo" name="tbSaleItemInstallment" color="FFFF80" x="1584" y="2384" />
		<entity schema="SnApp.dbo" name="tbSaleItemPackage" color="FFFF80" x="672" y="3472" />
		<entity schema="SnApp.dbo" name="tbSaleItemPaymentTransaction" color="FFFF80" x="1184" y="2208" />
		<entity schema="SnApp.dbo" name="tbSaleItemResourceHold" color="FFFF80" x="1568" y="2592" />
		<entity schema="SnApp.dbo" name="tbSaleItemTax" color="FFFF80" x="624" y="3120" />
		<entity schema="SnApp.dbo" name="tbSaleItemVoucher" color="FFFF80" x="976" y="3536" />
		<entity schema="SnApp.dbo" name="tbSaleMembership" color="FFFF80" x="256" y="1840" />
		<entity schema="SnApp.dbo" name="tbSalePromotion" color="FFFF80" x="560" y="720" />
		<entity schema="SnApp.dbo" name="tbSaleRefund" color="FFFF80" x="3040" y="2288" />
		<entity schema="SnApp.dbo" name="tbSaleTab" color="FFFF80" x="304" y="480" />
		<entity schema="SnApp.dbo" name="tbSaleTable" color="FFFF80" x="560" y="192" />
		<entity schema="SnApp.dbo" name="tbSaleTempEmptyAccount" color="C1D8EE" x="48" y="2800" />
		<entity schema="SnApp.dbo" name="tbSaleToken" color="FFFF80" x="48" y="1648" />
		<entity schema="SnApp.dbo" name="tbSeat" color="CBBBB4" x="11856" y="7968" />
		<entity schema="SnApp.dbo" name="tbSeatEnvelope" color="CBBBB4" x="11440" y="6800" />
		<entity schema="SnApp.dbo" name="tbSeatHold" color="CBBBB4" x="11136" y="6480" />
		<entity schema="SnApp.dbo" name="tbSeatInfo" color="CBBBB4" x="12448" y="7696" />
		<entity schema="SnApp.dbo" name="tbSeatMap" color="CBBBB4" x="11168" y="7568" />
		<entity schema="SnApp.dbo" name="tbSeatPerformance" color="CBBBB4" x="11008" y="6896" />
		<entity schema="SnApp.dbo" name="tbSeatPerformanceCategory" color="CBBBB4" x="10512" y="6912" />
		<entity schema="SnApp.dbo" name="tbSeatPerformanceLink" color="CBBBB4" x="10656" y="7344" />
		<entity schema="SnApp.dbo" name="tbSeatSector" color="CBBBB4" x="11552" y="7168" />
		<entity schema="SnApp.dbo" name="tbSerial" color="EAEAEA" x="288" y="12912" />
		<entity schema="SnApp.dbo" name="tbServer" color="B9FFFF" x="8672" y="6144" />
		<entity schema="SnApp.dbo" name="tbServerParam" color="B9FFFF" x="9312" y="5888" />
		<entity schema="SnApp.dbo" name="tbServerProfile" color="B9FFFF" x="9344" y="6576" />
		<entity schema="SnApp.dbo" name="tbServerStartUp" color="B9FFFF" x="8064" y="5904" />
		<entity schema="SnApp.dbo" name="tbServerWarVersion" color="B9EBFF" x="9296" y="6176" />
		<entity schema="SnApp.dbo" name="tbServiceStatus" color="C1D8EE" x="8368" y="6384" />
		<entity schema="SnApp.dbo" name="tbSession" color="EAEAEA" x="1376" y="10048" />
		<entity schema="SnApp.dbo" name="tbSessionPool" color="EAEAEA" x="752" y="10080" />
		<entity schema="SnApp.dbo" name="tbSessionToken" color="EAEAEA" x="1824" y="10128" />
		<entity schema="SnApp.dbo" name="tbSessionTokenBlackList" color="EAEAEA" x="2176" y="10032" />
		<entity schema="SnApp.dbo" name="tbShopCart" color="FFFF80" x="256" y="3264" />
		<entity schema="SnApp.dbo" name="tbSiaeBox" color="C0CEBD" x="432" y="18384" />
		<entity schema="SnApp.dbo" name="tbSiaeCard" color="C0CEBD" x="48" y="18416" />
		<entity schema="SnApp.dbo" name="tbSiaeConfig" color="C0CEBD" x="480" y="19600" />
		<entity schema="SnApp.dbo" name="tbSiaeEvent" color="C0CEBD" x="704" y="19104" />
		<entity schema="SnApp.dbo" name="tbSiaeEventSector" color="C0CEBD" x="832" y="19552" />
		<entity schema="SnApp.dbo" name="tbSiaeLocation" color="C0CEBD" x="1376" y="18768" />
		<entity schema="SnApp.dbo" name="tbSiaeLog" color="C0CEBD" x="400" y="18640" />
		<entity schema="SnApp.dbo" name="tbSiaeLogAbbonamento" color="C0CEBD" x="224" y="20288" />
		<entity schema="SnApp.dbo" name="tbSiaeLookup" color="C0CEBD" x="288" y="19456" />
		<entity schema="SnApp.dbo" name="tbSiaeOrganizer" color="C0CEBD" x="1136" y="18656" />
		<entity schema="SnApp.dbo" name="tbSiaePerformance" color="C0CEBD" x="1104" y="19152" />
		<entity schema="SnApp.dbo" name="tbSiaePerformanceSector" color="C0CEBD" x="1040" y="19408" />
		<entity schema="SnApp.dbo" name="tbSiaeProduct" color="C0CEBD" x="704" y="18736" />
		<entity schema="SnApp.dbo" name="tbSiaeReport" color="C0CEBD" x="48" y="19280" />
		<entity schema="SnApp.dbo" name="tbSiaeSystem" color="C0CEBD" x="816" y="18384" />
		<entity schema="SnApp.dbo" name="tbSiaeTax" color="C0CEBD" x="1440" y="19056" />
		<entity schema="SnApp.dbo" name="tbSiaeTaxRate" color="C0CEBD" x="1536" y="19168" />
		<entity schema="SnApp.dbo" name="tbSiaeWorkstation" color="C0CEBD" x="1536" y="18656" />
		<entity schema="SnApp.dbo" name="tbSignature" color="FFFF80" x="4416" y="144" />
		<entity schema="SnApp.dbo" name="tbStatDate" color="EAEAEA" x="9600" y="11472" />
		<entity schema="SnApp.dbo" name="tbStatTime" color="EAEAEA" x="10288" y="11568" />
		<entity schema="SnApp.dbo" name="tbSurvey" color="EAEAEA" x="1376" y="4768" />
		<entity schema="SnApp.dbo" name="tbSurvey2Mask" color="EAEAEA" x="1392" y="4512" />
		<entity schema="SnApp.dbo" name="tbTag" color="EAEAEA" x="1200" y="6512" />
		<entity schema="SnApp.dbo" name="tbTagLink" color="EAEAEA" x="832" y="6368" />
		<entity schema="SnApp.dbo" name="tbTask" color="EAEAEA" x="304" y="8208" />
		<entity schema="SnApp.dbo" name="tbTask2ServerProfile" color="FFB3B3" x="688" y="8496" />
		<entity schema="SnApp.dbo" name="tbTaskDataExport" color="EAEAEA" x="816" y="8272" />
		<entity schema="SnApp.dbo" name="tbTaskTrigger" color="EAEAEA" x="928" y="9120" />
		<entity schema="SnApp.dbo" name="tbTax" color="FFCAFF" x="2784" y="9184" />
		<entity schema="SnApp.dbo" name="tbTaxBracket" color="FFCAFF" x="3344" y="9328" />
		<entity schema="SnApp.dbo" name="tbTaxLocation" color="FFCAFF" x="2592" y="9872" />
		<entity schema="SnApp.dbo" name="tbTaxProfile" color="FFCAFF" x="2576" y="8688" />
		<entity schema="SnApp.dbo" name="tbTaxProfile2Tax" color="FFCAFF" x="2592" y="8944" />
		<entity schema="SnApp.dbo" name="tbTaxRate" color="FFCAFF" x="2960" y="9776" />
		<entity schema="SnApp.dbo" name="tbTicket" color="FFB3B3" x="10256" y="656" />
		<entity schema="SnApp.dbo" name="tbTicket2Event" color="EAEAEA" x="11536" y="80" />
		<entity schema="SnApp.dbo" name="tbTicketAmortization" color="FFB3B3" x="11984" y="1392" />
		<entity schema="SnApp.dbo" name="tbTicketElectronic" color="FFB3B3" x="9952" y="688" />
		<entity schema="SnApp.dbo" name="tbTicketElectronicData" color="FFB3B3" x="9952" y="880" />
		<entity schema="SnApp.dbo" name="tbTicketFacePrice" color="FFB3B3" x="10496" y="288" />
		<entity schema="SnApp.dbo" name="tbTicketGuest" color="FFB3B3" x="9696" y="1728" />
		<entity schema="SnApp.dbo" name="tbTicketGuestLink" color="EAEAEA" x="10080" y="1712" />
		<entity schema="SnApp.dbo" name="tbTicketIncProd" color="FFB3B3" x="9808" y="384" />
		<entity schema="SnApp.dbo" name="tbTicketLedgerTrigger" color="FFB3B3" x="10864" y="1024" />
		<entity schema="SnApp.dbo" name="tbTicketLocker" color="FFB3B3" x="8864" y="352" />
		<entity schema="SnApp.dbo" name="tbTicketMediaMatch" color="FF8080" x="11088" y="368" />
		<entity schema="SnApp.dbo" name="tbTicketMemebershipPoint" color="FFB3B3" x="9792" y="2048" />
		<entity schema="SnApp.dbo" name="tbTicketPerformanceException" color="CBBBB4" x="10816" y="688" />
		<entity schema="SnApp.dbo" name="tbTicketRenew" color="FFB3B3" x="8944" y="928" />
		<entity schema="SnApp.dbo" name="tbTicketRevenue" color="FFB3B3" x="12208" y="1936" />
		<entity schema="SnApp.dbo" name="tbTicketSecondary" color="FFB3B3" x="9776" y="1424" />
		<entity schema="SnApp.dbo" name="tbTicketTransaction" color="FFB3B3" x="9072" y="1440" />
		<entity schema="SnApp.dbo" name="tbTicketUpgrade" color="FFB3B3" x="9376" y="672" />
		<entity schema="SnApp.dbo" name="tbTicketUpgradeTax" color="FFB3B3" x="9344" y="1136" />
		<entity schema="SnApp.dbo" name="tbTicketUsage" color="FFB3B3" x="10480" y="1984" />
		<entity schema="SnApp.dbo" name="tbTicketUsageEntitlementDiff" color="FFB3B3" x="10544" y="2864" />
		<entity schema="SnApp.dbo" name="tbTicketUsageExternalRedeem" color="FFB3B3" x="11264" y="2864" />
		<entity schema="SnApp.dbo" name="tbTicketUsageMediaCode" color="FFB3B3" x="10960" y="2864" />
		<entity schema="SnApp.dbo" name="tbTicketUsageUser" color="FFB3B3" x="10160" y="2864" />
		<entity schema="SnApp.dbo" name="tbTimedTicketRule" color="FFCAFF" x="5296" y="10768" />
		<entity schema="SnApp.dbo" name="tbTimedTicketRuleItem" color="FFCAFF" x="4768" y="10992" />
		<entity schema="SnApp.dbo" name="tbTimedTicketStatement" color="FFB3B3" x="11424" y="2496" />
		<entity schema="SnApp.dbo" name="tbTransaction" color="FFFF80" x="832" y="656" />
		<entity schema="SnApp.dbo" name="tbTransaction2DocketDevice" color="FFFF80" x="1568" y="1488" />
		<entity schema="SnApp.dbo" name="tbTransaction2ExtSystemVoid" color="FFFF80" x="1840" y="768" />
		<entity schema="SnApp.dbo" name="tbTransaction2TicketUsage" color="FFFF80" x="5520" y="1584" />
		<entity schema="SnApp.dbo" name="tbTransactionAccountInventory" color="FFFF80" x="1440" y="256" />
		<entity schema="SnApp.dbo" name="tbTransactionAccountMerge" color="FFFF80" x="1136" y="384" />
		<entity schema="SnApp.dbo" name="tbTransactionActivationGroup" color="FFFF80" x="96" y="2528" />
		<entity schema="SnApp.dbo" name="tbTransactionCommission" color="FFFF80" x="3200" y="3856" />
		<entity schema="SnApp.dbo" name="tbTransactionCrossPlatform" color="FFFF80" x="3904" y="3088" />
		<entity schema="SnApp.dbo" name="tbTransactionCrossPlatformItem" color="FFFF80" x="3264" y="3120" />
		<entity schema="SnApp.dbo" name="tbTransactionDocket" color="FFFF80" x="1232" y="1520" />
		<entity schema="SnApp.dbo" name="tbTransactionItem" color="FFFF80" x="1168" y="1232" />
		<entity schema="SnApp.dbo" name="tbTransactionJob" color="FFFF80" x="896" y="1488" />
		<entity schema="SnApp.dbo" name="tbTransactionLedgerBalance" color="FFFF80" x="1888" y="1296" />
		<entity schema="SnApp.dbo" name="tbTransactionMediaTransfer" color="FFFF80" x="1360" y="528" />
		<entity schema="SnApp.dbo" name="tbTransactionStock" color="FFFF80" x="3504" y="3504" />
		<entity schema="SnApp.dbo" name="tbTransactionTicketPerformance" color="FFFF80" x="800" y="64" />
		<entity schema="SnApp.dbo" name="tbTransactionTicketPriority" color="FFFF80" x="1376" y="720" />
		<entity schema="SnApp.dbo" name="tbTransactionTicketTransfer" color="FFFF80" x="1200" y="80" />
		<entity schema="SnApp.dbo" name="tbTransactionUpsell" color="FFFF80" x="1328" y="1712" />
		<entity schema="SnApp.dbo" name="tbTransactionVoucher" color="FFFF80" x="2720" y="4208" />
		<entity schema="SnApp.dbo" name="tbTransactionWallet" color="FFFF80" x="1408" y="960" />
		<entity schema="SnApp.dbo" name="tbTransactionWarn" color="FFFF80" x="1440" y="1264" />
		<entity schema="SnApp.dbo" name="tbTranslate" color="EAEAEA" x="272" y="12368" />
		<entity schema="SnApp.dbo" name="tbUpload" color="EAEAEA" x="416" y="3856" />
		<entity schema="SnApp.dbo" name="tbUserActivity" color="C1FFC1" x="5616" y="4432" />
		<entity schema="SnApp.dbo" name="tbUserFilter" color="C1FFC1" x="5344" y="5072" />
		<entity schema="SnApp.dbo" name="tbVoucher" color="C1FFC1" x="3088" y="5696" />
		<entity schema="SnApp.dbo" name="tbVoucherItem" color="C1FFC1" x="2496" y="6048" />
		<entity schema="SnApp.dbo" name="tbWalletLog2SaleItem" color="FFFF80" x="560" y="2192" />
		<entity schema="SnApp.dbo" name="tbWarehouse" color="B9FFFF" x="7280" y="4352" />
		<entity schema="SnApp.dbo" name="tbWarehouseStock" color="B9FFFF" x="6944" y="4656" />
		<entity schema="SnApp.dbo" name="tbWebAuth" color="FFFF80" x="3552" y="96" />
		<entity schema="SnApp.dbo" name="tbWebAuthData" color="F9F9E6" x="3968" y="96" />
		<entity schema="SnApp.dbo" name="tbWorkstation" color="B9FFFF" x="9216" y="4000" />
		<entity schema="SnApp.dbo" name="tbWorkstation2AccessPoint" color="B9FFFF" x="9888" y="4912" />
		<entity schema="SnApp.dbo" name="tbWorkstationActivity" color="00FFFF" x="8368" y="4912" />
		<script name="FeePercValue" id="Editor-d07" language="SQL" >
			<string><![CDATA[ALTER TABLE SnApp.dbo.tbProductPriceDate ADD FeePercValue money;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Percentage value of the transaction amount to be used to calculate the fee price' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceDate', @level2type=N'COLUMN',@level2name=N'FeePercValue';
GO]]></string>
		</script>
		<script name="InsertUpdate" id="Editor-acb" language="SQL" >
			<string><![CDATA[ALTER TABLE SnApp.dbo.tbEntityChange ADD InsertUpdate bit     NOT NULL;
GO]]></string>
		</script>
		<script name="LastUpdate" id="Editor_703" language="SQL" >
			<string><![CDATA[UPDATE dbo.tbTask SET LastUpdate = ? ;]]></string>
		</script>
		<script name="LastUpdate_001" id="Editor_1dd0" language="SQL" >
			<string><![CDATA[ALTER TABLE dbo.tbTask ADD LastUpdate datetime;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Used for differential data exports' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'LastUpdate';]]></string>
		</script>
		<script name="MembershipPlanProductId" id="Editor-17b6" language="SQL" >
			<string><![CDATA[ALTER TABLE SnApp.dbo.tbIndividualCoupon ADD MembershipPlanProductId uniqueidentifier     NULL;
GO]]></string>
		</script>
		<script name="tbAccessPointDescription" id="Editor-c54" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbAccessPointDescription ( 
	AccessPointId        uniqueidentifier NOT NULL    ,
	ValidDateFrom        date NOT NULL    ,
	ValidDateTo          date     ,
	Description          nvarchar(100)     ,
	CONSTRAINT PK_AccessPointDescription PRIMARY KEY  ( AccessPointId, ValidDateFrom ) 
 );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Access point descriptions can be different according to their date range validity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccessPointDescription';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to access point internal id' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccessPointDescription', @level2type=N'COLUMN',@level2name=N'AccessPointId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Start validity of the description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccessPointDescription', @level2type=N'COLUMN',@level2name=N'ValidDateFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'End validity of the description. If null the descricption does not expire' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccessPointDescription', @level2type=N'COLUMN',@level2name=N'ValidDateTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Access point'' s description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccessPointDescription', @level2type=N'COLUMN',@level2name=N'Description';
GO

ALTER TABLE SnApp.dbo.tbAccessPointDescription ADD CONSTRAINT FK_AccessPointDescription_AccessPoint FOREIGN KEY ( AccessPointId ) REFERENCES SnApp.dbo.tbAccessPoint( AptWorkstationId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbAccountExposureLog" id="Editor_131a" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbAccountExposureLog ( 
	AccountId            uniqueidentifier NOT NULL    ,
	LogFiscalDate        date NOT NULL    ,
	LogSerial            smallint NOT NULL    ,
	LogAmount            money NOT NULL    ,
	DepositBalance       money NOT NULL    ,
	TransactionId        uniqueidentifier     ,
	CONSTRAINT PK_AccountExposureLog PRIMARY KEY  ( AccountId, LogFiscalDate, LogSerial ) 
 );
GO

CREATE  INDEX IX_AccountExposureLog_TransactionId ON SnApp.dbo.tbAccountExposureLog ( TransactionId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Changes to the tbAccountFinance.ExposureBalance are logged in this table' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountExposureLog';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Exposure balance including current operation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountExposureLog', @level2type=N'COLUMN',@level2name=N'DepositBalance';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'TransactionId is null for consolidating rows' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountExposureLog', @level2type=N'COLUMN',@level2name=N'TransactionId';
GO

ALTER TABLE SnApp.dbo.tbAccountExposureLog ADD CONSTRAINT FK_AccountExposureLog_Account FOREIGN KEY ( AccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbAccountExposureLog ADD CONSTRAINT FK_AccountExposureLog_TransactionId FOREIGN KEY ( TransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbAccountOpArea" id="Editor-219" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbAccountOpArea ( 
	AccountId            uniqueidentifier      NOT NULL,
	ZipFile              varbinary(max)      NULL,
	ZipFileLastUpdate    datetime      NULL,
	CONSTRAINT pk_tbAccountOpArea PRIMARY KEY  ( AccountId ) 
 );
GO

ALTER TABLE SnApp.dbo.tbAccountOpArea ADD CONSTRAINT FK_AccountOpArea_AccountId FOREIGN KEY ( AccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE CASCADE;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'tbAccount extension table to hold operating area specific properties' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountOpArea';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Zip file containing workstation configurations common to operating area level, such as users and other configs.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountOpArea', @level2type=N'COLUMN',@level2name=N'ZipFile';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Timestamp of field ZipFile last update' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountOpArea', @level2type=N'COLUMN',@level2name=N'ZipFileLastUpdate';
GO
]]></string>
		</script>
		<script name="tbAccountTaxExempt2Tax" id="Editor-1299" language="SQL" >
			<string><![CDATA[CREATE  TABLE tbAccountTaxExempt2Tax ( 
	AccountId            uniqueidentifier      NOT NULL,
	TaxId                uniqueidentifier      NOT NULL,
	CONSTRAINT PK_AccountTaxExempt2Tax PRIMARY KEY  ( AccountId, TaxId ) 
 );
GO

CREATE  INDEX IX_AccountTaxExempt2Tax_TaxId ON tbAccountTaxExempt2Tax ( TaxId );
GO

ALTER TABLE tbAccountTaxExempt2Tax ADD CONSTRAINT FK_AccountTaxExempt2Tax_AccountTaxExempt FOREIGN KEY ( AccountId ) REFERENCES tbAccountTaxExempt( AccountId ) ON DELETE CASCADE;
GO

ALTER TABLE tbAccountTaxExempt2Tax ADD CONSTRAINT FK_AccountTaxExempt2Tax_Tax FOREIGN KEY ( TaxId ) REFERENCES tbTax( TaxId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'List of "excplicit" exemptible taxes for the account' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTaxExempt2Tax';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Account internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTaxExempt2Tax', @level2type=N'COLUMN',@level2name=N'AccountId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tax internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTaxExempt2Tax', @level2type=N'COLUMN',@level2name=N'TaxId';
GO
]]></string>
		</script>
		<script name="tbAccountTemp" id="Editor-1909" language="SQL" >
			<string><![CDATA[CREATE TABLE tbAccountTemp ( 
	AccountId            uniqueidentifier NOT NULL    ,
	OpAreaId             uniqueidentifier NOT NULL    ,
	CreateDateTime       datetime NOT NULL    ,
	CONSTRAINT PK_AccountTemp PRIMARY KEY  ( AccountId ) 
 );
GO

CREATE  INDEX IX_AccountTemp_OpAreaId ON tbAccountTemp ( OpAreaId, CreateDateTime );
GO

CREATE  INDEX IX_AccountTemp_CreateDateTime ON tbAccountTemp ( CreateDateTime );
GO

ALTER TABLE tbAccountTemp ADD CONSTRAINT FK_AccountTemp_Account FOREIGN KEY ( AccountId ) REFERENCES tbAccount( AccountId ) ON DELETE CASCADE ON UPDATE NO ACTION;
GO

ALTER TABLE tbAccountTemp ADD CONSTRAINT FK_AccountTemp_OpAreaAccount FOREIGN KEY ( OpAreaId ) REFERENCES tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Store references for "temporary" accounts.\nTemporary accounts are usually created by external devices (tables) which collect demographics when guests are inline. These demographics are then recalled&validated from POS' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to account internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'AccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to operating area internal ID.\nIt helps searches from POS as each POS would show only temporary accounts created on its own operating area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'OpAreaId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record creation date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'CreateDateTime';
GO
]]></string>
		</script>
		<script name="tbAccountTemp_001" id="Editor-2137" language="SQL" >
			<string><![CDATA[CREATE TABLE tbAccountTemp ( 
	AccountId            uniqueidentifier NOT NULL    ,
	AccountTempCode      varchar(10) NOT NULL    ,
	OpAreaId             uniqueidentifier NOT NULL    ,
	CreateFiscalDate     date NOT NULL    ,
	CreateDateTime       datetime NOT NULL    ,
	CONSTRAINT PK_AccountTemp PRIMARY KEY  ( AccountId ) 
 );
GO

CREATE  INDEX IX_AccountTemp_OpAreaId ON tbAccountTemp ( OpAreaId, CreateDateTime );
GO

CREATE  INDEX IX_AccountTemp_CreateDateTime ON tbAccountTemp ( CreateDateTime );
GO

CREATE UNIQUE INDEX UQ_AccountTemp_AccountTempCode ON tbAccountTemp ( CreateFiscalDate, OpAreaId, AccountTempCode );
GO

ALTER TABLE tbAccountTemp ADD CONSTRAINT FK_AccountTemp_Account FOREIGN KEY ( AccountId ) REFERENCES tbAccount( AccountId ) ON DELETE CASCADE ON UPDATE NO ACTION;
GO

ALTER TABLE tbAccountTemp ADD CONSTRAINT FK_AccountTemp_OpAreaAccount FOREIGN KEY ( OpAreaId ) REFERENCES tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Store references for "temporary" accounts.\nTemporary accounts are usually created by external devices (tables) which collect demographics when guests are inline. These demographics are then recalled&validated from POS' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to account internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'AccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Unique code (per op.area / fiscal date)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'AccountTempCode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to operating area internal ID.\nIt helps searches from POS as each POS would show only temporary accounts created on its own operating area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'OpAreaId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record creation local fiscal date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'CreateFiscalDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record creation date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'CreateDateTime';
GO]]></string>
		</script>
		<script name="tbAccountTemp_003" id="Editor-226d" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbAccountTemp ( 
	AccountId            uniqueidentifier      NOT NULL,
	AccountTempCode      varchar(10)      NOT NULL,
	OpAreaId             uniqueidentifier      NOT NULL,
	WorkstationId        uniqueidentifier      NULL,
	CreateFiscalDate     date      NOT NULL,
	CreateDateTime       datetime      NOT NULL,
	CONSTRAINT PK_AccountTemp PRIMARY KEY  ( AccountId ) 
 );
GO

CREATE  INDEX IX_AccountTemp_CreateDateTime ON SnApp.dbo.tbAccountTemp ( CreateDateTime );
GO

CREATE UNIQUE  INDEX UQ_AccountTemp_AccountTempCode ON SnApp.dbo.tbAccountTemp ( CreateFiscalDate, OpAreaId, AccountTempCode );
GO

CREATE  INDEX IX_AccountTemp_WorkstationId ON SnApp.dbo.tbAccountTemp ( WorkstationId, CreateDateTime );
GO

CREATE  INDEX IX_AccountTemp_OpAreaId ON SnApp.dbo.tbAccountTemp ( OpAreaId, CreateDateTime ) INCLUDE (WorkstationId, CreateFiscalDate);
GO

ALTER TABLE SnApp.dbo.tbAccountTemp ADD CONSTRAINT FK_AccountTemp_Account FOREIGN KEY ( AccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbAccountTemp ADD CONSTRAINT FK_AccountTemp_OpAreaAccount FOREIGN KEY ( OpAreaId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbAccountTemp ADD CONSTRAINT FK_AccountTemp_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES SnApp.dbo.tbWorkstation( WorkstationId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Store references for "temporary" accounts.\nTemporary accounts are usually created by external devices (tables) which collect demographics when guests are inline. These demographics are then recalled&validated from POS' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to account internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'AccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Unique code (per op.area / fiscal date)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'AccountTempCode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to operating area internal ID.\nIt helps searches from POS as each POS would show only temporary accounts created on its own operating area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'OpAreaId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to workstation internal ID.\nIt helps searches from POS as each POS would show only temporary accounts created for this workstation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'WorkstationId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record creation local fiscal date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'CreateFiscalDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record creation date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAccountTemp', @level2type=N'COLUMN',@level2name=N'CreateDateTime';
GO
]]></string>
		</script>
		<script name="tbAsyncProcess" id="Editor_cd" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbAsyncProcess ( 
	AsyncProcessId       uniqueidentifier NOT NULL    ,
	ServerId             smallint NOT NULL    ,
	AsyncProcessName     nvarchar(50) NOT NULL    ,
	AsyncProcessClassAlias varchar(25)     ,
	AsyncProcessStatus   smallint NOT NULL    ,
	WorkstationId        uniqueidentifier NOT NULL    ,
	UserAccountId        uniqueidentifier     ,
	QuantityTot          int NOT NULL    ,
	QuantityPos          int NOT NULL    ,
	QuantitySkip         int NOT NULL    ,
	StartDateTime        datetime NOT NULL    ,
	EndDateTime          datetime     ,
	ReportEmailAddress   varchar(50)     ,
	ConfigData           nvarchar(max)     ,
	RefEntityType        smallint     ,
	RefEntityId          uniqueidentifier     ,
	CONSTRAINT PK_AsyncProcess PRIMARY KEY  ( AsyncProcessId ) 
 );
GO

CREATE  INDEX IX_AsyncProcess_ServerAndStatus ON dbo.tbAsyncProcess ( ServerId ASC, AsyncProcessStatus ASC, StartDateTime DESC );
GO

CREATE  INDEX IX_AsyncProcess_StartEnd ON dbo.tbAsyncProcess ( StartDateTime DESC, EndDateTime DESC );
GO

CREATE  INDEX IX_AsyncProcess_WorkstationId ON dbo.tbAsyncProcess ( WorkstationId ASC );
GO

CREATE  INDEX IX_AsyncProcess_UserAccountId ON dbo.tbAsyncProcess ( UserAccountId ASC ) where UserAccountId is not null;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tomcat instance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAsyncProcess', @level2type=N'COLUMN',@level2name=N'ServerId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[179]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAsyncProcess', @level2type=N'COLUMN',@level2name=N'AsyncProcessStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Email is sent on completion of the process' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAsyncProcess', @level2type=N'COLUMN',@level2name=N'ReportEmailAddress';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbAsyncProcess', @level2type=N'COLUMN',@level2name=N'RefEntityType';
GO

ALTER TABLE dbo.tbAsyncProcess ADD CONSTRAINT FK_AsyncProcess_UserAccount FOREIGN KEY ( UserAccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE dbo.tbAsyncProcess ADD CONSTRAINT FK_AsyncProcess_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES dbo.tbWorkstation( WorkstationId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbBoxWarn_001" id="Editor_46d" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbBoxWarn ( 
	BoxId                uniqueidentifier NOT NULL    ,
	BoxWarn              smallint NOT NULL    ,
	CONSTRAINT PK_BoxWarn PRIMARY KEY  ( BoxId, BoxWarn ) 
 );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains warning flags for each BOX' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbBoxWarn';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the BOX' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbBoxWarn', @level2type=N'COLUMN',@level2name=N'BoxId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[445]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbBoxWarn', @level2type=N'COLUMN',@level2name=N'BoxWarn';
GO

ALTER TABLE dbo.tbBoxWarn ADD CONSTRAINT FK_BoxWarn_BoxId FOREIGN KEY ( BoxId ) REFERENCES dbo.tbBox( BoxId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbCalendar" id="Editor-1d01" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbCalendar ( 
	CalendarId           uniqueidentifier      NOT NULL,
	CalendarType         smallint      NOT NULL,
	CalendarCode         varchar(15)      NOT NULL,
	CalendarName         nvarchar(100)      NOT NULL,
	Enabled              bit      NOT NULL,
	DatedCalendar        bit      NOT NULL,
	DatedEventId         uniqueidentifier      NULL,
	DatedLocationId      uniqueidentifier      NULL,
	DatedAccessAreaId    uniqueidentifier      NULL,
	CategoryId           uniqueidentifier      NULL,
	CONSTRAINT UQ_Calendar_CalendarCode UNIQUE ( CalendarCode ASC ) ,
	CONSTRAINT PK_Calendar PRIMARY KEY  ( CalendarId ) 
 );
GO

CREATE  INDEX IX_Calendar_DatedEventId ON SnApp.dbo.tbCalendar ( DatedEventId ASC ) where DatedEventId is not null;
GO

CREATE  INDEX IX_Calendar_DatedLocationId ON SnApp.dbo.tbCalendar ( DatedLocationId ASC ) where DatedLocationId is not null;
GO

CREATE  INDEX IX_Calendar_DatedAccessAreaId ON SnApp.dbo.tbCalendar ( DatedAccessAreaId ASC ) where DatedAccessAreaId is not null;
GO

CREATE  INDEX IX_Calendar_CalendarType ON SnApp.dbo.tbCalendar ( CalendarType, CalendarName ) INCLUDE (Enabled, DatedCalendar);
GO

CREATE  INDEX IX_Calendar_CategoryId ON SnApp.dbo.tbCalendar ( CategoryId );
GO

ALTER TABLE SnApp.dbo.tbCalendar ADD CONSTRAINT FK_Calendar_Account_DatedLocationId FOREIGN KEY ( DatedLocationId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbCalendar ADD CONSTRAINT FK_Calendar_Account_DatedAccessAreaId FOREIGN KEY ( DatedAccessAreaId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbCalendar ADD CONSTRAINT FK_Calendar_Event_DatedEventId FOREIGN KEY ( DatedEventId ) REFERENCES SnApp.dbo.tbEvent( EventId );
GO

ALTER TABLE SnApp.dbo.tbCalendar ADD CONSTRAINT FK_Calendar_Category FOREIGN KEY ( CategoryId ) REFERENCES SnApp.dbo.tbCategory( CategoryId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information about configure calendars' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'CalendarId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[485] Internal/Snapp/etc' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'CalendarType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Intelligible alphanumeric user defind code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'CalendarCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Calendar name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'CalendarName';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Status' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'Enabled';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tells if it is a "dated" calendar (used for dated product sales)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'DatedCalendar';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'In case of "dated calendar", reference to the dependant event' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'DatedEventId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'In case of "dated calendar", indicates the location for the dependant event' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'DatedLocationId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'In case of "dated calendar", indicates the access area for the dependant event' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'DatedAccessAreaId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Category of the calendar (applicable on root calendar node only)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbCalendar', @level2type=N'COLUMN',@level2name=N'CategoryId';
GO]]></string>
		</script>
		<script name="tbDocTemplate_001" id="Editor-b94" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbDocTemplate ( 
	DocTemplateId        uniqueidentifier      NOT NULL,
	CategoryId           uniqueidentifier      NOT NULL,
	DocTemplateType      smallint      NOT NULL,
	DocEditorType        smallint      NOT NULL,
	DocTemplateName      nvarchar(50)      NOT NULL,
	DocTemplateCode      varchar(15)      NOT NULL,
	DocEnabled           bit      NOT NULL,
	DocData              nvarchar(max)      NULL,
	ParentTemplateId     uniqueidentifier      NULL,
	SystemCode           varchar(15)      NULL,
	MediaGroupTagId      uniqueidentifier      NULL,
	ExecRequireLogin     bit      NOT NULL,
	MediaCashoutOption   smallint      NULL,
	LastUpdate           datetime      NOT NULL,
	SaleForApproval      bit      NOT NULL,
	SaleOpen             bit      NOT NULL,
	SalePaid             bit      NOT NULL,
	SaleCompleted        bit      NOT NULL,
	IndividualPAH        bit      NOT NULL,
	MediaRfidOptionType  smallint      NULL,
	DataSourceSelection  bit      NOT NULL,
	DataSourceId         uniqueidentifier      NULL,
	MaxDateRangeDays     int      NULL,
	ExtensionPackageId   uniqueidentifier      NULL,
	MediaEncoderPluginId uniqueidentifier      NULL,
	DataExportOutputFormat smallint      NULL,
	CsvFieldSeparator    nvarchar(10)      NULL,
	CsvQuoteCharacter    nvarchar(10)      NULL,
	CsvIncludeHeaderLine bit      NULL,
	CsvIncludeBOM        bit      NOT NULL,
	PayByLink            bit      NULL,
	AutoCompleteOnPayment bit      NULL,
	AutoCompleteDocTemplateId uniqueidentifier      NULL,
	CONSTRAINT UQ_DocTemplate_SystemCode UNIQUE ( SystemCode ASC, ExtensionPackageId ASC ) WHERE SystemCode IS NOT NULL
,
	CONSTRAINT UQ_DocTemplate_DocTemplateCode UNIQUE ( DocTemplateCode ASC ) ,
	CONSTRAINT PK_DocTemplate PRIMARY KEY  ( DocTemplateId ) 
 );
GO

CREATE  INDEX IX_DocTemplate_DocTemplateType_LastUpdate ON SnApp.dbo.tbDocTemplate ( DocTemplateType ASC, LastUpdate ASC );
GO

CREATE  INDEX IX_DocTemplate_ParentTemplateId ON SnApp.dbo.tbDocTemplate ( ParentTemplateId ASC );
GO

CREATE  INDEX IX_DocTemplate_DataSourceId ON SnApp.dbo.tbDocTemplate ( DataSourceId ASC ) where DataSourceId is not null;
GO

CREATE  INDEX IX_DocTemplate_ExtensionPackageId ON SnApp.dbo.tbDocTemplate ( ExtensionPackageId ASC ) where ExtensionPackageId is not null;
GO

CREATE  INDEX IX_DocTemplate_MediaEncoderPluginId ON SnApp.dbo.tbDocTemplate ( MediaEncoderPluginId ASC ) where MediaEncoderPluginId is not null;
GO

CREATE  INDEX IX_DocTemplate_CategoryId ON SnApp.dbo.tbDocTemplate ( CategoryId );
GO

CREATE  INDEX IX_DocTemplate_MediaGroupTagId ON SnApp.dbo.tbDocTemplate ( MediaGroupTagId );
GO

CREATE  INDEX IX_DocTemplate_AutoCompleteDocTemplateId ON SnApp.dbo.tbDocTemplate ( AutoCompleteDocTemplateId ASC ) where AutoCompleteDocTemplateId is not null;
GO

ALTER TABLE SnApp.dbo.tbDocTemplate ADD CONSTRAINT FK_DocTemplate_Category FOREIGN KEY ( CategoryId ) REFERENCES SnApp.dbo.tbCategory( CategoryId );
GO

ALTER TABLE SnApp.dbo.tbDocTemplate ADD CONSTRAINT FK_DocTemplate_MediaEncoderPlugin FOREIGN KEY ( MediaEncoderPluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId );
GO

ALTER TABLE SnApp.dbo.tbDocTemplate ADD CONSTRAINT FK_DocTemplate_Parent FOREIGN KEY ( ParentTemplateId ) REFERENCES SnApp.dbo.tbDocTemplate( DocTemplateId );
GO

ALTER TABLE SnApp.dbo.tbDocTemplate ADD CONSTRAINT FK_DocTemplate_MediaGroupTag FOREIGN KEY ( MediaGroupTagId ) REFERENCES SnApp.dbo.tbTag( TagId );
GO

ALTER TABLE SnApp.dbo.tbDocTemplate ADD CONSTRAINT FK_DocTemplate_ExtensionPackage FOREIGN KEY ( ExtensionPackageId ) REFERENCES SnApp.dbo.tbExtensionPackage( ExtensionPackageId );
GO

ALTER TABLE SnApp.dbo.tbDocTemplate ADD CONSTRAINT FK_DocTemplate_DataSource FOREIGN KEY ( DataSourceId ) REFERENCES SnApp.dbo.tbDataSource( DataSourceId );
GO

ALTER TABLE SnApp.dbo.tbDocTemplate ADD CONSTRAINT FK_DocTemplate_AutoCompleteDocTemplateId FOREIGN KEY ( AutoCompleteDocTemplateId ) REFERENCES SnApp.dbo.tbDocTemplate( DocTemplateId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds informations for all templates (media, order confirmation, stat.reports, etc)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DocTemplateId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Category (for data organization only)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'CategoryId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[85] - Identify the template context, like "media", "transaction receipt"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DocTemplateType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[87] - Identify the template format, like "email", "data export"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DocEditorType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Name of the template' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DocTemplateName';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Code of the template' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DocTemplateCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Enabled/Disabled' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DocEnabled';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Template''s data, format depend on field DocTemplateEditor' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DocData';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For queries, it''s the DocTemplateId ''owning'' this query' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'ParentTemplateId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Identifier for system templates' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'SystemCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates that this report can be executed without login check' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'ExecRequireLogin';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[192]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'MediaCashoutOption';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Templates'' last modification' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'LastUpdate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true report is available if order (sale) not approved' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'SaleForApproval';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true report is available if order (sale) is approved' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'SaleOpen';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true report is available if order (sale) is paid' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'SalePaid';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true report is available if order (sale) is completed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'SaleCompleted';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates to attach 1 print@home PDF per media, instead of 1 PDF overall' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'IndividualPAH';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[288]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'MediaRfidOptionType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When true, datasource can be selected on report''s execution' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DataSourceSelection';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Default datasource to be used to run the report' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DataSourceId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the specific extension package containing the report' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'ExtensionPackageId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the external media encoder plugin' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'MediaEncoderPluginId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[496] CSV,  XLS, PDF' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'DataExportOutputFormat';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Character to be used as field separator in CSV exports' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'CsvFieldSeparator';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Character to be used as "quote character" in CSV exports' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'CsvQuoteCharacter';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if field names should be inserted as the first line of the CSV export' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'CsvIncludeHeaderLine';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if CSV export should have the first byte as BOM (Byte Order Mark)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'CsvIncludeBOM';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'identify paybylink doc template' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'PayByLink';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the order will be automatically completed (Paid, Printed and Validated) once the pay by link payment approval is received' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'AutoCompleteOnPayment';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order confirmation DocTemplateId to be used to automatically send an order confirmmation including print at home tickets when the pay by link payment approval is received' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbDocTemplate', @level2type=N'COLUMN',@level2name=N'AutoCompleteDocTemplateId';
GO]]></string>
		</script>
		<script name="tbEntityChange" id="Editor-d96" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbEntityChange ( 
	EntityChangeId       bigint      NOT NULL,
	EntityType           smallint      NOT NULL,
	EntityId             uniqueidentifier      NOT NULL,
	InsertUpdate         bit      NOT NULL,
	EntityChangeGroup    smallint      NOT NULL,
	CreateDate           date      NOT NULL,
	DocData              nvarchar(max)      NULL,
	CONSTRAINT PK_EntityChange PRIMARY KEY  ( EntityChangeId ) 
 );
GO

CREATE UNIQUE  INDEX UQ_EntityChange_EntityId ON SnApp.dbo.tbEntityChange ( EntityId ASC );
GO

CREATE  INDEX IX_EntityChange_EntityType ON SnApp.dbo.tbEntityChange ( EntityType ASC, EntityChangeId ASC ) include (InsertUpdate, EntityId);
GO

CREATE  INDEX IX_EntityChange_EntityChangeGroup ON SnApp.dbo.tbEntityChange ( EntityChangeGroup, CreateDate, EntityChangeId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'EntityType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[446]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'EntityChangeGroup';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record date of creation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'CreateDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'JSON serialization of the entity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'DocData';
GO
]]></string>
		</script>
		<script name="tbEntityChange_001" id="Editor-98a" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbEntityChange ( 
	EntityChangeId       bigint    IDENTITY(1,1)  NOT NULL,
	EntityType           smallint      NOT NULL,
	EntityId             uniqueidentifier      NOT NULL,
	InsertUpdate         bit      NOT NULL,
	EntityChangeGroup    smallint      NOT NULL,
	CreateDate           date      NOT NULL,
	DocData              nvarchar(max)      NULL,
	CONSTRAINT PK_EntityChange PRIMARY KEY  ( EntityChangeId ) 
 );
GO

CREATE UNIQUE  INDEX UQ_EntityChange_EntityId ON SnApp.dbo.tbEntityChange ( EntityId ASC );
GO

CREATE  INDEX IX_EntityChange_EntityType ON SnApp.dbo.tbEntityChange ( EntityType ASC, EntityChangeId ASC ) include (InsertUpdate, EntityId);
GO

CREATE  INDEX IX_EntityChange_EntityChangeGroup ON SnApp.dbo.tbEntityChange ( EntityChangeGroup, CreateDate, EntityChangeId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'EntityType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[446]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'EntityChangeGroup';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record date of creation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'CreateDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'JSON serialization of the entity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'DocData';
GO
]]></string>
		</script>
		<script name="tbEntityChange_002" id="Editor-ef5" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbEntityChange ( 
	EntityChangeId       bigint    IDENTITY(1,1)  NOT NULL,
	EntityType           smallint      NOT NULL,
	EntityId             uniqueidentifier      NOT NULL,
	InsertUpdate         bit      NOT NULL,
	EntityChangeGroup    smallint      NOT NULL,
	CreateDate           date      NOT NULL,
	DocData              nvarchar(max)      NULL,
	CONSTRAINT PK_EntityChange PRIMARY KEY  ( EntityChangeId ) 
 );
GO

CREATE UNIQUE  INDEX UQ_EntityChange_EntityId ON SnApp.dbo.tbEntityChange ( EntityId ASC );
GO

CREATE  INDEX IX_EntityChange_EntityType ON SnApp.dbo.tbEntityChange ( EntityType ASC, EntityChangeId ASC ) include (InsertUpdate, EntityId);
GO

CREATE  INDEX IX_EntityChange_EntityChangeGroup ON SnApp.dbo.tbEntityChange ( EntityChangeGroup, CreateDate, EntityChangeId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'EntityType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[446]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'EntityChangeGroup';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record date of creation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'CreateDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'JSON serialization of the entity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEntityChange', @level2type=N'COLUMN',@level2name=N'DocData';
GO
]]></string>
		</script>
		<script name="tbEvent" id="Editor-1a1c" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbEvent ( 
	EventId              uniqueidentifier      NOT NULL,
	AccountId            uniqueidentifier      NULL,
	EventType            smallint      NOT NULL,
	CategoryId           uniqueidentifier      NOT NULL,
	EventCode            varchar(10)      NOT NULL,
	EventName            nvarchar(50)      NOT NULL,
	EventNameExt         nvarchar(50)      NULL,
	ShowNameExt          bit      NOT NULL,
	EventStatus          smallint      NOT NULL,
	OnSaleFrom           date      NULL,
	OnSaleTo             date      NULL,
	ProducerAccountId    uniqueidentifier      NULL,
	LocationAccountId    uniqueidentifier      NULL,
	AccessAreaAccountId  uniqueidentifier      NULL,
	CalendarId           uniqueidentifier      NULL,
	UncountCalendarId    uniqueidentifier      NULL,
	DefaultPerformanceDuration int      NULL,
	AdmissionOpenMins    smallint      NULL,
	AdmissionCloseMins   smallint      NULL,
	PositionLat          float(1)      NULL,
	PositionLong         float(1)      NULL,
	Weight               int      NULL,
	ActiveDateFrom       date      NULL,
	ActiveDateTo         date      NULL,
	ActiveTimeFrom       datetime      NULL,
	ActiveTimeTo         datetime      NULL,
	ActiveMON            bit      NOT NULL,
	ActiveTUE            bit      NOT NULL,
	ActiveWED            bit      NOT NULL,
	ActiveTHU            bit      NOT NULL,
	ActiveFRI            bit      NOT NULL,
	ActiveSAT            bit      NOT NULL,
	ActiveSUN            bit      NOT NULL,
	AverageVisitTime     int      NULL,
	ReferencePrice       money      NULL,
	PerformanceSelection bit      NOT NULL,
	QueueSlotFrequence   smallint      NOT NULL,
	QueueSlotCapacity    smallint      NOT NULL,
	AutoCreatePerfDays   smallint      NOT NULL,
	LastPerfAutoCreate   smalldatetime      NULL,
	SoldOutWarnLimit     tinyint      NULL,
	RestrictOpenOrder    bit      NOT NULL,
	VarExpRule           smallint      NULL,
	VarExpQuantity       smallint      NULL,
	VarFirstUsageRule    smallint      NULL,
	VarFirstUsageQuantity smallint      NULL,
	AdmDateFrom          date      NULL,
	AdmDateTo            date      NULL,
	AdmTimeFrom          datetime      NULL,
	AdmTimeTo            datetime      NULL,
	CrossPlatformId      uniqueidentifier      NULL,
	CrossEventStatus     smallint      NULL,
	BackgroundColor      varchar(6)      NULL,
	ForegroundColor      varchar(6)      NULL,
	IconAlias            varchar(50)      NULL,
	BookingWindowDays    smallint      NULL,
	DynRateCodeType      smallint      NULL,
	DynRateCodeValueType smallint      NULL,
	WaiverDocTemplateId  uniqueidentifier      NULL,
	RedemptionCacheDeltaHours smallint      NULL,
	LastUpdate           datetime      NOT NULL,
	StopBookingWindowMinutes smallint      NULL,
	CapacityThresholdDeltaMins smallint      NULL,
	CONSTRAINT UQ_Event_EventCode UNIQUE ( EventCode ASC ) ,
	CONSTRAINT PK_Event PRIMARY KEY  ( EventId ) 
 );
GO

CREATE  INDEX IX_Event_AccountId ON SnApp.dbo.tbEvent ( AccountId ASC ) where AccountId is not null;
GO

CREATE  INDEX IX_Event_CategoryId ON SnApp.dbo.tbEvent ( CategoryId ASC );
GO

CREATE  INDEX IX_Event_ProducerAccountId ON SnApp.dbo.tbEvent ( ProducerAccountId ASC ) where ProducerAccountId is not null;
GO

CREATE  INDEX IX_Event_LocationAccountId ON SnApp.dbo.tbEvent ( LocationAccountId ASC ) where LocationAccountId is not null;
GO

CREATE  INDEX IX_Event_AccessAreaAccountId ON SnApp.dbo.tbEvent ( AccessAreaAccountId ASC ) where AccessAreaAccountId is not null;
GO

CREATE  INDEX IX_Event_CalendarId ON SnApp.dbo.tbEvent ( CalendarId ASC ) where CalendarId is not null;
GO

CREATE  INDEX IX_Event_LastPerfAutoCreate ON SnApp.dbo.tbEvent ( EventType ASC, LastPerfAutoCreate ASC );
GO

CREATE  INDEX IX_Event_CrossPlatformId ON SnApp.dbo.tbEvent ( CrossPlatformId ASC ) where CrossPlatformId is not null;
GO

CREATE  INDEX IX_Event_UncountCalendarId ON SnApp.dbo.tbEvent ( UncountCalendarId );
GO

CREATE  INDEX IX_Event_WaiverDocTemplateId ON SnApp.dbo.tbEvent ( WaiverDocTemplateId ) WHERE WaiverDocTemplateId IS NOT NULL;
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_ProducerAccount FOREIGN KEY ( ProducerAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_Account FOREIGN KEY ( AccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_LocationAccount FOREIGN KEY ( LocationAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_AcAreaAccount FOREIGN KEY ( AccessAreaAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_Category FOREIGN KEY ( CategoryId ) REFERENCES SnApp.dbo.tbCategory( CategoryId );
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_Calendar FOREIGN KEY ( CalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId );
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_AccountCrossPlatform FOREIGN KEY ( CrossPlatformId ) REFERENCES SnApp.dbo.tbAccountCrossPlatform( AccountId );
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_UncountCalendar FOREIGN KEY ( UncountCalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId );
GO

ALTER TABLE SnApp.dbo.tbEvent ADD CONSTRAINT FK_Event_WaiverDocTemplate FOREIGN KEY ( WaiverDocTemplateId ) REFERENCES SnApp.dbo.tbDocTemplate( DocTemplateId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information of events (shows)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'EventId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the location which this event belongs to' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AccountId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[38]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'EventType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Category of the event (determins applicable data masks)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'CategoryId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Intelligible alphanumeric user defined code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'EventCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Event name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'EventName';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Event additional description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'EventNameExt';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if EventNameExt should be displayed on POS buttons' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ShowNameExt';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[40]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'EventStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date from which the event is available for sale. 
Null = no limit' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'OnSaleFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date after which the event is not available for sale anymore. 
Null = no limit' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'OnSaleTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Organization producing the event' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ProducerAccountId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Default for new performances' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'LocationAccountId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Default for new performances' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AccessAreaAccountId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Operating calendar' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'CalendarId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference a calendar for which dates should not be counted as "outstanding" bookings' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'UncountCalendarId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'In minutes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'DefaultPerformanceDuration';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Start admission "n" minutes relative to performance start ("-10" mean 10 minutes before)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AdmissionOpenMins';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Stop admission "n" minutes relative to performance start. ("+10" means 10 minuter after performance start)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AdmissionCloseMins';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'GPS latitude coords' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'PositionLat';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'GPS longitude coords' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'PositionLong';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sorting weight' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'Weight';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Rough indication of when the event will be performing (usefull for temporary events B2C representation, without going to performance level)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveDateFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveDateTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveTimeFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveTimeTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveMON';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveTUE';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveWED';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveTHU';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveFRI';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveSAT';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ActiveSUN';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'" (in minutes)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AverageVisitTime';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ReferencePrice';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'PerformanceSelection';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'expressed in minutes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'QueueSlotFrequence';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Not Yet Used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'QueueSlotCapacity';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If greater than zero, system will auto-create performances for "n" days accordingly to the operating calendar (CalendarId)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AutoCreatePerfDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal Use' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'LastPerfAutoCreate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For limited capacity events, it represents the percertage, under which the system will display seats in "orange" color, indicating that a performance is almost sold out' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'SoldOutWarnLimit';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If flagged, orders cannot be left open but must be paid on creation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'RestrictOpenOrder';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[289]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'VarExpRule';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[289]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'VarFirstUsageRule';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Rough indication of when the event will be performing (usefull for temporary events B2C representation, without going to performance level)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AdmDateFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AdmDateTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AdmTimeFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'AdmTimeTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If not null, event comes from cross platform. No manual changes are allowed.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'CrossPlatformId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[302] Present only if CrossPlatformId is not null' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'CrossEventStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'RGB hex color' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'BackgroundColor';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'RGB hex color' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'ForegroundColor';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'FontAwesome icon name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'IconAlias';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Users can only select performances up to this number of days in the future' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'BookingWindowDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[461] Indicates if tbEventDynRateCode.Value refers to SOLD vs AVAILABLE quantities' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'DynRateCodeType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[135] Indicates if tbEventDynRateCode.Value are expressed as ABSOLUTE or PERCENTAGE' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'DynRateCodeValueType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Template for the waiver required to access this event''s performances' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'WaiverDocTemplateId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of hours, before/after performance admission timeframe, where the performance should be anyway loaded into redemption''s cache, in order to properly return "too early / too late" validation errors' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'RedemptionCacheDeltaHours';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record last modification date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'LastUpdate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Users can select performances only within this many minutes from their start time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'StopBookingWindowMinutes';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Threshold delta minutes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbEvent', @level2type=N'COLUMN',@level2name=N'CapacityThresholdDeltaMins';
GO
]]></string>
		</script>
		<script name="tbFullText" id="Editor_3c0" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbFullText ( 
	EntityId             uniqueidentifier NOT NULL    ,
	Word                 nvarchar(50) NOT NULL    ,
	EntityType           smallint NOT NULL    ,
	SearchWeight         tinyint NOT NULL    ,
	CONSTRAINT PK_FullText PRIMARY KEY  ( EntityId, Word ) 
 );
GO

CREATE  INDEX IX_FullText_EntitType_Word ON SnApp.dbo.tbFullText ( EntityType ASC, Word ASC )  INCLUDE (SearchWeight);
GO
]]></string>
		</script>
		<script name="tbHistoryDetail" id="Editor-594" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbHistoryDetail ( 
	HistoryLogDetailId   uniqueidentifier      NOT NULL,
	HistoryLogId         uniqueidentifier      NOT NULL,
	HistoryField         smallint      NOT NULL,
	HistorySubField      nvarchar(100)      NOT NULL,
	HistorySubFieldType  smallint      NULL,
	OldValue             nvarchar(100)      NULL,
	NewValue             nvarchar(100)      NULL,
	OldValueLong         nvarchar(max)      NULL,
	NewValueLong         nvarchar(max)      NULL,
	OldEntityType        smallint      NULL,
	OldEntityId          uniqueidentifier      NULL,
	NewEntityType        smallint      NULL,
	NewEntityId          uniqueidentifier      NULL,
	CONSTRAINT PK_HistoryDetail PRIMARY KEY  ( HistoryLogDetailId ) 
 );
GO

CREATE  INDEX IX_HistoryDetail_OldEntityId ON SnApp.dbo.tbHistoryDetail ( OldEntityId ASC ) where OldEntityId is not null;
GO

CREATE  INDEX IX_HistoryDetail_NewEntityId ON SnApp.dbo.tbHistoryDetail ( NewEntityId ASC ) where NewEntityId is not null;
GO

CREATE  INDEX IX_HistoryDetail_HistoryLogId ON SnApp.dbo.tbHistoryDetail ( HistoryLogId, HistoryField, HistorySubField );
GO

ALTER TABLE SnApp.dbo.tbHistoryDetail ADD CONSTRAINT FK_HistoryDetail_HistoryLog FOREIGN KEY ( HistoryLogId ) REFERENCES SnApp.dbo.tbHistoryLog( HistoryLogId ) ON DELETE CASCADE;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Keeps trace of the modifications made to an entity with detailed information' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[301] Used to vreate a description for the history field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'HistoryField';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to further identify an history field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'HistorySubField';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK(305) Used to identify the type of the history sub field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'HistorySubFieldType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The actual old value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'OldValue';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The actual new value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'NewValue';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to store the old value if it is longer than 100 characters' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'OldValueLong';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to store the new value if it is longher than 100 characters' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'NewValueLong';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131] The old value could be a different entity type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'OldEntityType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ID of the old entity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'OldEntityId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131] The new value could be a different entity type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'NewEntityType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ID of the new entity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbHistoryDetail', @level2type=N'COLUMN',@level2name=N'NewEntityId';
GO
]]></string>
		</script>
		<script name="tbIndividualCoupon" id="Editor-1f84" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbIndividualCoupon ( 
	IndividualCouponId   uniqueidentifier      NOT NULL,
	IndividualCouponCode varchar(150)      NOT NULL,
	IndividualCouponStatus smallint      NOT NULL,
	ProductId            uniqueidentifier      NOT NULL,
	IssueTransactionId   uniqueidentifier      NOT NULL,
	IssueFiscalDate      date      NOT NULL,
	IssueDateTime        smalldatetime      NOT NULL,
	SettleTransactionId  uniqueidentifier      NULL,
	SettleFiscalDate     date      NULL,
	SettleDateTime       smalldatetime      NULL,
	ValidDateFrom        date      NULL,
	ValidDateTo          date      NULL,
	CampaignCode         varchar(15)      NULL,
	AccountId            uniqueidentifier      NULL,
	MembershipPlanProductId uniqueidentifier      NULL,
	CONSTRAINT UQ_IndividualCoupon_Code UNIQUE ( IndividualCouponCode ASC ) ,
	CONSTRAINT PK_IndividualCoupon PRIMARY KEY  ( IndividualCouponId ) 
 );
GO

CREATE  INDEX IX_IndividualCoupon_ProductId ON SnApp.dbo.tbIndividualCoupon ( ProductId ASC, IssueDateTime ASC );
GO

CREATE  INDEX IX_IndividualCoupon_IssueTransactionId ON SnApp.dbo.tbIndividualCoupon ( IssueTransactionId ASC, IssueDateTime ASC );
GO

CREATE  INDEX IX_IndividualCoupon_SettleTransactionId ON SnApp.dbo.tbIndividualCoupon ( SettleTransactionId ASC, SettleDateTime ASC ) where SettleTransactionId is not null;
GO

CREATE  INDEX IX_IndividualCoupon_AccountId ON SnApp.dbo.tbIndividualCoupon ( AccountId ASC, IssueDateTime ASC ) where AccountId is not null;
GO

CREATE  INDEX IX_IndividualCoupon_IssueFiscalDate ON SnApp.dbo.tbIndividualCoupon ( IssueFiscalDate ASC, IssueDateTime ASC );
GO

CREATE  INDEX IX_IndividualCoupon_SettleFiscalDate ON SnApp.dbo.tbIndividualCoupon ( SettleFiscalDate ASC, SettleDateTime ASC ) where SettleFiscalDate is not null;
GO

CREATE  INDEX IX_IndividualCoupon_CampaignCode ON SnApp.dbo.tbIndividualCoupon ( CampaignCode ASC, IssueDateTime ASC ) where CampaignCode is not null;
GO

ALTER TABLE SnApp.dbo.tbIndividualCoupon ADD CONSTRAINT FK_IndividualCoupon_Account FOREIGN KEY ( AccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbIndividualCoupon ADD CONSTRAINT FK_IndividualCoupon_Product FOREIGN KEY ( ProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

ALTER TABLE SnApp.dbo.tbIndividualCoupon ADD CONSTRAINT FK_IndividualCoupon_IssueTransaction FOREIGN KEY ( IssueTransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId );
GO

ALTER TABLE SnApp.dbo.tbIndividualCoupon ADD CONSTRAINT FK_IndividualCoupon_SettleTransaction FOREIGN KEY ( SettleTransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId );
GO

ALTER TABLE SnApp.dbo.tbIndividualCoupon ADD CONSTRAINT FK_IndividualCoupon_MembershipPlan FOREIGN KEY ( MembershipPlanProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId ) ON DELETE SET NULL;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Max length for media code is 32. But since when a media gets recycled, the media code becomes "mediacode#PNR" we leave some extra space in the table field.
03/11/2021 - Size increased to 150 cause it is now possible to create individual coupons with external codes (ex. QR codes)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbIndividualCoupon', @level2type=N'COLUMN',@level2name=N'IndividualCouponCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[269]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbIndividualCoupon', @level2type=N'COLUMN',@level2name=N'IndividualCouponStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Refers to promo rule' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbIndividualCoupon', @level2type=N'COLUMN',@level2name=N'ProductId';
GO]]></string>
		</script>
		<script name="tbInstallmentContractTrigger" id="Editor-21ba" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbInstallmentContractTrigger ( 
	InstallmentContractTriggerId uniqueidentifier      NOT NULL,
	InstallmentContractId uniqueidentifier      NOT NULL,
	InstallmentContractTriggerType smallint      NOT NULL,
	ScheduledDate        date      NOT NULL,
	TriggerDateTime      datetime      NULL,
	CONSTRAINT PK_InstallmentContractTrigger PRIMARY KEY  ( InstallmentContractTriggerId ) 
 );
GO

CREATE  INDEX IX_InstallmentContractTrigger_InstallmentContractId ON SnApp.dbo.tbInstallmentContractTrigger ( InstallmentContractId, ScheduledDate );
GO

CREATE  INDEX IX_InstallmentContractTrigger_ScheduledDate ON SnApp.dbo.tbInstallmentContractTrigger ( ScheduledDate, TriggerDateTime ) where TriggerDateTime is null;
GO

ALTER TABLE SnApp.dbo.tbInstallmentContractTrigger ADD CONSTRAINT FK_InstallmentContractTrigger_InstallmentContract FOREIGN KEY ( InstallmentContractId ) REFERENCES SnApp.dbo.tbInstallmentContract( InstallmentContractId ) ON DELETE CASCADE;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Stores planner trigger dates (renewal, renewal notice, ect...) for each installment contract' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInstallmentContractTrigger';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInstallmentContractTrigger', @level2type=N'COLUMN',@level2name=N'InstallmentContractTriggerId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to installment contract' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInstallmentContractTrigger', @level2type=N'COLUMN',@level2name=N'InstallmentContractId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[463] renewal, renewal notice, etc...' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInstallmentContractTrigger', @level2type=N'COLUMN',@level2name=N'InstallmentContractTriggerType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date scheduled for the trigger to happen' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInstallmentContractTrigger', @level2type=N'COLUMN',@level2name=N'ScheduledDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/Time about when the event is triggered' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInstallmentContractTrigger', @level2type=N'COLUMN',@level2name=N'TriggerDateTime';
GO
]]></string>
		</script>
		<script name="tbInvoice" id="Editor_f74" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbInvoice ( 
	InvoiceId            uniqueidentifier NOT NULL    ,
	InvoiceCode          varchar(30) NOT NULL    ,
	InvoiceStatus        smallint NOT NULL    ,
	IssueDateTime        datetime NOT NULL    ,
	IssueDate            date NOT NULL    ,
	DueDate              date NOT NULL    ,
	AccountId            uniqueidentifier NOT NULL    ,
	LocationId           uniqueidentifier NOT NULL    ,
	OpAreaId             uniqueidentifier NOT NULL    ,
	WorkstationId        uniqueidentifier NOT NULL    ,
	UserAccountId        uniqueidentifier NOT NULL    ,
	TotalAmount          money NOT NULL    ,
	TotalTax             money NOT NULL    ,
	ItemCount            int NOT NULL    ,
	CONSTRAINT PK_Invoice PRIMARY KEY  ( InvoiceId ) 
 );

CREATE  INDEX IX_Invoice_AccountId ON dbo.tbInvoice ( AccountId, IssueDateTime );

CREATE  INDEX IX_Invoice_OpAreaId ON dbo.tbInvoice ( OpAreaId, IssueDateTime );

CREATE  INDEX IX_Invoice_UserAccountId ON dbo.tbInvoice ( UserAccountId, IssueDateTime );

CREATE  INDEX IX_Invoice_LocationId ON dbo.tbInvoice ( LocationId, IssueDateTime );

CREATE  INDEX IX_Invoice_WorkstationId ON dbo.tbInvoice ( WorkstationId, IssueDateTime );

CREATE  INDEX IX_Invoice_IssueDate ON dbo.tbInvoice ( IssueDate, IssueDateTime );

CREATE UNIQUE INDEX UQ_Invoice_InvoiceCode ON dbo.tbInvoice ( InvoiceCode );

CREATE  INDEX IX_Invoice_DueDate ON dbo.tbInvoice ( DueDate, IssueDateTime );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the invoice header data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Unique code of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceCode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceStatus';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Issue Date/Time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'IssueDateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Issue date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'IssueDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Due date of the invoice payment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'DueDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Account of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'AccountId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the location the invoice is issued for' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'LocationId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to operating area where the invoice was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'OpAreaId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to workstation where the invoice was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'WorkstationId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the user that created the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'UserAccountId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total gross amount of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'TotalAmount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total tax amount of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'TotalTax';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total quantity of items in the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'ItemCount';

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_Account FOREIGN KEY ( AccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_UserAccount FOREIGN KEY ( UserAccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES dbo.tbWorkstation( WorkstationId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_LocationAccount FOREIGN KEY ( LocationId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_OpAreaAccount FOREIGN KEY ( OpAreaId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;]]></string>
		</script>
		<script name="tbInvoiceItem" id="Editor_eba" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbInvoiceItem ( 
	InvoiceItemId        uniqueidentifier NOT NULL    ,
	InvoiceId            uniqueidentifier NOT NULL    ,
	SaleItemId           uniqueidentifier NOT NULL    ,
	UnitAmount           money NOT NULL    ,
	UnitTax              money NOT NULL    ,
	Quantity             int NOT NULL    ,
	TotalAmount          money NOT NULL    ,
	TotalTax             money NOT NULL    ,
	CONSTRAINT PK_InvoiceItem PRIMARY KEY  ( InvoiceItemId ) 
 );

CREATE UNIQUE INDEX UQ_InvoiceItem_InvoiceId ON dbo.tbInvoiceItem ( InvoiceId, SaleItemId );

CREATE UNIQUE INDEX UQ_InvoiceItem_SaleItemId ON dbo.tbInvoiceItem ( SaleItemId, InvoiceId );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the invoice items data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'InvoiceItemId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'InvoiceId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the invoiced sale item' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'SaleItemId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Unit amount of the item  (discounted, tax inclusive)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'UnitAmount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Unit tax amount of the item' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'UnitTax';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of items' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'Quantity';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'UnitAmount * Quantity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'TotalAmount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'UnitTax * Quantity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'TotalTax';

ALTER TABLE dbo.tbInvoiceItem ADD CONSTRAINT FK_InvoiceItem_Invoice FOREIGN KEY ( InvoiceId ) REFERENCES dbo.tbInvoice( InvoiceId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoiceItem ADD CONSTRAINT FK_InvoiceItem_SaleItem FOREIGN KEY ( SaleItemId ) REFERENCES dbo.tbSaleItem( SaleItemId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbInvoiceItem_001" id="Editor_f2d" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbInvoiceItem ( 
	InvoiceItemId        uniqueidentifier NOT NULL    ,
	InvoiceId            uniqueidentifier NOT NULL    ,
	SaleItemId           uniqueidentifier NOT NULL    ,
	UnitAmount           money NOT NULL    ,
	UnitTax              money NOT NULL    ,
	Quantity             int NOT NULL    ,
	TotalAmount          money NOT NULL    ,
	TotalTax             money NOT NULL    ,
	CONSTRAINT PK_InvoiceItem PRIMARY KEY  ( InvoiceItemId ) 
 );
GO

CREATE UNIQUE INDEX UQ_InvoiceItem_InvoiceId ON SnApp.dbo.tbInvoiceItem ( InvoiceId, SaleItemId, UnitAmount );
GO

CREATE UNIQUE INDEX UQ_InvoiceItem_SaleItemId ON SnApp.dbo.tbInvoiceItem ( SaleItemId, InvoiceId, UnitAmount );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the invoice items data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'InvoiceItemId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'InvoiceId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the invoiced sale item' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'SaleItemId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Unit amount of the item  (discounted, tax inclusive)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'UnitAmount';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Unit tax amount of the item' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'UnitTax';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of items' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'Quantity';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'UnitAmount * Quantity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'TotalAmount';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'UnitTax * Quantity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoiceItem', @level2type=N'COLUMN',@level2name=N'TotalTax';
GO

ALTER TABLE SnApp.dbo.tbInvoiceItem ADD CONSTRAINT FK_InvoiceItem_Invoice FOREIGN KEY ( InvoiceId ) REFERENCES SnApp.dbo.tbInvoice( InvoiceId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbInvoiceItem ADD CONSTRAINT FK_InvoiceItem_SaleItem FOREIGN KEY ( SaleItemId ) REFERENCES SnApp.dbo.tbSaleItem( SaleItemId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbInvoicePayment" id="Editor_2269" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbInvoicePayment ( 
	InvoiceId            uniqueidentifier NOT NULL    ,
	PaymentId            uniqueidentifier NOT NULL    ,
	PaymentAmount        money NOT NULL    ,
	CONSTRAINT PK_InvoicePayment PRIMARY KEY  ( InvoiceId, PaymentId ) 
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains a reference to the approved payments of the invoiced sales' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoicePayment';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoicePayment', @level2type=N'COLUMN',@level2name=N'InvoiceId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the payment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoicePayment', @level2type=N'COLUMN',@level2name=N'PaymentId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Payment amount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoicePayment', @level2type=N'COLUMN',@level2name=N'PaymentAmount';

ALTER TABLE dbo.tbInvoicePayment ADD CONSTRAINT FK_InvoicePayment_Invoice FOREIGN KEY ( InvoiceId ) REFERENCES dbo.tbInvoice( InvoiceId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoicePayment ADD CONSTRAINT FK_InvoicePayment_Payment FOREIGN KEY ( PaymentId ) REFERENCES dbo.tbPayment( PaymentId ) ON DELETE NO ACTION ON UPDATE NO ACTION;]]></string>
		</script>
		<script name="tbInvoice_001" id="Editor_1800" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbInvoice ( 
	InvoiceId            uniqueidentifier NOT NULL    ,
	InvoiceCode          varchar(30) NOT NULL    ,
	InvoiceStatus        smallint NOT NULL    ,
	IssueDateTime        datetime NOT NULL    ,
	IssueDate            date NOT NULL    ,
	DueDate              date NOT NULL    ,
	AccountId            uniqueidentifier NOT NULL    ,
	LocationId           uniqueidentifier NOT NULL    ,
	OpAreaId             uniqueidentifier NOT NULL    ,
	WorkstationId        uniqueidentifier NOT NULL    ,
	UserAccountId        uniqueidentifier NOT NULL    ,
	TotalAmount          money NOT NULL    ,
	TotalTax             money NOT NULL    ,
	ItemCount            int NOT NULL    ,
	CONSTRAINT PK_Invoice PRIMARY KEY  ( InvoiceId ) ,
	CONSTRAINT UQ_Invoice_InvoiceCode UNIQUE ( InvoiceCode ) 
 );

CREATE  INDEX IX_Invoice_AccountId ON dbo.tbInvoice ( AccountId, IssueDateTime );

CREATE  INDEX IX_Invoice_OpAreaId ON dbo.tbInvoice ( OpAreaId, IssueDateTime );

CREATE  INDEX IX_Invoice_UserAccountId ON dbo.tbInvoice ( UserAccountId, IssueDateTime );

CREATE  INDEX IX_Invoice_LocationId ON dbo.tbInvoice ( LocationId, IssueDateTime );

CREATE  INDEX IX_Invoice_WorkstationId ON dbo.tbInvoice ( WorkstationId, IssueDateTime );

CREATE  INDEX IX_Invoice_IssueDate ON dbo.tbInvoice ( IssueDate, IssueDateTime );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the invoice header data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Unique code of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceCode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceStatus';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Issue Date/Time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'IssueDateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Issue date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'IssueDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Due date of the invoice payment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'DueDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Account of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'AccountId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the location the invoice is issued for' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'LocationId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to operating area where the invoice was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'OpAreaId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to workstation where the invoice was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'WorkstationId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the user that created the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'UserAccountId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total gross amount of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'TotalAmount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total tax amount of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'TotalTax';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total quantity of items in the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'ItemCount';

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_Account FOREIGN KEY ( AccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_UserAccount FOREIGN KEY ( UserAccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES dbo.tbWorkstation( WorkstationId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_LocationAccount FOREIGN KEY ( LocationId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_OpAreaAccount FOREIGN KEY ( OpAreaId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbInvoice_004" id="Editor_1304" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbInvoice ( 
	InvoiceId            uniqueidentifier NOT NULL    ,
	InvoiceCode          varchar(30) NOT NULL    ,
	InvoiceStatus        smallint NOT NULL    ,
	IssueDateTime        datetime NOT NULL    ,
	IssueDate            date NOT NULL    ,
	DueDate              date NOT NULL    ,
	AccountId            uniqueidentifier NOT NULL    ,
	LocationId           uniqueidentifier NOT NULL    ,
	OpAreaId             uniqueidentifier NOT NULL    ,
	WorkstationId        uniqueidentifier NOT NULL    ,
	UserAccountId        uniqueidentifier NOT NULL    ,
	TotalAmount          money NOT NULL    ,
	TotalTax             money NOT NULL    ,
	ItemCount            int NOT NULL    ,
	CONSTRAINT PK_Invoice PRIMARY KEY  ( InvoiceId ) 
 );

CREATE  INDEX IX_Invoice_AccountId ON dbo.tbInvoice ( AccountId, IssueDateTime );

CREATE  INDEX IX_Invoice_OpAreaId ON dbo.tbInvoice ( OpAreaId, IssueDateTime );

CREATE  INDEX IX_Invoice_UserAccountId ON dbo.tbInvoice ( UserAccountId, IssueDateTime );

CREATE  INDEX IX_Invoice_LocationId ON dbo.tbInvoice ( LocationId, IssueDateTime );

CREATE  INDEX IX_Invoice_WorkstationId ON dbo.tbInvoice ( WorkstationId, IssueDateTime );

CREATE  INDEX IX_Invoice_IssueDate ON dbo.tbInvoice ( IssueDate, IssueDateTime );

CREATE UNIQUE INDEX UQ_Invoice_InvoiceCode ON dbo.tbInvoice ( InvoiceCode );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the invoice header data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Unique code of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceCode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'InvoiceStatus';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Issue Date/Time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'IssueDateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Issue date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'IssueDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Due date of the invoice payment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'DueDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Account of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'AccountId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the location the invoice is issued for' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'LocationId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to operating area where the invoice was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'OpAreaId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to workstation where the invoice was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'WorkstationId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the user that created the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'UserAccountId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total gross amount of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'TotalAmount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total tax amount of the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'TotalTax';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total quantity of items in the invoice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbInvoice', @level2type=N'COLUMN',@level2name=N'ItemCount';

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_Account FOREIGN KEY ( AccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_UserAccount FOREIGN KEY ( UserAccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES dbo.tbWorkstation( WorkstationId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_LocationAccount FOREIGN KEY ( LocationId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbInvoice ADD CONSTRAINT FK_Invoice_OpAreaAccount FOREIGN KEY ( OpAreaId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbLedgerManual" id="Editor_197" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbLedgerManual ( 
	LedgerManualId       uniqueidentifier NOT NULL    ,
	LedgerManualDateTime smalldatetime NOT NULL    ,
	LedgerLocalDateTime  smalldatetime     ,
	LocationId           uniqueidentifier NOT NULL    ,
	WorkstationId        uniqueidentifier NOT NULL    ,
	UserAccountId        uniqueidentifier NOT NULL    ,
	LedgerManualNotes    nvarchar(100)     ,
	TicketId             uniqueidentifier     ,
	AffectClearingLimit  bit     ,
	GateCategoryId       uniqueidentifier     ,
	CONSTRAINT PK_LedgerManual PRIMARY KEY  ( LedgerManualId )
 );

CREATE  INDEX IX_LedgerManual_WorstationId ON dbo.tbLedgerManual ( WorkstationId ASC, LedgerManualDateTime ASC );

CREATE  INDEX IX_LedgerManual_UserAccountId ON dbo.tbLedgerManual ( UserAccountId ASC, LedgerManualDateTime ASC );

CREATE  INDEX IX_LedgerManual_DateTime ON dbo.tbLedgerManual ( LedgerManualDateTime ASC );

CREATE  INDEX IX_LedgerManual_TicketId ON dbo.tbLedgerManual ( TicketId ASC, LedgerManualDateTime ASC ) where ticketId is not null;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to store ledger manual entries information' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerManual';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerManual', @level2type=N'COLUMN',@level2name=N'LedgerManualId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Operation date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerManual', @level2type=N'COLUMN',@level2name=N'LedgerManualDateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/Time of the entry' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerManual', @level2type=N'COLUMN',@level2name=N'LedgerLocalDateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the location' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerManual', @level2type=N'COLUMN',@level2name=N'LocationId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the workstation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerManual', @level2type=N'COLUMN',@level2name=N'WorkstationId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the operator' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerManual', @level2type=N'COLUMN',@level2name=N'UserAccountId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Operation''s notes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerManual', @level2type=N'COLUMN',@level2name=N'LedgerManualNotes';

ALTER TABLE dbo.tbLedgerManual ADD CONSTRAINT FK_LedgerManual_UserAccount FOREIGN KEY ( UserAccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbLedgerManual ADD CONSTRAINT FK_LedgerManual_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES dbo.tbWorkstation( WorkstationId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbLedgerManual ADD CONSTRAINT FK_LedgerManual_Ticket FOREIGN KEY ( TicketId ) REFERENCES dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbLedgerManual ADD CONSTRAINT FK_LedgerManual_LocationAccount FOREIGN KEY ( LocationId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbLedgerManual ADD CONSTRAINT FK_LedgerManual_GateCategory FOREIGN KEY ( GateCategoryId ) REFERENCES dbo.tbGateCategory( GateCategoryId ) ON DELETE NO ACTION ON UPDATE NO ACTION;]]></string>
		</script>
		<script name="tbLedgerRule" id="Editor-45e" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbLedgerRule ( 
	LedgerRuleId         uniqueidentifier      NOT NULL,
	LedgerTriggerType    smallint      NOT NULL,
	TriggerAccessPointId uniqueidentifier      NULL,
	TriggerEntityType    smallint      NOT NULL,
	TriggerEntityId      uniqueidentifier      NOT NULL,
	LedgerRuleAmount     money      NOT NULL,
	LedgerRuleAmountType smallint      NOT NULL,
	PluginId             uniqueidentifier      NULL,
	LastUpdate           datetime      NULL,
	SerialNumber         int      NOT NULL,
	LedgerRuleStatus     smallint      NOT NULL,
	AutoRevertLedgerAccountId uniqueidentifier      NULL,
	AutoRevertLocationType smallint      NULL,
	AutoRevertLocationId uniqueidentifier      NULL,
	CONSTRAINT PK_LedgerRule PRIMARY KEY  ( LedgerRuleId ) 
 );
GO

CREATE  INDEX IX_LedgerRule_TriggerEntityId ON SnApp.dbo.tbLedgerRule ( TriggerEntityId ASC );
GO

CREATE  INDEX IX_LedgerRule_PluginId ON SnApp.dbo.tbLedgerRule ( PluginId ) where PluginId is not null;
GO

CREATE  INDEX IX_LedgerRule_AutoRevertLedgerAccountId ON SnApp.dbo.tbLedgerRule ( AutoRevertLedgerAccountId );
GO

CREATE  INDEX IX_LedgerRule_AutoRevertLocationId ON SnApp.dbo.tbLedgerRule ( AutoRevertLocationId );
GO

ALTER TABLE SnApp.dbo.tbLedgerRule ADD CONSTRAINT FK_LedgerRule_Plugin FOREIGN KEY ( PluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbLedgerRule ADD CONSTRAINT FK_LedgerRule_AutoRevertLedgerAccount FOREIGN KEY ( AutoRevertLedgerAccountId ) REFERENCES SnApp.dbo.tbLedgerAccount( LedgerAccountId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbLedgerRule ADD CONSTRAINT FK_LedgerRule_AutoRevertLocation FOREIGN KEY ( AutoRevertLocationId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE CASCADE;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information about configured ledger rules' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'LedgerRuleId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[183] Sale, RedeemEntry, RedeemReentry, etc' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'LedgerTriggerType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Filter on access point during redemption' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'TriggerAccessPointId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131] Product/AttributeItem' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'TriggerEntityType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[181]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'LedgerRuleAmountType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to external ledger rule' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'PluginId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used in order to identify the ledger rule in order to keep track of the history details when the prices are changed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'SerialNumber';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[353] Active / Inactive / Deleted' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'LedgerRuleStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'General deferred revenue ledger account ID to be used when rule is "Refund" and flag "Automatic revert" is checked.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'AutoRevertLedgerAccountId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[182] - Fixed, SaleLocation, AdmissionLocation, ProductLocation, TransactionLocation, ReservationOwner' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'AutoRevertLocationType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Location to be used when rule is "Refund" and "Automatic revert" flag is checked' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRule', @level2type=N'COLUMN',@level2name=N'AutoRevertLocationId';
GO
]]></string>
		</script>
		<script name="tbLedgerRuleTemplate_001" id="Editor-1fd7" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbLedgerRuleTemplate ( 
	LedgerRuleTemplateId uniqueidentifier      NOT NULL,
	LedgerRuleTemplateCode varchar(15)      NOT NULL,
	LedgerRuleTemplateName nvarchar(50)      NOT NULL,
	Enabled              bit      NOT NULL,
	LastUpdate           datetime      NULL,
	CategoryId           uniqueidentifier      NULL,
	CONSTRAINT UQ_LedgerRuleTemplate_Code UNIQUE ( LedgerRuleTemplateCode ASC ) ,
	CONSTRAINT PK_LedgerRuleTemplate PRIMARY KEY  ( LedgerRuleTemplateId ) 
 );
GO

CREATE  INDEX IX_LedgerRuleTemplate_CategoryId ON SnApp.dbo.tbLedgerRuleTemplate ( CategoryId ) WHERE CategoryId IS NOT NULL;
GO

ALTER TABLE SnApp.dbo.tbLedgerRuleTemplate ADD CONSTRAINT FK_LedgerRuleTemplate_Category FOREIGN KEY ( CategoryId ) REFERENCES SnApp.dbo.tbCategory( CategoryId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information about configure ledger rule profiles' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRuleTemplate';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRuleTemplate', @level2type=N'COLUMN',@level2name=N'LedgerRuleTemplateId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Intellegible alphanumeric user defined code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRuleTemplate', @level2type=N'COLUMN',@level2name=N'LedgerRuleTemplateCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Name of the profile' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRuleTemplate', @level2type=N'COLUMN',@level2name=N'LedgerRuleTemplateName';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Status' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRuleTemplate', @level2type=N'COLUMN',@level2name=N'Enabled';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Category of the ledgerRuleTemplate' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbLedgerRuleTemplate', @level2type=N'COLUMN',@level2name=N'CategoryId';
GO]]></string>
		</script>
		<script name="tbMembershipPointAccrualRule" id="Editor-13f2" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbMembershipPointAccrualRule ( 
	MembershipPointAccrualRuleId uniqueidentifier      NOT NULL,
	MembershipPointAccrualRuleStatus smallint      NOT NULL,
	ProductId            uniqueidentifier      NOT NULL,
	MembershipPointId    uniqueidentifier      NOT NULL,
	ExchangeRate         decimal(38,19)      NOT NULL,
	ValidDateFrom        date      NULL,
	ValidDateTo          date      NULL,
	CalendarId           uniqueidentifier      NULL,
	CONSTRAINT PK_MembershipPointAccrualRule PRIMARY KEY  ( MembershipPointAccrualRuleId ) 
 );
GO

CREATE  INDEX IX_MembershipPointAccrualRule_CalendarId ON SnApp.dbo.tbMembershipPointAccrualRule ( CalendarId, MembershipPointAccrualRuleStatus ) where CalendarId is not null;
GO

CREATE  INDEX IX_tbMembershipPointAccrualRule_MembershipPointId ON SnApp.dbo.tbMembershipPointAccrualRule ( MembershipPointId, ProductId, MembershipPointAccrualRuleStatus );
GO

CREATE  INDEX IX_tbMembershipPointAccrualRule_ProductId ON SnApp.dbo.tbMembershipPointAccrualRule ( ProductId, MembershipPointId, MembershipPointAccrualRuleStatus );
GO

ALTER TABLE SnApp.dbo.tbMembershipPointAccrualRule ADD CONSTRAINT FK_MembershipPointAccrualRule_MembershipPoint FOREIGN KEY ( MembershipPointId ) REFERENCES SnApp.dbo.tbMembershipPoint( MembershipPointId );
GO

ALTER TABLE SnApp.dbo.tbMembershipPointAccrualRule ADD CONSTRAINT FK_MembershipPointAccrualRule_Calendar FOREIGN KEY ( CalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId );
GO

ALTER TABLE SnApp.dbo.tbMembershipPointAccrualRule ADD CONSTRAINT FK_MembershipPointAccrualRule_Product FOREIGN KEY ( ProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId ) ON DELETE CASCADE;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the rules to manage the reward point accrual' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Rule unique identifier' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'MembershipPointAccrualRuleId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[504]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'MembershipPointAccrualRuleStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the priviledge card product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'ProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the membership point' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'MembershipPointId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The number of points earn for every dollar of the product price' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'ExchangeRate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The rule is valid from this date. Infinite if is null.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'ValidDateFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The rule is valid to this date. Infinite if is null.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'ValidDateTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the calendar' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'CalendarId';
GO
]]></string>
		</script>
		<script name="tbMembershipPointAccrualRule2PaymentMethod" id="Editor-2e6" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbMembershipPointAccrualRule2PaymentMethod ( 
	MembershipPointAccrualRuleId uniqueidentifier      NOT NULL,
	PaymentMethodId      uniqueidentifier      NOT NULL,
	CONSTRAINT PK_MembershipPointAccrualRule2PaymentMethod PRIMARY KEY  ( MembershipPointAccrualRuleId, PaymentMethodId ) 
 );
GO

CREATE  INDEX IX_MembershipPointAccrualRule2PaymentMethod_PaymentMethodId ON SnApp.dbo.tbMembershipPointAccrualRule2PaymentMethod ( PaymentMethodId );
GO

ALTER TABLE SnApp.dbo.tbMembershipPointAccrualRule2PaymentMethod ADD CONSTRAINT FK_MembershipPointAccrualRule2PaymentMethod_MembershipPointAccrualRule FOREIGN KEY ( MembershipPointAccrualRuleId ) REFERENCES SnApp.dbo.tbMembershipPointAccrualRule( MembershipPointAccrualRuleId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbMembershipPointAccrualRule2PaymentMethod ADD CONSTRAINT FK_MembershipPointAccrualRule2PaymentMethod_PaymentMethod FOREIGN KEY ( PaymentMethodId ) REFERENCES SnApp.dbo.tbPluginPaymentMethod( PluginId ) ON DELETE CASCADE;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link table  membership point accrual rule to payment method' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule2PaymentMethod';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Membership point accrual rule unique identifier' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule2PaymentMethod', @level2type=N'COLUMN',@level2name=N'MembershipPointAccrualRuleId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Payment method unique identifier' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule2PaymentMethod', @level2type=N'COLUMN',@level2name=N'PaymentMethodId';
GO
]]></string>
		</script>
		<script name="tbMembershipPointAccrualRule_001" id="Editor-356" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbMembershipPointAccrualRule ( 
	MembershipPointAccrualRuleId uniqueidentifier      NOT NULL,
	MembershipPointAccrualRuleStatus smallint      NOT NULL,
	ProductId            uniqueidentifier      NOT NULL,
	MembershipPointId    uniqueidentifier      NOT NULL,
	ExchangeRate         decimal(38,19)      NOT NULL,
	ValidDateFrom        date      NULL,
	ValidDateTo          date      NULL,
	CalendarId           uniqueidentifier      NULL,
	RestrictPaymentMethodsType smallint      NULL,
	CONSTRAINT PK_MembershipPointAccrualRule PRIMARY KEY  ( MembershipPointAccrualRuleId ) 
 );
GO

CREATE  INDEX IX_MembershipPointAccrualRule_CalendarId ON SnApp.dbo.tbMembershipPointAccrualRule ( CalendarId, MembershipPointAccrualRuleStatus ) where CalendarId is not null;
GO

CREATE  INDEX IX_tbMembershipPointAccrualRule_MembershipPointId ON SnApp.dbo.tbMembershipPointAccrualRule ( MembershipPointId, ProductId, MembershipPointAccrualRuleStatus );
GO

CREATE  INDEX IX_tbMembershipPointAccrualRule_ProductId ON SnApp.dbo.tbMembershipPointAccrualRule ( ProductId, MembershipPointId, MembershipPointAccrualRuleStatus );
GO

ALTER TABLE SnApp.dbo.tbMembershipPointAccrualRule ADD CONSTRAINT FK_MembershipPointAccrualRule_MembershipPoint FOREIGN KEY ( MembershipPointId ) REFERENCES SnApp.dbo.tbMembershipPoint( MembershipPointId );
GO

ALTER TABLE SnApp.dbo.tbMembershipPointAccrualRule ADD CONSTRAINT FK_MembershipPointAccrualRule_Calendar FOREIGN KEY ( CalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId );
GO

ALTER TABLE SnApp.dbo.tbMembershipPointAccrualRule ADD CONSTRAINT FK_MembershipPointAccrualRule_Product FOREIGN KEY ( ProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId ) ON DELETE CASCADE;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the rules to manage the reward point accrual' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Rule unique identifier' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'MembershipPointAccrualRuleId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[504]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'MembershipPointAccrualRuleStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the priviledge card product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'ProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the membership point' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'MembershipPointId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The number of points earn for every dollar of the product price' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'ExchangeRate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The rule is valid from this date. Infinite if is null.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'ValidDateFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The rule is valid to this date. Infinite if is null.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'ValidDateTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the calendar' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'CalendarId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[508]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMembershipPointAccrualRule', @level2type=N'COLUMN',@level2name=N'RestrictPaymentMethodsType';
GO
]]></string>
		</script>
		<script name="tbMetaField" id="Editor_c95" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbMetaField ( 
	MetaFieldId          uniqueidentifier NOT NULL    ,
	MetaFieldCode        varchar(15) NOT NULL    ,
	MetaFieldName        nvarchar(50) NOT NULL    ,
	FieldType            smallint     ,
	FieldDataType        smallint NOT NULL    ,
	FieldDataFormat      smallint     ,
	SearchWeight         tinyint     ,
	RandomCombine        tinyint     ,
	MaxLength            smallint     ,
	MetaFieldGroupId     uniqueidentifier     ,
	MaskingRule          smallint     ,
	MaskStartChars       smallint     ,
	MaskEndChars         smallint     ,
	MaskSplitWords       bit     ,
	MaskMinChars         smallint     ,
	MaskMinCharsAlign    smallint     ,
	MaskingRulePluginId  uniqueidentifier     ,
	CONSTRAINT UQ_MetaField_Code UNIQUE ( MetaFieldCode ASC ) ,
	CONSTRAINT PK_MetaField PRIMARY KEY  ( MetaFieldId ) 
 );
GO

CREATE  INDEX IX_MetaField_FieldDataType ON SnApp.dbo.tbMetaField ( FieldDataType ASC );
GO

CREATE  INDEX IX_MetaField_MetaFieldGroupId ON SnApp.dbo.tbMetaField ( MetaFieldGroupId ) where MetaFieldGroupId is not null;
GO

CREATE  INDEX IX_MetaField_MaskingRulePluginId ON SnApp.dbo.tbMetaField ( MaskingRulePluginId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds user defined fields' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MetaFieldId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Intelligible alphanumeric user defined code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MetaFieldCode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Name of the field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MetaFieldName';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[9] (FirstName, LastName, Etc)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'FieldType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[8] (Text, Numeric, Etc...)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'FieldDataType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[270]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'FieldDataFormat';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used in account de-duplication search' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'SearchWeight';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used only for FieldType=Random.\nIndicates how many of the MetaFieldItems should be combined togheter in order to generate the random value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'RandomCombine';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Defines field length limit for a specific meta data field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaxLength';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[450] (General, Dynamic)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskingRule';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of chars not to be masked at the beginning of the text' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskStartChars';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of chars not to be masked at the end of the text' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskEndChars';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Mask each single word' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskSplitWords';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minimum number of chars to be masked' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskMinChars';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Alignment of the minimum number of chars to be masked' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskMinCharsAlign';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the plugin used to mask this field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskingRulePluginId';
GO

ALTER TABLE SnApp.dbo.tbMetaField ADD CONSTRAINT FK_MetaField_MetaFieldGroup FOREIGN KEY ( MetaFieldGroupId ) REFERENCES SnApp.dbo.tbMetaFieldGroup( MetaFieldGroupId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbMetaField ADD CONSTRAINT FK_MetaField_Plugin FOREIGN KEY ( MaskingRulePluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbMetaFieldFlag" id="Editor_22f3" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbMetaFieldFlag ( 
	MetaFieldId          uniqueidentifier NOT NULL    ,
	MetaFieldFlag        smallint NOT NULL    ,
	CONSTRAINT PK_MetaFieldFlag PRIMARY KEY  ( MetaFieldId, MetaFieldFlag ) 
 );
GO

CREATE  INDEX IX_MetaFieldFlag_MetaFieldFlag ON dbo.tbMetaFieldFlag ( MetaFieldFlag );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to meta field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaFieldFlag', @level2type=N'COLUMN',@level2name=N'MetaFieldId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[398]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaFieldFlag', @level2type=N'COLUMN',@level2name=N'MetaFieldFlag';
GO

ALTER TABLE dbo.tbMetaFieldFlag ADD CONSTRAINT FK_MetaFieldFlag_MetaField FOREIGN KEY ( MetaFieldId ) REFERENCES dbo.tbMetaField( MetaFieldId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO]]></string>
		</script>
		<script name="tbMetaField_001" id="Editor_1624" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbMetaField ( 
	MetaFieldId          uniqueidentifier NOT NULL    ,
	MetaFieldCode        varchar(15) NOT NULL    ,
	MetaFieldName        nvarchar(50) NOT NULL    ,
	FieldType            smallint     ,
	FieldDataType        smallint NOT NULL    ,
	FieldDataFormat      smallint     ,
	SearchWeight         tinyint     ,
	RandomCombine        tinyint     ,
	MaxLength            smallint     ,
	MetaFieldGroupId     uniqueidentifier     ,
	MaskingRule          smallint     ,
	MaskStartChars       smallint     ,
	MaskEndChars         smallint     ,
	MaskSplitWords       bit NOT NULL    ,
	MaskMinChars         smallint     ,
	MaskMinCharsAlign    smallint     ,
	MaskingRulePluginId  uniqueidentifier     ,
	CONSTRAINT UQ_MetaField_Code UNIQUE ( MetaFieldCode ASC ) ,
	CONSTRAINT PK_MetaField PRIMARY KEY  ( MetaFieldId ) 
 );
GO

CREATE  INDEX IX_MetaField_FieldDataType ON SnApp.dbo.tbMetaField ( FieldDataType ASC );
GO

CREATE  INDEX IX_MetaField_MetaFieldGroupId ON SnApp.dbo.tbMetaField ( MetaFieldGroupId ) where MetaFieldGroupId is not null;
GO

CREATE  INDEX IX_MetaField_MaskingRulePluginId ON SnApp.dbo.tbMetaField ( MaskingRulePluginId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds user defined fields' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MetaFieldId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Intelligible alphanumeric user defined code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MetaFieldCode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Name of the field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MetaFieldName';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[9] (FirstName, LastName, Etc)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'FieldType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[8] (Text, Numeric, Etc...)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'FieldDataType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[270]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'FieldDataFormat';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used in account de-duplication search' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'SearchWeight';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used only for FieldType=Random.\nIndicates how many of the MetaFieldItems should be combined togheter in order to generate the random value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'RandomCombine';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Defines field length limit for a specific meta data field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaxLength';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[450] (General, Dynamic)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskingRule';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of chars not to be masked at the beginning of the text' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskStartChars';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of chars not to be masked at the end of the text' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskEndChars';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Mask each single word' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskSplitWords';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minimum number of chars to be masked' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskMinChars';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[451] Alignment type of the minimum number of chars to be masked' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskMinCharsAlign';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the plugin used to mask this field' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbMetaField', @level2type=N'COLUMN',@level2name=N'MaskingRulePluginId';
GO

ALTER TABLE SnApp.dbo.tbMetaField ADD CONSTRAINT FK_MetaField_MetaFieldGroup FOREIGN KEY ( MetaFieldGroupId ) REFERENCES SnApp.dbo.tbMetaFieldGroup( MetaFieldGroupId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbMetaField ADD CONSTRAINT FK_MetaField_Plugin FOREIGN KEY ( MaskingRulePluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbNotifyLog" id="Editor_160b" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbNotifyLog ( 
	NotifyLogId          uniqueidentifier NOT NULL    ,
	NotifyRuleId         uniqueidentifier NOT NULL    ,
	NotifyDateTime       datetime NOT NULL    ,
	ServerDateTime       datetime NOT NULL    ,
	WorkstationId        uniqueidentifier NOT NULL    ,
	UserAccountId        uniqueidentifier     ,
	EmailSent            bit NOT NULL    ,
	SmsSent              bit NOT NULL    ,
	DocData              nvarchar(max)     ,
	ActionId             uniqueidentifier     ,
	CONSTRAINT PK_NotifyLog PRIMARY KEY  ( NotifyLogId ) 
 );
GO

CREATE  INDEX IX_NotifyLog_NotifyDateTime ON dbo.tbNotifyLog ( NotifyDateTime ASC );
GO

CREATE  INDEX IX_NotifyLog_NotifyRuleId ON dbo.tbNotifyLog ( NotifyRuleId ASC, NotifyDateTime ASC );
GO

CREATE  INDEX IX_NotifyLog_WorkstationId ON dbo.tbNotifyLog ( WorkstationId ASC, NotifyDateTime ASC );
GO

CREATE  INDEX IX_NotifyLog_UserAccountId ON dbo.tbNotifyLog ( UserAccountId ASC, NotifyDateTime ASC ) where UserAccountId is not null;
GO

CREATE  INDEX IX_NotifyLog_ServerDateTime ON dbo.tbNotifyLog ( ServerDateTime ASC );
GO

CREATE  INDEX IX_NotifyLog_ActionId ON dbo.tbNotifyLog ( ActionId ) where ActionId is not null;
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Logs events happened according to what is configured in tbNotifyRule' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog';;
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'NotifyLogId';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the notification rule triggered' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'NotifyRuleId';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time about when the event happened' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'NotifyDateTime';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time about when the record was saved at DB' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'ServerDateTime';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the workstation where the event happened' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'WorkstationId';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'User logged in when the event happend' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'UserAccountId';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if an email notification has been sent' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'EmailSent';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if an sms notification has been sent' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'SmsSent';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Additional info in JSON' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'DocData';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the generated action (email)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbNotifyLog', @level2type=N'COLUMN',@level2name=N'ActionId';
GO

ALTER TABLE dbo.tbNotifyLog ADD CONSTRAINT FK_NotifyLog_UserAccount FOREIGN KEY ( UserAccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE dbo.tbNotifyLog ADD CONSTRAINT FK_NotifyLog_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES dbo.tbWorkstation( WorkstationId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE dbo.tbNotifyLog ADD CONSTRAINT FK_NotifyLog_NotifyRule FOREIGN KEY ( NotifyRuleId ) REFERENCES dbo.tbNotifyRule( NotifyRuleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE dbo.tbNotifyLog ADD CONSTRAINT FK_NotifyLog_Action FOREIGN KEY ( ActionId ) REFERENCES dbo.tbAction( ActionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO]]></string>
		</script>
		<script name="tbOutboundQueueHistoryConsQueue" id="Editor-179" language="SQL" >
			<string><![CDATA[CREATE TABLE tbOutboundQueueHistoryConsQueue ( 
	OutboundQueueHistoryId uniqueidentifier NOT NULL    ,
	ServerId             smallint     ,
	ConsQueueStatus      smallint NOT NULL    ,
	QueueDateTime        datetime NOT NULL    ,
	StartDateTime        datetime     ,
	EndDateTime          datetime     ,
	CONSTRAINT PK_OutboundQueueHistoryConsQueue PRIMARY KEY  ( OutboundQueueHistoryId ) 
 );
GO

CREATE  INDEX IX_OutboundQueueHistoryConsQueue_ServerId ON tbOutboundQueueHistoryConsQueue ( ServerId ASC, ConsQueueStatus ASC );
GO

CREATE  INDEX IX_OutboundQueueHistoryConsQueue_ConsQueueStatus ON tbOutboundQueueHistoryConsQueue ( ConsQueueStatus ASC, QueueDateTime ASC );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the outbound queue' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbOutboundQueueHistoryConsQueue', @level2type=N'COLUMN',@level2name=N'OutboundQueueHistoryId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tomcat instance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbOutboundQueueHistoryConsQueue', @level2type=N'COLUMN',@level2name=N'ServerId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[266]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbOutboundQueueHistoryConsQueue', @level2type=N'COLUMN',@level2name=N'ConsQueueStatus';
GO

ALTER TABLE tbOutboundQueueHistoryConsQueue ADD CONSTRAINT FK_OutboundQueueHistoryConsQueue_OutboundQueueHistory FOREIGN KEY ( OutboundQueueHistoryId ) REFERENCES tbOutboundQueueHistory( OutboundQueueHistoryId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbPaymentFolio" id="Editor-14" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbPaymentFolio ( 
	PaymentId            uniqueidentifier      NOT NULL,
	FolioNumber          nvarchar(20)      NOT NULL,
	RoomNumber           nvarchar(20)      NULL,
	GuestName            varchar(50)      NULL,
	CONSTRAINT PK_PaymentFolio PRIMARY KEY  ( PaymentId ) 
 );
GO

CREATE  INDEX IX_PaymentFolio_FolioNumber ON SnApp.dbo.tbPaymentFolio ( FolioNumber ASC );
GO

CREATE  INDEX IX_PaymentFolio_RoomNumber ON SnApp.dbo.tbPaymentFolio ( RoomNumber ASC ) where RoomNumber is not null;
GO

ALTER TABLE SnApp.dbo.tbPaymentFolio ADD CONSTRAINT FK_PaymentFolio_Payment FOREIGN KEY ( PaymentId ) REFERENCES SnApp.dbo.tbPayment( PaymentId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Extension table for tbPayment. Holds additional information for "folio" payment methods' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentFolio';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal Id' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentFolio', @level2type=N'COLUMN',@level2name=N'PaymentId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Folio number charged for payment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentFolio', @level2type=N'COLUMN',@level2name=N'FolioNumber';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Room number where the folio belog to' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentFolio', @level2type=N'COLUMN',@level2name=N'RoomNumber';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Name of the Guest where folio is referenced to' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentFolio', @level2type=N'COLUMN',@level2name=N'GuestName';
GO
]]></string>
		</script>
		<script name="tbPaymentMembership" id="Editor-1f2e" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbPaymentMembership ( 
	PaymentId            uniqueidentifier      NOT NULL,
	MembershipPlanProductId uniqueidentifier      NOT NULL,
	MembershipCardCode   varchar(100)      NOT NULL,
	MembershipCardCodeDisplay varchar(100)      NOT NULL,
	CardHolderName       nvarchar(100)      NULL,
	CONSTRAINT PK_PaymentMembership PRIMARY KEY  ( PaymentId ) 
 );
GO

CREATE  INDEX IX_PaymentMembership_MembershipPlanProductId ON SnApp.dbo.tbPaymentMembership ( MembershipPlanProductId );
GO

CREATE  INDEX IX_PaymentMembership_MembershipCardCode ON SnApp.dbo.tbPaymentMembership ( MembershipCardCode );
GO

ALTER TABLE SnApp.dbo.tbPaymentMembership ADD CONSTRAINT FK_PaymentMembership_Payment FOREIGN KEY ( PaymentId ) REFERENCES SnApp.dbo.tbPayment( PaymentId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbPaymentMembership ADD CONSTRAINT FK_PaymentMembership_MembershipPlanProduct FOREIGN KEY ( MembershipPlanProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Extension table for tbPayment. Holds additional information for "membership" payment methods' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentMembership';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentMembership', @level2type=N'COLUMN',@level2name=N'PaymentId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to tbProduct.ProductId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentMembership', @level2type=N'COLUMN',@level2name=N'MembershipPlanProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Unique membership card identifier for internal use' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentMembership', @level2type=N'COLUMN',@level2name=N'MembershipCardCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Membership card code to be displayed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentMembership', @level2type=N'COLUMN',@level2name=N'MembershipCardCodeDisplay';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Card holder name (could be masked)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentMembership', @level2type=N'COLUMN',@level2name=N'CardHolderName';
GO
]]></string>
		</script>
		<script name="tbPaymentToken" id="Editor_1bed" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbPaymentToken ( 
	PaymentTokenId       uniqueidentifier NOT NULL    ,
	PaymentTokenCode     varchar(100) NOT NULL    ,
	PaymentTokenType     smallint NOT NULL    ,
	PaymentTokenDesc     varchar(30)     ,
	CreateDate           date NOT NULL    ,
	CardType             varchar(15)     ,
	CardNumber           varchar(20)     ,
	ExpirationDate       date     ,
	AccountId            uniqueidentifier     ,
	PluginId             uniqueidentifier     ,
	CONSTRAINT UQ_PaymentToken_Code UNIQUE ( PaymentTokenCode ASC ) ,
	CONSTRAINT PK_PaymentToken PRIMARY KEY  ( PaymentTokenId ) 
 );
GO

ALTER TABLE SnApp.dbo.tbPaymentToken ADD CONSTRAINT CK_PaymentToken_PluginId CHECK ( ((PaymentTokenType <> 1) OR ((PaymentTokenType = 1) AND (PluginId is not null))) );
GO

CREATE  INDEX IX_PaymentToken_AccountId ON SnApp.dbo.tbPaymentToken ( AccountId ASC, CreateDate ASC ) where AccountId is not null;
GO

CREATE  INDEX IX_PaymentToken_ExpirationDate ON SnApp.dbo.tbPaymentToken ( ExpirationDate ASC ) where ExpirationDate is not null;
GO

CREATE  INDEX IX_PaymentToken_CreateDate ON SnApp.dbo.tbPaymentToken ( CreateDate ASC );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information about payments which require token storage for future transactions' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal Id' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PaymentTokenId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Token value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PaymentTokenCode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[218] - Internal use' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PaymentTokenType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"Alias" or description that could be associated with a card+token' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PaymentTokenDesc';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date of creation of the token' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'CreateDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'VISA, AMEX, etc....' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'CardType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Masked credit card number' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'CardNumber';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date of expiration of the token (null means no expiration)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'ExpirationDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the account in the account table (if any)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'AccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the payment plugin which inserted the token' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PluginId';
GO

ALTER TABLE SnApp.dbo.tbPaymentToken ADD CONSTRAINT FK_PaymentToken_Account FOREIGN KEY ( AccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPaymentToken ADD CONSTRAINT FK_PaymentToken_Plugin FOREIGN KEY ( PluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO]]></string>
		</script>
		<script name="tbPaymentTokenData_001" id="Editor_1e0c" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbPaymentTokenData ( 
	PaymentTokenId       uniqueidentifier NOT NULL    ,
	ParamName            varchar(30) NOT NULL    ,
	ParamValue           nvarchar(100) NOT NULL    ,
	ParamValueLong       nvarchar(max)     ,
	CONSTRAINT PK_PaymentTokenData PRIMARY KEY  ( PaymentTokenId, ParamName ) 
 );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Table designed to store additional custom data for payment tokens.\nEspecially useful for credit card integration with external devices returning custom/specific data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentTokenData';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to tbPaymentToken table' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentTokenData', @level2type=N'COLUMN',@level2name=N'PaymentTokenId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Name of the parameter' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentTokenData', @level2type=N'COLUMN',@level2name=N'ParamName';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Value of the parameter' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentTokenData', @level2type=N'COLUMN',@level2name=N'ParamValue';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Value of the parameter if longer then 100 chars' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentTokenData', @level2type=N'COLUMN',@level2name=N'ParamValueLong';
GO

ALTER TABLE SnApp.dbo.tbPaymentTokenData ADD CONSTRAINT FK_PaymentTokenData_PaymentToken FOREIGN KEY ( PaymentTokenId ) REFERENCES SnApp.dbo.tbPaymentToken( PaymentTokenId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO]]></string>
		</script>
		<script name="tbPaymentToken_001" id="Editor_1405" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbPaymentToken ( 
	PaymentTokenId       uniqueidentifier NOT NULL    ,
	PaymentTokenCode     varchar(100) NOT NULL    ,
	PaymentTokenType     smallint NOT NULL    ,
	PaymentTokenDesc     varchar(30)     ,
	CreateDate           date NOT NULL    ,
	CardType             varchar(15)     ,
	CardNumber           varchar(20)     ,
	ExpirationDate       date     ,
	AccountId            uniqueidentifier     ,
	PluginId             uniqueidentifier     ,
	CONSTRAINT UQ_PaymentToken_Code UNIQUE ( PaymentTokenCode ASC ) ,
	CONSTRAINT PK_PaymentToken PRIMARY KEY  ( PaymentTokenId ) 
 );
GO

ALTER TABLE SnApp.dbo.tbPaymentToken ADD CONSTRAINT CK_PaymentToken_PluginId CHECK ( ((PaymentTokenType <> 1) OR ((PaymentTokenType = 1) AND (PluginId is not null))) );
GO

CREATE  INDEX IX_PaymentToken_AccountId ON SnApp.dbo.tbPaymentToken ( AccountId ASC, CreateDate ASC ) where AccountId is not null;
GO

CREATE  INDEX IX_PaymentToken_ExpirationDate ON SnApp.dbo.tbPaymentToken ( ExpirationDate ASC ) where ExpirationDate is not null;
GO

CREATE  INDEX IX_PaymentToken_CreateDate ON SnApp.dbo.tbPaymentToken ( CreateDate ASC );
GO

CREATE  INDEX IX_PaymentToken_PluginId ON SnApp.dbo.tbPaymentToken ( PluginId ) WHERE PluginId is not null;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information about payments which require token storage for future transactions' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal Id' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PaymentTokenId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Token value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PaymentTokenCode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[218] - Internal use' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PaymentTokenType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'"Alias" or description that could be associated with a card+token' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PaymentTokenDesc';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date of creation of the token' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'CreateDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'VISA, AMEX, etc....' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'CardType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Masked credit card number' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'CardNumber';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date of expiration of the token (null means no expiration)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'ExpirationDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the account in the account table (if any)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'AccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the payment plugin which inserted the token' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentToken', @level2type=N'COLUMN',@level2name=N'PluginId';
GO

ALTER TABLE SnApp.dbo.tbPaymentToken ADD CONSTRAINT FK_PaymentToken_Account FOREIGN KEY ( AccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPaymentToken ADD CONSTRAINT FK_PaymentToken_Plugin FOREIGN KEY ( PluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbPaymentWallet" id="Editor-11b4" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbPaymentWallet ( 
	PaymentId            uniqueidentifier      NOT NULL,
	TicketMediaMatchId   uniqueidentifier      NOT NULL,
	MembershipPointId    uniqueidentifier      NOT NULL,
	ExchangeRate         decimal(38,19)      NOT NULL,
	PointAmount          money      NOT NULL,
	MediaId              uniqueidentifier      NULL,
	PortfolioSlotHoldId  uniqueidentifier      NULL,
	PorfolioSlotLogId    uniqueidentifier      NULL,
	CONSTRAINT PK_PaymentWallet PRIMARY KEY  ( PaymentId ) 
 );
GO

CREATE  INDEX IX_PaymentWallet_PortfolioId ON SnApp.dbo.tbPaymentWallet ( TicketMediaMatchId ASC );
GO

CREATE  INDEX IX_PaymentWallet_MediaId ON SnApp.dbo.tbPaymentWallet ( MediaId ASC ) where MediaId is not null;
GO

CREATE  INDEX IX_PaymentWallet_PortfolioHoldId ON SnApp.dbo.tbPaymentWallet ( PortfolioSlotHoldId ASC ) where PortfolioHoldSlotId is not null;
GO

CREATE  INDEX IX_PaymentWallet_MembershipPointId ON SnApp.dbo.tbPaymentWallet ( MembershipPointId ASC );
GO

CREATE  INDEX IX_PaymentWallet_PortfolioSlotLogId ON SnApp.dbo.tbPaymentWallet ( PorfolioSlotLogId ) where PortfolioSlotLogId is not null;
GO

ALTER TABLE SnApp.dbo.tbPaymentWallet ADD CONSTRAINT FK_PaymentWallet_Portfolio FOREIGN KEY ( TicketMediaMatchId ) REFERENCES SnApp.dbo.tbTicketMediaMatch( TicketMediaMatchId );
GO

ALTER TABLE SnApp.dbo.tbPaymentWallet ADD CONSTRAINT FK_PaymentWallet_Media FOREIGN KEY ( MediaId ) REFERENCES SnApp.dbo.tbMedia( MediaId );
GO

ALTER TABLE SnApp.dbo.tbPaymentWallet ADD CONSTRAINT FK_PaymentWallet_Payment FOREIGN KEY ( PaymentId ) REFERENCES SnApp.dbo.tbPayment( PaymentId );
GO

ALTER TABLE SnApp.dbo.tbPaymentWallet ADD CONSTRAINT FK_PaymentWallet_MembershipPoint FOREIGN KEY ( MembershipPointId ) REFERENCES SnApp.dbo.tbMembershipPoint( MembershipPointId );
GO

ALTER TABLE SnApp.dbo.tbPaymentWallet ADD CONSTRAINT FK_PaymentWallet_PortfolioSlotHold FOREIGN KEY ( PortfolioSlotHoldId ) REFERENCES SnApp.dbo.tbPortfolioSlotHold( PortfolioSlotHoldId );
GO

ALTER TABLE SnApp.dbo.tbPaymentWallet ADD CONSTRAINT FK_PaymentWallet_PortfolioSlotLog FOREIGN KEY ( PorfolioSlotLogId ) REFERENCES SnApp.dbo.tbPortfolioSlotLog( PortfolioSlotLogId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to PortfolioSlotLog' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPaymentWallet', @level2type=N'COLUMN',@level2name=N'PorfolioSlotLogId';
GO
]]></string>
		</script>
		<script name="tbPerformance" id="Editor_1f1f" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbPerformance ( 
	PerformanceId        uniqueidentifier NOT NULL    ,
	EventId              uniqueidentifier NOT NULL    ,
	CalendarId           uniqueidentifier     ,
	PerformanceTypeId    uniqueidentifier     ,
	RateCodeId           uniqueidentifier     ,
	LocationAccountId    uniqueidentifier     ,
	AccessAreaAccountId  uniqueidentifier     ,
	AllocateResourcesOnCreate bit NOT NULL    ,
	DateTimeFrom         smalldatetime NOT NULL    ,
	DateTimeTo           smalldatetime NOT NULL    ,
	TimeZone             tinyint NOT NULL    ,
	DBDateTimeFrom       smalldatetime NOT NULL    ,
	DBDateTimeTo         smalldatetime NOT NULL    ,
	PerformanceStatus    smallint NOT NULL    ,
	OnSaleFrom           date     ,
	OnSaleTo             date     ,
	CustomSeat           bit NOT NULL    ,
	PerformanceTypeFromCalendar bit NOT NULL    ,
	QuantityRedeemed     int NOT NULL    ,
	QuantityInside       int NOT NULL    ,
	AdmissionOpenMins    smallint     ,
	AdmissionCloseMins   smallint     ,
	AutoCreated          bit NOT NULL    ,
	RestrictOpenOrder    bit NOT NULL    ,
	EnvelopeSwapDateTime datetime     ,
	[InheritFulfilmentArea ] bit NOT NULL    ,
	[FulfilmentAreaTagId ] uniqueidentifier     ,
	CONSTRAINT PK_Performance PRIMARY KEY  ( PerformanceId ) 
 );
GO

CREATE  INDEX IX_Performance_EventDateTime ON SnApp.dbo.tbPerformance ( EventId ASC, DBDateTimeFrom ASC );
GO

CREATE  INDEX IX_Performance_DateTimeFromTo ON SnApp.dbo.tbPerformance ( DBDateTimeFrom ASC, DBDateTimeTo ASC ) include (EventId);
GO

CREATE  INDEX IX_Performance_LocationDateTime ON SnApp.dbo.tbPerformance ( LocationAccountId ASC, DBDateTimeFrom ASC ) include ([EventId]);
GO

CREATE  INDEX IX_Performance_AcAreaDateTime ON SnApp.dbo.tbPerformance ( AccessAreaAccountId ASC, DBDateTimeFrom ASC );
GO

CREATE  INDEX IX_Performance_Event_Status_DateTimeTo ON SnApp.dbo.tbPerformance ( EventId ASC, PerformanceStatus ASC, DBDateTimeTo ASC );
GO

CREATE  INDEX IX_Performance_AcAreaDateTimeTo ON SnApp.dbo.tbPerformance ( AccessAreaAccountId ASC, DateTimeTo ASC );
GO

CREATE  INDEX IX_Performance_EventAutoCreated ON SnApp.dbo.tbPerformance ( EventId ASC, AutoCreated ASC, DBDateTimeTo ASC );
GO

CREATE  INDEX IX_Performance_RateCodeId ON SnApp.dbo.tbPerformance ( RateCodeId ASC, DBDateTimeFrom ASC ) where RateCodeId is not null;
GO

CREATE  INDEX IX_Performance_CalendarId ON SnApp.dbo.tbPerformance ( CalendarId ASC, DBDateTimeFrom ASC ) where CalendarId is not null;
GO

CREATE  INDEX IX_Performance_PerformaneTypeId ON SnApp.dbo.tbPerformance ( PerformanceTypeId ) where PerformanceTypeId is not null;
GO

CREATE  INDEX IX_Performance_FulfilmentAreaTagId ON SnApp.dbo.tbPerformance ( [FulfilmentAreaTagId ] ) where FulfilmentAreaTagId is not null;
GO

CREATE  INDEX IX_Performance_EventId_DateTimeFrom ON SnApp.dbo.tbPerformance ( EventId, DateTimeFrom )  INCLUDE DateTimeTo, PerformanceStatus;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information abount event''s performances' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'PerformanceId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Event of the performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'EventId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Calendar of the performance. Used  to autmatically assign PerformanceType and RateCode' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'CalendarId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'PerformanceType of the performance. Used to access different price lists' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'PerformanceTypeId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'RateCode of the performance. Used to access different price lists' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'RateCodeId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Location where the performance will actually take place' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'LocationAccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For admission control purposes, tells what is the access area which grant access to the performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'AccessAreaAccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Location''s timezone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'DateTimeFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Location''s timezone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'DateTimeTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[238]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'TimeZone';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time of the performance related to DB timezone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'DBDateTimeFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time of the performance related to DB timezone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'DBDateTimeTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[104]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'PerformanceStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Performance sellable only starting from date.\nNull = no limits' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'OnSaleFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Performance sellable only within date.\nNull = no limits' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'OnSaleTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the performance has a custom seat template instead of the access area default' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'CustomSeat';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tells to inherit PerformanceType and RateCode from calendar (event''s calendar will be used if not defined at performance levell)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'PerformanceTypeFromCalendar';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Counter for Entries' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'QuantityRedeemed';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Counter for (Entries - Exits)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'QuantityInside';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'look at tbEvent.AdmissionOpenMins' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'AdmissionOpenMins';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'look at tbEvent.AdmissionCloseMins' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'AdmissionCloseMins';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If flagged, orders cannot be left open but must be paid on creation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'RestrictOpenOrder';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time when the performance was checked the last time for seat envelope automatic swap' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'EnvelopeSwapDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If TRUE, inherits the fulfilment access area id from the configured access area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'InheritFulfilmentArea ';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ID of the fulfillment access area group label (tag) created in BKO' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'FulfilmentAreaTagId ';
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_LocationAccount FOREIGN KEY ( LocationAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_AcAreaAccount FOREIGN KEY ( AccessAreaAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_Event FOREIGN KEY ( EventId ) REFERENCES SnApp.dbo.tbEvent( EventId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_PerformanceType FOREIGN KEY ( PerformanceTypeId ) REFERENCES SnApp.dbo.tbPerformanceType( PerformanceTypeId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_Calendar FOREIGN KEY ( CalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_RateCode FOREIGN KEY ( RateCodeId ) REFERENCES SnApp.dbo.tbRateCode( RateCodeId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_FulfilmentAreaTag FOREIGN KEY ( [FulfilmentAreaTagId ] ) REFERENCES SnApp.dbo.tbTag( TagId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbPerformance_001" id="Editor_1e67" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbPerformance ( 
	PerformanceId        uniqueidentifier NOT NULL    ,
	EventId              uniqueidentifier NOT NULL    ,
	CalendarId           uniqueidentifier     ,
	PerformanceTypeId    uniqueidentifier     ,
	RateCodeId           uniqueidentifier     ,
	LocationAccountId    uniqueidentifier     ,
	AccessAreaAccountId  uniqueidentifier     ,
	AllocateResourcesOnCreate bit NOT NULL    ,
	DateTimeFrom         smalldatetime NOT NULL    ,
	DateTimeTo           smalldatetime NOT NULL    ,
	TimeZone             tinyint NOT NULL    ,
	DBDateTimeFrom       smalldatetime NOT NULL    ,
	DBDateTimeTo         smalldatetime NOT NULL    ,
	PerformanceStatus    smallint NOT NULL    ,
	OnSaleFrom           date     ,
	OnSaleTo             date     ,
	CustomSeat           bit NOT NULL    ,
	PerformanceTypeFromCalendar bit NOT NULL    ,
	QuantityRedeemed     int NOT NULL    ,
	QuantityInside       int NOT NULL    ,
	AdmissionOpenMins    smallint     ,
	AdmissionCloseMins   smallint     ,
	AutoCreated          bit NOT NULL    ,
	RestrictOpenOrder    bit NOT NULL    ,
	EnvelopeSwapDateTime datetime     ,
	[InheritFulfilmentArea ] bit NOT NULL    ,
	[FulfilmentAreaTagId ] uniqueidentifier     ,
	CONSTRAINT PK_Performance PRIMARY KEY  ( PerformanceId ) 
 );
GO

CREATE  INDEX IX_Performance_EventDateTime ON SnApp.dbo.tbPerformance ( EventId ASC, DBDateTimeFrom ASC );
GO

CREATE  INDEX IX_Performance_DateTimeFromTo ON SnApp.dbo.tbPerformance ( DBDateTimeFrom ASC, DBDateTimeTo ASC ) include (EventId);
GO

CREATE  INDEX IX_Performance_LocationDateTime ON SnApp.dbo.tbPerformance ( LocationAccountId ASC, DBDateTimeFrom ASC ) include ([EventId]);
GO

CREATE  INDEX IX_Performance_AcAreaDateTime ON SnApp.dbo.tbPerformance ( AccessAreaAccountId ASC, DBDateTimeFrom ASC );
GO

CREATE  INDEX IX_Performance_Event_Status_DateTimeTo ON SnApp.dbo.tbPerformance ( EventId ASC, PerformanceStatus ASC, DBDateTimeTo ASC );
GO

CREATE  INDEX IX_Performance_AcAreaDateTimeTo ON SnApp.dbo.tbPerformance ( AccessAreaAccountId ASC, DateTimeTo ASC );
GO

CREATE  INDEX IX_Performance_EventAutoCreated ON SnApp.dbo.tbPerformance ( EventId ASC, AutoCreated ASC, DBDateTimeTo ASC );
GO

CREATE  INDEX IX_Performance_RateCodeId ON SnApp.dbo.tbPerformance ( RateCodeId ASC, DBDateTimeFrom ASC ) where RateCodeId is not null;
GO

CREATE  INDEX IX_Performance_CalendarId ON SnApp.dbo.tbPerformance ( CalendarId ASC, DBDateTimeFrom ASC ) where CalendarId is not null;
GO

CREATE  INDEX IX_Performance_PerformaneTypeId ON SnApp.dbo.tbPerformance ( PerformanceTypeId ) where PerformanceTypeId is not null;
GO

CREATE  INDEX IX_Performance_FulfilmentAreaTagId ON SnApp.dbo.tbPerformance ( [FulfilmentAreaTagId ] ) where FulfilmentAreaTagId is not null;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information abount event''s performances' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'PerformanceId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Event of the performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'EventId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Calendar of the performance. Used  to autmatically assign PerformanceType and RateCode' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'CalendarId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'PerformanceType of the performance. Used to access different price lists' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'PerformanceTypeId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'RateCode of the performance. Used to access different price lists' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'RateCodeId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Location where the performance will actually take place' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'LocationAccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For admission control purposes, tells what is the access area which grant access to the performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'AccessAreaAccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Location''s timezone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'DateTimeFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Location''s timezone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'DateTimeTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[238]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'TimeZone';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time of the performance related to DB timezone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'DBDateTimeFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time of the performance related to DB timezone' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'DBDateTimeTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[104]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'PerformanceStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Performance sellable only starting from date.\nNull = no limits' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'OnSaleFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Performance sellable only within date.\nNull = no limits' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'OnSaleTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the performance has a custom seat template instead of the access area default' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'CustomSeat';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tells to inherit PerformanceType and RateCode from calendar (event''s calendar will be used if not defined at performance levell)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'PerformanceTypeFromCalendar';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Counter for Entries' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'QuantityRedeemed';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Counter for (Entries - Exits)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'QuantityInside';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'look at tbEvent.AdmissionOpenMins' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'AdmissionOpenMins';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'look at tbEvent.AdmissionCloseMins' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'AdmissionCloseMins';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If flagged, orders cannot be left open but must be paid on creation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'RestrictOpenOrder';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time when the performance was checked the last time for seat envelope automatic swap' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'EnvelopeSwapDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If TRUE, inherits the fulfilment access area id from the configured access area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'InheritFulfilmentArea ';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ID of the fulfillment access area group label (tag) created in BKO' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPerformance', @level2type=N'COLUMN',@level2name=N'FulfilmentAreaTagId ';
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_LocationAccount FOREIGN KEY ( LocationAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_AcAreaAccount FOREIGN KEY ( AccessAreaAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_Event FOREIGN KEY ( EventId ) REFERENCES SnApp.dbo.tbEvent( EventId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_PerformanceType FOREIGN KEY ( PerformanceTypeId ) REFERENCES SnApp.dbo.tbPerformanceType( PerformanceTypeId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_Calendar FOREIGN KEY ( CalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_RateCode FOREIGN KEY ( RateCodeId ) REFERENCES SnApp.dbo.tbRateCode( RateCodeId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbPerformance ADD CONSTRAINT FK_Performance_FulfilmentAreaTag FOREIGN KEY ( [FulfilmentAreaTagId ] ) REFERENCES SnApp.dbo.tbTag( TagId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbPluginPaymentMethod_001" id="Editor-ea1" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbPluginPaymentMethod ( 
	PluginId             uniqueidentifier      NOT NULL,
	PaymentMethodCode    varchar(15)      NULL,
	PaymentGroupTagId    uniqueidentifier      NULL,
	AutoFill             bit      NOT NULL,
	IconName             varchar(20)      NULL,
	IconAlias            varchar(50)      NULL,
	BackgroundColor      varchar(6)      NULL,
	ForegroundColor      varchar(6)      NULL,
	PaymentCountMessage  nvarchar(100)      NULL,
	DebitLedgerAccountId uniqueidentifier      NULL,
	CreditLedgerAccountId uniqueidentifier      NULL,
	MaxChangeAmount      money      NULL,
	EnabledOnSale        bit      NOT NULL,
	Refundable           bit  DEFAULT 1    NOT NULL,
	[CashPayment ]       bit  DEFAULT 0    NOT NULL,
	StraightSale         bit  DEFAULT 0    NOT NULL,
	OpenCashDrawer       bit  DEFAULT 0    NOT NULL,
	LastUpdate           datetime      NULL,
	TargetPaymentMethodId uniqueidentifier      NULL,
	OnlineStatus         smallint      NULL,
	CONSTRAINT UQ_PluginPaymentMethod_PaymentMethodCode UNIQUE ( PaymentMethodCode ASC ) where PaymentMethodCode is not null
,
	CONSTRAINT PK_PluginPaymentMethod PRIMARY KEY  ( PluginId ) 
 );
GO

CREATE  INDEX IX_PluginPaymentMethod_PaymentGroupTagId ON SnApp.dbo.tbPluginPaymentMethod ( PaymentGroupTagId ASC );
GO

CREATE  INDEX IX_PluginPaymentMethod_DebitLedgerAccountId ON SnApp.dbo.tbPluginPaymentMethod ( DebitLedgerAccountId ASC );
GO

CREATE  INDEX IX_PluginPaymentMethod_CreditLedgerAccountId ON SnApp.dbo.tbPluginPaymentMethod ( CreditLedgerAccountId ASC );
GO

CREATE  INDEX IX_PluginPaymentMethod_TargetPaymentMethodId ON SnApp.dbo.tbPluginPaymentMethod ( TargetPaymentMethodId );
GO

ALTER TABLE SnApp.dbo.tbPluginPaymentMethod ADD CONSTRAINT FK_PluginPaymentMethod_Plugin FOREIGN KEY ( PluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId );
GO

ALTER TABLE SnApp.dbo.tbPluginPaymentMethod ADD CONSTRAINT FK_PluginPaymentMethod_Tag_PaymentGroupTagId FOREIGN KEY ( PaymentGroupTagId ) REFERENCES SnApp.dbo.tbTag( TagId );
GO

ALTER TABLE SnApp.dbo.tbPluginPaymentMethod ADD CONSTRAINT FK_PluginPaymentMethod_DebitLedgerAccount FOREIGN KEY ( DebitLedgerAccountId ) REFERENCES SnApp.dbo.tbLedgerAccount( LedgerAccountId );
GO

ALTER TABLE SnApp.dbo.tbPluginPaymentMethod ADD CONSTRAINT FK_PluginPaymentMethod_CreditLedgerAccount FOREIGN KEY ( CreditLedgerAccountId ) REFERENCES SnApp.dbo.tbLedgerAccount( LedgerAccountId );
GO

ALTER TABLE SnApp.dbo.tbPluginPaymentMethod ADD CONSTRAINT FK_PluginPaymentMethod_TargetPaymentMethod FOREIGN KEY ( TargetPaymentMethodId ) REFERENCES SnApp.dbo.tbPlugin( PluginId ) ON DELETE SET NULL;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'font-awesome icon alias' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'IconAlias';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Hex color for background (null = transparent)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'BackgroundColor';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Hex color for foreground (null = black)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'ForegroundColor';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Max amount of change that can be given back when overpaying with payment method' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'MaxChangeAmount';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to define if a payment method can be used for sale (orders/straight)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'EnabledOnSale';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to define if a payment method can be used for refund' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'Refundable';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the payment method is cash' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'CashPayment ';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Payment can be used in straight sales' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'StraightSale';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Define if cash drawer has to be opened when this payment method is used to pay/partially pay a transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'OpenCashDrawer';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Last update of payment method' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'LastUpdate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Currently used for "credit" payment methods only, define which "advanced payment" method should be used in place of the selected "credit" payment method when the organization has deposit to be deducted' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'TargetPaymentMethodId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[502]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPluginPaymentMethod', @level2type=N'COLUMN',@level2name=N'OnlineStatus';
GO
]]></string>
		</script>
		<script name="tbPortfolioSlotLog" id="Editor_10d5" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbPortfolioSlotLog ( 
	PortfolioSlotLogId   char(1) NOT NULL    ,
	PortfolioId          uniqueidentifier NOT NULL    ,
	MembershipPointId    uniqueidentifier NOT NULL    ,
	PortfolioSlotType    tinyint NOT NULL    ,
	LogFiscalDate        date NOT NULL    ,
	LogSerial            smallint NOT NULL    ,
	LogDateTime          smalldatetime NOT NULL    ,
	LogAmount            money NOT NULL    ,
	EntityType           smallint     ,
	EntityId             uniqueidentifier     ,
	SubEntityType        smallint     ,
	SubEntityId          uniqueidentifier     ,
	LogNote              nvarchar(max)     ,
	SettleTransactionId  uniqueidentifier     ,
	PortfolioSlotHoldId  uniqueidentifier     ,
	PortfolioSlotLogType tinyint NOT NULL    ,
	PortfolioSlotBalanceSerial smallint NOT NULL    ,
	TicketId             uniqueidentifier     ,
	CONSTRAINT PK_PortfolioSlotLog PRIMARY KEY  ( PortfolioSlotLogId )
 );

CREATE  INDEX IX_PortfolioSlotLog_SettleTransactionId ON dbo.tbPortfolioSlotLog ( SettleTransactionId ASC, PortfolioId ASC, MembershipPointId ASC ) where SettleTransactionId is not null;

CREATE  INDEX IX_PortfolioSlotLog_MembershipPointId ON dbo.tbPortfolioSlotLog ( MembershipPointId ASC );

CREATE  INDEX IX_PortfolioSlotLog_EntityId ON dbo.tbPortfolioSlotLog ( EntityId ASC, SubEntityId ASC, MembershipPointId ASC, PortfolioSlotType ASC ) where EntityId is not null;

CREATE  INDEX IX_PortfolioSlotLog_PortfolioSlotHoldId ON dbo.tbPortfolioSlotLog ( PortfolioSlotHoldId ASC ) where PortfolioSlotHoldId is not null;

CREATE  INDEX IX_PortfolioSlotLog_SubEntityId ON dbo.tbPortfolioSlotLog ( SubEntityId ASC, MembershipPointId ASC, PortfolioSlotType ASC ) where SubEntityId is not null;

CREATE  INDEX IX_PortfolioSlotLog_PortfolioId ON dbo.tbPortfolioSlotLog ( PortfolioId ASC, MembershipPointId ASC, PortfolioSlotType ASC, LogFiscalDate ASC );

CREATE  INDEX IX_PortfolioSlotLog_TicketId ON dbo.tbPortfolioSlotLog ( TicketId ) where TicketIdis not null;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Progressive number' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'LogSerial';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[261]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'PortfolioSlotLogType';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to PortfolioSlotBalance record (PortfolioId+MembershipId+PortfolioSlotType+PortfolioSlotBalanceSerial)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'PortfolioSlotBalanceSerial';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Filled on clearing portfolio slot logs caused by ticket Expiration/Breakage/Clearing' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'TicketId';

ALTER TABLE dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_SettleTransactionId FOREIGN KEY ( SettleTransactionId ) REFERENCES dbo.tbTransaction( TransactionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_PortfolioSlot FOREIGN KEY ( PortfolioId ) REFERENCES dbo.tbPortfolioSlot( PortfolioId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_PortfolioSlotHold FOREIGN KEY ( PortfolioSlotHoldId ) REFERENCES dbo.tbPortfolioSlotHold( PortfolioSlotHoldId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_Ticket FOREIGN KEY ( TicketId ) REFERENCES dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;]]></string>
		</script>
		<script name="tbPortfolioSlotLog_001" id="Editor-eaa" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbPortfolioSlotLog ( 
	PortfolioSlotLogId   char(1)      NOT NULL,
	PortfolioId          uniqueidentifier      NOT NULL,
	MembershipPointId    uniqueidentifier      NOT NULL,
	PortfolioSlotType    tinyint      NOT NULL,
	LogFiscalDate        date      NOT NULL,
	LogSerial            smallint      NOT NULL,
	LogDateTime          smalldatetime      NOT NULL,
	LogAmount            money      NOT NULL,
	LogAmountMoney       money      NOT NULL,
	EntityType           smallint      NULL,
	EntityId             uniqueidentifier      NULL,
	SubEntityType        smallint      NULL,
	SubEntityId          uniqueidentifier      NULL,
	LogNote              nvarchar(max)      NULL,
	SettleTransactionId  uniqueidentifier      NULL,
	PortfolioSlotHoldId  uniqueidentifier      NULL,
	PortfolioSlotLogType tinyint      NOT NULL,
	PortfolioSlotBalanceSerial smallint      NOT NULL,
	TicketId             uniqueidentifier      NULL,
	ParentPortfolioSlotLogId uniqueidentifier      NULL,
	VoidPortfolioSlotLogId uniqueidentifier      NULL,
	LogReference         varchar(100)      NULL,
	CONSTRAINT PK_PortfolioSlotLog PRIMARY KEY  ( PortfolioSlotLogId ) 
 );
GO

CREATE  INDEX IX_PortfolioSlotLog_SettleTransactionId ON SnApp.dbo.tbPortfolioSlotLog ( SettleTransactionId ASC, PortfolioId ASC, MembershipPointId ASC ) where SettleTransactionId is not null;
GO

CREATE  INDEX IX_PortfolioSlotLog_MembershipPointId ON SnApp.dbo.tbPortfolioSlotLog ( MembershipPointId ASC );
GO

CREATE  INDEX IX_PortfolioSlotLog_EntityId ON SnApp.dbo.tbPortfolioSlotLog ( EntityId ASC, SubEntityId ASC, MembershipPointId ASC, PortfolioSlotType ASC ) where EntityId is not null;
GO

CREATE  INDEX IX_PortfolioSlotLog_PortfolioSlotHoldId ON SnApp.dbo.tbPortfolioSlotLog ( PortfolioSlotHoldId ASC ) where PortfolioSlotHoldId is not null;
GO

CREATE  INDEX IX_PortfolioSlotLog_SubEntityId ON SnApp.dbo.tbPortfolioSlotLog ( SubEntityId ASC, MembershipPointId ASC, PortfolioSlotType ASC ) where SubEntityId is not null;
GO

CREATE  INDEX IX_PortfolioSlotLog_TicketId ON SnApp.dbo.tbPortfolioSlotLog ( TicketId ) where TicketId is not null;
GO

CREATE  INDEX IX_PortfolioSlotLog_PortfolioId ON SnApp.dbo.tbPortfolioSlotLog ( PortfolioId ASC, MembershipPointId ASC, PortfolioSlotType ASC, PortfolioSlotBalanceSerial, LogFiscalDate ASC );
GO

CREATE  INDEX IX_PortfolioSlotLog_ParentPortfolioSlotLogId ON SnApp.dbo.tbPortfolioSlotLog ( ParentPortfolioSlotLogId ) where ParentPortfolioSlotLogId is not null;
GO

CREATE  INDEX IX_PortfolioSlotLog_VoidPortfolioSlotLogId ON SnApp.dbo.tbPortfolioSlotLog ( VoidPortfolioSlotLogId ) where VoidPortfolioSlotLogId is not null;
GO

ALTER TABLE SnApp.dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_SettleTransactionId FOREIGN KEY ( SettleTransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId );
GO

ALTER TABLE SnApp.dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_PortfolioSlot FOREIGN KEY ( PortfolioId ) REFERENCES SnApp.dbo.tbPortfolioSlot( PortfolioId );
GO

ALTER TABLE SnApp.dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_PortfolioSlotHold FOREIGN KEY ( PortfolioSlotHoldId ) REFERENCES SnApp.dbo.tbPortfolioSlotHold( PortfolioSlotHoldId );
GO

ALTER TABLE SnApp.dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_Ticket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId );
GO

ALTER TABLE SnApp.dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_PortfolioSlotBalance FOREIGN KEY ( PortfolioId, MembershipPointId, PortfolioSlotType, PortfolioSlotBalanceSerial ) REFERENCES SnApp.dbo.tbPortfolioSlotBalance( PortfolioId, MembershipPointId, PortfolioSlotType, PortfolioSlotBalanceSerial );
GO

ALTER TABLE SnApp.dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_ParentPortfolioSlotLog FOREIGN KEY ( ParentPortfolioSlotLogId ) REFERENCES SnApp.dbo.tbPortfolioSlotLog( PortfolioSlotLogId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbPortfolioSlotLog ADD CONSTRAINT FK_PortfolioSlotLog_VoidPortfolioSlotLog FOREIGN KEY ( VoidPortfolioSlotLogId ) REFERENCES SnApp.dbo.tbPortfolioSlotLog( PortfolioSlotLogId ) ON DELETE CASCADE;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LogAmount * tbPortfolioSlotBalance.ExchangeRate' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Progressive number' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'LogSerial';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[261]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'PortfolioSlotLogType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to PortfolioSlotBalance record (PortfolioId+MembershipId+PortfolioSlotType+PortfolioSlotBalanceSerial)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'PortfolioSlotBalanceSerial';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Filled on clearing portfolio slot logs caused by ticket Expiration/Breakage/Clearing' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to parent ID when more logs are created during payment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'ParentPortfolioSlotLogId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to original slot log that has been voided' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'VoidPortfolioSlotLogId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'External reference' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbPortfolioSlotLog', @level2type=N'COLUMN',@level2name=N'LogReference';
GO
]]></string>
		</script>
		<script name="tbProduct" id="Editor-1db4" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbProduct ( 
	ProductId            uniqueidentifier      NOT NULL,
	CategoryId           uniqueidentifier      NOT NULL,
	ProductType          smallint      NOT NULL,
	ProductStatus        smallint      NOT NULL,
	ProductCode          varchar(15)      NOT NULL,
	ProductName          nvarchar(50)      NOT NULL,
	ProductNameExt       nvarchar(50)      NULL,
	ShowNameExt          bit      NOT NULL,
	ParentEntityType     smallint      NULL,
	ParentEntityId       uniqueidentifier      NULL,
	QuantityMin          smallint      NOT NULL,
	QuantityStep         smallint      NOT NULL,
	TrnMaxQty            smallint      NULL,
	PricePoints          int      NULL,
	MembershipPoints     int      NULL,
	PrintGroupTagId      uniqueidentifier      NULL,
	FinanceGroupTagId    uniqueidentifier      NULL,
	TimeRounding         smallint      NULL,
	AdmGroupTagId        uniqueidentifier      NULL,
	AreaGroupTagId       uniqueidentifier      NULL,
	ExtMediaGroupId      uniqueidentifier      NULL,
	GroupTicketOption    smallint      NOT NULL,
	TaxCalcType          smallint      NOT NULL,
	ClearingLimitPerc    money      NULL,
	WalletCreditLimit    money      NOT NULL,
	AccountCategoryId    uniqueidentifier      NULL,
	PriorityOrder        smallint      NULL,
	PackageExplode       bit      NOT NULL,
	AutoGenDocStep       smallint      NULL,
	AutoGenDocActivation smallint      NULL,
	PriceStepValue       smallint      NULL,
	PriceStepType        smallint      NULL,
	MinStepQuantity      smallint      NULL,
	DefaultStepQuantity  smallint      NULL,
	ResourceEndOfDay     bit      NULL,
	CreateEventId        uniqueidentifier      NULL,
	CalendarId           uniqueidentifier      NULL,
	DatedCalendarId      uniqueidentifier      NULL,
	VisitCalendarId      uniqueidentifier      NULL,
	StopSaleCalendarId   uniqueidentifier      NULL,
	EntryQty             int      NULL,
	OnSaleTimeFrom       smallint      NULL,
	OnSaleTimeTo         smallint      NULL,
	OnSaleDateFrom       date      NULL,
	OnSaleDateTo         date      NULL,
	PerformanceTimeFrom  smallint      NULL,
	PerformanceTimeTo    smallint      NULL,
	ChargeToWallet       bit      NOT NULL,
	VariablePrice        bit      NOT NULL,
	VariablePriceMin     money      NULL,
	VariablePriceMax     money      NULL,
	BiometricCheckLevel  smallint      NULL,
	BiometricEnrollment  smallint      NULL,
	BioValidityType      smallint      NULL,
	BioValidityQuantity  smallint      NULL,
	ManualVerificationType smallint      NULL,
	PresaleValue         money      NOT NULL,
	PresaleValueType     smallint      NOT NULL,
	PresaleProductId     uniqueidentifier      NULL,
	ProductPriorityLevel smallint      NULL,
	ExpirationUsageType  smallint      NOT NULL,
	POS_AllowPrint       bit      NOT NULL,
	CLC_AllowPrint       bit      NOT NULL,
	B2B_AllowPrint       bit      NOT NULL,
	B2C_AllowPrint       bit      NOT NULL,
	MWLT_AllowPrint      bit      NOT NULL,
	LocationId           uniqueidentifier      NULL,
	TaxProfileId         uniqueidentifier      NULL,
	BackgroundColor      varchar(6)      NULL,
	ForegroundColor      varchar(6)      NULL,
	IconAlias            varchar(50)      NULL,
	ProductPriceAdvanceType smallint      NOT NULL,
	PaymentProfileId     uniqueidentifier      NULL,
	MeasureProfileId     uniqueidentifier      NULL,
	PreparationMins      int      NULL,
	PosPricingPluginId   uniqueidentifier      NULL,
	WebPricingPluginId   uniqueidentifier      NULL,
	AgeCategory          smallint      NULL,
	MinAge               smallint      NULL,
	MaxAge               smallint      NULL,
	LastUpdate           datetime      NULL,
	RenewWindowStartDays smallint      NULL,
	RenewWindowEndDays   smallint      NULL,
	PriorityOrderCheckType smallint      NULL,
	RevalidateFeeProductId uniqueidentifier      NOT NULL,
	RevalidateExtensionDays smallint      NULL,
	RevalidateWindowStartDays smallint      NULL,
	RevalidateWindowEndDays smallint      NULL,
	ChangePerformanceAdvanceDays smallint      NULL,
	ChangeVisitDateFeeProductId uniqueidentifier      NULL,
	ChangeVisitDateFeeDays smallint      NULL,
	TicketVoidAdvanceDays smallint      NULL,
	TicketVoidAdvanceFeeDays smallint      NULL,
	TicketVoidFeeProductId int      NULL,
	WalletClearingTriggerType smallint      NULL,
	MembershipPointClearingTriggerType smallint      NULL,
	PerformanceFutureDays int      NULL,
	PerformanceFutureDaysExt int      NULL,
	PerformanceFutureQty int      NULL,
	PerformanceFutureQtyExt int      NULL,
	ProductPackageType   smallint      NULL,
	ProductPackageReadType smallint      NULL,
	MediaEncoderPluginId uniqueidentifier      NULL,
	MediaPrintCodeAliasTypeId uniqueidentifier      NULL,
	PerformanceSelectionType smallint      NULL,
	PortfolioPriority    smallint      NULL,
	TaxablePrice         money      NULL,
	IdVerificationMessage nvarchar(50)      NULL,
	CONSTRAINT UQ_Product_ProductCode UNIQUE ( ProductCode ASC ) ,
	CONSTRAINT PK_Product PRIMARY KEY  ( ProductId ) 
 );
GO

CREATE  INDEX IX_Product_ParentEntityId ON SnApp.dbo.tbProduct ( ParentEntityId ASC ) where ParentEntityId is not null;
GO

CREATE  INDEX IX_Product_CategoryId ON SnApp.dbo.tbProduct ( CategoryId ASC );
GO

CREATE  INDEX IX_Product_AccountCategoryId ON SnApp.dbo.tbProduct ( AccountCategoryId ASC );
GO

CREATE  INDEX IX_Product_CalendarId ON SnApp.dbo.tbProduct ( CalendarId ASC ) where CalendarId is not null;
GO

CREATE  INDEX IX_Product_PrintGroupTagId ON SnApp.dbo.tbProduct ( PrintGroupTagId ASC ) where PrintGroupTagId is not null;
GO

CREATE  INDEX IX_Product_FinanceGroupTagId ON SnApp.dbo.tbProduct ( FinanceGroupTagId ASC ) where FinanceGroupTagId is not null;
GO

CREATE  INDEX IX_Product_AdmGroupTagId ON SnApp.dbo.tbProduct ( AdmGroupTagId ASC ) where AdmGroupTagId is not null;
GO

CREATE  INDEX IX_Product_AreaGroupTagId ON SnApp.dbo.tbProduct ( AreaGroupTagId ASC ) where AreaGroupTagId is not null;
GO

CREATE  INDEX IX_Product_ExtMediaGroupId ON SnApp.dbo.tbProduct ( ExtMediaGroupId ASC ) where ExtMediaGroupId is not null;
GO

CREATE  INDEX IX_Product_TaxProfileId ON SnApp.dbo.tbProduct ( TaxProfileId ASC ) where TaxProfileId is not null;
GO

CREATE  INDEX IX_Product_LocationId ON SnApp.dbo.tbProduct ( LocationId ASC ) where LocationId is not null;
GO

CREATE  INDEX IX_Product_PaymentProfileId ON SnApp.dbo.tbProduct ( PaymentProfileId ASC ) where PaymentProfileId is not null;
GO

CREATE  INDEX IX_Product_MeasureProfileId ON SnApp.dbo.tbProduct ( MeasureProfileId ASC ) where MeasureProfileId is not null;
GO

CREATE  INDEX IX_Product_PresaleProductId ON SnApp.dbo.tbProduct ( PresaleProductId ASC ) where PresaleProductId is not null;
GO

CREATE  INDEX IX_Performance_CreateEventId ON SnApp.dbo.tbProduct ( CreateEventId ASC ) where CreateEventId is not null;
GO

CREATE  INDEX IX_Product_PosPricingPluginId ON SnApp.dbo.tbProduct ( PosPricingPluginId ASC ) where PosPricingPluginId is not null;
GO

CREATE  INDEX IX_Product_WebPricingPluginId ON SnApp.dbo.tbProduct ( WebPricingPluginId ASC ) where WebPricingPluginId is not null;
GO

CREATE  INDEX IX_Product_DatedCalendarId ON SnApp.dbo.tbProduct ( DatedCalendarId ASC ) where DatedCalendarId is not null;
GO

CREATE  INDEX IX_Product_RevalidateFeeProductId ON SnApp.dbo.tbProduct ( RevalidateFeeProductId ASC ) where RevalidateFeeProductId is not null;
GO

CREATE  INDEX IX_Product_VisitCalendarId ON SnApp.dbo.tbProduct ( VisitCalendarId ) where VisitCalendarId is not null;
GO

CREATE  INDEX IX_Product_TicketVoidFeeProductId ON SnApp.dbo.tbProduct ( TicketVoidFeeProductId ) where TicketVoidFeeProductId is not null;
GO

CREATE  INDEX IX_Product_StopSaleCalendarId ON SnApp.dbo.tbProduct ( StopSaleCalendarId ) WHERE StopSaleCalendarId is not null;
GO

CREATE  INDEX IX_Product_ChangeVisitDateFeeProductId ON SnApp.dbo.tbProduct ( ChangeVisitDateFeeProductId ) WHERE ChangeVisitDateFeeProductId is not NULL;
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_Location FOREIGN KEY ( LocationId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_CreateEvent FOREIGN KEY ( CreateEventId ) REFERENCES SnApp.dbo.tbEvent( EventId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_PresaleProduct FOREIGN KEY ( PresaleProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_RevalidateFeeProduct FOREIGN KEY ( RevalidateFeeProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_AccountCategory FOREIGN KEY ( AccountCategoryId ) REFERENCES SnApp.dbo.tbCategory( CategoryId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_Category FOREIGN KEY ( CategoryId ) REFERENCES SnApp.dbo.tbCategory( CategoryId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_PosPricingPlugin FOREIGN KEY ( PosPricingPluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_WebPricingPlugin FOREIGN KEY ( WebPricingPluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_PrintGroupTag FOREIGN KEY ( PrintGroupTagId ) REFERENCES SnApp.dbo.tbTag( TagId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_FinanceGroupTag FOREIGN KEY ( FinanceGroupTagId ) REFERENCES SnApp.dbo.tbTag( TagId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_AdmGroupTag FOREIGN KEY ( AdmGroupTagId ) REFERENCES SnApp.dbo.tbTag( TagId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_AreaGroupTag FOREIGN KEY ( AreaGroupTagId ) REFERENCES SnApp.dbo.tbTag( TagId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_Calendar FOREIGN KEY ( CalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_DatedCalendar FOREIGN KEY ( DatedCalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_TaxProfile FOREIGN KEY ( TaxProfileId ) REFERENCES SnApp.dbo.tbTaxProfile( TaxProfileId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_PaymentProfile FOREIGN KEY ( PaymentProfileId ) REFERENCES SnApp.dbo.tbPaymentProfile( PaymentProfileId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_MeasureProfile FOREIGN KEY ( MeasureProfileId ) REFERENCES SnApp.dbo.tbMeasureProfile( MeasureProfileId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_ExtMediaGroup FOREIGN KEY ( ExtMediaGroupId ) REFERENCES SnApp.dbo.tbExtMediaGroup( ExtMediaGroupId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_TicketVoidFeeProduct FOREIGN KEY ( TicketVoidFeeProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_VisitCalendar FOREIGN KEY ( VisitCalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_StopSaleCalendar FOREIGN KEY ( StopSaleCalendarId ) REFERENCES SnApp.dbo.tbCalendar( CalendarId );
GO

ALTER TABLE SnApp.dbo.tbProduct ADD CONSTRAINT FK_Product_ChangeVisitDateFeeProduct FOREIGN KEY ( ChangeVisitDateFeeProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information about configured product types' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Category of the event (determins applicable data masks)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'CategoryId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[18] Family / Product / Package' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[49]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Intelligible alphanumeric user defined code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product type name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductName';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product type additional description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductNameExt';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tells if ProductNameExt should display or not. Changes POS UI representation of the product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ShowNameExt';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ParentEntityType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product type could be overall available (this field = null) or beloning only to a subset entity (like an event)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ParentEntityId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minumum sellable quantity. Default 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'QuantityMin';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Quantity increment/decrement minumum. For example setting to 2 grant having only even quantities. Default 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'QuantityStep';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Maxi quantity of the specific product type allowed in a transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TrnMaxQty';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'not used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PricePoints';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'not used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MembershipPoints';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical grouping - Print Group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PrintGroupTagId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical grouping - Finance Group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'FinanceGroupTagId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[202] ResourceMan: define allocation start fragmentation. Even if PriceStep is set hourly, you may want to allow allocation to start every 15mins' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TimeRounding';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical grouping - Admission Group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AdmGroupTagId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical grouping - Area Group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AreaGroupTagId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[153]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'GroupTicketOption';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[25] included, excluded, exempt' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TaxCalcType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used by ledger rules to calculate the "max value" of a ticket. When null equals 100% of selling price' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ClearingLimitPerc';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Not used anymore' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'WalletCreditLimit';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Default category for products requiring account' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AccountCategoryId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used for sorting purposes in the selling UI' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PriorityOrder';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For packages only. Indicates that package price is the sum of its products and that shoud be exploded in statistics' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PackageExplode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[199]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AutoGenDocStep';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[200]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AutoGenDocActivation';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ResourceMan: define if price is daily, hourly, 10mins, etc' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PriceStepValue';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[201]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PriceStepType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ResourceMan: define minimum allocation duration (multiplier for PriceStepValue)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MinStepQuantity';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ResourceMan: define default allocation duration (multiplier for PriceStepValue)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'DefaultStepQuantity';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Occupy resource for the rest of the day' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ResourceEndOfDay';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Auto-create a performance for this event when the product gets sold. Date/time will reflect resource allocation. Used for bitrhday party scenarios' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'CreateEventId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Defines which days the product is sellable. If null is always sellable' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'CalendarId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Calendar to be used for "dated products" selection' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'DatedCalendarId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Defines if a product can be sold for the date selected at POS (performance/dated products) based on the calendar specified.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'VisitCalendarId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to calendar for "stop sale" dates' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'StopSaleCalendarId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used along with StopSaleCalendar determines buiness rules for upgrades' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'EntryQty';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minutes from 00:00' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'OnSaleTimeFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minutes from 00:00' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'OnSaleTimeTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date from' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'OnSaleDateFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date to' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'OnSaleDateTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sellable only when tied to performance starting from time...
(stores total minutes starting from 00:00)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceTimeFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sellable only when tied to performance starting before time...
(stores total minutes starting from 00:00)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceTimeTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When sold in "Portfolio SaleFlowType", the price will be charged on that portfolio, incresing the credit limit' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ChargeToWallet';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if price matrix whould be ignored and price should be defined dymaically by operator at sale time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'VariablePrice';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Variable price minimum amount selectable by operator' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'VariablePriceMin';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Variable price maximum amount selectable by operator' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'VariablePriceMax';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[231]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BiometricCheckLevel';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[296]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BiometricEnrollment';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[273] Used with BioValidityQuantity in order to set the expiration date of a biometric template linked to a secondary ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BioValidityType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used with BioValidityType in order to set the expiration date of a biometric template linked to a secondary ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BioValidityQuantity';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[429]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ManualVerificationType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Italian SIAE Prevendita' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PresaleValue';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Lk[135] 1=Absolute, 2=Percentage' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PresaleValueType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical product type, to be use instead of the "system presale product type" when accounting presales' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PresaleProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Lk[250] 10=Primary, 15=Co-Primary,  20=Secondary
Secondary products are linked to all the Primary and Co-Primary products sold in the same transaction.
Secondary products are also linked to all the products that belong to the same portfolio of the Primary products' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductPriorityLevel';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[255]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ExpirationUsageType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product can be printed from POS' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'POS_AllowPrint';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product can be printed from CallCenter' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'CLC_AllowPrint';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product can be printed from B2B' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'B2B_AllowPrint';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product can be printed from B2C' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'B2C_AllowPrint';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Allow Mobile Wallet Printing' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MWLT_AllowPrint';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'not used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'LocationId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tax profile' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TaxProfileId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'RGB hex color' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BackgroundColor';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'RGB hex color' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ForegroundColor';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'FontAwesome icon name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'IconAlias';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[285]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductPriceAdvanceType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Payment profile (set of rules on how the product type can be paid with)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PaymentProfileId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Measure profile - Invetory management' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MeasureProfileId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Time (minutes) required for the preparation of the product. Used primarly for food preparation.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PreparationMins';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the pricing plugin to be used from POS' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PosPricingPluginId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the pricing plugin to be used from WEB' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'WebPricingPluginId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[456] Adult, Child, Senior, etc...' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AgeCategory';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to add a sell constraint based on the age' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MinAge';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to add a sell constraint based on the age' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MaxAge';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Last update of the product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'LastUpdate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Selta days, calculated on source ticket expiration, from which renewal can be done. Null = Always' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RenewWindowStartDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Delta days, calculated on source ticket expiration, up to which renewal can be done. Null = Always' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RenewWindowEndDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[347] How many times the system checks the primary accesses against a secondary entry attempt' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PriorityOrderCheckType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product id of the Fee to be used in the revalidation transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RevalidateFeeProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days the product expiration will be extened for' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RevalidateExtensionDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Revalidation window opening. Delta days from the original expiration date.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RevalidateWindowStartDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Revalidation window closure. Delta days from the original expiration date.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RevalidateWindowEndDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days before visit date, until which a performance change is possible.
Value is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ChangePerformanceAdvanceDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the "fee" product ID to be used to chanrge a fee when visit date on a ticket is changed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ChangeVisitDateFeeProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days, after visit date, from which a fee will be applied when changing visit date on a ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ChangeVisitDateFeeDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days before visit date, until which refund is allowed.
Value is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TicketVoidAdvanceDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days before visit date, until which refund is allowed with chargeable fees.
Value is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TicketVoidAdvanceFeeDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the product fee, that will be applied in case "TicketvoidAdvanceFeeDays" field is configured' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TicketVoidFeeProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[182] Expiration, Clearing, Breakage' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'WalletClearingTriggerType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[182] Expiration, Clearing, Breakage' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MembershipPointClearingTriggerType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For "before usage" events, indicates how far in the future a performance can be booked' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceFutureDays';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For "before usage" events, indicates how far in the future a performance can be booked with override' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceFutureDaysExt';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For "before usage" events, indicates the max number of bookable performances' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceFutureQty';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For "before usage" events, indicates the max number of bookable performances with override' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceFutureQtyExt';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[481] (Merged products, Itemized products)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductPackageType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[482] (Grouped)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductPackageReadType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product media encoder pluginId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MediaEncoderPluginId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'define the codealiastype where the external encoded code will be saved' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MediaPrintCodeAliasTypeId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[66] Entry Type - Automatic, Before encoding, before usage' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceSelectionType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When configured, will determine the priority (of usage) of the product in the portfolio when sold.
Null value means the product will be inserted as last (lowest priority) in the portfolio.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PortfolioPriority';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Defines the percentage of the product’s price that is subject to taxes.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TaxablePrice';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Custom/specific ID verification message when needed at admission' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'IdVerificationMessage';
GO
]]></string>
		</script>
		<script name="tbProductPriceAdvance" id="Editor-394" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbProductPriceAdvance ( 
	ProductPriceDateId   uniqueidentifier      NOT NULL,
	CellIndex            smallint      NOT NULL,
	SaleChannelId        uniqueidentifier      NULL,
	PerformanceTypeId    uniqueidentifier      NULL,
	RateCodeId           uniqueidentifier      NULL,
	AdvanceDays          smallint      NOT NULL,
	PriceActionType      smallint      NOT NULL,
	PriceValueType       smallint      NOT NULL,
	PriceValue           money      NOT NULL,
	TimeUnitType         smallint      NOT NULL,
	CONSTRAINT UQ_ProductPriceAdvance UNIQUE ( ProductPriceDateId ASC, SaleChannelId ASC, PerformanceTypeId ASC, RateCodeId ASC, AdvanceDays ASC ) ,
	CONSTRAINT PK_ProductPriceAdvance PRIMARY KEY  ( ProductPriceDateId, CellIndex ) 
 );
GO

CREATE  INDEX IX_ProductPriceAdvance_SaleChannelId ON SnApp.dbo.tbProductPriceAdvance ( SaleChannelId ASC );
GO

CREATE  INDEX IX_ProductPriceAdvance_PerformanceTypeId ON SnApp.dbo.tbProductPriceAdvance ( PerformanceTypeId ASC );
GO

CREATE  INDEX IX_ProductPriceAdvance_RateCodeId ON SnApp.dbo.tbProductPriceAdvance ( RateCodeId ASC );
GO

ALTER TABLE SnApp.dbo.tbProductPriceAdvance ADD CONSTRAINT FK_ProductPriceAdvance_PerformanceType FOREIGN KEY ( PerformanceTypeId ) REFERENCES SnApp.dbo.tbPerformanceType( PerformanceTypeId );
GO

ALTER TABLE SnApp.dbo.tbProductPriceAdvance ADD CONSTRAINT FK_ProductPriceAdvance_SaleChannel FOREIGN KEY ( SaleChannelId ) REFERENCES SnApp.dbo.tbSaleChannel( SaleChannelId );
GO

ALTER TABLE SnApp.dbo.tbProductPriceAdvance ADD CONSTRAINT FK_ProductPriceAdvance_ProductPriceDate FOREIGN KEY ( ProductPriceDateId ) REFERENCES SnApp.dbo.tbProductPriceDate( ProductPriceDateId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbProductPriceAdvance ADD CONSTRAINT FK_ProductPriceAdvance_RateCode FOREIGN KEY ( RateCodeId ) REFERENCES SnApp.dbo.tbRateCode( RateCodeId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'It''s the product type''s advanced sale rules matrix' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sequential number used just to complete the primary key' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'CellIndex';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Mutually exclusive with PerformanceTypeId and RateCodeId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'SaleChannelId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Mutually exclusive with SaleChannelId and RateCodeId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'PerformanceTypeId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Mutually exclusive with SaleChannelId and PerformanceTypeId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'RateCodeId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[134]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'PriceActionType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[135]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'PriceValueType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Value of the cell. Meaning depends on PriceActionType and PriceActionValue' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'PriceValue';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[513]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'TimeUnitType';
GO
]]></string>
		</script>
		<script name="tbProductPriceAdvance_001" id="Editor-2a5" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbProductPriceAdvance ( 
	ProductPriceDateId   uniqueidentifier      NOT NULL,
	CellIndex            smallint      NOT NULL,
	SaleChannelId        uniqueidentifier      NULL,
	PerformanceTypeId    uniqueidentifier      NULL,
	RateCodeId           uniqueidentifier      NULL,
	AdvanceDays          smallint      NOT NULL,
	PriceActionType      smallint      NOT NULL,
	PriceValueType       smallint      NOT NULL,
	PriceValue           money      NOT NULL,
	TimeUnitType         smallint      NOT NULL,
	CONSTRAINT PK_ProductPriceAdvance PRIMARY KEY  ( ProductPriceDateId, CellIndex ) ,
	CONSTRAINT UQ_ProductPriceAdvance UNIQUE ( ProductPriceDateId ASC, SaleChannelId ASC, PerformanceTypeId ASC, RateCodeId ASC, AdvanceDays ASC, TimeUnitType ASC ) 
 );
GO

CREATE  INDEX IX_ProductPriceAdvance_SaleChannelId ON SnApp.dbo.tbProductPriceAdvance ( SaleChannelId ASC );
GO

CREATE  INDEX IX_ProductPriceAdvance_PerformanceTypeId ON SnApp.dbo.tbProductPriceAdvance ( PerformanceTypeId ASC );
GO

CREATE  INDEX IX_ProductPriceAdvance_RateCodeId ON SnApp.dbo.tbProductPriceAdvance ( RateCodeId ASC );
GO

ALTER TABLE SnApp.dbo.tbProductPriceAdvance ADD CONSTRAINT FK_ProductPriceAdvance_PerformanceType FOREIGN KEY ( PerformanceTypeId ) REFERENCES SnApp.dbo.tbPerformanceType( PerformanceTypeId );
GO

ALTER TABLE SnApp.dbo.tbProductPriceAdvance ADD CONSTRAINT FK_ProductPriceAdvance_SaleChannel FOREIGN KEY ( SaleChannelId ) REFERENCES SnApp.dbo.tbSaleChannel( SaleChannelId );
GO

ALTER TABLE SnApp.dbo.tbProductPriceAdvance ADD CONSTRAINT FK_ProductPriceAdvance_ProductPriceDate FOREIGN KEY ( ProductPriceDateId ) REFERENCES SnApp.dbo.tbProductPriceDate( ProductPriceDateId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbProductPriceAdvance ADD CONSTRAINT FK_ProductPriceAdvance_RateCode FOREIGN KEY ( RateCodeId ) REFERENCES SnApp.dbo.tbRateCode( RateCodeId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'It''s the product type''s advanced sale rules matrix' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sequential number used just to complete the primary key' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'CellIndex';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Mutually exclusive with PerformanceTypeId and RateCodeId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'SaleChannelId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Mutually exclusive with SaleChannelId and RateCodeId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'PerformanceTypeId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Mutually exclusive with SaleChannelId and PerformanceTypeId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'RateCodeId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[134]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'PriceActionType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[135]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'PriceValueType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Value of the cell. Meaning depends on PriceActionType and PriceActionValue' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'PriceValue';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[513]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductPriceAdvance', @level2type=N'COLUMN',@level2name=N'TimeUnitType';
GO
]]></string>
		</script>
		<script name="tbProductUpsell_002" id="Editor-1e48" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbProductUpsell ( 
	ProductId            uniqueidentifier      NOT NULL,
	TargetProductId      uniqueidentifier      NOT NULL,
	PriorityOrder        int      NOT NULL,
	UpsellType           smallint      NOT NULL,
	SamePortfolio        smallint      NOT NULL,
	QuantityMin          int      NULL,
	QuantityMax          int      NULL,
	CONSTRAINT PK_ProductUpsell PRIMARY KEY  ( ProductId, TargetProductId ) 
 );
GO

CREATE  INDEX IX_ProductUpsell_TargetProductId ON SnApp.dbo.tbProductUpsell ( ProductId );
GO

CREATE  INDEX IX_ProductUpsell_PriorityOrder ON SnApp.dbo.tbProductUpsell ( ProductId, PriorityOrder );
GO

ALTER TABLE SnApp.dbo.tbProductUpsell ADD CONSTRAINT FK_ProductUpsell_Product FOREIGN KEY ( ProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbProductUpsell ADD CONSTRAINT FK_ProductUpsell_TargetProduct FOREIGN KEY ( TargetProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Suggested upsell products for each product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductUpsell';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to product internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductUpsell', @level2type=N'COLUMN',@level2name=N'ProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the product suggested for upsell' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductUpsell', @level2type=N'COLUMN',@level2name=N'TargetProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sorting index' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductUpsell', @level2type=N'COLUMN',@level2name=N'PriorityOrder';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[488] Alternative / AddOn' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductUpsell', @level2type=N'COLUMN',@level2name=N'UpsellType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the product "TargetProductId" suggested for upsell (add-on only) should be added to the same portfolio as "ProductId"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductUpsell', @level2type=N'COLUMN',@level2name=N'SamePortfolio';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minimun quantity constraint' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductUpsell', @level2type=N'COLUMN',@level2name=N'QuantityMin';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Max quantity constraint' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductUpsell', @level2type=N'COLUMN',@level2name=N'QuantityMax';
GO
]]></string>
		</script>
		<script name="tbProductVarPrice" id="Editor-102e" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbProductVarPrice ( 
	ProductVarPriceId    uniqueidentifier      NOT NULL,
	ProductId            uniqueidentifier      NOT NULL,
	PriceValueType       uniqueidentifier      NOT NULL,
	PriceValue           money      NOT NULL,
	CONSTRAINT PK_ProductVarPrice PRIMARY KEY  ( ProductVarPriceId ) 
 );
GO

CREATE  INDEX IX_ProductVarPrice_ProductId ON SnApp.dbo.tbProductVarPrice ( ProductId );
GO

ALTER TABLE SnApp.dbo.tbProductVarPrice ADD CONSTRAINT FK_ProductVarPrice_Product FOREIGN KEY ( ProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId ) ON DELETE CASCADE;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains preset amounts for "variable price" products' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductVarPrice';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductVarPrice', @level2type=N'COLUMN',@level2name=N'ProductVarPriceId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to tbProduct' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductVarPrice', @level2type=N'COLUMN',@level2name=N'ProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[135] absolute/percentage' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductVarPrice', @level2type=N'COLUMN',@level2name=N'PriceValueType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Amount' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProductVarPrice', @level2type=N'COLUMN',@level2name=N'PriceValue';
GO
]]></string>
		</script>
		<script name="tbProduct_001" id="Editor-d9c" language="SQL" >
			<string><![CDATA[CREATE TABLE tbProduct ( 
	ProductId            uniqueidentifier NOT NULL    ,
	CategoryId           uniqueidentifier NOT NULL    ,
	ProductType          smallint NOT NULL    ,
	ProductStatus        smallint NOT NULL    ,
	ProductCode          varchar(15) NOT NULL    ,
	ProductName          nvarchar(50) NOT NULL    ,
	ProductNameExt       nvarchar(50) NULL    ,
	ShowNameExt          bit NOT NULL    ,
	ParentEntityType     smallint NULL    ,
	ParentEntityId       uniqueidentifier NULL    ,
	QuantityMin          smallint NOT NULL    ,
	QuantityStep         smallint NOT NULL    ,
	TrnMaxQty            smallint NULL    ,
	PricePoints          int NULL    ,
	MembershipPoints     int NULL    ,
	PrintGroupTagId      uniqueidentifier NULL    ,
	FinanceGroupTagId    uniqueidentifier NULL    ,
	TimeRounding         smallint NULL    ,
	AdmGroupTagId        uniqueidentifier NULL    ,
	AreaGroupTagId       uniqueidentifier NULL    ,
	ExtMediaGroupId      uniqueidentifier NULL    ,
	GroupTicketOption    smallint NOT NULL    ,
	TaxCalcType          smallint NOT NULL    ,
	ClearingLimitPerc    money NULL    ,
	WalletCreditLimit    money NOT NULL    ,
	AccountCategoryId    uniqueidentifier NULL    ,
	PriorityOrder        smallint NULL    ,
	PackageExplode       bit NOT NULL    ,
	AutoGenDocStep       smallint NULL    ,
	AutoGenDocActivation smallint NULL    ,
	PriceStepValue       smallint NULL    ,
	PriceStepType        smallint NULL    ,
	MinStepQuantity      smallint NULL    ,
	DefaultStepQuantity  smallint NULL    ,
	ResourceEndOfDay     bit NULL    ,
	CreateEventId        uniqueidentifier NULL    ,
	CalendarId           uniqueidentifier NULL    ,
	DatedCalendarId      uniqueidentifier NULL    ,
	VisitCalendarId      uniqueidentifier NULL    ,
	UncountCalendarId    uniqueidentifier NULL    ,
	OnSaleTimeFrom       smallint NULL    ,
	OnSaleTimeTo         smallint NULL    ,
	OnSaleDateFrom       date NULL    ,
	OnSaleDateTo         date NULL    ,
	PerformanceTimeFrom  smallint NULL    ,
	PerformanceTimeTo    smallint NULL    ,
	ChargeToWallet       bit NOT NULL    ,
	VariablePrice        bit NOT NULL    ,
	VariablePriceMin     money NULL    ,
	VariablePriceMax     money NULL    ,
	BiometricCheckLevel  smallint NULL    ,
	BiometricEnrollment  smallint NULL    ,
	BioValidityType      smallint NULL    ,
	BioValidityQuantity  smallint NULL    ,
	ManualVerificationType smallint NULL    ,
	PresaleValue         money NOT NULL    ,
	PresaleValueType     smallint NOT NULL    ,
	PresaleProductId     uniqueidentifier NULL    ,
	ProductPriorityLevel smallint NULL    ,
	ExpirationUsageType  smallint NOT NULL    ,
	POS_AllowPrint       bit NOT NULL    ,
	CLC_AllowPrint       bit NOT NULL    ,
	B2B_AllowPrint       bit NOT NULL    ,
	B2C_AllowPrint       bit NOT NULL    ,
	LocationId           uniqueidentifier NULL    ,
	TaxProfileId         uniqueidentifier NULL    ,
	BackgroundColor      varchar(6) NULL    ,
	ForegroundColor      varchar(6) NULL    ,
	IconAlias            varchar(50) NULL    ,
	ProductPriceAdvanceType smallint NOT NULL    ,
	PaymentProfileId     uniqueidentifier NULL    ,
	MeasureProfileId     uniqueidentifier NULL    ,
	PreparationMins      int NULL    ,
	PosPricingPluginId   uniqueidentifier NULL    ,
	WebPricingPluginId   uniqueidentifier NULL    ,
	AgeCategory          smallint NULL    ,
	MinAge               smallint NULL    ,
	MaxAge               smallint NULL    ,
	LastUpdate           datetime NULL    ,
	RenewWindowStartDays smallint NULL    ,
	RenewWindowEndDays   smallint NULL    ,
	PriorityOrderCheckType smallint NULL    ,
	RevalidateFeeProductId uniqueidentifier NOT NULL    ,
	RevalidateExtensionDays smallint NULL    ,
	RevalidateWindowStartDays smallint NULL    ,
	RevalidateWindowEndDays smallint NULL    ,
	ChangePerformanceAdvanceDays smallint NULL    ,
	TicketVoidAdvanceDays smallint NULL    ,
	TicketVoidAdvanceFeeDays smallint NULL    ,
	TicketVoidFeeProductId int NULL    ,
	WalletClearingTriggerType smallint NULL    ,
	MembershipPointClearingTriggerType smallint NULL    ,
	PerformanceFutureDays int NULL    ,
	PerformanceFutureDaysExt int NULL    ,
	PerformanceFutureQty int NULL    ,
	PerformanceFutureQtyExt int NULL    ,
	CONSTRAINT UQ_Product_ProductCode UNIQUE ( ProductCode ASC ) ,
	CONSTRAINT PK_Product PRIMARY KEY  ( ProductId ) 
 );
GO

CREATE  INDEX IX_Product_ParentEntityId ON tbProduct ( ParentEntityId ASC ) where ParentEntityId is not null;
GO

CREATE  INDEX IX_Product_CategoryId ON tbProduct ( CategoryId ASC );
GO

CREATE  INDEX IX_Product_AccountCategoryId ON tbProduct ( AccountCategoryId ASC );
GO

CREATE  INDEX IX_Product_CalendarId ON tbProduct ( CalendarId ASC ) where CalendarId is not null;
GO

CREATE  INDEX IX_Product_PrintGroupTagId ON tbProduct ( PrintGroupTagId ASC ) where PrintGroupTagId is not null;
GO

CREATE  INDEX IX_Product_FinanceGroupTagId ON tbProduct ( FinanceGroupTagId ASC ) where FinanceGroupTagId is not null;
GO

CREATE  INDEX IX_Product_AdmGroupTagId ON tbProduct ( AdmGroupTagId ASC ) where AdmGroupTagId is not null;
GO

CREATE  INDEX IX_Product_AreaGroupTagId ON tbProduct ( AreaGroupTagId ASC ) where AreaGroupTagId is not null;
GO

CREATE  INDEX IX_Product_ExtMediaGroupId ON tbProduct ( ExtMediaGroupId ASC ) where ExtMediaGroupId is not null;
GO

CREATE  INDEX IX_Product_TaxProfileId ON tbProduct ( TaxProfileId ASC ) where TaxProfileId is not null;
GO

CREATE  INDEX IX_Product_LocationId ON tbProduct ( LocationId ASC ) where LocationId is not null;
GO

CREATE  INDEX IX_Product_PaymentProfileId ON tbProduct ( PaymentProfileId ASC ) where PaymentProfileId is not null;
GO

CREATE  INDEX IX_Product_MeasureProfileId ON tbProduct ( MeasureProfileId ASC ) where MeasureProfileId is not null;
GO

CREATE  INDEX IX_Product_PresaleProductId ON tbProduct ( PresaleProductId ASC ) where PresaleProductId is not null;
GO

CREATE  INDEX IX_Performance_CreateEventId ON tbProduct ( CreateEventId ASC ) where CreateEventId is not null;
GO

CREATE  INDEX IX_Product_PosPricingPluginId ON tbProduct ( PosPricingPluginId ASC ) where PosPricingPluginId is not null;
GO

CREATE  INDEX IX_Product_WebPricingPluginId ON tbProduct ( WebPricingPluginId ASC ) where WebPricingPluginId is not null;
GO

CREATE  INDEX IX_Product_DatedCalendarId ON tbProduct ( DatedCalendarId ASC ) where DatedCalendarId is not null;
GO

CREATE  INDEX IX_Product_RevalidateFeeProductId ON tbProduct ( RevalidateFeeProductId ASC ) where RevalidateFeeProductId is not null;
GO

CREATE  INDEX IX_Product_VisitCalendarId ON tbProduct ( VisitCalendarId ) where VisitCalendarId is not null;
GO

CREATE  INDEX IX_Product_TicketVoidFeeProductId ON tbProduct ( TicketVoidFeeProductId ) where TicketVoidFeeProductId is not null;
GO

CREATE  INDEX IX_Product_UncountCalendarId ON tbProduct ( UncountCalendarId ) where UncountCalendarId is not null;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Location FOREIGN KEY ( LocationId ) REFERENCES tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_CreateEvent FOREIGN KEY ( CreateEventId ) REFERENCES tbEvent( EventId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_PresaleProductId FOREIGN KEY ( PresaleProductId ) REFERENCES tbProduct( ProductId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_RevalidateFeeProductId FOREIGN KEY ( RevalidateFeeProductId ) REFERENCES tbProduct( ProductId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Category_AccountCategoryId FOREIGN KEY ( AccountCategoryId ) REFERENCES tbCategory( CategoryId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Category FOREIGN KEY ( CategoryId ) REFERENCES tbCategory( CategoryId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_PosPricingPlugin FOREIGN KEY ( PosPricingPluginId ) REFERENCES tbPlugin( PluginId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_WebPricingPlugin FOREIGN KEY ( WebPricingPluginId ) REFERENCES tbPlugin( PluginId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Tag_PrintGroupTagId FOREIGN KEY ( PrintGroupTagId ) REFERENCES tbTag( TagId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Tag_FinanceGroupTagId FOREIGN KEY ( FinanceGroupTagId ) REFERENCES tbTag( TagId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Tag_AdmGroupTagId FOREIGN KEY ( AdmGroupTagId ) REFERENCES tbTag( TagId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Tag_AreaGroupTagId FOREIGN KEY ( AreaGroupTagId ) REFERENCES tbTag( TagId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Calendar FOREIGN KEY ( CalendarId ) REFERENCES tbCalendar( CalendarId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Calendar_DatedCalendarId FOREIGN KEY ( DatedCalendarId ) REFERENCES tbCalendar( CalendarId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_TaxProfile FOREIGN KEY ( TaxProfileId ) REFERENCES tbTaxProfile( TaxProfileId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_PaymentProfile FOREIGN KEY ( PaymentProfileId ) REFERENCES tbPaymentProfile( PaymentProfileId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_MeasureProfile FOREIGN KEY ( MeasureProfileId ) REFERENCES tbMeasureProfile( MeasureProfileId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_ExtMediaGroup FOREIGN KEY ( ExtMediaGroupId ) REFERENCES tbExtMediaGroup( ExtMediaGroupId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_TicketVoidFeeProductId FOREIGN KEY ( TicketVoidFeeProductId ) REFERENCES tbProduct( ProductId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_Calendar_VisitCalendarId FOREIGN KEY ( VisitCalendarId ) REFERENCES tbCalendar( CalendarId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE tbProduct ADD CONSTRAINT FK_Product_UncountCalendar FOREIGN KEY ( UncountCalendarId ) REFERENCES tbCalendar( CalendarId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds information about configured product types' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Category of the event (determins applicable data masks)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'CategoryId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[18] Family / Product / Package' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[49]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Intelligible alphanumeric user defined code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductCode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product type name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductName';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product type additional description' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductNameExt';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tells if ProductNameExt should display or not. Changes POS UI representation of the product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ShowNameExt';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ParentEntityType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product type could be overall available (this field = null) or beloning only to a subset entity (like an event)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ParentEntityId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minumum sellable quantity. Default 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'QuantityMin';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Quantity increment/decrement minumum. For example setting to 2 grant having only even quantities. Default 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'QuantityStep';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Maxi quantity of the specific product type allowed in a transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TrnMaxQty';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'not used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PricePoints';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'not used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MembershipPoints';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical grouping - Print Group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PrintGroupTagId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical grouping - Finance Group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'FinanceGroupTagId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[202] ResourceMan: define allocation start fragmentation. Even if PriceStep is set hourly, you may want to allow allocation to start every 15mins' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TimeRounding';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical grouping - Admission Group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AdmGroupTagId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical grouping - Area Group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AreaGroupTagId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[153]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'GroupTicketOption';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[25] included, excluded, exempt' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TaxCalcType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used by ledger rules to calculate the "max value" of a ticket. When null equals 100% of selling price' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ClearingLimitPerc';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Not used anymore' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'WalletCreditLimit';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Default category for products requiring account' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AccountCategoryId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used for sorting purposes in the selling UI' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PriorityOrder';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For packages only. Indicates that package price is the sum of its products and that shoud be exploded in statistics' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PackageExplode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[199]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AutoGenDocStep';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[200]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AutoGenDocActivation';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ResourceMan: define if price is daily, hourly, 10mins, etc' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PriceStepValue';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[201]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PriceStepType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ResourceMan: define minimum allocation duration (multiplier for PriceStepValue)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MinStepQuantity';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ResourceMan: define default allocation duration (multiplier for PriceStepValue)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'DefaultStepQuantity';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Occupy resource for the rest of the day' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ResourceEndOfDay';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Auto-create a performance for this event when the product gets sold. Date/time will reflect resource allocation. Used for bitrhday party scenarios' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'CreateEventId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Defines which days the product is sellable. If null is always sellable' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'CalendarId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Calendar to be used for "dated products" selection' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'DatedCalendarId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Defines if a product can be sold for the date selected at POS (performance/dated products) based on the calendar specified.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'VisitCalendarId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference a caledar for which dates should not be counted as "outstanding" bookings' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'UncountCalendarId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minutes from 00:00' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'OnSaleTimeFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Minutes from 00:00' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'OnSaleTimeTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date from' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'OnSaleDateFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date to' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'OnSaleDateTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sellable only when tied to performance starting from time...\n(stores total minutes starting from 00:00)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceTimeFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sellable only when tied to performance starting before time...\n(stores total minutes starting from 00:00)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceTimeTo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When sold in "Portfolio SaleFlowType", the price will be charged on that portfolio, incresing the credit limit' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ChargeToWallet';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if price matrix whould be ignored and price should be defined dymaically by operator at sale time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'VariablePrice';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Variable price minimum amount selectable by operator' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'VariablePriceMin';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Variable price maximum amount selectable by operator' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'VariablePriceMax';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[231]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BiometricCheckLevel';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[296]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BiometricEnrollment';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[273] Used with BioValidityQuantity in order to set the expiration date of a biometric template linked to a secondary ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BioValidityType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used with BioValidityType in order to set the expiration date of a biometric template linked to a secondary ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BioValidityQuantity';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[429]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ManualVerificationType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Italian SIAE Prevendita' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PresaleValue';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Lk[135] 1=Absolute, 2=Percentage' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PresaleValueType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Statistical product type, to be use instead of the "system presale product type" when accounting presales' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PresaleProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Lk[250] 10=Primary, 15=Co-Primary,  20=Secondary\nSecondary products are linked to all the Primary and Co-Primary products sold in the same transaction.\nSecondary products are also linked to all the products that belong to the same portfolio of the Primary products' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductPriorityLevel';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[255]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ExpirationUsageType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product can be printed from POS' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'POS_AllowPrint';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product can be printed from CallCenter' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'CLC_AllowPrint';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product can be printed from B2B' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'B2B_AllowPrint';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product can be printed from B2C' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'B2C_AllowPrint';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'not used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'LocationId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tax profile' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TaxProfileId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'RGB hex color' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'BackgroundColor';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'RGB hex color' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ForegroundColor';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'FontAwesome icon name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'IconAlias';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[285]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ProductPriceAdvanceType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Payment profile (set of rules on how the product type can be paid with)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PaymentProfileId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Measure profile - Invetory management' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MeasureProfileId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Time (minutes) required for the preparation of the product. Used primarly for food preparation.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PreparationMins';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the pricing plugin to be used from POS' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PosPricingPluginId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the pricing plugin to be used from WEB' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'WebPricingPluginId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[456] Adult, Child, Senior, etc...' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'AgeCategory';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to add a sell constraint based on the age' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MinAge';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to add a sell constraint based on the age' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MaxAge';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Last update of the product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'LastUpdate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Selta days, calculated on source ticket expiration, from which renewal can be done. Null = Always' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RenewWindowStartDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Delta days, calculated on source ticket expiration, up to which renewal can be done. Null = Always' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RenewWindowEndDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[347] How many times the system checks the primary accesses against a secondary entry attempt' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PriorityOrderCheckType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Product id of the Fee to be used in the revalidation transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RevalidateFeeProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days the product expiration will be extened for' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RevalidateExtensionDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Revalidation window opening. Delta days from the original expiration date.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RevalidateWindowStartDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Revalidation window closure. Delta days from the original expiration date.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'RevalidateWindowEndDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days before visit date, until which a performance change is possible.\nValue is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'ChangePerformanceAdvanceDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days before visit date, until which refund is allowed.\nValue is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TicketVoidAdvanceDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of days before visit date, until which refund is allowed with chargeable fees.\nValue is a delta relative to the visit date: negative numbers refer to BEFORE the visit date; positive numbers refer to AFTER the visit date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TicketVoidAdvanceFeeDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the product fee, that will be applied in case "TicketvoidAdvanceFeeDays" field is configured' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'TicketVoidFeeProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[222] Wallet clearing trigger type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'WalletClearingTriggerType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[222] MembershipPoint clearing trigger type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'MembershipPointClearingTriggerType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For "before usage" events, indicates how far in the future a performance can be booked' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceFutureDays';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For "before usage" events, indicates how far in the future a performance can be booked with override' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceFutureDaysExt';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For "before usage" events, indicates the max number of bookable performances' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceFutureQty';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For "before usage" events, indicates the max number of bookable performances with override' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbProduct', @level2type=N'COLUMN',@level2name=N'PerformanceFutureQtyExt';
GO
]]></string>
		</script>
		<script name="tbRepository" id="Editor-151b" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbRepository ( 
	RepositoryId         uniqueidentifier      NOT NULL,
	EntityType           smallint      NOT NULL,
	EntityId             uniqueidentifier      NOT NULL,
	RepositoryCode       varchar(15)      NOT NULL,
	FileName             nvarchar(50)      NOT NULL,
	Description          nvarchar(50)      NULL,
	Version              int      NOT NULL,
	Shared               bit      NOT NULL,
	RequireParsing       bit      NOT NULL,
	DistinctAttachment   bit      NOT NULL,
	ConvertToPDF         bit      NOT NULL,
	LastUpdate           datetime      NOT NULL,
	DocData              varbinary(max)      NOT NULL,
	Thumb                varbinary(max)      NULL,
	Small                varbinary(max)      NULL,
	Large                varbinary(max)      NULL,
	Hash                 nvarchar(32)      NULL,
	ValidDateFrom        date      NULL,
	ValidDateTo          date      NULL,
	CONSTRAINT UQ_Repository_RepositoryCode UNIQUE ( RepositoryCode ASC ) ,
	CONSTRAINT PK_Repository PRIMARY KEY  ( RepositoryId ) 
 );
GO

CREATE  INDEX IX_Repository_EntityId ON SnApp.dbo.tbRepository ( EntityId ASC );
GO

CREATE  INDEX IX_Repository_EntityType ON SnApp.dbo.tbRepository ( EntityType ASC, FileName ASC );
GO

CREATE  INDEX IX_ValidDateTo_EntityId ON SnApp.dbo.tbRepository ( EntityId ASC, ValidDateTo ASC ) WHERE ValidDateTo is not null;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'EntityType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When attached to order confirmation emails, the document gets parsed and filled with dynamic data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'RequireParsing';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When attached to order confirmation emails, attach 1 copy for each guest' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'DistinctAttachment';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When attached to order confirmation emails gets converted into PDF format' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'ConvertToPDF';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'50px smooth scaled' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'Thumb';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'150px smooth scaled' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'Small';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'400px width, not scaled' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'Large';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'md5 hash' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'Hash';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Beginning of validity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'ValidDateFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Expiration of validity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'ValidDateTo';
GO
]]></string>
		</script>
		<script name="tbRepository_001" id="Editor-88e" language="SQL" >
			<string><![CDATA[CREATE  TABLE tbRepository ( 
	RepositoryId         uniqueidentifier      NOT NULL,
	EntityType           smallint      NOT NULL,
	EntityId             uniqueidentifier      NOT NULL,
	RepositoryCode       varchar(15)      NOT NULL,
	FileName             nvarchar(50)      NOT NULL,
	Description          nvarchar(50)      NULL,
	Version              int      NOT NULL,
	Shared               bit      NOT NULL,
	RequireParsing       bit      NOT NULL,
	DistinctAttachment   bit      NOT NULL,
	ConvertToPDF         bit      NOT NULL,
	LastUpdate           datetime      NOT NULL,
	DocData              varbinary(max)      NOT NULL,
	Thumb                varbinary(max)      NULL,
	Small                varbinary(max)      NULL,
	Large                varbinary(max)      NULL,
	Hash                 nvarchar(32)      NULL,
	ValidDateFrom        date      NULL,
	ValidDateTo          date      NULL,
	DocTemplateId        uniqueidentifier      NULL,
	CONSTRAINT UQ_Repository_RepositoryCode UNIQUE ( RepositoryCode ASC ) ,
	CONSTRAINT PK_Repository PRIMARY KEY  ( RepositoryId ) 
 );
GO

CREATE  INDEX IX_Repository_EntityId ON tbRepository ( EntityId ASC );
GO

CREATE  INDEX IX_Repository_EntityType ON tbRepository ( EntityType ASC, FileName ASC );
GO

CREATE  INDEX IX_ValidDateTo_EntityId ON tbRepository ( EntityId ASC, ValidDateTo ASC ) WHERE ValidDateTo is not null;
GO

CREATE  INDEX IX_Repository_DocTemplateId ON tbRepository ( DocTemplateId, FileName ) WHERE DocTemplateId is NOT NULL;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'EntityType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When attached to order confirmation emails, the document gets parsed and filled with dynamic data' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'RequireParsing';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When attached to order confirmation emails, attach 1 copy for each guest' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'DistinctAttachment';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When attached to order confirmation emails gets converted into PDF format' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'ConvertToPDF';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'50px smooth scaled' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'Thumb';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'150px smooth scaled' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'Small';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'400px width, not scaled' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'Large';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'md5 hash' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'Hash';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Beginning of validity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'ValidDateFrom';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Expiration of validity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'ValidDateTo';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to "waiver" template (tbDocTemplate)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbRepository', @level2type=N'COLUMN',@level2name=N'DocTemplateId';
GO
]]></string>
		</script>
		<script name="tbResourceHold" id="Editor_699" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbResourceHold ( 
	ResourceHoldId       uniqueidentifier NOT NULL    ,
	ResourceHoldStatus   int NOT NULL    ,
	CreateDateTime       datetime NOT NULL    ,
	ExpireDateTime       datetime     ,
	ExtResourceHold      varchar(50)     ,
	ExtResourceDesc      nvarchar(100)     ,
	ExtResourceData      nvarchar(max)     ,
	CONSTRAINT PK_ResourceHold PRIMARY KEY  ( ResourceHoldId ) 
 );
GO

CREATE  INDEX IX_ResourceHold_ExpireDateTime ON SnApp.dbo.tbResourceHold ( ExpireDateTime ) include (ResourceHoldStatus) where ExpireDateTime is not null;
GO

CREATE  INDEX IX_ResourceHold_ExtResourceHold ON SnApp.dbo.tbResourceHold ( ExtResourceHold ) where ExtResourceHold is not null;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Information about resource "hold ids"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceHold';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceHold', @level2type=N'COLUMN',@level2name=N'ResourceHoldId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[?]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceHold', @level2type=N'COLUMN',@level2name=N'ResourceHoldStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Hold creation timestamp' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceHold', @level2type=N'COLUMN',@level2name=N'CreateDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Expiration timestamp' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceHold', @level2type=N'COLUMN',@level2name=N'ExpireDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'HoldId given by 3rd party integration' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceHold', @level2type=N'COLUMN',@level2name=N'ExtResourceHold';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Visual resource name returned by 3rd party integration' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceHold', @level2type=N'COLUMN',@level2name=N'ExtResourceDesc';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Any other proprietary data (JSON/XML) given by 3rd party integration' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceHold', @level2type=N'COLUMN',@level2name=N'ExtResourceData';
GO
]]></string>
		</script>
		<script name="tbResourceSchedule" id="Editor_225a" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbResourceSchedule ( 
	ResourceScheduleId   uniqueidentifier NOT NULL    ,
	ResourceSerialId     uniqueidentifier NOT NULL    ,
	DateTimeFrom         smalldatetime NOT NULL    ,
	DateTimeTo           smalldatetime NOT NULL    ,
	DurationMins         int NOT NULL    ,
	ScheduleStatus       smallint NOT NULL    ,
	MainResource         bit NOT NULL    ,
	ResourceHoldId       uniqueidentifier NOT NULL    ,
	ExtResourceHold      varchar(50)     ,
	ExtResourceDesc      varchar(100)     ,
	ExtResourceData      varchar(max)     ,
	PerformanceId        uniqueidentifier     ,
	ProductId            uniqueidentifier     ,
	SaleItemDetailId     uniqueidentifier     ,
	TicketId             uniqueidentifier     ,
	HoldExpire           smalldatetime     ,
	HandOverTransactionId uniqueidentifier     ,
	ReturnTransactionId  uniqueidentifier     ,
	AdvancedSaleQuantity smallint     ,
	CONSTRAINT PK_ResourceSchedule PRIMARY KEY  ( ResourceScheduleId ) 
 );
GO

CREATE  INDEX IX_ResourceSchedule_PerformanceId ON SnApp.dbo.tbResourceSchedule ( PerformanceId ASC ) where PerformanceId is not null;
GO

CREATE  INDEX IX_ResourceSchedule_ProductId ON SnApp.dbo.tbResourceSchedule ( ProductId ASC ) where ProductId is not null;
GO

CREATE  INDEX IX_ResourceSchedule_ResourceHoldId ON SnApp.dbo.tbResourceSchedule ( ResourceHoldId ASC );
GO

CREATE  INDEX IX_ResourceSchedule_HoldExpire ON SnApp.dbo.tbResourceSchedule ( HoldExpire ASC ) where HoldExpire is not null;
GO

CREATE  INDEX IX_ResourceSchedule_SaleItemDetailId ON SnApp.dbo.tbResourceSchedule ( SaleItemDetailId ASC ) where SaleItemDetailId is not null;
GO

CREATE  INDEX IX_ResourceSchedule_TicketId ON SnApp.dbo.tbResourceSchedule ( TicketId ASC ) where TicketId is not null;
GO

CREATE  INDEX IX_ResourceSchedule_HandOverTransactionId ON SnApp.dbo.tbResourceSchedule ( HandOverTransactionId ASC ) where HandOverTransactionId is not null;
GO

CREATE  INDEX IX_ResourceSchedule_ReturnTransactionId ON SnApp.dbo.tbResourceSchedule ( ReturnTransactionId ASC ) where ReturnTransactionId is not null;
GO

CREATE  INDEX IX_ResourceSchedule_ResourceSerialId ON SnApp.dbo.tbResourceSchedule ( ResourceSerialId ASC, DateTimeFrom ASC ) INCLUDE(DateTimeTo,ReturnTransactionId);
GO

CREATE UNIQUE INDEX UQ_ResourceSchedule_ExtResourceHold ON SnApp.dbo.tbResourceSchedule ( ExtResourceHold ) where ExtResourceHold is not null;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Could be greater than the difference between DateTimeFrom/To, if the product type has ResourceEndOfDay flagged' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceSchedule', @level2type=N'COLUMN',@level2name=N'DurationMins';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[204] Hold, Book, Collected, Returned' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceSchedule', @level2type=N'COLUMN',@level2name=N'ScheduleStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'HoldId given by 3rd party integration (when using AvailabilityPluginId)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceSchedule', @level2type=N'COLUMN',@level2name=N'ExtResourceHold';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Visual resource name returned by 3rd party integration (when using AvailabilityPluginId)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceSchedule', @level2type=N'COLUMN',@level2name=N'ExtResourceDesc';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Any other proprietary data (JSON/XML) given by 3rd party integration (when using AvailabilityPluginId)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceSchedule', @level2type=N'COLUMN',@level2name=N'ExtResourceData';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For pre-scheduled classes. Mutually exclusive with ProductId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceSchedule', @level2type=N'COLUMN',@level2name=N'PerformanceId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'For free scheduling. Mutually exclusive with PerformanceId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceSchedule', @level2type=N'COLUMN',@level2name=N'ProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Quantity sellable in advance (not on the same day of the schedule). Null = NoLimits' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbResourceSchedule', @level2type=N'COLUMN',@level2name=N'AdvancedSaleQuantity';
GO

ALTER TABLE SnApp.dbo.tbResourceSchedule ADD CONSTRAINT FK_ResourceSchedule_Product FOREIGN KEY ( ProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbResourceSchedule ADD CONSTRAINT FK_ResourceSchedule_Performance FOREIGN KEY ( PerformanceId ) REFERENCES SnApp.dbo.tbPerformance( PerformanceId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbResourceSchedule ADD CONSTRAINT FK_ResourceSchedule_Transaction_HandOverTransactionId FOREIGN KEY ( HandOverTransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbResourceSchedule ADD CONSTRAINT FK_ResourceSchedule_Transaction_ReturnTransactionId FOREIGN KEY ( ReturnTransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbResourceSchedule ADD CONSTRAINT FK_ResourceSchedule_Ticket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbResourceSchedule ADD CONSTRAINT FK_ResourceSchedule_SaleItemDetail FOREIGN KEY ( SaleItemDetailId ) REFERENCES SnApp.dbo.tbSaleItemDetail( SaleItemDetailId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbResourceSchedule ADD CONSTRAINT FK_ResourceSchedule_ResourceSerial FOREIGN KEY ( ResourceSerialId ) REFERENCES SnApp.dbo.tbResourceSerial( ResourceSerialId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbSale" id="Editor-16fe" language="SQL" >
			<string><![CDATA[CREATE  TABLE tbSale ( 
	SaleId               uniqueidentifier      NOT NULL,
	LicenseId            smallint      NOT NULL,
	UserAccountId        uniqueidentifier      NULL,
	WorkstationId        uniqueidentifier      NOT NULL,
	SaleChannelId        uniqueidentifier      NULL,
	SaleStatus           smallint      NOT NULL,
	SaleDateTime         smalldatetime      NOT NULL,
	SaleFiscalDate       date      NOT NULL,
	SaleCode             varchar(15)      NULL,
	Approved             bit      NOT NULL,
	Invoiced             bit      NOT NULL,
	Consignment          bit      NOT NULL,
	Paid                 bit      NOT NULL,
	Encoded              bit      NOT NULL,
	Printed              bit      NOT NULL,
	Validated            bit      NOT NULL,
	Completed            bit      NOT NULL,
	TotalAmount          money      NOT NULL,
	PaidAmount           money      NOT NULL,
	ItemCount            int      NOT NULL,
	HoldId               uniqueidentifier      NULL,
	ReceiptEmailAddress  nvarchar(50)      NULL,
	ReceiptPhoneNumber   nvarchar(50)      NULL,
	AutoPurge            bit      NOT NULL,
	SaleFlowType         smallint      NOT NULL,
	BatchDate            date      NULL,
	BatchNumber          tinyint      NULL,
	SaleSequence         int      NULL,
	TaxExempt            bit      NOT NULL,
	VisitDateMin         date      NULL,
	VisitDateMax         date      NULL,
	FulfilmentAreaTagId  uniqueidentifier      NULL,
	ScheduledPaymentDate date      NULL,
	OrderVersion         bigint      NULL,
	OrderSequence        bigint      NULL,
	OrderSeed            smallint      NULL,
	Archivable           bit  DEFAULT 0    NOT NULL,
	ArchivableDateTime   datetime      NULL,
	Archived             bit  DEFAULT 0    NOT NULL,
	ArchivedDateTime     datetime      NULL,
	CONSTRAINT UQ_Sale_SaleSequence UNIQUE ( SaleSequence ASC ) where BatchSequence is not null
,
	CONSTRAINT PK_Sale PRIMARY KEY  ( SaleId ) 
 );
GO

CREATE  INDEX IX_Sale_HoldId ON tbSale ( HoldId ASC ) where HoldId is not null;
GO

CREATE  INDEX IX_Sale_SaleCode ON tbSale ( SaleCode ASC );
GO

CREATE  INDEX IX_Sale_WorkstationId ON tbSale ( WorkstationId ASC, SaleDateTime ASC );
GO

CREATE  INDEX IX_Sale_UserAccountId ON tbSale ( UserAccountId ASC, SaleDateTime ASC ) where UserAccountId is not null;
GO

CREATE  INDEX IX_Sale_SaleFiscalDate ON tbSale ( SaleFiscalDate ASC, SaleDateTime DESC );
GO

CREATE  INDEX IX_Sale_SaleChannelId ON tbSale ( SaleChannelId ASC ) where SaleChannelId is not null;
GO

CREATE  INDEX IX_Sale_VisitDateMin ON tbSale ( VisitDateMin ASC, SaleDateTime ASC ) where VisitDateMin is not null;
GO

CREATE  INDEX IX_Sale_VisitDateMax ON tbSale ( VisitDateMax ASC, SaleDateTime ASC ) where VisitDateMax is not null;
GO

CREATE  INDEX IX_Sale_VisitDateMaxNotEncoded ON tbSale ( VisitDateMax ASC ) where 
  VisitDateMax is not null and
  Paid=1 and
  Encoded=0;
GO

CREATE  INDEX IX_Sale_FulfilmentAreaTagId ON tbSale ( FulfilmentAreaTagId ) where FulfilmentAreaTagId is not null;
GO

CREATE  INDEX IX_Sale_Batch ON tbSale ( BatchDate ASC, FulfilmentAreaTagId , BatchNumber ASC, Printed ASC ) where BatchDate is not null;
GO

CREATE  INDEX [IX_Sale_FulfilmentTagId ] ON tbSale ( FulfilmentAreaTagId, BatchDate ASC, BatchNumber ASC, Printed ASC ) where FulfilmentTagId is not null;
GO

CREATE  INDEX IX_Sale_ScheduledPaymentDate ON tbSale ( ScheduledPaymentDate ) where (ScheduledPaymentDate) is not null and (Paid=0);
GO

CREATE UNIQUE  INDEX UQ_Sale_OrderSequence ON tbSale ( OrderSequence ) WHERE OrderSequence<>0 INCLUDE OrderSeed;
GO

CREATE UNIQUE  INDEX UQ_Sale_OrderVersion ON tbSale ( OrderVersion ) WHERE OrderVersion is not null INCLUDE SaleFiscalDate;
GO

CREATE  INDEX IX_Sale_WaitingForPayment ON tbSale ( SaleStatus, SaleDateTime ) where SaleStatus=200;
GO

CREATE  INDEX IX_Sale_ToBeArchived ON tbSale ( Archivable, Archived, ArchivableDateTime ) INCLUDE (ArchivedDateTime) WHERE (Archivable=1 AND Archived=0);
GO

CREATE  INDEX IX_Sale_Archived ON tbSale ( Archived, ArchivedDateTime ) WHERE Archived=1;
GO

ALTER TABLE tbSale ADD CONSTRAINT FK_Sale_Account FOREIGN KEY ( UserAccountId ) REFERENCES tbAccount( AccountId );
GO

ALTER TABLE tbSale ADD CONSTRAINT FK_Sale_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES tbWorkstation( WorkstationId );
GO

ALTER TABLE tbSale ADD CONSTRAINT FK_Sale_SaleChannel FOREIGN KEY ( SaleChannelId ) REFERENCES tbSaleChannel( SaleChannelId );
GO

ALTER TABLE tbSale ADD CONSTRAINT FK_Sale_License FOREIGN KEY ( LicenseId ) REFERENCES tbLicense( LicenseId ) ON DELETE SET NULL;
GO

ALTER TABLE tbSale ADD CONSTRAINT FK_Sale_FulfimentAreaTag FOREIGN KEY ( FulfilmentAreaTagId ) REFERENCES tbTag( TagId ) ON DELETE SET NULL;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains sales eligible for archiving but not yet archived' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'INDEX',@level2name=N'IX_Sale_ToBeArchived';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Header of the orders' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'SaleId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Licensee this order belongs to' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'LicenseId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Operator which created the order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'UserAccountId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Workstation from which the order was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'WorkstationId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sale channel used for princing in the order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'SaleChannelId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[39]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'SaleStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/time the order when was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'SaleDateTime';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Fiscal date the order when was created' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'SaleFiscalDate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'PNR' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'SaleCode';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order Approved' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Approved';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order invoiced (An invoice was issued for the items of the order)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Invoiced';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order will be paid when tickets are redeemed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Consignment';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order fully Paid' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Paid';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order Encoded (ticket/media records created)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Encoded';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order Printed (medias printed)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Printed';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order Validated - tickets activated' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Validated';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Order Completed - cannot be modified anymore' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Completed';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Algebric Sum of the field TotalAmount of each transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'TotalAmount';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Algebric Sum of the field PaidAmount of each transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'PaidAmount';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Algebric Sum of the field ItemCount of each transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'ItemCount';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'In case the order contains limited capacity events, this points to the record locking seats' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'HoldId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used for order confirmation emails' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'ReceiptEmailAddress';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used for product phone delivery' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'ReceiptPhoneNumber';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When false, task "Reservation Maintenance" will skip it' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'AutoPurge';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[197]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'SaleFlowType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Batch printing scheduled date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'BatchDate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Batch printing scheduled number' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'BatchNumber';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sale sequence number' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'SaleSequence';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tells if the order is a tax exempt order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'TaxExempt';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Estimated visit date. If order reference more dates, the eldest will be used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'VisitDateMin';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Estimated visit date. If order reference more dates, the youngest will be used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'VisitDateMax';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ID of the fulfillment access area group label (tag) created in BKO' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'FulfilmentAreaTagId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date of when the order is due for payment. Is filled on sale creation/modification, based on the organization config.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'ScheduledPaymentDate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Autoinc field updated everytime the entity (in this specific record or any dependant) is modified. To be used for differential reports' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'OrderVersion';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sequential unique (for this table) number generate on creation starting from 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'OrderSequence';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Information used along with OrderSequence to create encrypted barcodes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'OrderSeed';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the sale is eligible for archiving' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Archivable';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/Time of where field "Archivable" was set to 1. Should be NULL when "Archivable"=0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'ArchivableDateTime';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates that the sale was serialized/archived on an external archiving database' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'Archived';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Date/Time of where field "Archived" was set to 1. Should be NULL when "Archived"=0' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale', @level2type=N'COLUMN',@level2name=N'ArchivedDateTime';
GO
]]></string>
		</script>
		<script name="tbSale2SaleTab" id="Editor_a9f" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbSale2SaleTab ( 
	SaleId               uniqueidentifier NOT NULL    ,
	SaleTabId            uniqueidentifier NOT NULL    ,
	CONSTRAINT PK_Sale2SaleTab PRIMARY KEY  ( SaleId, SaleTabId ) 
 );
GO

CREATE  INDEX IX_Sale2SaleTab_SaleTabId ON dbo.tbSale2SaleTab ( SaleTabId  ASC  );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Hold information about the Sale Tabs this order refers to' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale2SaleTab';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale2SaleTab', @level2type=N'COLUMN',@level2name=N'SaleId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the SaleTab' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale2SaleTab', @level2type=N'COLUMN',@level2name=N'SaleTabId';
GO

ALTER TABLE dbo.tbSale2SaleTab ADD CONSTRAINT FK_Sale2SaleTab_SaleId FOREIGN KEY ( SaleId ) REFERENCES dbo.tbSale( SaleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE dbo.tbSale2SaleTab ADD CONSTRAINT FK_Sale2SaleTab_SaleTabId FOREIGN KEY ( SaleTabId ) REFERENCES dbo.tbSaleTab( SaleTabId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO]]></string>
		</script>
		<script name="tbSale2SaleTab_001" id="Editor_a18" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbSale2SaleTab ( 
	SaleId               uniqueidentifier NOT NULL    ,
	SaleTabId            uniqueidentifier NOT NULL    ,
	CONSTRAINT PK_Sale2SaleTab PRIMARY KEY  ( SaleId ) 
 );
GO

CREATE UNIQUE INDEX UQ_Sale2SaleTab_SaleTab ON dbo.tbSale2SaleTab ( SaleTabId  ASC , SaleId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Hold information about the Sale Tabs this order refers to' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale2SaleTab';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale2SaleTab', @level2type=N'COLUMN',@level2name=N'SaleId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the SaleTab' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSale2SaleTab', @level2type=N'COLUMN',@level2name=N'SaleTabId';
GO

ALTER TABLE dbo.tbSale2SaleTab ADD CONSTRAINT FK_Sale2SaleTab_SaleId FOREIGN KEY ( SaleId ) REFERENCES dbo.tbSale( SaleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE dbo.tbSale2SaleTab ADD CONSTRAINT FK_Sale2SaleTab_SaleTabId FOREIGN KEY ( SaleTabId ) REFERENCES dbo.tbSaleTab( SaleTabId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO]]></string>
		</script>
		<script name="tbSaleCapacityLog" id="Editor_7dc" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbSaleCapacityLog ( 
	SaleCapacityLogId    uniqueidentifier NOT NULL    ,
	SaleCapacitySlotId   uniqueidentifier NOT NULL    ,
	QuantityDelta        smallint NOT NULL    ,
	DateTime             timestamp NOT NULL    ,
	FiscalDate           date NOT NULL    ,
	TransactionId        uniqueidentifier     ,
	SaleCapacityHoldId   uniqueidentifier     ,
	EntityType           smallint     ,
	EntityId             uniqueidentifier     ,
	CONSTRAINT PK_SaleCapacityLog PRIMARY KEY  ( SaleCapacityLogId )
 );

CREATE  INDEX IX_SaleCapacityLog_SaleCapacitySlotId ON dbo.tbSaleCapacityLog ( SaleCapacitySlotId ASC );

CREATE  INDEX IX_SaleCapacityLog_TransactionId ON dbo.tbSaleCapacityLog ( TransactionId ASC ) where TransactionId is not null;

CREATE  INDEX IX_SaleCapacityLog_SaleCapacityHoldId ON dbo.tbSaleCapacityLog ( SaleCapacityHoldId ASC ) where SaleCapacityHoldId is not null;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Log every allocation made on the SaleCapacitySlot' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleCapacityLog';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'SaleCapacitySlot on wich the allocation was made' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleCapacityLog', @level2type=N'COLUMN',@level2name=N'SaleCapacitySlotId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Quantity allocated' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleCapacityLog', @level2type=N'COLUMN',@level2name=N'QuantityDelta';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Log date time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleCapacityLog', @level2type=N'COLUMN',@level2name=N'DateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Log fiscal date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleCapacityLog', @level2type=N'COLUMN',@level2name=N'FiscalDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Transaction that requested the allocation' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleCapacityLog', @level2type=N'COLUMN',@level2name=N'TransactionId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleCapacityLog', @level2type=N'COLUMN',@level2name=N'EntityType';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Entity linked to this log. Could be a SaleItem' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleCapacityLog', @level2type=N'COLUMN',@level2name=N'EntityId';

ALTER TABLE dbo.tbSaleCapacityLog ADD CONSTRAINT FK_SaleCapacityLog_Transaction FOREIGN KEY ( TransactionId ) REFERENCES dbo.tbTransaction( TransactionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbSaleCapacityLog ADD CONSTRAINT FK_SaleCapacityLog_SaleCapacitySlot FOREIGN KEY ( SaleCapacitySlotId ) REFERENCES dbo.tbSaleCapacitySlot( SaleCapacitySlotId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbSaleCapacityLog ADD CONSTRAINT FK_SaleCapacityLog_SaleCapacityHold FOREIGN KEY ( SaleCapacityHoldId ) REFERENCES dbo.tbSaleCapacityHold( SaleCapacityHoldId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbSaleConsQueue" id="Editor-41e" language="SQL" >
			<string><![CDATA[CREATE TABLE tbSaleConsQueue ( 
	SaleId               uniqueidentifier NOT NULL    ,
	ServerId             smallint     ,
	ConsQueueStatus      smallint NOT NULL    ,
	QueueDateTime        datetime NOT NULL    ,
	StartDateTime        datetime     ,
	EndDateTime          datetime     ,
	CONSTRAINT Pk_SaleConsQueue PRIMARY KEY  ( SaleId ) 
 );
GO

CREATE  INDEX IX_ConsQueue_ConsQueueType_0 ON tbSaleConsQueue ( ConsQueueStatus, QueueDateTime );
GO

CREATE  INDEX IX_ConsQueue_ServerId_0 ON tbSaleConsQueue ( ServerId, ConsQueueStatus );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleConsQueue', @level2type=N'COLUMN',@level2name=N'SaleId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tomcat instance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleConsQueue', @level2type=N'COLUMN',@level2name=N'ServerId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[266]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleConsQueue', @level2type=N'COLUMN',@level2name=N'ConsQueueStatus';
GO

ALTER TABLE tbSaleConsQueue ADD CONSTRAINT Fk_SaleConsQueue_Sale FOREIGN KEY ( SaleId ) REFERENCES tbSale( SaleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbSaleItem" id="Editor_1606" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbSaleItem ( 
	SaleItemId           uniqueidentifier NOT NULL    ,
	SaleId               uniqueidentifier NOT NULL    ,
	ProductId            uniqueidentifier NOT NULL    ,
	MainSaleItemId       uniqueidentifier     ,
	PerformanceTypeId    uniqueidentifier     ,
	PerformanceSetId     uniqueidentifier     ,
	PerformanceId        uniqueidentifier     ,
	OptionSetId          uniqueidentifier     ,
	TicketId             uniqueidentifier     ,
	MultiPerformance     bit NOT NULL    ,
	UnitRawPrice         money NOT NULL    ,
	TaxCalcType          smallint NOT NULL    ,
	UnitAmount           money NOT NULL    ,
	UnitTax              money NOT NULL    ,
	UnitFaceAmount       money NOT NULL    ,
	UnitFaceTax          money NOT NULL    ,
	Quantity             smallint NOT NULL    ,
	QuantityUnit         smallint NOT NULL    ,
	TotalAmount          money NOT NULL    ,
	TotalTax             money NOT NULL    ,
	StatAmount           money NOT NULL    ,
	DistinctItem         bit NOT NULL    ,
	PriceQuoteToken      varchar(100)     ,
	ValidDateFrom        date     ,
	ValidDateTo          date     ,
	CONSTRAINT PK_SaleItem PRIMARY KEY  ( SaleItemId ) 
 );
GO

CREATE  INDEX IX_SaleItem_SaleId ON SnApp.dbo.tbSaleItem ( SaleId ASC );
GO

CREATE  INDEX IX_SaleItem_ProductId ON SnApp.dbo.tbSaleItem ( ProductId ASC );
GO

CREATE  INDEX IX_SaleItem_PerformanceId ON SnApp.dbo.tbSaleItem ( PerformanceId ASC ) where PerformanceId is not null;
GO

CREATE  INDEX IX_SaleItem_PerformanceSetId ON SnApp.dbo.tbSaleItem ( PerformanceSetId ASC ) include(SaleId)
where PerformanceSetId is not null;
GO

CREATE  INDEX IX_SaleItem_MainSaleItemId ON SnApp.dbo.tbSaleItem ( MainSaleItemId ASC ) where MainSaleItemId is not null;
GO

CREATE  INDEX IX_SaleItem_OptionSetId ON SnApp.dbo.tbSaleItem ( OptionSetId ) where OptionSetId is not null;
GO

CREATE  INDEX IX_SaleItem_PerformanceTypeId ON SnApp.dbo.tbSaleItem ( PerformanceTypeId ) where PerformanceTypeId is not null;
GO

CREATE  INDEX IX_SaleItem_TicketId ON SnApp.dbo.tbSaleItem ( TicketId ) where TicketId is not null;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Items of an order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'SaleItemId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'SaleId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'ProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If not null, it mean this is a statistical item added as part of an attribute item' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'MainSaleItemId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'PerformanceType used to determin the price' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'PerformanceTypeId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the performance set' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'PerformanceSetId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'It''s the first of the performance set' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'PerformanceId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Set of dynamic options selected for this item' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'OptionSetId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the source ticket ID in case of upgrade/downgrade.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the perfromance set has more than one performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'MultiPerformance';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Price from the prodtype price matrix, including dynamic attributes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'UnitRawPrice';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[25] included, excluded, exempt' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'TaxCalcType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Unit amount (discounted, tax inclusive)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'UnitAmount';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Unit taxes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'UnitTax';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Original price of the item, could have been sold at a different price.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'UnitFaceAmount';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Tax amount of the FacePrice' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'UnitFaceTax';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Quantity, algebraic sum of tbTransactionItem.Quantity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'Quantity';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'ResourceMan: indicates time units... if a price is set hourly, this field indicates how many hours' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'QuantityUnit';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'UnitAmount * Quantity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'TotalAmount';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'UnitTax * Quantity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'TotalTax';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Amount to be used for statistical purposes. Tax included.\nDepending on configuration, one sold sale item could be split by the system into two sale items. The sum of the StatAmount is the price of the original item.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'StatAmount';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the item was splitted for different discount/taxes.\nFor example: in shopcart you have 1 item qty 3, and a promotion giving 1 of the item as free; in the table you''ll end up with 2 records, [A] qty 2 full price, [B] qty 1 price 0.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'DistinctItem';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Used to store 3rd party pricing plugin token (when available)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'PriceQuoteToken';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Filled in for variable expiration rule products' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'ValidDateFrom';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Filled in for variable expiration rule products' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleItem', @level2type=N'COLUMN',@level2name=N'ValidDateTo';
GO

ALTER TABLE SnApp.dbo.tbSaleItem ADD CONSTRAINT FK_SaleItem_Product FOREIGN KEY ( ProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbSaleItem ADD CONSTRAINT FK_SaleItem_PerformanceType FOREIGN KEY ( PerformanceTypeId ) REFERENCES SnApp.dbo.tbPerformanceType( PerformanceTypeId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbSaleItem ADD CONSTRAINT FK_SaleItem_Performance FOREIGN KEY ( PerformanceId ) REFERENCES SnApp.dbo.tbPerformance( PerformanceId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbSaleItem ADD CONSTRAINT FK_SaleItem_Sale FOREIGN KEY ( SaleId ) REFERENCES SnApp.dbo.tbSale( SaleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbSaleItem ADD CONSTRAINT FK_SaleItem_MainSaleItem FOREIGN KEY ( MainSaleItemId ) REFERENCES SnApp.dbo.tbSaleItem( SaleItemId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbSaleItem ADD CONSTRAINT FK_SaleItem_OptionSet FOREIGN KEY ( OptionSetId ) REFERENCES SnApp.dbo.tbOptionSet( OptionSetId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbSaleItem ADD CONSTRAINT FK_SaleItem_Ticket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbSalePromotion" id="Editor_1ad" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbSalePromotion ( 
	SalePromotionId      uniqueidentifier NOT NULL    ,
	SaleId               uniqueidentifier NOT NULL    ,
	PromoProductId       uniqueidentifier NOT NULL    ,
	IndividualCouponId   uniqueidentifier     ,
	SaleFiscalDate       date NOT NULL    ,
	Quantity             int NOT NULL    ,
	DiscountAmount       money NOT NULL    ,
	CONSTRAINT PK_SalePromotion PRIMARY KEY  ( SalePromotionId ),
	CONSTRAINT UQ_SalePromotion UNIQUE ( SaleId, PromoProductId, IndividualCouponId ) 
 );

CREATE  INDEX IX_SalePromotion_PromoProductId ON dbo.tbSalePromotion ( PromoProductId, SaleFiscalDate );

CREATE  INDEX IX_SalePromotion_SaleId ON dbo.tbSalePromotion ( SaleId, SaleFiscalDate );

CREATE  INDEX IX_SalePromotion_IndividualCouponId ON dbo.tbSalePromotion ( IndividualCouponId, SaleFiscalDate ) where IndividualCouponId is not null;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the quantity of each promotion applied to the sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'SaleId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Promotion' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'PromoProductId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the individual coupon that added this promotion to the sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'IndividualCouponId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Fiscal date of the Sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'SaleFiscalDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Quantity of the promotion applied to the sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'Quantity';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Amount discounted by this promotion' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'DiscountAmount';

ALTER TABLE dbo.tbSalePromotion ADD CONSTRAINT FK_SalePromotion_Sale FOREIGN KEY ( SaleId ) REFERENCES dbo.tbSale( SaleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbSalePromotion ADD CONSTRAINT FK_SalePromotion_Product FOREIGN KEY ( PromoProductId ) REFERENCES dbo.tbProduct( ProductId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbSalePromotion ADD CONSTRAINT FK_SalePromotion_IndividualCoupon FOREIGN KEY ( IndividualCouponId ) REFERENCES dbo.tbIndividualCoupon( IndividualCouponId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbSalePromotion_001" id="Editor_1df0" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbSalePromotion ( 
	SalePromotionId      uniqueidentifier NOT NULL    ,
	SaleId               uniqueidentifier NOT NULL    ,
	PromoProductId       uniqueidentifier NOT NULL    ,
	IndividualCouponId   uniqueidentifier     ,
	SaleFiscalDate       date NOT NULL    ,
	Quantity             int NOT NULL    ,
	DiscountAmount       money NOT NULL    ,
	CONSTRAINT PK_SalePromotion PRIMARY KEY  ( SalePromotionId )
 );

CREATE  INDEX UQ_SalePromotion ON dbo.tbSalePromotion ( SaleId, PromoProductId, IndividualCouponId );

CREATE  INDEX IX_SalePromotion_PromoProductId ON dbo.tbSalePromotion ( PromoProductId, SaleFiscalDate );

CREATE  INDEX IX_SalePromotion_SaleId ON dbo.tbSalePromotion ( SaleId, SaleFiscalDate );

CREATE  INDEX IX_SalePromotion_IndividualCouponId ON dbo.tbSalePromotion ( IndividualCouponId, SaleFiscalDate ) where IndividualCouponId is not null;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains the quantity of each promotion applied to the sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'SaleId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the Promotion' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'PromoProductId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the individual coupon that added this promotion to the sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'IndividualCouponId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Fiscal date of the Sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'SaleFiscalDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Quantity of the promotion applied to the sale' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'Quantity';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Amount discounted by this promotion' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSalePromotion', @level2type=N'COLUMN',@level2name=N'DiscountAmount';

ALTER TABLE dbo.tbSalePromotion ADD CONSTRAINT FK_SalePromotion_Sale FOREIGN KEY ( SaleId ) REFERENCES dbo.tbSale( SaleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbSalePromotion ADD CONSTRAINT FK_SalePromotion_Product FOREIGN KEY ( PromoProductId ) REFERENCES dbo.tbProduct( ProductId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbSalePromotion ADD CONSTRAINT FK_SalePromotion_IndividualCoupon FOREIGN KEY ( IndividualCouponId ) REFERENCES dbo.tbIndividualCoupon( IndividualCouponId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbSaleToken" id="Editor_13f3" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbSaleToken ( 
	SaleTokenId          uniqueidentifier NOT NULL    ,
	SaleId               uniqueidentifier NOT NULL    ,
	SaleTokenType        tinyint NOT NULL    ,
	SaleTokenStatus      tinyint NOT NULL    ,
	ExpireDateTime       date NOT NULL    ,
	CONSTRAINT PK_SaleToken_SaleTokenId PRIMARY KEY  ( SaleTokenId ) 
 );
GO

CREATE  INDEX IX_SaleToken_SaleId ON SnApp.dbo.tbSaleToken ( SaleId, ExpireDateTime );
GO

CREATE  INDEX IX_SaleToken_StatusAndExpire ON SnApp.dbo.tbSaleToken ( SaleTokenStatus, ExpireDateTime );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Information about "pay by link" tokens' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'SaleTokenId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'SaleId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[?}' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'SaleTokenType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[?}' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'SaleTokenStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Data/Time of the expiration of the token' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'ExpireDateTime';
GO

ALTER TABLE SnApp.dbo.tbSaleToken ADD CONSTRAINT FK_SaleToken_Sale FOREIGN KEY ( SaleId ) REFERENCES SnApp.dbo.tbSale( SaleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbSaleToken_001" id="Editor_1e6f" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbSaleToken ( 
	SaleTokenId          uniqueidentifier NOT NULL    ,
	SaleId               uniqueidentifier NOT NULL    ,
	SaleTokenType        tinyint NOT NULL    ,
	SaleTokenStatus      tinyint NOT NULL    ,
	ExpireDateTime       smalldatetime NOT NULL    ,
	WebAuthId            uniqueidentifier     ,
	WorkstationId        uniqueidentifier NOT NULL    ,
	CONSTRAINT PK_SaleToken_SaleTokenId PRIMARY KEY  ( SaleTokenId ) 
 );
GO

CREATE  INDEX IX_SaleToken_SaleId ON SnApp.dbo.tbSaleToken ( SaleId, ExpireDateTime );
GO

CREATE  INDEX IX_SaleToken_StatusAndExpire ON SnApp.dbo.tbSaleToken ( SaleTokenStatus, ExpireDateTime );
GO

CREATE  INDEX IX_SaleToken_WebAuthId ON SnApp.dbo.tbSaleToken ( WebAuthId ) where WebAuthId is not null;
GO

CREATE  INDEX IX_SaleToken_WorkstationId ON SnApp.dbo.tbSaleToken ( WorkstationId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Information about "pay by link" tokens' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'SaleTokenId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the order' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'SaleId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[457]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'SaleTokenType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[458]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'SaleTokenStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Data/Time of the expiration of the token' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'ExpireDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to web auth request' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'WebAuthId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the workstation that performed the "lock"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSaleToken', @level2type=N'COLUMN',@level2name=N'WorkstationId';
GO

ALTER TABLE SnApp.dbo.tbSaleToken ADD CONSTRAINT FK_SaleToken_Sale FOREIGN KEY ( SaleId ) REFERENCES SnApp.dbo.tbSale( SaleId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbSaleToken ADD CONSTRAINT FK_SaleToken_WebAuth FOREIGN KEY ( WebAuthId ) REFERENCES SnApp.dbo.tbWebAuth( WebAuthId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbSaleToken ADD CONSTRAINT FK_SaleToken_WorkstationId FOREIGN KEY ( WorkstationId ) REFERENCES SnApp.dbo.tbWorkstation( WorkstationId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbSeatInfo_001" id="Editor-1374" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbSeatInfo ( 
	SeatId               uniqueidentifier      NOT NULL,
	ColLabel             varchar(15)      NULL,
	RowLabel             varchar(15)      NULL,
	CONSTRAINT PK_SeatInfo PRIMARY KEY  ( SeatId ) 
 );
GO

ALTER TABLE SnApp.dbo.tbSeatInfo ADD CONSTRAINT FK_SeatInfo_Seat FOREIGN KEY ( SeatId ) REFERENCES SnApp.dbo.tbSeat( SeatId ) ON DELETE CASCADE;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains seat informations which do not get cloned on each performance.... so cannot be customized performance by performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatInfo';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to seat' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatInfo', @level2type=N'COLUMN',@level2name=N'SeatId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Column label (usually a number)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatInfo', @level2type=N'COLUMN',@level2name=N'ColLabel';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Row label (usually a letter)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatInfo', @level2type=N'COLUMN',@level2name=N'RowLabel';
GO
]]></string>
		</script>
		<script name="tbSeatSector" id="Editor_26ed" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbSeatSector ( 
	SeatSectorId         uniqueidentifier NOT NULL    ,
	AcAreaAccountId      uniqueidentifier NOT NULL    ,
	ParentSectorId       uniqueidentifier     ,
	SeatSectorType       smallint NOT NULL    ,
	SeatSectorCode       varchar(10)     ,
	SeatSectorName       nvarchar(30) NOT NULL    ,
	RootSectorId         uniqueidentifier NOT NULL    ,
	CONSTRAINT PK_SeatSector PRIMARY KEY  ( SeatSectorId ) 
 );

CREATE  INDEX IX_SeatSector_AcAreaAccountId ON dbo.tbSeatSector ( AcAreaAccountId ASC );

CREATE  INDEX IX_SeatSector_ParentSectorId ON dbo.tbSeatSector ( ParentSectorId ASC );

CREATE  INDEX IX_SeatSector_RootSectorId ON dbo.tbSeatSector ( RootSectorId );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Sectors definition table.\nStructure is recursive cause you could have multiple maps per access area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatSector';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatSector', @level2type=N'COLUMN',@level2name=N'SeatSectorId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to access area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatSector', @level2type=N'COLUMN',@level2name=N'AcAreaAccountId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[140] (Folder, Sector)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatSector', @level2type=N'COLUMN',@level2name=N'SeatSectorType';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Intelligible alphanumeric user defined code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatSector', @level2type=N'COLUMN',@level2name=N'SeatSectorCode';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Sector name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatSector', @level2type=N'COLUMN',@level2name=N'SeatSectorName';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the top-most sector on the hierarchy tree' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSeatSector', @level2type=N'COLUMN',@level2name=N'RootSectorId';

ALTER TABLE dbo.tbSeatSector ADD CONSTRAINT FK_SeatSector_AcAreaAccount FOREIGN KEY ( AcAreaAccountId ) REFERENCES dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbSeatSector ADD CONSTRAINT FK_SeatSector_ParentSector FOREIGN KEY ( ParentSectorId ) REFERENCES dbo.tbSeatSector( SeatSectorId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbSeatSector ADD CONSTRAINT FK_SeatSector_RootSector FOREIGN KEY ( RootSectorId ) REFERENCES dbo.tbSeatSector( SeatSectorId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbServerWarVersion" id="Editor-24d1" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbServerWarVersion ( 
	ServerId             smallint      NOT NULL,
	InstallDateTime      datetime      NOT NULL,
	WarVersion           nvarchar(50)      NOT NULL,
	UpgradeDuration      int      NOT NULL,
	CONSTRAINT PK_ServerWarVersion PRIMARY KEY  ( ServerId ) 
 );
GO

ALTER TABLE SnApp.dbo.tbServerWarVersion ADD CONSTRAINT FK_ServerWarVersion_Server FOREIGN KEY ( ServerId ) REFERENCES SnApp.dbo.tbServer( ServerId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'History of WAR upgrade version' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServerWarVersion';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Server Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServerWarVersion', @level2type=N'COLUMN',@level2name=N'ServerId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record installation timestamp' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServerWarVersion', @level2type=N'COLUMN',@level2name=N'InstallDateTime';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Duration of upgarde in milliseconds' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServerWarVersion', @level2type=N'COLUMN',@level2name=N'UpgradeDuration';
GO
]]></string>
		</script>
		<script name="tbServiceStatus" id="Editor_223c" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbServiceStatus ( 
	ServerId             int NOT NULL    ,
	ServiceId            uniqueidentifier NOT NULL    ,
	ServiceName          varchar(100) NOT NULL    ,
	ServiceStatus        int NOT NULL    ,
	ErrorMessage         nvarchar(max)     ,
	LastUpdate           datetime NOT NULL    ,
	CONSTRAINT PK_ServiceStatus PRIMARY KEY  ( ServerId, ServiceId ) 
 );
GO

CREATE  INDEX IX_ServiceStatus_ServiceId ON dbo.tbServiceStatus ( ServiceId );
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Contain updated snapshot of the status of each service per each running server' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServiceStatus';;
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Server internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServiceStatus', @level2type=N'COLUMN',@level2name=N'ServerId';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Service internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServiceStatus', @level2type=N'COLUMN',@level2name=N'ServiceId';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Service name' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServiceStatus', @level2type=N'COLUMN',@level2name=N'ServiceName';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[170]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServiceStatus', @level2type=N'COLUMN',@level2name=N'ServiceStatus';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Service current error message. When NULL, the service is not "in error"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServiceStatus', @level2type=N'COLUMN',@level2name=N'ErrorMessage';
GO

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Record last update timestamp' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbServiceStatus', @level2type=N'COLUMN',@level2name=N'LastUpdate';
GO

ALTER TABLE dbo.tbServiceStatus ADD CONSTRAINT FK_ServiceStatus_Server FOREIGN KEY ( ServerId ) REFERENCES dbo.tbServer( ServerId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbSiaeLog" id="Editor-e11" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbSiaeLog ( 
	LogId                int      NOT NULL,
	Sigillo              varchar(16)      NOT NULL,
	WorkstationId        uniqueidentifier      NOT NULL,
	EventId              uniqueidentifier      NULL,
	PerformanceId        uniqueidentifier      NULL,
	CodiceSistema        varchar(8)      NOT NULL,
	CodiceCarta          varchar(8)      NOT NULL,
	OrganizerId          uniqueidentifier      NOT NULL,
	LocationId           uniqueidentifier      NULL,
	PartnerAccountId     uniqueidentifier      NULL,
	ProductId            uniqueidentifier      NOT NULL,
	TicketId             uniqueidentifier      NULL,
	MediaId              uniqueidentifier      NULL,
	SaleItemDetailId     uniqueidentifier      NULL,
	Stato                varchar(10)      NOT NULL,
	Operazione           smallint      NOT NULL,
	OriginalLogId        int      NULL,
	DataOraEmissione     smalldatetime      NOT NULL,
	OrdinePosto          varchar(10)      NOT NULL,
	Posto                varchar(6)      NULL,
	TitoloBase           varchar(1)      NOT NULL,
	IvaPreassolta        varchar(1)      NOT NULL,
	TipoTurno            smallint      NOT NULL,
	ProgressivoCarta     int      NOT NULL,
	TipoTassazione       varchar(1)      NOT NULL,
	PrezzoTitolo         money      NOT NULL,
	IvaTitolo            money      NOT NULL,
	PrezzoPrevendita     money      NOT NULL,
	IvaPrevendita        money      NOT NULL,
	Rateo                money      NOT NULL,
	IvaRateo             money      NOT NULL,
	TipoTitolo           varchar(10)      NULL,
	RateoIntrattenimenti money      NULL,
	ImponibileIntrattenimenti money      NULL,
	IvaIntrattenimenti   money      NULL,
	Smaterializzato      bit      NOT NULL,
	IvaRateoIntrattenimenti money      NULL,
	DataOraEvento        smalldatetime      NULL,
	Capienza             int      NOT NULL,
	IsOrphan             bit      NOT NULL,
	StatoCorrente        varchar(10)      NULL,
	CausaleAnnullamento  varchar(10)      NULL,
	CONSTRAINT UQ_SiaeLog_Sigillo UNIQUE ( Sigillo ASC ) ,
	CONSTRAINT UQ_SiaeLog_Media UNIQUE ( MediaId ASC, PerformanceId ASC, Operazione ASC ) where TitoloBase = 'T'
and MediaId is not null
and PerformanceId is not null
and CausaleAnnullamento is null
,
	CONSTRAINT PK_SiaeLog PRIMARY KEY  ( LogId ) 
 );
GO

CREATE  INDEX IX_SiaeLog_WorkstationId ON SnApp.dbo.tbSiaeLog ( WorkstationId ASC, DataOraEmissione ASC );
GO

CREATE  INDEX IX_SiaeLog_PerformanceId ON SnApp.dbo.tbSiaeLog ( PerformanceId ASC, DataOraEmissione ASC ) where PerformanceId is not null;
GO

CREATE  INDEX IX_SiaeLog_CodiceSistema ON SnApp.dbo.tbSiaeLog ( CodiceSistema ASC, DataOraEmissione ASC );
GO

CREATE  INDEX IX_SiaeLog_CodiceCarta ON SnApp.dbo.tbSiaeLog ( CodiceCarta ASC, DataOraEmissione ASC );
GO

CREATE  INDEX IX_SiaeLog_OrganizerId ON SnApp.dbo.tbSiaeLog ( OrganizerId ASC, DataOraEmissione ASC );
GO

CREATE  INDEX IX_SiaeLog_LocationId ON SnApp.dbo.tbSiaeLog ( LocationId ASC, DataOraEmissione ASC ) where LocationId is not null;
GO

CREATE  INDEX IX_SiaeLog_TicketId ON SnApp.dbo.tbSiaeLog ( TicketId ASC, DataOraEmissione ASC ) where TicketId is not null;
GO

CREATE  INDEX IX_SiaeLog_MediaId ON SnApp.dbo.tbSiaeLog ( MediaId ASC, DataOraEmissione ASC ) where MediaId is not null;
GO

CREATE  INDEX IX_SiaeLog_ProductId ON SnApp.dbo.tbSiaeLog ( ProductId ASC );
GO

CREATE  INDEX IX_SiaeLog_SaleItemDetailId ON SnApp.dbo.tbSiaeLog ( SaleItemDetailId ASC, PerformanceId ASC, Posto ASC ) where SaleItemDetailId is not null;
GO

CREATE  INDEX IX_SiaeLog_OriginalLogId ON SnApp.dbo.tbSiaeLog ( OriginalLogId ASC ) where OriginalLogId is not null;
GO

CREATE  INDEX IX_SiaeLog_PartnerAccountId ON SnApp.dbo.tbSiaeLog ( PartnerAccountId ASC ) where PartnerAccountId is not null;
GO

CREATE  INDEX IX_SiaeLog_EventId ON SnApp.dbo.tbSiaeLog ( EventId ) where EventId is not null;
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_Account FOREIGN KEY ( PartnerAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES SnApp.dbo.tbWorkstation( WorkstationId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_Performance FOREIGN KEY ( PerformanceId ) REFERENCES SnApp.dbo.tbPerformance( PerformanceId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_Ticket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_Media FOREIGN KEY ( MediaId ) REFERENCES SnApp.dbo.tbMedia( MediaId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_SaleItemDetail FOREIGN KEY ( SaleItemDetailId ) REFERENCES SnApp.dbo.tbSaleItemDetail( SaleItemDetailId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_SiaeOrganizer FOREIGN KEY ( OrganizerId ) REFERENCES SnApp.dbo.tbSiaeOrganizer( OrganizerId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_SiaeLocation FOREIGN KEY ( LocationId ) REFERENCES SnApp.dbo.tbSiaeLocation( LocationId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_SiaeSystem FOREIGN KEY ( CodiceSistema ) REFERENCES SnApp.dbo.tbSiaeSystem( CodiceSistema );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_SiaeCard FOREIGN KEY ( CodiceCarta ) REFERENCES SnApp.dbo.tbSiaeCard( CodiceCarta );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_SiaeEvent FOREIGN KEY ( EventId ) REFERENCES SnApp.dbo.tbSiaeEvent( EventId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_Original FOREIGN KEY ( OriginalLogId ) REFERENCES SnApp.dbo.tbSiaeLog( LogId );
GO

ALTER TABLE SnApp.dbo.tbSiaeLog ADD CONSTRAINT FK_SiaeLog_SiaeProduct FOREIGN KEY ( ProductId ) REFERENCES SnApp.dbo.tbSiaeProduct( ProductId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Siae Log' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'B2B major client' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'PartnerAccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Lookup Table "Stato del titolo"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'Stato';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'0=Emissione 1=Annullo' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'Operazione';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to voided LogId' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'OriginalLogId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'A=Abbonamento, T=Titolo, F=Figurativo' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'TitoloBase';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Y or N' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'IvaPreassolta';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'0=Fisso 1=Libero' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'TipoTurno';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contatore in tbSiaeCard' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'ProgressivoCarta';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'DTD says its I or S;  \n-N=Normale B=Abbonamento F=Iva Preassolta-' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'TipoTassazione';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Lookup Table "Tipo titolo"' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'TipoTitolo';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'0=Normale 1=Smaterializzato' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'Smaterializzato';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Flag if we need generate void seal for this row' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'IsOrphan';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Lookup table CausaleAnnullamento' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLog', @level2type=N'COLUMN',@level2name=N'CausaleAnnullamento';
GO
]]></string>
		</script>
		<script name="tbSiaeLookup" id="Editor-1b74" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbSiaeLookup ( 
	LookupTableId        smallint      NOT NULL,
	LookupItemCode       varchar(10)      NOT NULL,
	LookupItemName       nvarchar(100)      NOT NULL,
	Note                 nvarchar(max)      NULL,
	CONSTRAINT PK_SiaeLookup PRIMARY KEY  ( LookupTableId, LookupItemCode ) 
 );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Additional note describing the details if any' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeLookup', @level2type=N'COLUMN',@level2name=N'Note';
GO]]></string>
		</script>
		<script name="tbSiaeOrganizer" id="Editor-11c4" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbSiaeOrganizer ( 
	OrganizerId          uniqueidentifier      NOT NULL,
	Denominazione        nvarchar(30)      NOT NULL,
	CodiceFiscale        varchar(16)      NULL,
	PartitaIva           varchar(11)      NULL,
	TipoOrganizzatore    varchar(1)      NOT NULL,
	CONSTRAINT PK_SiaeOrganizer PRIMARY KEY  ( OrganizerId ) 
 );
GO

ALTER TABLE SnApp.dbo.tbSiaeOrganizer ADD CONSTRAINT FK_SiaeOrganizer_Account FOREIGN KEY ( OrganizerId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO
]]></string>
		</script>
		<script name="tbSiaeWorkstation" id="Editor-1529" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbSiaeWorkstation ( 
	NumericCode          int    IDENTITY(1,1)  NOT NULL,
	WorkstationId        int      NOT NULL,
	AlphaCode            nvarchar(2)      NOT NULL,
	CONSTRAINT PK_SiaeWorkstation PRIMARY KEY  ( NumericCode ) 
 );
GO

CREATE  INDEX IX_SiaeWorkstation_Workstation ON SnApp.dbo.tbSiaeWorkstation ( WorkstationId );
GO

ALTER TABLE SnApp.dbo.tbSiaeWorkstation ADD CONSTRAINT FK_SiaeWorkstation_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES SnApp.dbo.tbWorkstation( WorkstationId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Codice richiedente consists of two parts: 1) prefix 2) Numeric code\nThis is the numeric code part' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeWorkstation', @level2type=N'COLUMN',@level2name=N'NumericCode';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Codice richiedente consists of two parts: 1) prefix 2) Numeric code\nThis is the prefix.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbSiaeWorkstation', @level2type=N'COLUMN',@level2name=N'AlphaCode';
GO
]]></string>
		</script>
		<script name="tbTagLink" id="Editor-1752" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTagLink ( 
	TagId                uniqueidentifier NOT NULL    ,
	EntityId             uniqueidentifier NOT NULL    ,
	TagLinkType          smallint NOT NULL    ,
	EntityType           smallint NOT NULL    ,
	CONSTRAINT PK_TagLink PRIMARY KEY  ( TagId, EntityId, TagLinkType ) 
 );
GO

CREATE  INDEX IX_TagLink_EntityId ON SnApp.dbo.tbTagLink ( EntityId ASC, TagLinkType ASC );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'N to N table for linking different entities to tags' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTagLink';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the tag' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTagLink', @level2type=N'COLUMN',@level2name=N'TagId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the entity' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTagLink', @level2type=N'COLUMN',@level2name=N'EntityId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[462]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTagLink', @level2type=N'COLUMN',@level2name=N'TagLinkType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[131]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTagLink', @level2type=N'COLUMN',@level2name=N'EntityType';
GO

ALTER TABLE SnApp.dbo.tbTagLink ADD CONSTRAINT FK_TagLink_Tag FOREIGN KEY ( TagId ) REFERENCES SnApp.dbo.tbTag( TagId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO]]></string>
		</script>
		<script name="tbTask" id="Editor_e4b" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbTask ( 
	TaskId               uniqueidentifier NOT NULL    ,
	TaskName             nvarchar(50) NOT NULL    ,
	TaskType             smallint NOT NULL    ,
	NextTaskId           uniqueidentifier     ,
	TaskConfig           nvarchar(max)     ,
	TaskFrequency        smallint NOT NULL    ,
	TimeFrom             datetime     ,
	TimeTo               datetime     ,
	TimeZone             tinyint NOT NULL    ,
	Interval             int     ,
	ActiveMon            bit NOT NULL    ,
	ActiveTue            bit NOT NULL    ,
	ActiveWed            bit NOT NULL    ,
	ActiveThu            bit NOT NULL    ,
	ActiveFri            bit NOT NULL    ,
	ActiveSat            bit NOT NULL    ,
	ActiveSun            bit NOT NULL    ,
	LastFire             datetime     ,
	LastReference        nvarchar(max)     ,
	LastEntityChangeId   bigint     ,
	LastUpdate           datetime     ,
	PurgeDays            int     ,
	TaskStatus           smallint NOT NULL    ,
	ClassAlias           varchar(30) NOT NULL    ,
	SendNotification     bit NOT NULL    ,
	NotificationSubject  nvarchar(100)     ,
	NotificationEmail    nvarchar(100)     ,
	NotifyOnJobFailure   bit NOT NULL    ,
	NotifyOnSuccessCount bit NOT NULL    ,
	NotifyOnWarnCount    bit NOT NULL    ,
	NotifyOnFailCount    bit NOT NULL    ,
	ExtensionPackageId   uniqueidentifier     ,
	CONSTRAINT PK_Task PRIMARY KEY  ( TaskId )
 );

CREATE  INDEX IX_Task_ExtensionPackageId ON dbo.tbTask ( ExtensionPackageId ASC ) where ExtensionPackageId is not null;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[154]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'TaskType';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[238]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'TimeZone';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Used for differential data exports' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'LastEntityChangeId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Used for differential data exports' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'LastUpdate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Job''s persistance''s number of days.\nWhen null, default is taken from data-purge task' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'PurgeDays';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[309] - Active, Disabled, Deleted' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'TaskStatus';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Class alias for the specific task' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'ClassAlias';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Specify if task execution should send notifications' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'SendNotification';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Notification subject if "SendNotification" is active' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'NotificationSubject';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'List of email addresses comma separated if "SendNotification" is active' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'NotificationEmail';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Send notification if job fails' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'NotifyOnJobFailure';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Send notification in case of at least one successful record processed.\nNotifyOnJob must be true.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'NotifyOnSuccessCount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Send notification in case of at least one record processed with warn.\nNotifyOnJob must be true.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'NotifyOnWarnCount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Send notification in case of at least one record process has failed.\nNotifyOnJob must be true.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'NotifyOnFailCount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the specific extension package containing the task' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTask', @level2type=N'COLUMN',@level2name=N'ExtensionPackageId';

ALTER TABLE dbo.tbTask ADD CONSTRAINT FK_Task_NextTask FOREIGN KEY ( NextTaskId ) REFERENCES dbo.tbTask( TaskId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbTask ADD CONSTRAINT FK_Task_ExtensionPackage FOREIGN KEY ( ExtensionPackageId ) REFERENCES dbo.tbExtensionPackage( ExtensionPackageId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbTaskTrigger" id="Editor-1599" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTaskTrigger ( 
	TaskTriggerId        uniqueidentifier NOT NULL    ,
	TaskId               uniqueidentifier NOT NULL    ,
	TriggerType          smallint NOT NULL    ,
	Enabled              bit NOT NULL    ,
	TriggerConfig        nvarchar(max)     ,
	CONSTRAINT PK_TaskTrigger PRIMARY KEY  ( TaskTriggerId ) 
 );
GO

CREATE  INDEX IX_TaskTrigger_TaskId ON SnApp.dbo.tbTaskTrigger ( TaskId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[156]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTaskTrigger', @level2type=N'COLUMN',@level2name=N'TriggerType';
GO

ALTER TABLE SnApp.dbo.tbTaskTrigger ADD CONSTRAINT FK_TaskTrigger_Task FOREIGN KEY ( TaskId ) REFERENCES SnApp.dbo.tbTask( TaskId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbTicket" id="Editor_22c5" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbTicket ( 
	TicketId             uniqueidentifier NOT NULL    ,
	LicenseId            smallint NOT NULL    ,
	TicketMediaMatchId   uniqueidentifier     ,
	SaleItemDetailId     uniqueidentifier NOT NULL    ,
	ProductId            uniqueidentifier     ,
	TransactionId        uniqueidentifier     ,
	SeatHoldId           uniqueidentifier     ,
	PerformanceSetId     uniqueidentifier     ,
	TicketStatus         smallint NOT NULL    ,
	StationSerial        smallint NOT NULL    ,
	TicketSerial         int NOT NULL    ,
	EncodeDateTime       smalldatetime NOT NULL    ,
	EncodeFiscalDate     date NOT NULL    ,
	ValidateDateTime     smalldatetime     ,
	ValidateFiscalDate   date     ,
	FirstUsageDateTime   smalldatetime     ,
	FirstUsageFiscalDate date     ,
	EntitlementData      varchar(max)     ,
	GroupQuantity        smallint NOT NULL    ,
	GroupTicketOption    smallint NOT NULL    ,
	ValidDateFrom        date     ,
	ValidDateTo          date     ,
	PurgeLevel           tinyint     ,
	Settled              bit NOT NULL    ,
	ManualExpiration     bit NOT NULL    ,
	BonusEntry           bit NOT NULL    ,
	OfflineVirtual       bit     ,
	UnitAmount           money NOT NULL    ,
	UnitTax              money NOT NULL    ,
	ClearingLimit        money NOT NULL    ,
	ClearingUsed         money NOT NULL    ,
	ClearingInitialAllocation money NOT NULL    ,
	PriorityOrder        smallint     ,
	BreakageDate         date     ,
	BiometricTicketOverride tinyint     ,
	TriggerBreakage      bit NOT NULL    ,
	TriggerExpiration    bit NOT NULL    ,
	TriggerClearing      bit NOT NULL    ,
	AccrualEndDate       date     ,
	CONSTRAINT UQ_Ticket_TDSSN UNIQUE ( EncodeFiscalDate ASC, LicenseId ASC, StationSerial ASC, TicketSerial ASC ) ,
	CONSTRAINT UQ_Ticket_SaleItemDetailId UNIQUE ( SaleItemDetailId ASC ) ,
	CONSTRAINT PK_Ticket PRIMARY KEY  ( TicketId ) 
 );

CREATE  INDEX IX_Ticket_PortfolioId ON dbo.tbTicket ( TicketMediaMatchId ASC, PriorityOrder ASC );

CREATE  INDEX IX_Ticket_SeatHoldId ON dbo.tbTicket ( SeatHoldId ASC ) where SeatHoldId is not null;

CREATE  INDEX IX_Ticket_ProductId ON dbo.tbTicket ( ProductId ASC, EncodeFiscalDate ASC, EncodeDateTime ASC ) INCLUDE(TicketStatus, FirstUsageDateTime);

CREATE  INDEX IX_Ticket_TransactionId ON dbo.tbTicket ( TransactionId ASC );

CREATE  INDEX IX_Ticket_EncodeFiscalDate ON dbo.tbTicket ( EncodeFiscalDate DESC, EncodeDateTime DESC, TicketSerial DESC );

CREATE  INDEX IX_Ticket_PerformanceSetId ON dbo.tbTicket ( PerformanceSetId ASC, FirstUsageDateTime ASC ) where PerformanceSetId is not null;

CREATE  INDEX IX_Ticket_ValidDateTo ON dbo.tbTicket ( ValidDateTo ASC ) where ValidDateTo is not null;

CREATE  INDEX IX_Ticket_TriggerBreakage ON dbo.tbTicket ( BreakageDate ASC, TriggerBreakage ASC ) where (BreakageDate is not null) and TriggerBreakage=0;

CREATE  INDEX IX_Ticket_TriggerExpiration ON dbo.tbTicket ( ValidDateTo ASC, TriggerExpiration ASC ) where (ValidDateTo is not null) and TriggerExpiration=0;

CREATE  INDEX IX_Ticket_TriggerClearing ON dbo.tbTicket ( ValidDateTo ASC, TriggerClearing ASC ) where (ValidDateTo is not null) and TriggerClearing=0;

CREATE  INDEX IX_Ticket_AccrualEndDate ON dbo.tbTicket ( AccrualEndDate  DESC , EncodeFiscalDate  DESC  );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Holds encoded products' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket';;

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'TicketId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Licensee owning this product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'LicenseId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to portfolio' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'TicketMediaMatchId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the sale item detail which sold this product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'SaleItemDetailId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'ProductId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the transaction which created this record' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'TransactionId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'For limited capacity events, reference to the seat locking info' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'SeatHoldId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to performance set' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'PerformanceSetId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[5]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'TicketStatus';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Serial of the workstation which encoded thi product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'StationSerial';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Serial of the product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'TicketSerial';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Encoding date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'EncodeDateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Encoding fiscal/date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'EncodeFiscalDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Validation date/time.\nNulll = not validated' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'ValidateDateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'First usage date/time.\nNull = not used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'FirstUsageDateTime';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Product enitlement''s JSON' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'EntitlementData';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'1 for non group ticket, otherwise is the quantity purchaised' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'GroupQuantity';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[153]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'GroupTicketOption';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Ticket validity start date' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'ValidDateFrom';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Ticket expiration date. This field value changes during the lifetime of a product everytime it gets used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'ValidDateTo';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[226]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'PurgeLevel';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Used for thos products which are not paid at sale time, but when the guest exits the location settling both ticket value and anything else purchaised with it' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'Settled';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Set to true when expiration date was manually changed from BKO' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'ManualExpiration';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'not used' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'BonusEntry';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'true if the record was created upon a redemption of a media issued offline which is not present at DB' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'OfflineVirtual';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Amount paid for the ticket (including taxes)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'UnitAmount';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Tax portion for the amount paid for the ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'UnitTax';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Total amount that can be moved to revenue (usually the ticket net price)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'ClearingLimit';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Clearing portion already moved to revenue' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'ClearingUsed';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'This field is populated by the Import API and gets the same value as Clearing Used at the time of the import' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'ClearingInitialAllocation';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Redemption priority on the same portfolio' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'PriorityOrder';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Date of when the breakage of ticket value should happen if ticket never used.' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'BreakageDate';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[379]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'BiometricTicketOverride';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'When true, ledger trigger on breakage has been triggered' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'TriggerBreakage';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'When true, ledger trigger on expiration has been triggered' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'TriggerExpiration';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'When true, ledger trigger on clearing has been triggered' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'TriggerClearing';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Stores fiscal date of when the revenue of the ticket has been acccrued to the point that can never change again. (Ex. after expiration, after upgrade, after clearing allocated is equal to clearing limit etc.)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicket', @level2type=N'COLUMN',@level2name=N'AccrualEndDate';

ALTER TABLE dbo.tbTicket ADD CONSTRAINT FK_Ticket_Product FOREIGN KEY ( ProductId ) REFERENCES dbo.tbProduct( ProductId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbTicket ADD CONSTRAINT FK_Ticket_Transaction FOREIGN KEY ( TransactionId ) REFERENCES dbo.tbTransaction( TransactionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbTicket ADD CONSTRAINT FK_Ticket_Portfolio FOREIGN KEY ( TicketMediaMatchId ) REFERENCES dbo.tbTicketMediaMatch( TicketMediaMatchId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbTicket ADD CONSTRAINT FK_Ticket_License FOREIGN KEY ( LicenseId ) REFERENCES dbo.tbLicense( LicenseId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbTicket ADD CONSTRAINT FK_Ticket_SaleItemDetail FOREIGN KEY ( SaleItemDetailId ) REFERENCES dbo.tbSaleItemDetail( SaleItemDetailId ) ON DELETE NO ACTION ON UPDATE NO ACTION;

ALTER TABLE dbo.tbTicket ADD CONSTRAINT FK_Ticket_SeatHold FOREIGN KEY ( SeatHoldId ) REFERENCES dbo.tbSeatHold( SeatHoldId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
]]></string>
		</script>
		<script name="tbTicketGuestLink" id="Editor_1978" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTicketGuestLink ( 
	TicketId             uniqueidentifier NOT NULL    ,
	GuestTicketId        uniqueidentifier NOT NULL    ,
	CONSTRAINT PK_TicketGuestLink PRIMARY KEY  ( TicketId, GuestTicketId ) 
 );
GO

CREATE  INDEX IX_TicketGuestLink_GuestTicketId ON SnApp.dbo.tbTicketGuestLink ( GuestTicketId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'List of guest tickets of host ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketGuestLink';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Host ticket reference' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketGuestLink', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Guest ticket reference' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketGuestLink', @level2type=N'COLUMN',@level2name=N'GuestTicketId';
GO

ALTER TABLE SnApp.dbo.tbTicketGuestLink ADD CONSTRAINT FK_TicketGuestLink_HostTicket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbTicketGuestLink ADD CONSTRAINT FK_TicketGuestLink_GuestTicket FOREIGN KEY ( GuestTicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbTicketLedgerTrigger" id="Editor_1efd" language="SQL" >
			<string><![CDATA[CREATE TABLE dbo.tbTicketLedgerTrigger ( 
	TicketLedgerTriggerId uniqueidentifier NOT NULL    ,
	TicketId             uniqueidentifier NOT NULL    ,
	TriggerLedgerType    smallint NOT NULL    ,
	TriggerDateTime      datetime NOT NULL    ,
	CONSTRAINT PK_TicketLedgerTrigger PRIMARY KEY  ( TicketLedgerTriggerId ),
	CONSTRAINT UQ_TicketLedgerTrigger_TicketId UNIQUE ( TicketId ASC, TriggerLedgerType ASC ) 
 );

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Unique identifier' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketLedgerTrigger', @level2type=N'COLUMN',@level2name=N'TicketLedgerTriggerId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to ticket record' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketLedgerTrigger', @level2type=N'COLUMN',@level2name=N'TicketId';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[183] Expiration, Breakage' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketLedgerTrigger', @level2type=N'COLUMN',@level2name=N'TriggerLedgerType';

exec sp_addextendedproperty  @name=N'MS_Description', @value=N'Trigger date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketLedgerTrigger', @level2type=N'COLUMN',@level2name=N'TriggerDateTime';

ALTER TABLE dbo.tbTicketLedgerTrigger ADD CONSTRAINT FK_TicketLedgerTrigger_Ticket FOREIGN KEY ( TicketId ) REFERENCES dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;]]></string>
		</script>
		<script name="tbTicketPerformanceException_002" id="Editor-183f" language="SQL" >
			<string><![CDATA[CREATE TABLE tbTicketPerformanceException ( 
	TicketId             uniqueidentifier NOT NULL    ,
	PerformanceId        uniqueidentifier NOT NULL    ,
	TimeFrom             time NULL    ,
	CONSTRAINT PK_TicketPerformanceException PRIMARY KEY  ( TicketId, PerformanceId ) 
 );
GO

CREATE  INDEX IX_TicketPerformanceException_PerformanceId ON tbTicketPerformanceException ( PerformanceId );
GO

ALTER TABLE tbTicketPerformanceException ADD CONSTRAINT FK_TicketPerformanceException_Performance FOREIGN KEY ( PerformanceId ) REFERENCES tbPerformance( PerformanceId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Contains exceptions (such "time start validity") of a ticket for a specific performance.\nIf a performance is not referenced, it means that there are no exceptions, but the performance could be still be associated to the ticket (through tbTicket.PerformanceSetId)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketPerformanceException';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketPerformanceException', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketPerformanceException', @level2type=N'COLUMN',@level2name=N'PerformanceId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Start validity time, when not null, the ticket can be used for the performance only after the indicated time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketPerformanceException', @level2type=N'COLUMN',@level2name=N'TimeFrom';
GO
]]></string>
		</script>
		<script name="tbTicketRenew" id="Editor-20d1" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTicketRenew ( 
	TicketId             uniqueidentifier NOT NULL    ,
	SourceTicketId       uniqueidentifier NOT NULL    ,
	RenewStartDate       date NOT NULL    ,
	CONSTRAINT PK_TicketRenew PRIMARY KEY  ( TicketId ) 
 );
GO

CREATE  INDEX IX_TicketRenew_SourceTicketId ON SnApp.dbo.tbTicketRenew ( SourceTicketId ASC );
GO

CREATE  INDEX IX_TicketRenew_RenewStartDate ON SnApp.dbo.tbTicketRenew ( RenewStartDate );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Extension table for tbTicket.\nHolds information for products which are the renewal of another product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to destination product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to source product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew', @level2type=N'COLUMN',@level2name=N'SourceTicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The day after the end validity of the source ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew', @level2type=N'COLUMN',@level2name=N'RenewStartDate';
GO

ALTER TABLE SnApp.dbo.tbTicketRenew ADD CONSTRAINT FK_TicketRenew_Ticket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbTicketRenew ADD CONSTRAINT FK_TicketRenew_SourceTicket FOREIGN KEY ( SourceTicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbTicketRenew_002" id="Editor-f22" language="SQL" >
			<string><![CDATA[CREATE  TABLE tbTicketRenew ( 
	TicketId             uniqueidentifier      NOT NULL,
	SourceTicketId       uniqueidentifier      NULL,
	RenewStartDate       date      NOT NULL,
	SourceArchivedTicketId uniqueidentifier      NULL,
	SourceArchivedTicketCode varchar(50)      NULL,
	CONSTRAINT PK_TicketRenew PRIMARY KEY  ( TicketId ) 
 );
GO

CREATE  INDEX IX_TicketRenew_SourceTicketId ON tbTicketRenew ( SourceTicketId ASC );
GO

CREATE  INDEX IX_TicketRenew_RenewStartDate ON tbTicketRenew ( RenewStartDate );
GO

CREATE  INDEX IX_TicketRenew_SourceArchivedTicketId ON tbTicketRenew ( SourceArchivedTicketId );
GO

ALTER TABLE tbTicketRenew ADD CONSTRAINT FK_TicketRenew_Ticket FOREIGN KEY ( TicketId ) REFERENCES tbTicket( TicketId );
GO

ALTER TABLE tbTicketRenew ADD CONSTRAINT FK_TicketRenew_SourceTicket FOREIGN KEY ( SourceTicketId ) REFERENCES tbTicket( TicketId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Extension table for tbTicket.\nHolds information for products which are the renewal of another product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to destination product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to source product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew', @level2type=N'COLUMN',@level2name=N'SourceTicketId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The day after the end validity of the source ticket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew', @level2type=N'COLUMN',@level2name=N'RenewStartDate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the renewal source ticket in case it has been archived' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew', @level2type=N'COLUMN',@level2name=N'SourceArchivedTicketId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Archived source ticket code' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketRenew', @level2type=N'COLUMN',@level2name=N'SourceArchivedTicketCode';
GO
]]></string>
		</script>
		<script name="tbTicketUsage" id="Editor-45" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTicketUsage ( 
	TicketUsageId        uniqueidentifier      NOT NULL,
	UsageDateTime        datetime      NOT NULL,
	UsageFiscalDate      date      NOT NULL,
	UsageType            smallint      NOT NULL,
	ValidateResult       smallint      NOT NULL,
	MediaId              uniqueidentifier      NULL,
	AptWorkstationId     uniqueidentifier      NOT NULL,
	TicketId             uniqueidentifier      NULL,
	AccessAreaAccountId  uniqueidentifier      NULL,
	PerformanceId        uniqueidentifier      NULL,
	IncProductId         uniqueidentifier      NULL,
	IncProductValue      money      NULL,
	ValidateDateTime     smalldatetime      NULL,
	GroupQuantity        smallint      NULL,
	UsageLocalDateTime   datetime      NULL,
	InvalidOfflineValidateResult smallint      NULL,
	TicketStatus         smallint      NULL,
	BiometricType        smallint      NULL,
	BiometricScore       int      NULL,
	BioEnrollmentType    tinyint      NULL,
	Imported             bit      NULL,
	ForcedGate           bit      NULL,
	Invalidated          bit      NULL,
	SimulatedRedemption  bit      NULL,
	UsageMethodType      tinyint      NULL,
	BiometricGroup       bit      NOT NULL,
	BiometricGroupTicketId uniqueidentifier      NULL,
	FlashAtTurnstile     bit      NULL,
	PeopleOfDetermination bit      NULL,
	RotationsAllowed     smallint      NULL,
	ExtraEntry           bit      NULL,
	TicketUsageSequence  bigint      NULL,
	TicketUsageSeed      smallint      NULL,
	CONSTRAINT PK_TicketUsage PRIMARY KEY  ( TicketUsageId ) 
 );
GO

CREATE  INDEX IX_TicketUsage_AptWorkstationId ON SnApp.dbo.tbTicketUsage ( AptWorkstationId ASC );
GO

CREATE  INDEX IX_TicketUsage_MediaId ON SnApp.dbo.tbTicketUsage ( MediaId ASC );
GO

CREATE  INDEX IX_TicketUsage_UsageDateTime ON SnApp.dbo.tbTicketUsage ( UsageDateTime DESC );
GO

CREATE  INDEX IX_TicketUsage_PerformanceId ON SnApp.dbo.tbTicketUsage ( PerformanceId ASC );
GO

CREATE  INDEX IX_TicketUsage_AccessAreaId ON SnApp.dbo.tbTicketUsage ( AccessAreaAccountId ASC );
GO

CREATE  INDEX IX_TicketUsage_IncProductId ON SnApp.dbo.tbTicketUsage ( IncProductId ASC ) where IncProductId is not null;
GO

CREATE  INDEX IX_TicketUsage_UsageFiscalDate_V2 ON SnApp.dbo.tbTicketUsage ( UsageFiscalDate, UsageDateTime ) include (UsageType, ValidateResult, SimulatedRedemption, Invalidated);
GO

CREATE UNIQUE  INDEX UQ_TicketUsage_TicketUsageSequence ON SnApp.dbo.tbTicketUsage ( TicketUsageSequence ) WHERE TicketUsageSequence<>0 INCLUDE (TicketUsageSeed, UsageFiscalDate);
GO

CREATE  INDEX IX_TicketUsage_BiometricGroupTicketId ON SnApp.dbo.tbTicketUsage ( BiometricGroupTicketId  ) where BiometricGroupTicketId is not null;
GO

CREATE  INDEX IX_TicketUsage_TicketId_V3 ON SnApp.dbo.tbTicketUsage ( TicketId, UsageFiscalDate, UsageDateTime ) include (UsageType, ValidateResult, SimulatedRedemption, Invalidated);
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_AcAreaAccount FOREIGN KEY ( AccessAreaAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_AptWorkstation FOREIGN KEY ( AptWorkstationId ) REFERENCES SnApp.dbo.tbWorkstation( WorkstationId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_IncProduct FOREIGN KEY ( IncProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Performance FOREIGN KEY ( PerformanceId ) REFERENCES SnApp.dbo.tbPerformance( PerformanceId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Ticket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_MediaId FOREIGN KEY ( MediaId ) REFERENCES SnApp.dbo.tbMedia( MediaId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Ticket_BiometricGroupTicket FOREIGN KEY ( BiometricGroupTicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Log of all ticket scans/redemption both valid/invalid. Include also "included prooduct redemptions" (see tbTicketIncProd)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Server date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Relative to the redemption location' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageFiscalDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[69]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[70]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ValidateResult';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to media' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'MediaId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to access point' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'AptWorkstationId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to access area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'AccessAreaAccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'PerformanceId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to redeemed product (see tbTicketIncProd)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'IncProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Value of the redeemed product to be used for ledger pourposes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'IncProductValue';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If null, the validate was online, otherwise this is the date/time when the usage was processed by the back-end' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ValidateDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of entries for group tickets. If null we must use the GroupQuantity on the tbTicket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'GroupQuantity';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Client date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageLocalDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Original validate result for invalid offline usages' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'InvalidOfflineValidateResult';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[5] Status of the ticket when the scan happened' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[229]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Biometric check result value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricScore';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[440] - None, Enrollment, ReEnrollment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BioEnrollmentType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the usage has been imported: the scan/redemption was non handled by SnApp' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'Imported';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the access point configuration was overridden in the API call, requesting to use a specific gate (op.area)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ForcedGate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record should be ignored (ie: it was voided)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'Invalidated';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true indicates a simulated redemption and should not be taken into account for any in-park statistics' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'SimulatedRedemption';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[439] - Identifies what has been used to trigger the usage (Media, Ticket, Account, Document...)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageMethodType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Usage authorized using a biometric template taken from a different ticket within the biometric group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricGroup';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the ticket used to authorize the biometric template' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricGroupTicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Flash at turnstile has been triggered' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'FlashAtTurnstile';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Status of the flag "People of determination" on the rlated product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'PeopleOfDetermination';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of rotations allowed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'RotationsAllowed';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true extra entries can be performed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ExtraEntry';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sequential unique (for this table) number starting from 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageSequence';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Information used along with TicketSequence to create encrypted barcodes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageSeed';
GO
]]></string>
		</script>
		<script name="tbTicketUsageExternalRedeem" id="Editor-fe1" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTicketUsageExternalRedeem ( 
	TicketUsageId        uniqueidentifier NOT NULL    ,
	PluginId             AS  ,
	DocData              nvarchar(max)     ,
	CONSTRAINT PK_tbTicketUsageExternalRedeem PRIMARY KEY  ( TicketUsageId ) 
 );
GO

CREATE  INDEX IX_TicketUsageExternalRedeem_PluginId ON SnApp.dbo.tbTicketUsageExternalRedeem ( PluginId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Storing usages redeemed with an external validator' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsageExternalRedeem';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to tbTicketUsage ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsageExternalRedeem', @level2type=N'COLUMN',@level2name=N'TicketUsageId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to redeeemer plugin' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsageExternalRedeem', @level2type=N'COLUMN',@level2name=N'PluginId';
GO

ALTER TABLE SnApp.dbo.tbTicketUsageExternalRedeem ADD CONSTRAINT FK_tbTicketUsageExternalRedeem_TicketUsage FOREIGN KEY ( TicketUsageId ) REFERENCES SnApp.dbo.tbTicketUsage( TicketUsageId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbTicketUsageExternalRedeem ADD CONSTRAINT FK_tbTicketUsageExternalRedeem_Plugin FOREIGN KEY ( PluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbTicketUsage_001" id="Editor-10c" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTicketUsage ( 
	TicketUsageId        uniqueidentifier      NOT NULL,
	UsageDateTime        datetime      NOT NULL,
	UsageFiscalDate      date      NOT NULL,
	UsageType            smallint      NOT NULL,
	ValidateResult       smallint      NOT NULL,
	MediaId              uniqueidentifier      NULL,
	AptWorkstationId     uniqueidentifier      NOT NULL,
	TicketId             uniqueidentifier      NULL,
	AccessAreaAccountId  uniqueidentifier      NULL,
	PerformanceId        uniqueidentifier      NULL,
	IncProductId         uniqueidentifier      NULL,
	IncProductValue      money      NULL,
	ValidateDateTime     smalldatetime      NULL,
	GroupQuantity        smallint      NULL,
	UsageLocalDateTime   datetime      NULL,
	InvalidOfflineValidateResult smallint      NULL,
	TicketStatus         smallint      NULL,
	BiometricType        smallint      NULL,
	BiometricScore       int      NULL,
	BioEnrollmentType    tinyint      NULL,
	Imported             bit      NULL,
	ForcedGate           bit      NULL,
	Invalidated          bit      NULL,
	SimulatedRedemption  bit      NULL,
	UsageMethodType      tinyint      NULL,
	BiometricGroup       bit      NOT NULL,
	BiometricGroupTicketId uniqueidentifier      NULL,
	FlashAtTurnstile     bit      NULL,
	PeopleOfDetermination bit      NULL,
	RotationsAllowed     smallint      NULL,
	ExtraEntry           bit      NULL,
	TicketUsageSequence  bigint      NULL,
	TicketUsageSeed      smallint      NULL,
	CONSTRAINT PK_TicketUsage PRIMARY KEY  ( TicketUsageId ) 
 );
GO

CREATE  INDEX IX_TicketUsage_AptWorkstationId ON SnApp.dbo.tbTicketUsage ( AptWorkstationId ASC );
GO

CREATE  INDEX IX_TicketUsage_MediaId ON SnApp.dbo.tbTicketUsage ( MediaId ASC );
GO

CREATE  INDEX IX_TicketUsage_UsageDateTime ON SnApp.dbo.tbTicketUsage ( UsageDateTime DESC );
GO

CREATE  INDEX IX_TicketUsage_PerformanceId ON SnApp.dbo.tbTicketUsage ( PerformanceId ASC );
GO

CREATE  INDEX IX_TicketUsage_AccessAreaId ON SnApp.dbo.tbTicketUsage ( AccessAreaAccountId ASC );
GO

CREATE  INDEX IX_TicketUsage_IncProductId ON SnApp.dbo.tbTicketUsage ( IncProductId ASC ) where IncProductId is not null;
GO

CREATE  INDEX IX_TicketUsage_TicketId_V2 ON SnApp.dbo.tbTicketUsage ( TicketId, UsageFiscalDate ) include (UsageType, ValidateResult, SimulatedRedemption, Invalidated);
GO

CREATE  INDEX IX_TicketUsage_UsageFiscalDate_V2 ON SnApp.dbo.tbTicketUsage ( UsageFiscalDate, UsageDateTime ) include (UsageType, ValidateResult, SimulatedRedemption, Invalidated);
GO

CREATE UNIQUE  INDEX UQ_TicketUsage_TicketUsageSequence ON SnApp.dbo.tbTicketUsage ( TicketUsageSequence ) WHERE TicketUsageSequence<>0 INCLUDE (TicketUsageSeed, UsageFiscalDate);
GO

CREATE  INDEX IX_TicketUsage_BiometricGroupTicketId ON SnApp.dbo.tbTicketUsage ( BiometricGroupTicketId  ) where BiometricGroupTicketId is not null;
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_AcAreaAccount FOREIGN KEY ( AccessAreaAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_AptWorkstation FOREIGN KEY ( AptWorkstationId ) REFERENCES SnApp.dbo.tbWorkstation( WorkstationId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_IncProduct FOREIGN KEY ( IncProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Performance FOREIGN KEY ( PerformanceId ) REFERENCES SnApp.dbo.tbPerformance( PerformanceId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Ticket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_MediaId FOREIGN KEY ( MediaId ) REFERENCES SnApp.dbo.tbMedia( MediaId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Ticket_BiometricGroupTicketId FOREIGN KEY ( BiometricGroupTicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Log of all ticket scans/redemption both valid/invalid. Include also "included prooduct redemptions" (see tbTicketIncProd)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Server date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Relative to the redemption location' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageFiscalDate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[69]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[70]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ValidateResult';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to media' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'MediaId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to access point' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'AptWorkstationId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to access area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'AccessAreaAccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'PerformanceId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to redeemed product (see tbTicketIncProd)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'IncProductId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Value of the redeemed product to be used for ledger pourposes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'IncProductValue';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If null, the validate was online, otherwise this is the date/time when the usage was processed by the back-end' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ValidateDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of entries for group tickets. If null we must use the GroupQuantity on the tbTicket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'GroupQuantity';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Client date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageLocalDateTime';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Original validate result for invalid offline usages' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'InvalidOfflineValidateResult';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[5] Status of the ticket when the scan happened' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketStatus';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[229]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Biometric check result value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricScore';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[440] - None, Enrollment, ReEnrollment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BioEnrollmentType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the usage has been imported: the scan/redemption was non handled by SnApp' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'Imported';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the access point configuration was overridden in the API call, requesting to use a specific gate (op.area)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ForcedGate';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record should be ignored (ie: it was voided)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'Invalidated';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true indicates a simulated redemption and should not be taken into account for any in-park statistics' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'SimulatedRedemption';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[439] - Identifies what has been used to trigger the usage (Media, Ticket, Account, Document...)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageMethodType';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Usage authorized using a biometric template from the biometric group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricGroup';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to ticket matching the biometric comparison' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricGroupTicketId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Flash at turnstile has been triggered' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'FlashAtTurnstile';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Status of the flag "People of determination" on the rlated product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'PeopleOfDetermination';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of rotations allowed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'RotationsAllowed';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true extra entries can be performed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ExtraEntry';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sequential unique (for this table) number starting from 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageSequence';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Information used along with TicketSequence to create encrypted barcodes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageSeed';
GO]]></string>
		</script>
		<script name="tbTicketUsage_002" id="Editor-b76" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbTicketUsage ( 
	TicketUsageId        uniqueidentifier      NOT NULL,
	UsageDateTime        datetime      NOT NULL,
	UsageFiscalDate      date      NOT NULL,
	UsageType            smallint      NOT NULL,
	ValidateResult       smallint      NOT NULL,
	MediaId              uniqueidentifier      NULL,
	AptWorkstationId     uniqueidentifier      NOT NULL,
	TicketId             uniqueidentifier      NULL,
	AccessAreaAccountId  uniqueidentifier      NULL,
	PerformanceId        uniqueidentifier      NULL,
	IncProductId         uniqueidentifier      NULL,
	IncProductValue      money      NULL,
	ValidateDateTime     smalldatetime      NULL,
	GroupQuantity        smallint      NULL,
	UsageLocalDateTime   datetime      NULL,
	InvalidOfflineValidateResult smallint      NULL,
	TicketStatus         smallint      NULL,
	BiometricType        smallint      NULL,
	BiometricScore       int      NULL,
	BioEnrollmentType    tinyint      NULL,
	Imported             bit      NULL,
	ForcedGate           bit      NULL,
	Invalidated          bit      NULL,
	SimulatedRedemption  bit      NULL,
	UsageMethodType      tinyint      NULL,
	BiometricGroup       bit      NOT NULL,
	BiometricGroupTicketId uniqueidentifier      NULL,
	FlashAtTurnstile     bit      NULL,
	PeopleOfDetermination bit      NULL,
	RotationsAllowed     smallint      NULL,
	ExtraEntry           bit      NULL,
	TicketUsageSequence  bigint      NULL,
	TicketUsageSeed      smallint      NULL,
	VoidTicketUsageId    uniqueidentifier      NULL,
	CONSTRAINT PK_TicketUsage PRIMARY KEY  ( TicketUsageId ) 
 );
GO

CREATE  INDEX IX_TicketUsage_AptWorkstationId ON SnApp.dbo.tbTicketUsage ( AptWorkstationId ASC );
GO

CREATE  INDEX IX_TicketUsage_MediaId ON SnApp.dbo.tbTicketUsage ( MediaId ASC );
GO

CREATE  INDEX IX_TicketUsage_UsageDateTime ON SnApp.dbo.tbTicketUsage ( UsageDateTime DESC );
GO

CREATE  INDEX IX_TicketUsage_PerformanceId ON SnApp.dbo.tbTicketUsage ( PerformanceId ASC );
GO

CREATE  INDEX IX_TicketUsage_AccessAreaId ON SnApp.dbo.tbTicketUsage ( AccessAreaAccountId ASC );
GO

CREATE  INDEX IX_TicketUsage_IncProductId ON SnApp.dbo.tbTicketUsage ( IncProductId ASC ) where IncProductId is not null;
GO

CREATE  INDEX IX_TicketUsage_UsageFiscalDate_V2 ON SnApp.dbo.tbTicketUsage ( UsageFiscalDate, UsageDateTime ) include (UsageType, ValidateResult, SimulatedRedemption, Invalidated);
GO

CREATE UNIQUE  INDEX UQ_TicketUsage_TicketUsageSequence ON SnApp.dbo.tbTicketUsage ( TicketUsageSequence ) WHERE TicketUsageSequence<>0 INCLUDE (TicketUsageSeed, UsageFiscalDate);
GO

CREATE  INDEX IX_TicketUsage_BiometricGroupTicketId ON SnApp.dbo.tbTicketUsage ( BiometricGroupTicketId  ) where BiometricGroupTicketId is not null;
GO

CREATE  INDEX IX_TicketUsage_TicketId_V3 ON SnApp.dbo.tbTicketUsage ( TicketId, UsageFiscalDate, UsageDateTime ) include (UsageType, ValidateResult, SimulatedRedemption, Invalidated);
GO

CREATE UNIQUE  INDEX UQ_TicketUsage_VoidTicketUsageId ON SnApp.dbo.tbTicketUsage ( VoidTicketUsageId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_AcAreaAccount FOREIGN KEY ( AccessAreaAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_AptWorkstation FOREIGN KEY ( AptWorkstationId ) REFERENCES SnApp.dbo.tbWorkstation( WorkstationId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_IncProduct FOREIGN KEY ( IncProductId ) REFERENCES SnApp.dbo.tbProduct( ProductId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Performance FOREIGN KEY ( PerformanceId ) REFERENCES SnApp.dbo.tbPerformance( PerformanceId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Ticket FOREIGN KEY ( TicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_MediaId FOREIGN KEY ( MediaId ) REFERENCES SnApp.dbo.tbMedia( MediaId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_Ticket_BiometricGroupTicket FOREIGN KEY ( BiometricGroupTicketId ) REFERENCES SnApp.dbo.tbTicket( TicketId );
GO

ALTER TABLE SnApp.dbo.tbTicketUsage ADD CONSTRAINT FK_TicketUsage_TicketUsageId_Void FOREIGN KEY ( VoidTicketUsageId ) REFERENCES SnApp.dbo.tbTicketUsage( TicketUsageId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Log of all ticket scans/redemption both valid/invalid. Include also "included prooduct redemptions" (see tbTicketIncProd)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage';;
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Internal ID' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Server date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageDateTime';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Relative to the redemption location' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageFiscalDate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[69]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[70]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ValidateResult';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to media' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'MediaId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to access point' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'AptWorkstationId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to product' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to access area' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'AccessAreaAccountId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to performance' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'PerformanceId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to redeemed product (see tbTicketIncProd)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'IncProductId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Value of the redeemed product to be used for ledger pourposes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'IncProductValue';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If null, the validate was online, otherwise this is the date/time when the usage was processed by the back-end' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ValidateDateTime';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of entries for group tickets. If null we must use the GroupQuantity on the tbTicket' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'GroupQuantity';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Client date/time' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageLocalDateTime';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Original validate result for invalid offline usages' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'InvalidOfflineValidateResult';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[5] Status of the ticket when the scan happened' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[229]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Biometric check result value' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricScore';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[440] - None, Enrollment, ReEnrollment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BioEnrollmentType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the usage has been imported: the scan/redemption was non handled by SnApp' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'Imported';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Indicates if the access point configuration was overridden in the API call, requesting to use a specific gate (op.area)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ForcedGate';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Record should be ignored (ie: it was voided)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'Invalidated';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true indicates a simulated redemption and should not be taken into account for any in-park statistics' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'SimulatedRedemption';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[439] - Identifies what has been used to trigger the usage (Media, Ticket, Account, Document...)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'UsageMethodType';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Usage authorized using a biometric template taken from a different ticket within the biometric group' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricGroup';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the ticket used to authorize the biometric template' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'BiometricGroupTicketId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Flash at turnstile has been triggered' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'FlashAtTurnstile';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Status of the flag "People of determination" on the rlated product type' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'PeopleOfDetermination';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Number of rotations allowed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'RotationsAllowed';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'If true extra entries can be performed' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'ExtraEntry';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Sequential unique (for this table) number starting from 1' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageSequence';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Information used along with TicketSequence to create encrypted barcodes' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'TicketUsageSeed';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Reference to the voided ticket usage (if any)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTicketUsage', @level2type=N'COLUMN',@level2name=N'VoidTicketUsageId';
GO
]]></string>
		</script>
		<script name="tbTransaction2TicketUsage" id="Editor_10b5" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTransaction2TicketUsage ( 
	TransactionId        uniqueidentifier NOT NULL    ,
	TicketUsageId        uniqueidentifier NOT NULL    ,
	RefTicketUsageId     uniqueidentifier     ,
	CONSTRAINT PK_Transaction2TicketUsage PRIMARY KEY  ( TransactionId, TicketUsageId ) 
 );
GO

CREATE  INDEX IX_tbTransaction2TicketUsage_RefTicketUsageId ON SnApp.dbo.tbTransaction2TicketUsage ( RefTicketUsageId ASC ) where RefTicketUsageId is not null;
GO

CREATE  INDEX IX_Transaction2TicketUsage_TicketUsageId ON SnApp.dbo.tbTransaction2TicketUsage ( TicketUsageId );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Enlist transactions which match docket device configuration' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTransaction2TicketUsage';;
GO

ALTER TABLE SnApp.dbo.tbTransaction2TicketUsage ADD CONSTRAINT FK_Transaction2TicketUsage_Transaction FOREIGN KEY ( TransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbTransaction2TicketUsage ADD CONSTRAINT FK_Transaction2TicketUsage_TicketUsage FOREIGN KEY ( TicketUsageId ) REFERENCES SnApp.dbo.tbTicketUsage( TicketUsageId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbTransaction2TicketUsage ADD CONSTRAINT Relationship1255 FOREIGN KEY ( RefTicketUsageId ) REFERENCES SnApp.dbo.tbTicketUsage( TicketUsageId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO
]]></string>
		</script>
		<script name="tbTransactionAccountMerge" id="Editor_72e" language="SQL" >
			<string><![CDATA[CREATE TABLE SnApp.dbo.tbTransactionAccountMerge ( 
	TransactionId        uniqueidentifier NOT NULL    ,
	FinalAccountId       uniqueidentifier NOT NULL    ,
	SourceAccountId      uniqueidentifier NOT NULL    ,
	CONSTRAINT PK_TransactionAccountMerge PRIMARY KEY  ( TransactionId, FinalAccountId, SourceAccountId ) 
 );
GO

CREATE  INDEX IX_TransactionAccountMerge_FinalAccountId ON SnApp.dbo.tbTransactionAccountMerge ( FinalAccountId ASC );
GO

CREATE  INDEX IX_TransactionAccountMerge_SourceAccountId ON SnApp.dbo.tbTransactionAccountMerge ( SourceAccountId ASC );
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'When an account merge is performed a transaction merge is created.\nThis table is the link between the transaction, the final account and the source account(s)' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTransactionAccountMerge';;
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'The transaction generated by the account merge' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTransactionAccountMerge', @level2type=N'COLUMN',@level2name=N'TransactionId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'This is the result account of the merge function. The source accont have been merged into this one' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTransactionAccountMerge', @level2type=N'COLUMN',@level2name=N'FinalAccountId';
GO

exec [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'A source account merged into the final one' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbTransactionAccountMerge', @level2type=N'COLUMN',@level2name=N'SourceAccountId';
GO

ALTER TABLE SnApp.dbo.tbTransactionAccountMerge ADD CONSTRAINT FK_TransactionAccountMerge_Transaction FOREIGN KEY ( TransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbTransactionAccountMerge ADD CONSTRAINT FK_TransactionAccountMerge_FinalAccount FOREIGN KEY ( FinalAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO

ALTER TABLE SnApp.dbo.tbTransactionAccountMerge ADD CONSTRAINT FK_TransactionAccountMerge_SourceAccount FOREIGN KEY ( SourceAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId ) ON DELETE NO ACTION ON UPDATE NO ACTION;
GO]]></string>
		</script>
		<script name="tbWebAuth" id="Editor-1d30" language="SQL" >
			<string><![CDATA[CREATE  TABLE SnApp.dbo.tbWebAuth ( 
	WebAuthId            uniqueidentifier      NOT NULL,
	WebAuthRef           varchar(50)      NOT NULL,
	WebAuthStatus        tinyint      NOT NULL,
	WebAuthAmount        money      NOT NULL,
	CreateDateTime       smalldatetime      NOT NULL,
	CloseDateTime        smalldatetime      NULL,
	SaleId               uniqueidentifier      NULL,
	WorkstationId        uniqueidentifier      NOT NULL,
	UserAccountId        uniqueidentifier      NULL,
	PluginId             uniqueidentifier      NOT NULL,
	PaymentMethodId      uniqueidentifier      NOT NULL,
	CreateOrderConfirmation bit      NOT NULL,
	SendOrderConfirmation bit      NOT NULL,
	IncludeTickets       bit      NOT NULL,
	PreparePahDownload   bit      NOT NULL,
	DocTemplateId        uniqueidentifier      NULL,
	AuthorizationCode    varchar(50)      NULL,
	PaymentId            uniqueidentifier      NULL,
	TransactionId        uniqueidentifier      NULL,
	CONSTRAINT UQ_WebAuth_WebAuthRef UNIQUE ( WebAuthRef ASC ) ,
	CONSTRAINT PK_WebAuth PRIMARY KEY  ( WebAuthId ) 
 );
GO

CREATE  INDEX IX_WebAuth_CreateDateTime ON SnApp.dbo.tbWebAuth ( CreateDateTime ASC );
GO

CREATE  INDEX IX_WebAuth_SaleId ON SnApp.dbo.tbWebAuth ( SaleId ASC );
GO

CREATE  INDEX IX_WebAuth_WorkstationId ON SnApp.dbo.tbWebAuth ( WorkstationId ASC );
GO

CREATE  INDEX IX_WebAuth_PluginId ON SnApp.dbo.tbWebAuth ( PluginId ASC );
GO

CREATE  INDEX IX_WebAuth_AuthorizationCode ON SnApp.dbo.tbWebAuth ( AuthorizationCode ASC );
GO

CREATE  INDEX IX_WebAuth_PaymentMethodId ON SnApp.dbo.tbWebAuth ( PaymentMethodId ASC );
GO

CREATE  INDEX IX_WebAuth_DocTemplateId ON SnApp.dbo.tbWebAuth ( DocTemplateId ASC ) where DocTemplateId is not null;
GO

CREATE  INDEX IX_WebAuth_UserAccountId ON SnApp.dbo.tbWebAuth ( UserAccountId ASC ) where UserAccountId is not null;
GO

CREATE  INDEX IX_WebAuth_paymentId ON SnApp.dbo.tbWebAuth ( PaymentId ) where PaymentId is not null;
GO

CREATE  INDEX IX_WebAuth_TransactionId ON SnApp.dbo.tbWebAuth ( TransactionId ) where TransactionId is not null;
GO

CREATE  INDEX IX_WebAuth_WebAuthStatus ON SnApp.dbo.tbWebAuth ( WebAuthStatus, CreateDateTime );
GO

ALTER TABLE SnApp.dbo.tbWebAuth ADD CONSTRAINT FK_WebAuth_Account FOREIGN KEY ( UserAccountId ) REFERENCES SnApp.dbo.tbAccount( AccountId );
GO

ALTER TABLE SnApp.dbo.tbWebAuth ADD CONSTRAINT FK_WebAuth_Workstation FOREIGN KEY ( WorkstationId ) REFERENCES SnApp.dbo.tbWorkstation( WorkstationId );
GO

ALTER TABLE SnApp.dbo.tbWebAuth ADD CONSTRAINT FK_WebAuth_Sale FOREIGN KEY ( SaleId ) REFERENCES SnApp.dbo.tbSale( SaleId );
GO

ALTER TABLE SnApp.dbo.tbWebAuth ADD CONSTRAINT FK_WebAuth_Plugin FOREIGN KEY ( PluginId ) REFERENCES SnApp.dbo.tbPlugin( PluginId );
GO

ALTER TABLE SnApp.dbo.tbWebAuth ADD CONSTRAINT FK_WebAuth_PaymentMethod FOREIGN KEY ( PaymentMethodId ) REFERENCES SnApp.dbo.tbPlugin( PluginId );
GO

ALTER TABLE SnApp.dbo.tbWebAuth ADD CONSTRAINT FK_WebAuth_DocTemplate FOREIGN KEY ( DocTemplateId ) REFERENCES SnApp.dbo.tbDocTemplate( DocTemplateId );
GO

ALTER TABLE SnApp.dbo.tbWebAuth ADD CONSTRAINT FK_WebAuth_Payment FOREIGN KEY ( PaymentId ) REFERENCES SnApp.dbo.tbPayment( PaymentId ) ON DELETE CASCADE;
GO

ALTER TABLE SnApp.dbo.tbWebAuth ADD CONSTRAINT FK_WebAuth_Transaction FOREIGN KEY ( TransactionId ) REFERENCES SnApp.dbo.tbTransaction( TransactionId );
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Identifier sent to the bank' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbWebAuth', @level2type=N'COLUMN',@level2name=N'WebAuthRef';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'LK[54]' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbWebAuth', @level2type=N'COLUMN',@level2name=N'WebAuthStatus';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the payment' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbWebAuth', @level2type=N'COLUMN',@level2name=N'PaymentId';
GO

execute [SnApp].sys.sp_addextendedproperty  @name=N'MS_Description', @value=N'Link to the transaction' , @level0type=N'SCHEMA',@level0name=N'dbo', @level1type=N'TABLE',@level1name=N'tbWebAuth', @level2type=N'COLUMN',@level2name=N'TransactionId';
GO
]]></string>
		</script>
	</layout>
</project>