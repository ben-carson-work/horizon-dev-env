<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<DOEnt_DocTemplate>
	<Header>
		<EntityType>37</EntityType>
		<EntityId>0FEDBCD8-5BD7-CE74-06CC-015AB7D0BC79</EntityId>
		<LastUpdate>2023-10-20T11:32:00.000+0200</LastUpdate>
	</Header>
	<DocTemplate>
		<IconName>rpt-dataexport.png</IconName>
		<EntityType>37</EntityType>
		<DocTemplateId>0FEDBCD8-5BD7-CE74-06CC-015AB7D0BC79</DocTemplateId>
		<DocTemplateName>@Stats.UserActivityDetail</DocTemplateName>
		<DocTemplateCode>DOC85</DocTemplateCode>
		<CategoryId>06A43409-24CA-32A6-0194-015AB7D0B14E</CategoryId>
		<DocEnabled>true</DocEnabled>
		<ExecRequireLogin>true</ExecRequireLogin>
		<DocTemplateType>5</DocTemplateType>
		<DocEditorType>6</DocEditorType>
		<SystemCode>UsrActivityDet</SystemCode>
		<DocContexts/>
		<SaleForApproval>false</SaleForApproval>
		<SaleOpen>false</SaleOpen>
		<SalePaid>false</SalePaid>
		<SaleCompleted>false</SaleCompleted>
		<IndividualPAH>false</IndividualPAH>
		<DataExportOutputFormat/>
		<CsvFieldSeparator/>
		<CsvQuoteCharacter/>
		<CsvIncludeHeaderLine/>
		<LogCount>1</LogCount>
		<DataSourceSelection>false</DataSourceSelection>
		<DataSourceId/>
		<MaxDateRangeDays/>
		<MediaEncoderPluginId/>
		<ProductDocumentTagIDs/>
		<AttachDocTemplateIDs/>
		<MediaRfidOptionType/>
		<ParamList>
			<Param>
				<DocParamId>936E129B-016D-F1F8-06E1-018B1DC4C386</DocParamId>
				<DocTemplateId>0FEDBCD8-5BD7-CE74-06CC-015AB7D0BC79</DocTemplateId>
				<DocParamType>4</DocParamType>
				<DocParamName>DateFrom</DocParamName>
				<DocParamCaption>@Common.FromDate</DocParamCaption>
				<DocParamDefault>[@CurrentDate]</DocParamDefault>
				<Mandatory>false</Mandatory>
			</Param>
			<Param>
				<DocParamId>D4F7CE3C-DF58-BB0E-06E2-018B1DC4C386</DocParamId>
				<DocTemplateId>0FEDBCD8-5BD7-CE74-06CC-015AB7D0BC79</DocTemplateId>
				<DocParamType>4</DocParamType>
				<DocParamName>DateTo</DocParamName>
				<DocParamCaption>@Common.ToDate</DocParamCaption>
				<DocParamDefault>[@CurrentDate]</DocParamDefault>
				<Mandatory>false</Mandatory>
			</Param>
			<Param>
				<DocParamId>9AAE5EE7-5B6E-ABAC-06E3-018B1DC4C387</DocParamId>
				<DocTemplateId>0FEDBCD8-5BD7-CE74-06CC-015AB7D0BC79</DocTemplateId>
				<DocParamType>1001</DocParamType>
				<DocParamName>LocationId</DocParamName>
				<DocParamCaption>@Account.Location</DocParamCaption>
				<DocParamDefault>[@CurrentLocationId]</DocParamDefault>
				<Mandatory>false</Mandatory>
			</Param>
			<Param>
				<DocParamId>B75CF35F-1403-5091-06E4-018B1DC4C387</DocParamId>
				<DocTemplateId>0FEDBCD8-5BD7-CE74-06CC-015AB7D0BC79</DocTemplateId>
				<DocParamType>1002</DocParamType>
				<DocParamName>OpAreaId</DocParamName>
				<DocParamCaption>@Account.OpArea</DocParamCaption>
				<DocParamDefault>[@CurrentOpAreaId]</DocParamDefault>
				<Mandatory>false</Mandatory>
			</Param>
			<Param>
				<DocParamId>FD275CC4-53C6-A92F-06E5-018B1DC4C388</DocParamId>
				<DocTemplateId>0FEDBCD8-5BD7-CE74-06CC-015AB7D0BC79</DocTemplateId>
				<DocParamType>1004</DocParamType>
				<DocParamName>UserId</DocParamName>
				<DocParamCaption>@Common.User</DocParamCaption>
				<DocParamDefault>[@CurrentUserId]</DocParamDefault>
				<Mandatory>false</Mandatory>
			</Param>
			<Param>
				<DocParamId>D94B5009-DFF4-E81B-06E6-018B1DC4C388</DocParamId>
				<DocTemplateId>0FEDBCD8-5BD7-CE74-06CC-015AB7D0BC79</DocTemplateId>
				<DocParamType>1003</DocParamType>
				<DocParamName>WorkstationId</DocParamName>
				<DocParamCaption>@Common.Workstation</DocParamCaption>
				<DocParamDefault>[@CurrentWorkstationId]</DocParamDefault>
				<Mandatory>false</Mandatory>
			</Param>
		</ParamList>
		<DataSourceList>
			<DataSource>
				<Name>Default</Name>
				<Code>HHPY64SKYAJBVPA</Code>
				<SQL unescaped="true"><![CDATA[select 
  dbo.fnEntityDesc(20,T.TransactionId) as [TDSSN],
  T.TransactionDateTime as [Transaction Date Time],
  T.TransactionType as [Transaction Type Code],
  dbo.fnLookupItemDesc(3,T.TransactionType) as [Transaction Type Label], 
  T.PaidAmount as [Total Paid Amount],
  Sum(TI.QtyPaid) as [Quantity],
  CAST(T.DurationSelection as float)/10 as [Selection Time (sec.)],
  CAST(T.DurationPayment as float)/10 as [Payment Time (sec.)],
  CAST(T.DurationPrint as float)/10 as [Printing Time (sec.)],
  Log.UserName as [Account Username],
  UsrEmail.UserName as [Account Username (email)],
  A.DisplayName as [User Account Name],
  W.WorkstationCode as [Workstation Code],
  W.WorkstationName as [Workstation Name],
  OPA.AccountCode as [Operating Area Code],
  OPA.DisplayName as [Operating Area Name],
  Loc.AccountCode as [Location Code],
  Loc.DisplayName as [Location Name] 
from
  tbTransaction T left join
  tbTransactionItem TI on TI.TransactionId=T.TransactionId left join
  tbAccount A on A.AccountId=T.UserAccountId left join
  tbWorkstation W on T.WorkstationId=W.WorkstationId left join
  tbAccount OPA on OPA.AccountId=W.OpAreaAccountId left join
  tbAccount Loc on Loc.AccountId=W.LocationAccountId left join
  tbLoginAlias Log on (Log.AccountId=T.UserAccountId and Log.PrimaryAlias=1) left join
  tbLoginAlias UsrEmail on (UsrEmail.AccountId=A.AccountId and UsrEmail.LoginAliasType=1)
where
  T.Paid = 1 and
  T.TransactionFiscalDate>=:@DateFrom and
  T.TransactionFiscalDate<=:@DateTo and
  (:@WorkstationId is null or W.WorkstationId=:@WorkstationId) and
  (:@OpAreaId is null or W.OpAreaAccountId=:@OpAreaId) and
  (:@LocationId is null or W.LocationAccountId=:@LocationId) and
  (:@UserId is null or T.UserAccountId=:@UserId)
group by 
  T.TransactionId,
  T.TransactionDateTime,
  T.TransactionType,
  T.PaidAmount,
  T.DurationSelection,
  T.DurationPrint,
  T.DurationPayment,
  Log.UserName,
  A.DisplayName,
  UsrEmail.UserName,
  W.WorkstationCode,
  W.WorkstationName,
  OPA.AccountCode,
  OPA.DisplayName,
  Loc.AccountCode,
  Loc.DisplayName
Order by
  T.TransactionDateTime]]></SQL>
			</DataSource>
		</DataSourceList>
		<RightList>
			<Right>
				<IconName>station.png</IconName>
				<UsrEntityType>3</UsrEntityType>
				<UsrEntityId>ACD59ABD-B0FE-DF2C-0108-015AB7D0B016</UsrEntityId>
				<UsrEntityCode>BKOFFICE</UsrEntityCode>
				<UsrEntityName>Back Office</UsrEntityName>
				<RightLevel>5</RightLevel>
			</Right>
			<Right>
				<IconName>account_prs.png</IconName>
				<UsrEntityType>15</UsrEntityType>
				<UsrEntityId>E1FC2E69-410D-6AB4-003C-0179C2BB4E51</UsrEntityId>
				<UsrEntityCode>SYSUSR1000</UsrEntityCode>
				<UsrEntityName>System</UsrEntityName>
				<RightLevel>5</RightLevel>
			</Right>
		</RightList>
		<RichDescList>
			<RichDescItem>
				<IconName>flag_USA.png</IconName>
				<LangISO>en</LangISO>
				<Description>&lt;h1&gt;User Activity Detail Report&lt;/h1&gt;&lt;h2&gt;Abstract&lt;/h2&gt;“User Activity Detail” generates a report of the detailed log of selected User Activity in a selected Location and Operating Area in a selected period at your choice.&lt;h2&gt;Generating the report&lt;/h2&gt; Parameter Input&lt;br&gt;While generating the report, input parameters menu presents an intuitive interface.&lt;br&gt;Built-in wizards will help you quickly and easily create at your choice profile for your site by&lt;br&gt;&lt;br&gt;&lt;ul&gt;&lt;li&gt;[&lt;em&gt;From date – To Date&lt;/em&gt;] – Period to be analysed, easy-to-select.&lt;ul&gt;&lt;li&gt;Note: The dates if not specified are to be considered “Fiscal Date”&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location&lt;/em&gt;] – Site Location Name, easy-to-select. Selecting&amp;nbsp;&lt;em&gt;-empty-&lt;/em&gt;,&amp;nbsp;default is all the locations&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Operating Area&lt;/em&gt;] – Site Operating Area name, easy-to-select. Selecting&amp;nbsp;&lt;em&gt;blanck&amp;nbsp;&lt;/em&gt;or "&lt;em&gt;-empty-"&lt;/em&gt;,&amp;nbsp;default is all the Operating Areas&lt;/li&gt;&lt;li&gt;[&lt;em&gt;User&lt;/em&gt;] – – Account User Name.&lt;ul&gt;&lt;li&gt;Input Format as per drop down menu.Selecting&amp;nbsp;&lt;em&gt;blanck&amp;nbsp;&lt;/em&gt;or "&lt;em&gt;-empty-"&lt;/em&gt;,&amp;nbsp;default is all the existing/authorized Users&lt;/li&gt;&lt;li&gt;Display format: “Last Name, First Name”.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Workstation&lt;/em&gt;] – Workstation Name, easy-to-select. Selecting&amp;nbsp;&lt;em&gt;blanck&amp;nbsp;&lt;/em&gt;or "&lt;em&gt;-empty-"&lt;/em&gt;,&amp;nbsp;default is all the workstations&lt;/li&gt;&lt;/ul&gt; Output File Extension&lt;br&gt;Built-in wizards will help you easily and quickly generate at your choice reports in XLSX or CSV or PDF formats. Format selection is required before running the report.​​​​​​​&lt;ul&gt;&lt;li&gt;XLSX&lt;ul&gt;&lt;li&gt;Report generates an EXCEL (latest version) file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;CSV&lt;ul&gt;&lt;li&gt;its generation requires:&lt;ul&gt;&lt;li&gt;&lt;em&gt;Field delimiter&lt;/em&gt;: Separator to be put between fields. Usually a "comma". When null, default is taken from user configuration.&lt;/li&gt;&lt;li&gt;&lt;em&gt;Quote character&lt;/em&gt;: Character used to surround fields&lt;/li&gt;&lt;li&gt;&lt;em&gt;Include header line&lt;/em&gt;&amp;nbsp;to tick the box. Default is YES.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;PDF&lt;ul&gt;&lt;li&gt;Report generates a PDF (latest version) file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Header&lt;/h2&gt; Report parameters::&lt;ul&gt;&lt;li&gt;[&lt;em&gt;Execution date/time&lt;/em&gt;] -Report Execution Time. Date and Hours format as per configuration [Location, Operating Area, Workstation]&lt;/li&gt;&lt;li&gt;[&lt;em&gt;From date – To Date&lt;/em&gt;] – Selected Period&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location&lt;/em&gt;] – Site Location Code and Name. Display format: "[SITE LOCATION CODE] Site Location Name".Selecting blanck or "- empty" all the &amp;nbsp;Locations' exposure are analysed and listed&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Operating Area&lt;/em&gt;] –&amp;nbsp;Site Operating Area Code and Name. Display format: "[SITE OPERATING AREA CODE] Site Operating Area Name". Selecting blanck or "- empty" all the &amp;nbsp;Operating Area' exposure are analysed and listed&lt;/li&gt;&lt;li&gt;[&lt;em&gt;User&lt;/em&gt;] – – Account User Name. Selecting blanck or "- empty" all the users. Display format: "Last Name", "First Name".&lt;ul&gt;&lt;li&gt;Display format: “Last Name, First Name”.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Workstation&lt;/em&gt;] – Site Workstation Code and Name. Display format: "[SITE WORKSTATION CODE] Site Workstation Name". Selecting blanck or "- empty" all the Workstation' exposure are analysed and listed&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Contents (by Columns)&lt;/h2&gt; The program produces easy-to-read reports that include text information.&lt;ul&gt;&lt;li&gt;[&lt;em&gt;TDSSN&lt;/em&gt;] – Unique Transaction Serial Number, format “T:licence_number.workstation_number.YYDDMM.dailycounter”&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Transaction Date Time&lt;/em&gt;] – Transaction execution Date and Time. Display format as per configuration [Location, Operating Area, Workstation]&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Transaction Type Code&lt;/em&gt;] - Transaction Type Code # 1 .. 100 (see LOOKUP TABLES &amp;gt;&amp;gt; Transaction Type, Table Code: 3)&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Transaction Type Label&lt;/em&gt;] - Transaction Type Description (see LOOKUP TABLES &amp;gt;&amp;gt; Transaction Type)&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Total&amp;nbsp;Paid Amount&lt;/em&gt;] – Total Paid Amount, in local currency&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Quantity&lt;/em&gt;] –&amp;nbsp;Quantity of Paid Products, in unit&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Selection Time (sec.)&lt;/em&gt;] - Total of the timing spent to perform the Selection of the Product to buy. It is expressed in seconds&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Payment Time (sec.)&lt;/em&gt;] - Total of the timing spent to perform the Payment. It is expressed in seconds&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Printing Time (sec.)&lt;/em&gt;] - Total of the timing spent to perform the Printing. It is expressed in seconds&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account Username&lt;/em&gt;] - Account Username&amp;nbsp;&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account Username (email)&lt;/em&gt;] - Account Login Mail Address&lt;/li&gt;&lt;li&gt;[&lt;em&gt;User Account Name&lt;/em&gt;] - Account User Name. Format: “Last Name, First Name”&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Workstation Code&lt;/em&gt;] - Workstation Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Workstation Name&lt;/em&gt;] - Workstation Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Operating Area Code&lt;/em&gt;] - Operating Area Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Operating Area Name&lt;/em&gt;] – Operating Area Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location Code&lt;/em&gt;] - Location Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location Name&lt;/em&gt;] - Location Name&lt;/li&gt;&lt;/ul&gt;</Description>
			</RichDescItem>
		</RichDescList>
	</DocTemplate>
</DOEnt_DocTemplate>