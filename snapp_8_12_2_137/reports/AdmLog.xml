<?xml version="1.0" encoding="UTF-8" standalone="no"?><DOEnt_DocTemplate><Header><EntityType>37</EntityType><EntityId>0C0D1DD0-E4EE-5AD3-0010-0152448AB64F</EntityId><LastUpdate>2024-02-22T09:18:00.000+0100</LastUpdate></Header><DocTemplate><IconName>rpt-dataexport.png</IconName><EntityType>37</EntityType><DocTemplateId>0C0D1DD0-E4EE-5AD3-0010-0152448AB64F</DocTemplateId><DocTemplateName>@Common.AccessLog</DocTemplateName><DocTemplateCode>DOC33</DocTemplateCode><CategoryId>56E73AC4-0538-494A-B661-345BBBDE739D</CategoryId><DocEnabled>true</DocEnabled><ExecRequireLogin>true</ExecRequireLogin><DocTemplateType>5</DocTemplateType><DocEditorType>6</DocEditorType><SystemCode>AdmLog</SystemCode><DocContexts/><SaleForApproval>false</SaleForApproval><SaleOpen>false</SaleOpen><SalePaid>false</SalePaid><SaleCompleted>false</SaleCompleted><IndividualPAH>false</IndividualPAH><DataExportOutputFormat/><CsvFieldSeparator/><CsvQuoteCharacter/><CsvIncludeHeaderLine/><LogCount>8</LogCount><DataSourceSelection>false</DataSourceSelection><DataSourceId/><MaxDateRangeDays/><MediaEncoderPluginId/><ProductDocumentTagIDs/><AttachDocTemplateIDs/><MediaRfidOptionType/><ParamList><Param><DocParamId>97470E51-AF2C-931C-00BE-018D7A4ABD21</DocParamId><DocTemplateId>0C0D1DD0-E4EE-5AD3-0010-0152448AB64F</DocTemplateId><DocParamType>4</DocParamType><DocParamName>DateFrom</DocParamName><DocParamCaption>@Common.FromDate</DocParamCaption><DocParamDefault>[@CurrentDate]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>E960BA1F-6392-743C-00BF-018D7A4ABD22</DocParamId><DocTemplateId>0C0D1DD0-E4EE-5AD3-0010-0152448AB64F</DocTemplateId><DocParamType>4</DocParamType><DocParamName>DateTo</DocParamName><DocParamCaption>@Common.ToDate</DocParamCaption><DocParamDefault>[@CurrentDate]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>97A1F658-FB6C-C0BF-00C0-018D7A4ABD23</DocParamId><DocTemplateId>0C0D1DD0-E4EE-5AD3-0010-0152448AB64F</DocTemplateId><DocParamType>1001</DocParamType><DocParamName>LocationId</DocParamName><DocParamCaption>@Account.Location</DocParamCaption><DocParamDefault>[@CurrentLocationId]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>55038F27-DF85-12AE-00C1-018D7A4ABD24</DocParamId><DocTemplateId>0C0D1DD0-E4EE-5AD3-0010-0152448AB64F</DocTemplateId><DocParamType>1101</DocParamType><DocParamName>Z_TagId</DocParamName><DocParamCaption>Product TAG</DocParamCaption><DocParamDefault/><Mandatory>false</Mandatory></Param></ParamList><DataSourceList><DataSource><Name>Default</Name><Code>9KFC7YQKVXMHKDT</Code><SQL unescaped="true"><![CDATA[declare @TagId uniqueidentifier; set @TagId=:@Z_TagId;
declare @LocationId uniqueidentifier; set @LocationId=:@LocationId;

select
  TU.UsageDateTime as [Usage Date Time],
  TU.UsageType as [Usage Type Code],
  dbo.fnLookupItemDesc(69,TU.UsageType) as [Usage Type Label],
  TU.ValidateDateTime as [Validate Date Time],
  Coalesce(TU.GroupQuantity, TCK.GroupQuantity) as [Group Quantity],
  (case when TU.ValidateDateTime is null then 0 else 1 end) as [Off Line Usage],
  LOC.AccountId as [Location ID],
  LOC.AccountCode as [Location Code],
  LOC.DisplayName as [Location Name],
  AAR.AccountId as [Access Area ID],
  AAR.AccountCode as [Access Area Code],
  AAR.DisplayName as [Access Area Name],
  APT.WorkstationId as [Access Point ID],
  APT.WorkstationCode as [Access Point Code],
  APT.WorkstationName as [Access Point Name],
  PRD.ProductId as [Product ID],
  PRD.ProductCode as [Product Code],
  PRD.ProductName as [Product Name],
  INC.ProductId as [ID of Embedded Product],
  INC.ProductCode as [Code of Embedded Product],
  INC.ProductName as [Name of Embedded Product],
  Stuff(( 
    select '|' + MC.MediaCode
    from tbMediaCode MC
    where MC.MediaId=TU.MediaId
    FOR XML PATH('')
  ), 1, 1, '') as [Barcodes],
  (CASE
    WHEN TCK.TicketId IS NULL THEN NULL
    ELSE dbo.fnBarcodeDSSN(6, 0, 32, TCK.TicketSeed, TCK.LicenseId, TCK.StationSerial, TCK.EncodeFiscalDate, TCK.TicketSerial, 0, 0) 
  END) as [Ticket Barcode],
  GST.AccountId as [Account ID],
  GST.AccountCode as [Account Code],
  GST.DisplayName as [Account Name],
  TU.Imported as [Imported],
  TU.ForcedGate as [Forced Specific Gate],
  TU.Invalidated as [Invalidated]
from
  tbTicketUsage TU left join
  tbWorkstation APT on APT.WorkstationId=TU.AptWorkstationId left join
  tbAccount LOC on LOC.AccountId=APT.LocationAccountId left join
  tbAccount AAR on AAR.AccountId=TU.AccessAreaAccountId left join
  tbTicket TCK on TCK.TicketId=TU.TicketId left join
  tbProduct PRD on PRD.ProductId=TCK.ProductId left join
  tbProduct INC on INC.ProductId=TU.IncProductId left join
  tbTicketMediaMatch PTF on PTF.TicketMediaMatchId=TCK.TicketMediaMatchId left join
  tbAccount GST on GST.AccountId=PTF.AccountId
where
  TU.UsageFiscalDate>=:@DateFrom and
  TU.UsageFiscalDate<=:@DateTo and
  TU.ValidateResult<100 and
  (@LocationId is null or APT.LocationAccountId=@LocationId) and
  (@TagId is null or TCK.ProductId in (select EntityId from tbTagLink where TagId=@TagId))
]]></SQL></DataSource></DataSourceList><RightList><Right><IconName>station.png</IconName><UsrEntityType>3</UsrEntityType><UsrEntityId>20A03348-9A17-4EEF-A1EE-02E59B9E2911</UsrEntityId><UsrEntityCode>BKOFFICE</UsrEntityCode><UsrEntityName>Back Office</UsrEntityName><RightLevel>5</RightLevel></Right><Right><IconName>account_prs.png</IconName><UsrEntityType>15</UsrEntityType><UsrEntityId>A0000131-0000-0000-0000-000000000015</UsrEntityId><UsrEntityCode/><UsrEntityName>Every user</UsrEntityName><RightLevel>5</RightLevel></Right></RightList><RichDescList><RichDescItem><IconName>flag_USA.png</IconName><LangISO>en</LangISO><Description>&lt;h1&gt;Access Log&lt;/h1&gt;&lt;h2&gt;Abstract&lt;/h2&gt;“Access Log” generates a report of the access log of all visitors using a product filtered by a selected tag in a selected location within a selected period at your choice.&lt;h2&gt;Generating the report&lt;/h2&gt; Parameter Input&lt;br&gt;While generating the report, input parameters menu presents an intuitive interface.&lt;br&gt;Built-in wizards will help you quickly and easily create at your choice profile for your site by&lt;ul&gt;&lt;li&gt;[&lt;em&gt;From date – To Date&lt;/em&gt;] – Period to be analysed, easy-to-select.&lt;ul&gt;&lt;li&gt;Note: The dates if not specified are to be considered&amp;nbsp;&lt;em&gt;“Fiscal Date”&lt;/em&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location&lt;/em&gt;] – Site Location, easy-to-select. Selecting&amp;nbsp;&lt;em&gt;-empty-&lt;/em&gt;, default is all the locations&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product TAG&lt;/em&gt;] -&amp;nbsp;Selection of a Product TAG label, only products with that tag will be shown.&lt;/li&gt;&lt;/ul&gt; Output File Extension&lt;br&gt;Built-in wizards will help you easily and quickly generate at your choice reports in XLSX or CSV or PDF formats. Format selection is required before running the report.&lt;ul&gt;&lt;li&gt;XLSX&lt;ul&gt;&lt;li&gt;Report generates an EXCEL (latest version) file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;CSV&lt;ul&gt;&lt;li&gt;its generation requires:&lt;ul&gt;&lt;li&gt;&lt;em&gt;Field delimiter&lt;/em&gt;: Separator to be put between fields. Usually a "comma". When null, default is taken from user configuration.&lt;/li&gt;&lt;li&gt;&lt;em&gt;Quote character&lt;/em&gt;: Character used to surround fields&lt;/li&gt;&lt;li&gt;&lt;em&gt;Include header line&lt;/em&gt;&amp;nbsp;to tick the box. Default is YES.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;PDF&lt;ul&gt;&lt;li&gt;Report generates a PDF (latest version) file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Header&lt;/h2&gt; Report parameters&lt;ul&gt;&lt;li&gt;[&lt;em&gt;Execution date/time&lt;/em&gt;] - Report Execution Time. Date and Hours format as per configuration [Location, Operating Area, Workstation]&lt;/li&gt;&lt;li&gt;[&lt;em&gt;From date – To Date&lt;/em&gt;] – Selected analysis period.&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location&lt;/em&gt;] – Site Location Code and Name. Display format: "[SITE LOCATION CODE] Site Location Name".Selecting blanck or "- empty" all the &amp;nbsp;Locations' exposure are analysed and listed&lt;/li&gt;&lt;li&gt;[Product&amp;nbsp;&lt;em&gt;TAG&lt;/em&gt;] – Selected tag.&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Contents (by Columns)&lt;/h2&gt;&lt;p&gt;The program produces easy-to-read reports that include text information.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;[&lt;em&gt;Usage Date Time&lt;/em&gt;] – Utilization Date and Time. Display format as per configuration (Location, Operating Area, Workstation)&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Usage Type Code&lt;/em&gt;] – Utilization Type code # (see “Type Description” here below)&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Usage Type Label&lt;/em&gt;] – Utilization Type Description (see "Ticket Usage" table - Table Code: 69)&amp;nbsp;&amp;nbsp;&lt;ul&gt;&lt;li&gt;1&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Entry&lt;/li&gt;&lt;li&gt;2&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Exit&lt;/li&gt;&lt;li&gt;3&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Re-entry&lt;/li&gt;&lt;li&gt;4&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Crossover&lt;/li&gt;&lt;li&gt;5&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Transit&lt;/li&gt;&lt;li&gt;6&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Override&lt;/li&gt;&lt;li&gt;7&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Already exit&lt;/li&gt;&lt;li&gt;11 &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; Product redemption&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Validation&amp;nbsp;Date Time&lt;/em&gt;] - Validation&amp;nbsp;date and time. Display format as per configuration (Location, Operating Area, Workstation)&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Group Quantity&lt;/em&gt;] – Group Quantity, in unit #&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Offline Usage&lt;/em&gt;] - Access Control was on Offline:&lt;ul&gt;&lt;li&gt;“0” : NO;&lt;/li&gt;&lt;li&gt;“1” : “YES”&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location ID&lt;/em&gt;] – Site Location ID&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location Code&lt;/em&gt;] – Site Location Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Location Name&lt;/em&gt;] – Site Location Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Access Area ID&lt;/em&gt;] – Access Area ID&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Access Area Code&lt;/em&gt;] – Access Area Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Access Area Name&lt;/em&gt;] – Access Area Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Access Point ID&lt;/em&gt;] – Access Point ID&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Access Point Code&lt;/em&gt;] – Access Point Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Access Point Name&lt;/em&gt;] – Access Point Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product ID&lt;/em&gt;] – Product ID&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product Code&lt;/em&gt;] – Product Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product Name&lt;/em&gt;] – Product Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;ID of Embedded Product&lt;/em&gt;] - Embedded Product ID&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Code of Embedded Product&lt;/em&gt;] - Embedded Product Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Name of Embedded Product&lt;/em&gt;] - Embedded Product Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Barcodes&lt;/em&gt;] - Media codes - Reference to media&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Ticket Barcode&lt;/em&gt;] - Ticket Barcode - Reference to redeemed media&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account ID&lt;/em&gt;] – Account ID&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account Code&lt;/em&gt;] – Account Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account Name&lt;/em&gt;] – Account Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Imported&lt;/em&gt;] – Indicates if the usage has been imported: the scan/redemption was non handled by SnApp&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Forced Specific Gate&lt;/em&gt;] – Indicates if the access point configuration was overridden in the API call, requesting to use a specific gate (op.area)&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Invalidated&lt;/em&gt;] – Original validate result for invalid offline usages&lt;/li&gt;&lt;/ul&gt;</Description></RichDescItem></RichDescList></DocTemplate></DOEnt_DocTemplate>