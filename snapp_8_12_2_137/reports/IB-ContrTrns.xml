<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<DOEnt_DocTemplate>
	<Header>
		<EntityType>37</EntityType>
		<EntityId>0E665226-A832-C73D-060A-015AB7D0BB22</EntityId>
		<LastUpdate>2023-10-19T15:27:00.000+0200</LastUpdate>
	</Header>
	<DocTemplate>
		<IconName>rpt-dataexport.png</IconName>
		<EntityType>37</EntityType>
		<DocTemplateId>0E665226-A832-C73D-060A-015AB7D0BB22</DocTemplateId>
		<DocTemplateName>@Stats.InstallmentContractTransactions</DocTemplateName>
		<DocTemplateCode>DOC49</DocTemplateCode>
		<CategoryId>06A43409-24CA-32A6-0194-015AB7D0B14E</CategoryId>
		<DocEnabled>true</DocEnabled>
		<ExecRequireLogin>true</ExecRequireLogin>
		<DocTemplateType>5</DocTemplateType>
		<DocEditorType>6</DocEditorType>
		<SystemCode>IB-ContrTrns</SystemCode>
		<DocContexts/>
		<SaleForApproval>false</SaleForApproval>
		<SaleOpen>false</SaleOpen>
		<SalePaid>false</SalePaid>
		<SaleCompleted>false</SaleCompleted>
		<IndividualPAH>false</IndividualPAH>
		<DataExportOutputFormat/>
		<CsvFieldSeparator/>
		<CsvQuoteCharacter/>
		<CsvIncludeHeaderLine/>
		<LogCount>0</LogCount>
		<DataSourceSelection>false</DataSourceSelection>
		<DataSourceId/>
		<MaxDateRangeDays/>
		<MediaEncoderPluginId/>
		<ProductDocumentTagIDs/>
		<AttachDocTemplateIDs/>
		<MediaRfidOptionType/>
		<ParamList>
			<Param>
				<DocParamId>3341B970-1814-C385-0356-018B1DC4B693</DocParamId>
				<DocTemplateId>0E665226-A832-C73D-060A-015AB7D0BB22</DocTemplateId>
				<DocParamType>4</DocParamType>
				<DocParamName>DateFrom</DocParamName>
				<DocParamCaption>@Common.FromDate</DocParamCaption>
				<DocParamDefault>[@CurrentDate]</DocParamDefault>
				<Mandatory>false</Mandatory>
			</Param>
			<Param>
				<DocParamId>57135615-83C5-AB89-0357-018B1DC4B693</DocParamId>
				<DocTemplateId>0E665226-A832-C73D-060A-015AB7D0BB22</DocTemplateId>
				<DocParamType>4</DocParamType>
				<DocParamName>DateTo</DocParamName>
				<DocParamCaption>@Common.ToDate</DocParamCaption>
				<DocParamDefault>[@CurrentDate]</DocParamDefault>
				<Mandatory>false</Mandatory>
			</Param>
		</ParamList>
		<DataSourceList>
			<DataSource>
				<Name>Default</Name>
				<Code>7535UVEF05Y5FB3</Code>
				<SQL unescaped="true"><![CDATA[select 
  AccountId as [Account ID],
  UserName as [Account Username],
  LoginEmail as [Account Username (email)],
  AccountName as [Account Name],
  InstallmentContractCode as [Contract Code],
  CreateFiscalDate as [Issue Date],
  (case RW when 1 then TotalAmount else null end) as [Transaction Total],
  ProductCode as [Product Code],
  ProductName as [Product Name],
  AreaGroupCode as [Area Group Code],
  AreaGroupName as [Area Group Name],
  ProductUnitAmount as [Product Unit Amount],
  ProductQuantity as [Product Quantity],
  ProductTotalAmount as [Product Total Amount]
from (
  select 
    A.AccountId,
    UsrLogin.UserName,
    A.DisplayName as [AccountName],
    UsrEmail.UserName as LoginEmail,
    IC.InstallmentContractCode,
    IC.CreateFiscalDate,
    IC.TotalAmount,
    Prd.ProductCode,
    Prd.ProductName,
    PG.TagCode as AreaGroupCode,
    PG.TagName as AreaGroupName,
    SI.UnitAmount as [ProductUnitAmount],
    SI.Quantity as [ProductQuantity],
    SI.TotalAmount as [ProductTotalAmount],
    ROW_NUMBER() OVER(PARTITION BY IC.InstallmentContractCode ORDER BY IC.CreateFiscalDate, IC.InstallmentContractCode) AS RW
  from
    tbInstallmentContract IC left join
    tbAccount A on A.AccountId=IC.AccountId left join
    tbTransaction Trn on Trn.TransactionId=IC.IssueTransactionId left join
    tbSaleItem SI on SI.SaleId=Trn.SaleId left join
    tbProduct Prd on Prd.ProductId=SI.ProductId left join
    tbTag PG on PG.TagId=Prd.AreaGroupTagId left join
    tbLoginAlias UsrLogin on UsrLogin.AccountId=A.AccountId and UsrLogin.LoginAliasType=0 left join
    tbLoginAlias UsrEmail on UsrEmail.AccountId=A.AccountId and UsrEmail.LoginAliasType=1
  where
    IC.CreateFiscalDate>=:@DateFrom and
    IC.CreateFiscalDate<=:@DateTo and
    IC.InstallmentContractStatus<>1/*draft*/
) X]]></SQL>
			</DataSource>
		</DataSourceList>
		<RightList>
			<Right>
				<IconName>station.png</IconName>
				<UsrEntityType>3</UsrEntityType>
				<UsrEntityId>ACD59ABD-B0FE-DF2C-0108-015AB7D0B016</UsrEntityId>
				<UsrEntityCode>BKOFFICE</UsrEntityCode>
				<UsrEntityName>Back Office</UsrEntityName>
				<RightLevel>5</RightLevel>
			</Right>
			<Right>
				<IconName>account_prs.png</IconName>
				<UsrEntityType>15</UsrEntityType>
				<UsrEntityId>E1FC2E69-410D-6AB4-003C-0179C2BB4E51</UsrEntityId>
				<UsrEntityCode>SYSUSR1000</UsrEntityCode>
				<UsrEntityName>System</UsrEntityName>
				<RightLevel>5</RightLevel>
			</Right>
		</RightList>
		<RichDescList>
			<RichDescItem>
				<IconName>flag_USA.png</IconName>
				<LangISO>en</LangISO>
				<Description>&lt;h1&gt;Installment Contract Transactions Report&lt;/h1&gt;&lt;h2&gt;Abstract&lt;/h2&gt;“Installment Contract Transactions” generates a report of all the installment contract transactions occurred in a selected period.&lt;h2&gt;Generating the report&lt;/h2&gt; Parameter Input&lt;br&gt;While generating the report, input parameters menu presents an intuitive interface..&lt;br&gt;Built-in wizards will help you quickly and easily create at your choice profile for your site by&lt;ul&gt;&lt;li&gt;[&lt;em&gt;From date – To Date&lt;/em&gt;] – Period to be analysed,&amp;nbsp;select the dates from the calendar. Only Installment contracts issued into within that period are taken into consideration.&lt;ul&gt;&lt;li&gt;Note: The dates if not specified are to be considered “Fiscal Date”&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;Output File Extension&lt;br&gt;Built-in wizards will help you easily and quickly generate at your choice reports in XLSX or CSV or PDF formats. Format selection is required before running the report.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;XLSX&lt;ul&gt;&lt;li&gt;Report generates an EXCEL (latest version) file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;CSV&lt;ul&gt;&lt;li&gt;its generation requires:&lt;ul&gt;&lt;li&gt;&lt;em&gt;Field delimiter&lt;/em&gt;: Separator to be put between fields. Usually a "comma". When null, default is taken from user configuration.&lt;/li&gt;&lt;li&gt;&lt;em&gt;Quote character&lt;/em&gt;: Character used to surround fields&lt;/li&gt;&lt;li&gt;&lt;em&gt;Include header line&lt;/em&gt;&amp;nbsp;to tick the box. Default is YES.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;PDF&lt;ul&gt;&lt;li&gt;Report generates a PDF (latest version) file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Header&lt;/h2&gt;&lt;p&gt;Report parameters:&lt;/p&gt;&lt;ul&gt;&lt;li&gt;[&lt;em&gt;Execution date/time&lt;/em&gt;] - Report Execution Time. Date and Hours format as per configuration [Location, Operating Area, Workstation]&lt;/li&gt;&lt;li&gt;[&lt;em&gt;From date – To Date&lt;/em&gt;] – Selected Period&amp;nbsp;referred to the Installment Creation Dates&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Contents (by Columns)&lt;/h2&gt; The program produces easy-to-read reports that include text information.&lt;ul&gt;&lt;li&gt;[&lt;em&gt;Account Id&lt;/em&gt;] – Accountt ID&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account&amp;nbsp;Username&lt;/em&gt;] – Account Login Username.&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account Name&lt;/em&gt;] – Account &amp;nbsp;Name. Display format: “Last Name, First Name”&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account Username (email)&lt;/em&gt;] - Account Login Mail address&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Contract Code&lt;/em&gt;] - Contract Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Issue Date&lt;/em&gt;] - Contract Issuing Date&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Transaction Total&lt;/em&gt;] - Total Transaction Amount. Value expressed in local currency&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product Code&lt;/em&gt;] - Product Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product Name&lt;/em&gt;] - Product Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Area Group Code&lt;/em&gt;] -&amp;nbsp;Statistical Grouping -&amp;nbsp; Area Group Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Area Group Name&lt;/em&gt;] - Statistical Grouping -&amp;nbsp;Area Group Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product Unit Amount&lt;/em&gt;] - Product Unit Amount&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product Quantity&lt;/em&gt;] - Product Quantity&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Product Total Amount&lt;/em&gt;] - Product Total Amount&lt;/li&gt;&lt;/ul&gt;</Description>
			</RichDescItem>
		</RichDescList>
	</DocTemplate>
</DOEnt_DocTemplate>