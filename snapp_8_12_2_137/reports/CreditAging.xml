<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<DOEnt_DocTemplate>
	<Header>
		<EntityType>37</EntityType>
		<EntityId>ADC542D7-02C8-E017-025F-01692FE8C208</EntityId>
		<LastUpdate>2023-10-20T15:03:00.000+0200</LastUpdate>
	</Header>
	<DocTemplate>
		<IconName>rpt-dataexport.png</IconName>
		<EntityType>37</EntityType>
		<DocTemplateId>ADC542D7-02C8-E017-025F-01692FE8C208</DocTemplateId>
		<DocTemplateName>@Stats.CreditAgingReport</DocTemplateName>
		<DocTemplateCode>YK916BH8UY8XP0P</DocTemplateCode>
		<CategoryId>06A43409-24CA-32A6-0194-015AB7D0B14E</CategoryId>
		<DocEnabled>true</DocEnabled>
		<ExecRequireLogin>true</ExecRequireLogin>
		<DocTemplateType>5</DocTemplateType>
		<DocEditorType>6</DocEditorType>
		<SystemCode>CreditAging</SystemCode>
		<DocContexts/>
		<SaleForApproval>false</SaleForApproval>
		<SaleOpen>false</SaleOpen>
		<SalePaid>false</SalePaid>
		<SaleCompleted>false</SaleCompleted>
		<IndividualPAH>false</IndividualPAH>
		<DataExportOutputFormat/>
		<CsvFieldSeparator/>
		<CsvQuoteCharacter/>
		<CsvIncludeHeaderLine/>
		<LogCount>0</LogCount>
		<DataSourceSelection>false</DataSourceSelection>
		<DataSourceId/>
		<MaxDateRangeDays/>
		<MediaEncoderPluginId/>
		<ProductDocumentTagIDs/>
		<AttachDocTemplateIDs/>
		<MediaRfidOptionType/>
		<ParamList>
			<Param>
				<DocParamId>9A51232D-FFE3-B11C-01D5-018AF49D7D90</DocParamId>
				<DocTemplateId>ADC542D7-02C8-E017-025F-01692FE8C208</DocTemplateId>
				<DocParamType>1201</DocParamType>
				<DocParamName>OrganizationId</DocParamName>
				<DocParamCaption>@Account.Organization</DocParamCaption>
				<DocParamDefault/>
				<Mandatory>false</Mandatory>
			</Param>
		</ParamList>
		<DataSourceList>
			<DataSource>
				<Name>Default</Name>
				<Code>U7ZZGCMK68ZBAZ0</Code>
				<SQL unescaped="true"><![CDATA[declare @Today date = Cast(GetDate() as date);
declare @OrganizationId uniqueidentifier; set @OrganizationId=:@OrganizationId;

select 
    A.DisplayName as [Account Name],
    A.AccountCode as [Account Code],
    Sum(P.PaymentAmount) as [Exposure Amount],
    Sum(case when (PC.DueDate>@Today) then P.PaymentAmount else 0 end) as [Not Yet Due Amount],
    Sum(case when (PC.DueDate<=@Today) then P.PaymentAmount else 0 end) as [Past Due Amount],
    Sum(case when ((PC.DueDate<=@Today) and DATEDIFF(dd,PC.DueDate,@Today)<=30) then P.PaymentAmount else 0 end) as [Expired 01-30 Days],
    Sum(case when ((PC.DueDate<=@Today) and DATEDIFF(dd,PC.DueDate,@Today)>30 and DATEDIFF(dd,PC.DueDate,@Today)<=60) then P.PaymentAmount else 0 end) as [Overdue by 31-60 Days],
    Sum(case when ((PC.DueDate<=@Today) and DATEDIFF(dd,PC.DueDate,@Today)>60 and DATEDIFF(dd,PC.DueDate,@Today)<=90) then P.PaymentAmount else 0 end) as [Overdue by 61-90 Days],
    Sum(case when ((PC.DueDate<=@Today) and DATEDIFF(dd,PC.DueDate,@Today)>90 and DATEDIFF(dd,PC.DueDate,@Today)<=120) then P.PaymentAmount else 0 end) as [Overdue by 91-120 Days],
    Sum(case when ((PC.DueDate<=@Today) and DATEDIFF(dd,PC.DueDate,@Today)>120) then P.PaymentAmount else 0 end) as [Overdue by >120 Days]
from 
  tbAccount A left join
  tbPaymentCredit PC on PC.AccountId=A.AccountId left join
  tbPayment P on P.PaymentId=PC.PaymentId 
where 
    (@OrganizationId is null or A.AccountId=@OrganizationId) and
    PC.CreditStatus=1 /*open*/
group by
    A.AccountCode,
    A.DisplayName
order by
  A.DisplayName
        ]]></SQL>
			</DataSource>
		</DataSourceList>
		<RightList>
			<Right>
				<IconName>station.png</IconName>
				<UsrEntityType>3</UsrEntityType>
				<UsrEntityId>ACD59ABD-B0FE-DF2C-0108-015AB7D0B016</UsrEntityId>
				<UsrEntityCode>BKOFFICE</UsrEntityCode>
				<UsrEntityName>Back Office</UsrEntityName>
				<RightLevel>5</RightLevel>
			</Right>
			<Right>
				<IconName>account_prs.png</IconName>
				<UsrEntityType>15</UsrEntityType>
				<UsrEntityId>E1FC2E69-410D-6AB4-003C-0179C2BB4E51</UsrEntityId>
				<UsrEntityCode>SYSUSR1000</UsrEntityCode>
				<UsrEntityName>System</UsrEntityName>
				<RightLevel>5</RightLevel>
			</Right>
		</RightList>
		<RichDescList>
			<RichDescItem>
				<IconName>flag_USA.png</IconName>
				<LangISO>en</LangISO>
				<Description>&lt;h1&gt;Accounts receivable aging&lt;/h1&gt;&lt;h2&gt;Abstract&lt;/h2&gt;“Accounts receivable aging” generates a report of the exposure of the selected account/organization.&lt;h2&gt;Generating the report&lt;/h2&gt; Parameter Input&lt;br&gt;While generating the report, input parameters menu presents an intuitive interface.&lt;br&gt;Built-in wizards will help you quickly and easily create at your choice profile for your site by&lt;ul&gt;&lt;li&gt;[&lt;em&gt;Organization&lt;/em&gt;] – Selected Organization to be analysed, easy-to-select. When selecting "- empty" all the Organizations' exposure are analysed and listed.&lt;/li&gt;&lt;/ul&gt; Output File Extension&lt;br&gt;Built-in wizards will help you easily and quickly generate at your choice reports in XLSX or CSV or PDF formats. Format selection is required before running the report.​​​​​​​&lt;ul&gt;&lt;li&gt;XLSX&lt;ul&gt;&lt;li&gt;Report generates an EXCEL (latest version) file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;CSV&lt;ul&gt;&lt;li&gt;its generation requires:&lt;ul&gt;&lt;li&gt;&lt;em&gt;Field delimiter&lt;/em&gt;: Separator to be put between fields. Usually a "comma". When null, default is taken from user configuration.&lt;/li&gt;&lt;li&gt;&lt;em&gt;Quote character&lt;/em&gt;: Character used to surround fields&lt;/li&gt;&lt;li&gt;&lt;em&gt;Include header line&lt;/em&gt;&amp;nbsp;to tick the box. Default is YES.&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;li&gt;PDF&lt;ul&gt;&lt;li&gt;Report generates a PDF (latest version) file&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Header&lt;/h2&gt; Report parameters&lt;ul&gt;&lt;li&gt;[&lt;em&gt;Title&lt;/em&gt;] - Accounts receivable aging&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Execution date/time&lt;/em&gt;] - Report Execution Time. Date and Hours format as per configuration [Location, Operating Area, Workstation]&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Organization&lt;/em&gt;] – Selected Organization Name. If blank then the report includes all the Organizations..&lt;/li&gt;&lt;/ul&gt;&lt;h2&gt;Contents (by Columns)&lt;/h2&gt;&lt;p&gt;The program produces easy-to-read reports that include text information.&lt;/p&gt;&lt;ul&gt;&lt;li&gt;[&lt;em&gt;Account Name&lt;/em&gt;] – Account Name&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Account Code&lt;/em&gt;] – Account Code&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Exposure Amount&lt;/em&gt;] – Total Not Payed Yet Amount Value in local currency&amp;nbsp;&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Not Yet Due Time&lt;/em&gt;] - Total Not Yet Due Amount Value in in local currency&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Past due&lt;/em&gt;] – Total Past Due Amount Value in&amp;nbsp;in local currency&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Overdue by 01-30 Days&lt;/em&gt;] - Overdue Payment Value within Day 1 and Day 30, in local currency&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Overdue by 31-60 Days&lt;/em&gt;] – Overdue Payment Value within Day 31 and Day 60, in local currency&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Overdue by 61-90 Days&lt;/em&gt;] – Overdue Payment Value within Day 61 and Day 90, in local currency&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Overdue by 91-120 Days&lt;/em&gt;] – Overdue Payment Value within Day 91 and Day 120, in local currency&lt;/li&gt;&lt;li&gt;[&lt;em&gt;Overdue by &amp;gt;121 Days&lt;/em&gt;] – Overdue Payment Value in more than 120, in local currency&lt;/li&gt;&lt;/ul&gt;</Description>
			</RichDescItem>
		</RichDescList>
	</DocTemplate>
</DOEnt_DocTemplate>