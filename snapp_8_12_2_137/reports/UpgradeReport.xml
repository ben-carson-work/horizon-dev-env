<?xml version="1.0" encoding="UTF-8" standalone="no"?><DOEnt_DocTemplate><Header><EntityType>37</EntityType><EntityId>0CFFBC28-F85B-F5DB-06DC-0163F3ACB9B1</EntityId><LastUpdate>2020-10-01T15:21:00.000+0200</LastUpdate></Header><DocTemplate><IconName>rpt-dataexport.png</IconName><EntityType>37</EntityType><DocTemplateId>0CFFBC28-F85B-F5DB-06DC-0163F3ACB9B1</DocTemplateId><DocTemplateName>UpgradeReport</DocTemplateName><DocTemplateCode>0WG45UF39J8PDE7</DocTemplateCode><CategoryId>588BF595-7BC8-A2F1-02F1-0163F3ACA8FC</CategoryId><DocEnabled>true</DocEnabled><ExecRequireLogin>true</ExecRequireLogin><DocTemplateType>5</DocTemplateType><DocEditorType>6</DocEditorType><SystemCode>UpgradeReport</SystemCode><DocContexts/><SaleForApproval>false</SaleForApproval><SaleOpen>false</SaleOpen><SalePaid>false</SalePaid><SaleCompleted>false</SaleCompleted><LogCount>0</LogCount><DataSourceSelection>false</DataSourceSelection><DataSourceId/><MaxDateRangeDays/><MediaEncoderPluginId/><MediaRfidOptionType/><ParamList><Param><DocParamId>CB1AD0A8-06E2-EACC-01B4-0174E41ABB20</DocParamId><DocTemplateId>0CFFBC28-F85B-F5DB-06DC-0163F3ACB9B1</DocTemplateId><DocParamType>4</DocParamType><DocParamName>DateFrom</DocParamName><DocParamCaption>@Common.FromDate</DocParamCaption><DocParamDefault>[@CurrentDate]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>1C386155-7F45-7A9C-01B5-0174E41ABB21</DocParamId><DocTemplateId>0CFFBC28-F85B-F5DB-06DC-0163F3ACB9B1</DocTemplateId><DocParamType>4</DocParamType><DocParamName>DateTo</DocParamName><DocParamCaption>@Common.ToDate</DocParamCaption><DocParamDefault>[@CurrentDate]</DocParamDefault><Mandatory>false</Mandatory></Param></ParamList><DataSourceList><DataSource><Name>Default</Name><Code>EK9HG8CG09VUT9F</Code><SQL><![CDATA[select §§n  ('T:' + CONVERT(varchar(10), TrnSrc.LicenseId) + '.' + CONVERT(varchar(5), WksSrc.StationSerial) + '.' + CONVERT(VARCHAR(6),TrnSrc.TransactionFiscalDate, 12) + '.' + CONVERT(varchar(5), TrnSrc.TransactionSerial)) as OriginalTransactionTDSSN,§§n  ('P:' + CONVERT(varchar(10), TckSrc.LicenseId) + '.' + CONVERT(varchar(5), TckSrc.StationSerial) + '.' + CONVERT(VARCHAR(6),TckSrc.EncodeFiscalDate, 12) + '.' + CONVERT(varchar(5), TckSrc.TicketSerial)) as OriginalProductTDSSN,§§n  SalSrc.SaleCode as OriginalPNR,§§n  LocSrc.AccountCode as OriginalLocationCode,§§n  LocSrc.DisplayName as OriginalLocationName,§§n  OpASrc.AccountCode as OriginalOpAreaCode,§§n  OpASrc.DisplayName as OriginalOpAreaName,§§n  WksSrc.WorkstationCode OriginalWorkstationCode,§§n  WksSrc.WorkstationName as OriginalWorkstationName,§§n  UsrSrc.DisplayName as OriginalUser,§§n  PrdSrc.ProductCode as OriginalProductCode,§§n  PrdSrc.ProductName as OriginalProductName,§§n  TckSrc.UnitAmount as OriginalProductPrice,§§n  ('T:' + CONVERT(varchar(10), TrnDst.LicenseId) + '.' + CONVERT(varchar(5), WksDst.StationSerial) + '.' + CONVERT(VARCHAR(6),TrnDst.TransactionFiscalDate, 12) + '.' + CONVERT(varchar(5), TrnDst.TransactionSerial)) as UpgradeTransactionTDSSN,§§n  ('P:' + CONVERT(varchar(10), TckDst.LicenseId) + '.' + CONVERT(varchar(5), TckDst.StationSerial) + '.' + CONVERT(VARCHAR(6),TckDst.EncodeFiscalDate, 12) + '.' + CONVERT(varchar(5), TckDst.TicketSerial)) as UpgradeProductTDSSN,§§n  SalDst.SaleCode as UpgradePNR,§§n  LocDst.AccountCode as UpgradeLocationCode,§§n  LocDst.DisplayName as UpgradeLocationName,§§n  OpADst.AccountCode as UpgradeOpAreaCode,§§n  OpADst.DisplayName as UpgradeOpAreaName,§§n  WksDst.WorkstationCode as UpgradeWorkstationCode,§§n  WksDst.WorkstationName as UpgradeWorkstationName,§§n  UsrDst.DisplayName as UpgradeUser,§§n  TrnDst.SupAccountId as SupervisorOverrideAuthorized,§§n  PrdDst.ProductCode as UpgradeProductCode,§§n  PrdDst.ProductName as UpgradeProductName,§§n  TckDst.UnitAmount as UpgradeProductPrice,§§n  (TckDst.UnitAmount-TckSrc.UnitAmount) as PaidPriceDifference§§nfrom §§n  tbTicket TckDst inner join§§n  tbTicketUpgrade TckUpg on TckUpg.TicketId=TckDst.TicketId left join§§n  tbTicket TckSrc on TckSrc.TicketId=TckUpg.SourceTicketId left join§§n  tbProduct PrdDst on PrdDst.ProductId=TckDst.ProductId left join§§n  tbProduct PrdSrc on PrdSrc.ProductId=TckSrc.ProductId left join§§n  tbTransaction TrnSrc on TrnSrc.TransactionId=TckSrc.TransactionId left join§§n  tbTransaction TrnDst on TrnDst.TransactionId=TckDst.TransactionId left join§§n  tbSale SalSrc on SalSrc.SaleId=TrnSrc.SaleId left join§§n  tbSale SalDst on SalDst.SaleId=TrnDst.SaleId left join§§n  tbWorkstation WksSrc on WksSrc.WorkstationId=TrnSrc.WorkstationId left join§§n  tbWorkstation WksDst on WksDst.WorkstationId=TrnDst.WorkstationId left join§§n  tbAccount OpASrc on OpASrc.AccountId=TrnSrc.OpAreaId left join§§n  tbAccount LocSrc on LocSrc.AccountId=OpASrc.ParentAccountId left join§§n  tbAccount OpADst on OpADst.AccountId=TrnDst.OpAreaId left join§§n  tbAccount LocDst on LocDst.AccountId=OpADst.ParentAccountId left join§§n  tbAccount UsrSrc on UsrSrc.AccountId=TrnSrc.UserAccountId left join§§n  tbAccount UsrDst on UsrDst.AccountId=TrnDst.UserAccountId§§nwhere §§n  TckDst.EncodeFiscalDate>=:@DateFrom and §§n  TckDst.EncodeFiscalDate<=:@DateTo]]></SQL></DataSource></DataSourceList></DocTemplate></DOEnt_DocTemplate>