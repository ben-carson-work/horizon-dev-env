<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<DOEnt_DocTemplate>
	<Header>
		<EntityType>37</EntityType>
		<EntityId>FECAE49E-B710-4931-86F1-900AB22E07A6</EntityId>
		<LastUpdate>2016-11-14T20:59:25.760+0400</LastUpdate>
	</Header>
	<DocTemplate>
		<IconName>rpt-html.png</IconName>
		<EntityType>37</EntityType>
		<DocTemplateId>FECAE49E-B710-4931-86F1-900AB22E07A6</DocTemplateId>
		<DocTemplateName>@Stats.AdmAccDlyGph</DocTemplateName>
		<CategoryId>022178C4-D09A-4E70-917E-7336ACF45BD4</CategoryId>
		<DocEnabled>true</DocEnabled>
		<ExecRequireLogin>false</ExecRequireLogin>
		<DocTemplateType>5</DocTemplateType>
		<DocEditorType>8</DocEditorType>
		<DocData>
			<![CDATA[<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">§§n<html>§§n§§n<head>§§n  <title>[@ITL.Stats.AdmAccDlyGph]</title>§§n§§n  <script type="text/javascript" src="[@CFG.site_url]/libraries/jquery/jquery-2.2.0.min.js"></script>§§n  <script type="text/javascript" src="[@CFG.site_url]/libraries/amcharts/amcharts.js"></script>§§n  <script type="text/javascript" src="[@CFG.site_url]/libraries/amcharts/serial.js"></script>§§n§§n  <style>§§n  §§n    a[href="http://www.amcharts.com/javascript-charts/"] {§§n      display: none !important;§§n    }§§n§§n    .header {§§n	  font-family: 'Open Sans', sans-serif;§§n      margin: 0 20px 0 20px;§§n      left: 0;§§n      right: 0;§§n    }§§n    .counters {§§n      width: 200px;§§n	  font-size: 22px;§§n      padding: 20px;§§n      background: #efefef;§§n  	  border: 1px #cfcfcf solid;§§n  	  border-radius: 8px;§§n      margin-bottom: 50px;§§n    }§§n  </style>§§n§§n  <script>§§n    $(document).ready(function() {§§n      var inside = 0;§§n      var data = [];§§n      var minHH = 7;§§n      var maxHH = 20;§§n      §§n      if ([@Default.DT_Hour] > minHH)§§n        data.push({Slot: new Date([@Default.DT_Year], [@Default.DT_Month]-1, [@Default.DT_Day], minHH, 0)});§§n        §§n      [@ListStart {ds:Default}]§§n        inside += [@Default.QtyEntry] - [@Default.QtyExit];§§n        data.push({§§n          Slot: new Date([@Default.DT_Year], [@Default.DT_Month]-1, [@Default.DT_Day], [@Default.DT_Hour], [@Default.DT_Minute]),§§n          QtyEntry: [@Default.QtyEntry],§§n          QtyExit: -[@Default.QtyExit],§§n          QtyExitABS: [@Default.QtyExit],§§n          QtyInside: inside§§n        });§§n      [@ListEnd]§§n§§n      if ([@Default.DT_Hour] < maxHH)§§n        data.push({Slot: new Date([@Default.DT_Year], [@Default.DT_Month]-1, [@Default.DT_Day], maxHH, 0)});§§n§§n      AmCharts.makeChart("slot-chart", {§§n        type: "serial",§§n        theme: "none",§§n        marginLeft: 20,§§n        dataProvider: data,§§n        legend: {§§n          markerType: "square",§§n          position: "top",§§n          autoMargins: true§§n        },§§n        valueAxes: [§§n          {§§n            id: "left-axis",§§n            position: "left",§§n            axisAlpha: 0,§§n            inside: false,§§n            autoGridCount: false,§§n            gridCount: 2,§§n            gridAlpha: 0.1,§§n            color: "#444444",§§n            title: "in park"§§n          },§§n          {§§n            id: "right-axis",§§n            position: "right",§§n            axisAlpha: 0,§§n            inside: false,§§n            autoGridCount: false,§§n            gridCount: 2,§§n            gridAlpha: 0.1,§§n            color: "#444444",§§n            title: "entries and exits"§§n          }§§n        ],§§n        graphs: [§§n          {§§n            balloonText: "<b>[[QtyInside]]</b> in park",§§n            bullet: "round",§§n            bulletSize: 8,§§n            lineColor: "#1157b5",§§n            lineThickness: 4,§§n            type: "smoothedLine",§§n            valueField: "QtyInside",§§n            valueAxis: "left-axis",§§n            title: "In park"§§n          },§§n          {§§n            lineColor: "#6bb55b",§§n            fillAlphas: 1.0,§§n            type: "column",§§n            valueField: "QtyEntry",§§n            valueAxis: "right-axis",§§n            title: "Entries"§§n          },§§n          {§§n            balloonText: "<b>[[QtyExitABS]]</b> exits",§§n            legendValueText: "[[QtyExitABS]]",§§n            lineColor: "#b05858",§§n            fillAlphas: 0.9,§§n            type: "column",§§n            valueField: "QtyExit",§§n            valueAxis: "right-axis",§§n            clustered: false,§§n            title: "Exits"§§n          }§§n        ],§§n        chartCursor: {§§n          categoryBalloonDateFormat: "JJ:NN",§§n          cursorAlpha: 0,§§n          cursorPosition: "mouse"§§n        },§§n        categoryField: "Slot",§§n        categoryAxis: {§§n          minPeriod: "15mm",§§n          parseDates: true,§§n          color: "#444444",§§n          gridThickness: 0§§n        }§§n      });§§n    });§§n§§n  </script>§§n</head>§§n§§n§§n<body>§§n  <div class="header">§§n    <table width="100%">§§n      <tr>§§n  	    <td><h1>[[@Total.LocationCode]] [@Total.LocationName] - [@Total.FiscalDate {format:ShortDate}]</h1></td>§§n        <td align="right"><h1>[@ITL.Stats.AdmAccDlyGph]<h1></td>§§n      </tr>§§n    </table>§§n  §§n  <div class="counters">§§n    <table width="100%">§§n      <tr>§§n        <td>[@ITL.Common.Entries]:</td><td align="right">[@Total.QtyEntry]</td>§§n      <tr>§§n      </tr>§§n        <td>[@ITL.Common.Exits]:</td><td align="right">[@Total.QtyExit]</td>§§n      <tr>§§n      </tr>§§n        <td>[@ITL.Common.InPark]:</td><td align="right">[@Total.QtyInside]</td>§§n      </tr>§§n    </table>§§n  </div>§§n  §§n  <div id="slot-chart" style="height:350px"></div>§§n</body>§§n§§n</html>]]>
		</DocData>
		<SystemCode>AdmAccDlyGph</SystemCode>
		<DocContexts/>
		<LogCount>94</LogCount>
		<ParamList>
			<Param>
				<DocParamId>C225801D-BDBB-D177-100A-0158638275C8</DocParamId>
				<DocTemplateId>FECAE49E-B710-4931-86F1-900AB22E07A6</DocTemplateId>
				<DocParamType>4</DocParamType>
				<DocParamName>FiscalDate</DocParamName>
				<DocParamCaption>@Common.Date</DocParamCaption>
				<DocParamDefault>[@CurrentDate]</DocParamDefault>
			</Param>
			<Param>
				<DocParamId>05EE212C-EB8B-3F90-100B-0158638275C9</DocParamId>
				<DocTemplateId>FECAE49E-B710-4931-86F1-900AB22E07A6</DocTemplateId>
				<DocParamType>1001</DocParamType>
				<DocParamName>LocationId</DocParamName>
				<DocParamCaption>@Account.Location</DocParamCaption>
				<DocParamDefault>[@CurrentLocationId]</DocParamDefault>
			</Param>
			<Param>
				<DocParamId>366FB9CA-51A8-9632-1009-0158638275C5</DocParamId>
				<DocTemplateId>FECAE49E-B710-4931-86F1-900AB22E07A6</DocTemplateId>
				<DocParamType>1005</DocParamType>
				<DocParamName>Z_AccessAreaId</DocParamName>
				<DocParamCaption>@Account.AccessArea</DocParamCaption>
				<DocParamDefault/>
			</Param>
		</ParamList>
		<DataSourceList>
			<DataSource>
				<Name>Default</Name>
				<SQL>
					<![CDATA[declare @FiscalDate date;§§nset @FiscalDate=Coalesce(:@FiscalDate, GetDate());§§n§§nselect §§n  LocationCode,§§n  LocationName,§§n  FiscalDate,§§n  DateTime,§§n  DT_Year,§§n  DT_Month,§§n  DT_Day,§§n  DT_Hour,§§n  DT_Minute,§§n  Sum(QtyEntry) as QtyEntry,§§n  Sum(QtyExit) as QtyExit	§§nfrom (§§n  select §§n    Loc.AccountCode as LocationCode,§§n    Loc.DisplayName as LocationName,§§n    CA.FiscalDate,§§n    CA.DateTime,§§n    Year(CA.DateTime) as DT_Year,§§n    Month(CA.DateTime) as DT_Month,§§n    Day(CA.DateTime) as DT_Day,§§n    DatePart(hour, CA.DateTime) as DT_Hour,§§n    DatePart(minute, CA.DateTime) as DT_Minute,§§n    Sum(CA.QtyEntry + CA.QtyReentry + CA.QtyCrossover + CA.QtyOverride + CA.QtyTransit + CA.QtyOffEntry + CA.QtyOffReentry + CA.QtyOffCrossover) as QtyEntry,§§n    0 as QtyExit§§n  from§§n    tbConsAccess CA inner join§§n    tbAccount AA on AA.AccountId=CA.AccessAreaAccountId inner join§§n    tbAccount Loc on Loc.AccountId=AA.ParentAccountId§§n  where§§n    CA.ConsolidateType=2 and§§n    CA.FiscalDate=@FiscalDate and§§n    (:@LocationId is null or Loc.AccountId=:@LocationId) and§§n    (:@Z_AccessAreaId is null or AA.AccountId=:@Z_AccessAreaId)§§n  group by§§n    Loc.AccountCode,§§n    Loc.DisplayName,§§n    CA.FiscalDate,§§n    CA.DateTime§§n  §§n  union§§n§§n  select §§n    Loc.AccountCode as LocationCode,§§n    Loc.DisplayName as LocationName,§§n    CR.FiscalDate,§§n    CR.DateTime,§§n    Year(CR.DateTime) as DT_Year,§§n    Month(CR.DateTime) as DT_Month,§§n    Day(CR.DateTime) as DT_Day,§§n    DatePart(hour, CR.DateTime) as DT_Hour,§§n    DatePart(minute, CR.DateTime) as DT_Minute,§§n    0 as QtyEntry,§§n    Sum(CR.QtyExit) as QtyExit§§n  from§§n    tbConsRotation CR inner join§§n    tbAccount Loc on Loc.AccountId=CR.LocationAccountId§§n  where§§n    CR.ConsolidateType=2 and§§n    CR.FiscalDate=@FiscalDate and§§n    (:@LocationId is null or CR.LocationAccountId=:@LocationId) and§§n  	(:@Z_AccessAreaId is null or CR.AptWorkstationId in (select AptWorkstationId from tbAccessPoint2Area where AccessAreaAccountId=:@Z_AccessAreaId))§§n  group by§§n    Loc.AccountCode,§§n    Loc.DisplayName,§§n    CR.FiscalDate,§§n    CR.DateTime§§n) Y§§n§§ngroup by §§n  LocationCode,§§n  LocationName,§§n  FiscalDate,§§n  DateTime,§§n  DT_Year,§§n  DT_Month,§§n  DT_Day,§§n  DT_Hour,§§n  DT_Minute,§§n  DateTime§§norder by§§n  DateTime§§n]]>
				</SQL>
			</DataSource>
			<DataSource>
				<Name>Total</Name>
				<SQL>
					<![CDATA[declare @FiscalDate date;§§nset @FiscalDate=Coalesce(:@FiscalDate, GetDate());§§n§§nselect§§n  LocationCode,§§n  LocationName,§§n  FiscalDate,§§n  Sum(QtyEntry) as QtyEntry,§§n  Sum(QtyExit) as QtyExit,§§n  Sum(QtyEntry - QtyExit) as QtyInside§§nfrom (§§n select §§n  Loc.AccountCode as LocationCode,§§n  Loc.DisplayName as LocationName,§§n  CR.FiscalDate,§§n  0 as QtyEntry,§§n  Sum(CR.QtyExit) as QtyExit§§nfrom§§n  tbConsRotation CR inner join§§n  tbAccount Loc on Loc.AccountId=CR.LocationAccountId§§nwhere§§n  CR.ConsolidateType=1 and§§n  CR.FiscalDate=@FiscalDate and§§n  (:@LocationId is null or CR.LocationAccountId=:@LocationId) and§§n  (:@Z_AccessAreaId is null or CR.AptWorkstationId in (select AptWorkstationId from tbAccessPoint2Area where AccessAreaAccountId=:@Z_AccessAreaId))§§ngroup by§§n  Loc.AccountCode,§§n  Loc.DisplayName,§§n  CR.FiscalDate§§n§§nunion§§n§§nselect §§n  Loc.AccountCode as LocationCode,§§n  Loc.DisplayName as LocationName,§§n  CA.FiscalDate,§§n  Sum(CA.QtyEntry + CA.QtyReentry + CA.QtyCrossover + CA.QtyOverride + CA.QtyTransit + CA.QtyOffEntry + CA.QtyOffReentry + CA.QtyOffCrossover) as QtyEntry,§§n  0 as QtyExit§§nfrom§§n  tbConsAccess CA inner join§§n  tbAccount AA on AA.AccountId=CA.AccessAreaAccountId inner join§§n  tbAccount Loc on Loc.AccountId=AA.ParentAccountId§§nwhere§§n  CA.ConsolidateType=1 and§§n  CA.FiscalDate=@FiscalDate and§§n  (:@LocationId is null or Loc.AccountId=:@LocationId) and§§n  (:@Z_AccessAreaId is null or AA.AccountId=:@Z_AccessAreaId)§§ngroup by§§n  Loc.AccountCode,§§n  Loc.DisplayName,§§n  CA.FiscalDate§§n  §§n  ) Y§§n§§ngroup by §§n  LocationCode,§§n  LocationName,§§n  FiscalDate§§n]]>
				</SQL>
			</DataSource>
		</DataSourceList>
		<RightList>
			<Right>
				<IconName>station.png</IconName>
				<UsrEntityType>3</UsrEntityType>
				<UsrEntityId>A0000131-0000-0000-0000-000000000003</UsrEntityId>
				<UsrEntityName>Every station</UsrEntityName>
				<RightLevel>5</RightLevel>
			</Right>
		</RightList>
	</DocTemplate>
</DOEnt_DocTemplate>