<?xml version="1.0" encoding="UTF-8" standalone="no"?><DOEnt_DocTemplate><Header><EntityType>37</EntityType><EntityId>570CB764-4EF9-8F74-071F-0163F3ACBA54</EntityId><LastUpdate>2020-10-01T15:24:00.000+0200</LastUpdate></Header><DocTemplate><IconName>rpt-dataexport.png</IconName><EntityType>37</EntityType><DocTemplateId>570CB764-4EF9-8F74-071F-0163F3ACBA54</DocTemplateId><DocTemplateName>Void Reason report</DocTemplateName><DocTemplateCode>SXRR41CX9EHY22T</DocTemplateCode><CategoryId>588BF595-7BC8-A2F1-02F1-0163F3ACA8FC</CategoryId><DocEnabled>true</DocEnabled><ExecRequireLogin>true</ExecRequireLogin><DocTemplateType>5</DocTemplateType><DocEditorType>6</DocEditorType><SystemCode>VoidReasonRpt</SystemCode><DocContexts/><SaleForApproval>false</SaleForApproval><SaleOpen>false</SaleOpen><SalePaid>false</SalePaid><SaleCompleted>false</SaleCompleted><LogCount>0</LogCount><DataSourceSelection>false</DataSourceSelection><DataSourceId/><MaxDateRangeDays/><MediaEncoderPluginId/><MediaRfidOptionType/><ParamList><Param><DocParamId>A9E8863B-0A01-899E-01E0-0174E41ABBA0</DocParamId><DocTemplateId>570CB764-4EF9-8F74-071F-0163F3ACBA54</DocTemplateId><DocParamType>4</DocParamType><DocParamName>DateFrom</DocParamName><DocParamCaption>@Common.FromDate</DocParamCaption><DocParamDefault>[@CurrentDate]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>0839A076-B07A-75F5-01E1-0174E41ABBA1</DocParamId><DocTemplateId>570CB764-4EF9-8F74-071F-0163F3ACBA54</DocTemplateId><DocParamType>4</DocParamType><DocParamName>DateTo</DocParamName><DocParamCaption>@Common.ToDate</DocParamCaption><DocParamDefault>[@CurrentDate]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>4CE75AC7-F488-152B-01E2-0174E41ABBA2</DocParamId><DocTemplateId>570CB764-4EF9-8F74-071F-0163F3ACBA54</DocTemplateId><DocParamType>1001</DocParamType><DocParamName>LocationId</DocParamName><DocParamCaption>@Account.Location</DocParamCaption><DocParamDefault>[@CurrentLocationId]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>09D17C1E-B930-93E1-01E3-0174E41ABBA2</DocParamId><DocTemplateId>570CB764-4EF9-8F74-071F-0163F3ACBA54</DocTemplateId><DocParamType>1002</DocParamType><DocParamName>OpAreaId</DocParamName><DocParamCaption>@Account.OpArea</DocParamCaption><DocParamDefault>[@CurrentOpAreaId]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>0F3DAEC3-5939-FA29-01E4-0174E41ABBA3</DocParamId><DocTemplateId>570CB764-4EF9-8F74-071F-0163F3ACBA54</DocTemplateId><DocParamType>1004</DocParamType><DocParamName>UserId</DocParamName><DocParamCaption>@Common.User</DocParamCaption><DocParamDefault>[@CurrentUserId]</DocParamDefault><Mandatory>false</Mandatory></Param><Param><DocParamId>50A7934B-68FE-2211-01E5-0174E41ABBA4</DocParamId><DocTemplateId>570CB764-4EF9-8F74-071F-0163F3ACBA54</DocTemplateId><DocParamType>1003</DocParamType><DocParamName>WorkstationId</DocParamName><DocParamCaption>@Common.Workstation</DocParamCaption><DocParamDefault>[@CurrentWorkstationId]</DocParamDefault><Mandatory>false</Mandatory></Param></ParamList><DataSourceList><DataSource><Name>Default</Name><Code>YEWY0KP3YBGQQBB</Code><SQL><![CDATA[select §§n  tbLkTransactionType.ItemName as TransactionType,§§n  T.TransactionDateTime,§§n  ('T:' + CONVERT(varchar(10), T.LicenseId) + '.' + CONVERT(varchar(5), W.StationSerial) + '.' + CONVERT(VARCHAR(6),T.TransactionFiscalDate, 12) + '.' + CONVERT(varchar(5), T.TransactionSerial)) as [TDSSN],§§n  T.TotalAmount,§§n  TI.Quantity,§§n  T.TransactionId,§§n  P.ProductName,§§n  SI.UnitAmount,§§n  PG.TagName as PrintGroup,§§n  FG.TagName as FinanceGroup,§§n  S.SaleCode,§§n  UsrLogin.UserName,§§n  UsrEmail.UserName as LoginEmail,§§n  Usr.DisplayName as [User],§§n  SupLogin.UserName as AuthorisedByUserName,§§n  SupEmail.UserName as AuthorisedByLoginEmail,§§n  Sup.DisplayName as AuthorisedBy,§§n  Stuff((§§n      select ' | ' + MF.MetaFieldName + ': ' + coalesce(MFI.MetaFieldItemName, MD.ShortValue)§§n      from§§n		tbMetaData MD left join§§n		tbMetaField MF on MF.MetaFieldId=MD.MetaFieldId left join§§n		tbMetaFieldItem MFI on (MF.MetaFieldId=MFI.MetaFieldId and MD.ShortValue=MFI.MetaFieldItemCode)§§n      where§§n        MD.EntityId=T.TransactionId§§n      order by§§n        MF.MetaFieldCode§§n      FOR XML PATH('')§§n    ), 1, 1, '') as Reason§§nfrom  §§n  tbTransaction T left join§§n  tbLookupItem tbLkTransactionType on tbLkTransactionType.TableCode=3 and tbLkTransactionType.ItemCode=T.TransactionType left join§§n  tbTransactionItem TI on TI.TransactionId=T.TransactionId left join§§n  tbSale S on S.SaleId=T.SaleId left join§§n  tbSaleItem SI on SI.SaleItemId=TI.SaleItemId left join§§n  tbProduct P on P.ProductId=SI.ProductId left join§§n  tbTag PG on PG.TagId=P.PrintGroupTagId left join§§n  tbTag FG on FG.TagId=P.FinanceGroupTagId left join§§n  tbWorkstation W on T.WorkstationId=W.WorkstationId left join§§n  tbAccount OPA on OPA.AccountId=T.OpAreaId left join§§n  tbAccount Usr on Usr.AccountId=T.UserAccountId left join§§n  tbAccount Sup on Sup.AccountId=T.SupAccountId  left join§§n  tbLoginAlias UsrLogin on UsrLogin.AccountId=Usr.AccountId and UsrLogin.LoginAliasType=0 left join§§n  tbLoginAlias UsrEmail on UsrEmail.AccountId=Usr.AccountId and UsrEmail.LoginAliasType=1 left join§§n  tbLoginAlias SupLogin on SupLogin.AccountId=Sup.AccountId and SupLogin.LoginAliasType=0 left join§§n  tbLoginAlias SupEmail on SupEmail.AccountId=Sup.AccountId and SupEmail.LoginAliasType=1§§nwhere§§n  T.TransactionType in (12,13,14,22,46,47,48) and§§n  T.TransactionFiscalDate>=:@DateFrom and§§n  T.TransactionFiscalDate<=:@DateTo and§§n  T.Paid<>0 and§§n  (:@WorkstationId is null or W.WorkstationId=:@WorkstationId) and§§n  (:@OpAreaId is null or OPA.AccountId=:@OpAreaId) and§§n  (:@LocationId is null or OPA.ParentAccountId=:@LocationId) and§§n  (:@UserId is null or T.UserAccountId=:@UserId)§§norder by §§n  T.TransactionDateTime	]]></SQL></DataSource></DataSourceList></DocTemplate></DOEnt_DocTemplate>